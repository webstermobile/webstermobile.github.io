"use strict";(self.webpackChunkst_admin=self.webpackChunkst_admin||[]).push([[2630],{56075:(w,B,i)=>{i.d(B,{h:()=>y});var e=i(24006),t=i(94650);let y=(()=>{class n{}return n.\u0275fac=function(x){return new(x||n)},n.\u0275dir=t.lG2({type:n,selectors:[["","appProvideParentForm",""]],features:[t._Bn([{provide:e.gN,useFactory:Z=>Z,deps:[e.F]}])]}),n})()},73071:(w,B,i)=>{i.d(B,{K:()=>x});var e=i(3927),t=i(94650),y=i(80529),n=i(28555),Z=i(91599);let x=(()=>{class u extends e.su{constructor(M,z,L){super(M,z),this.http=M,this.store=z,this.modelName="User",this.baseUrl="",this.handleError=L.createHandleError(`${this.modelName}Service`)}searchOwners(M){const z=this.getUrl("carpark/api/car-park-owners");return this.get(z)}searchOperators(M){const z=this.getUrl("carpark/api/car-park-operators");return this.get(z)}}return u.\u0275fac=function(M){return new(M||u)(t.LFG(y.eN),t.LFG(n.yh),t.LFG(Z.k))},u.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac}),u})()},52746:(w,B,i)=>{i.d(B,{t:()=>n});var e=i(72986),t=i(591),y=i(94650);let n=(()=>{class Z{constructor(){this.loading=!1,this.pagination={totalCount:0,rowsPerPage:20,page:1,sortBy:null,descending:!0,totalPages:1},this.listData=[],this.hadGetData$=new t.X(!1)}get hadGetData(){return this.hadGetData$.getValue()}get filterParams(){return this._filterParams}set filterParams(u){this._filterParams=u}reloadDataService(u,F="filterModel"){this.loading=!0,this.hadGetData$.next(!1),u[F](this.filterParams,this.pagination).pipe((0,e.q)(1)).subscribe(M=>{if(M.pagination.page>M.pagination.totalPages)return this.pagination={...this.pagination,page:M.pagination.totalPages},this.reloadDataService(u);this.loading=!1,this.pagination={...this.pagination,totalCount:M.pagination.totalCount||M.pagination.totalElements},this.listData=M.data,this.hadGetData$.next(!0)},()=>{this.loading=!1,this.listData=[],this.pagination={...this.pagination,totalCount:0}})}onQueryParamsChange(u){const{pageSize:F,pageIndex:M}=u;this.pagination={...this.pagination,rowsPerPage:F,page:M},this.reloadData()}reloadData(){}ngOnInit(){}}return Z.\u0275fac=function(u){return new(u||Z)},Z.\u0275cmp=y.Xpm({type:Z,selectors:[["ng-component"]],decls:0,vars:0,template:function(u,F){},encapsulation:2}),Z})()},22630:(w,B,i)=>{i.d(B,{z:()=>h});var e=i(36895),t=i(80529),y=i(24006),n=i(30329),Z=i(34793),x=i(372),u=i(73071),F=i(21532),S=(i(32311),i(3947),i(48942),i(85611),i(88796)),P=i(89383),J=i(19832),b=i(43056),R=i(56776),W=i(90355),q=(i(42883),i(20388)),E=i(34984),I=(i(69659),i(42265),i(94650));function p(c){return new J.w(c,"../assets/i18n/",".json")}let h=(()=>{class c{}return c.\u0275fac=function(l){return new(l||c)},c.\u0275mod=I.oAB({type:c}),c.\u0275inj=I.cJS({providers:[u.K],imports:[e.ez,y.u5,n.D,Z.Bz,x.kn,R.Db,b.UU,F.x,W.vO,S.A0,E.Ns.forRoot({echarts:()=>i.e(4734).then(i.bind(i,14734))}),q.zk.forRoot(),P.aw.forChild({loader:{provide:P.Zw,useFactory:p,deps:[t.eN]}})]}),c})()},32311:(w,B,i)=>{i.d(B,{_:()=>I});var e=i(38014),t=i(94650),y=i(36895),n=i(24006),Z=i(56075),x=i(38231),u=i(35635),F=i(66616),M=i(47044),z=i(21811),L=i(14685),v=i(89383);function S(p,A){1&p&&(t.TgZ(0,"div",49),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function P(p,A){1&p&&(t.TgZ(0,"div",49),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function J(p,A){1&p&&t._UZ(0,"i",50)}function b(p,A){1&p&&(t.TgZ(0,"div",51),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function R(p,A){1&p&&(t.TgZ(0,"div",52),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function W(p,A){1&p&&(t.TgZ(0,"div",52),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function Q(p,A){1&p&&(t.TgZ(0,"div",49),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function q(p,A){1&p&&(t.TgZ(0,"div",52),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function E(p,A){1&p&&(t.TgZ(0,"div",52),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function K(p,A){1&p&&(t.TgZ(0,"div",52),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function O(p,A){if(1&p){const h=t.EpF();t.TgZ(0,"div",11)(1,"div",12)(2,"h5"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",13),t.NdJ("click",function(){const l=t.CHM(h).index,o=t.oxw();return t.KtG(o.form.timeSlots.splice(l,1))}),t._UZ(6,"i",14),t.qZA()(),t.TgZ(7,"div",15)(8,"div",16)(9,"label",17)(10,"span",18),t._uU(11,"*"),t.qZA(),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"div",19)(15,"div",20)(16,"nz-time-picker",21,22),t.NdJ("ngModelChange",function(s){const o=t.CHM(h).$implicit;return t.KtG(o.from=s)}),t.qZA(),t.YNc(18,S,3,3,"div",23),t.qZA(),t.TgZ(19,"div",24),t._uU(20),t.ALo(21,"translate"),t.qZA(),t.TgZ(22,"div",20)(23,"nz-time-picker",21,25),t.NdJ("ngModelChange",function(s){const o=t.CHM(h).$implicit;return t.KtG(o.to=s)}),t.qZA(),t.YNc(25,P,3,3,"div",23),t.qZA()()(),t.YNc(26,J,1,0,"ng-template",null,26,t.W1O),t.TgZ(28,"div",16)(29,"label",27)(30,"span",18),t._uU(31,"*"),t.qZA(),t._uU(32),t.ALo(33,"translate"),t.qZA(),t.TgZ(34,"div",19)(35,"nz-input-group",28),t.ALo(36,"translate"),t.TgZ(37,"input",29,30),t.NdJ("ngModelChange",function(s){const o=t.CHM(h).$implicit;return t.KtG(o.rate=s)}),t.qZA()(),t.YNc(39,b,3,3,"div",31),t.qZA()(),t.TgZ(40,"div",16)(41,"label",17)(42,"span",18),t._uU(43,"*"),t.qZA(),t._uU(44),t.ALo(45,"translate"),t.qZA(),t.TgZ(46,"div",19)(47,"nz-input-group",32),t.ALo(48,"translate"),t.TgZ(49,"input",29,33),t.NdJ("ngModelChange",function(s){const o=t.CHM(h).$implicit;return t.KtG(o.firstChargingPeriod=s)}),t.qZA()(),t.YNc(51,R,3,3,"div",34),t.qZA()(),t.TgZ(52,"div",16)(53,"label",17)(54,"span",18),t._uU(55,"*"),t.qZA(),t._uU(56),t.ALo(57,"translate"),t.qZA(),t.TgZ(58,"div",19)(59,"nz-input-group",35)(60,"input",29,36),t.NdJ("ngModelChange",function(s){const o=t.CHM(h).$implicit;return t.KtG(o.minimumPerEntry=s)}),t.qZA()(),t.YNc(62,W,3,3,"div",34),t.qZA()()(),t.TgZ(63,"div",15)(64,"div",16)(65,"label",17)(66,"span",18),t._uU(67,"*"),t.qZA(),t._uU(68),t.ALo(69,"translate"),t.qZA(),t.TgZ(70,"div",37)(71,"nz-select",38,39),t.NdJ("ngModelChange",function(s){const o=t.CHM(h).$implicit;return t.KtG(o.rateType=s)}),t._UZ(73,"nz-option",40)(74,"nz-option",41)(75,"nz-option",42)(76,"nz-option",43),t.qZA(),t.YNc(77,Q,3,3,"div",23),t.qZA()(),t.TgZ(78,"div",16)(79,"label",17)(80,"span",18),t._uU(81,"*"),t.qZA(),t._uU(82),t.ALo(83,"translate"),t.qZA(),t.TgZ(84,"div",19)(85,"nz-input-group",32),t.ALo(86,"translate"),t.TgZ(87,"input",29,44),t.NdJ("ngModelChange",function(s){const o=t.CHM(h).$implicit;return t.KtG(o.graceTime=s)}),t.qZA()(),t.YNc(89,q,3,3,"div",34),t.qZA()(),t.TgZ(90,"div",16)(91,"label",17)(92,"span",18),t._uU(93,"*"),t.qZA(),t._uU(94),t.ALo(95,"translate"),t.qZA(),t.TgZ(96,"div",19)(97,"nz-input-group",28),t.ALo(98,"translate"),t.TgZ(99,"input",45,46),t.NdJ("ngModelChange",function(s){const o=t.CHM(h).$implicit;return t.KtG(o.firstChargingRate=s)}),t.qZA()(),t.YNc(101,E,3,3,"div",34),t.qZA()()(),t._UZ(102,"hr",47),t.TgZ(103,"div",15)(104,"div",16)(105,"label",17)(106,"span",18),t._uU(107,"*"),t.qZA(),t._uU(108),t.ALo(109,"translate"),t.qZA(),t.TgZ(110,"div",19)(111,"nz-input-group",35)(112,"input",29,48),t.NdJ("ngModelChange",function(s){const o=t.CHM(h).$implicit;return t.KtG(o.maxPerDate=s)}),t.qZA()(),t.YNc(114,K,3,3,"div",34),t.qZA()()()()}if(2&p){const h=A.$implicit,c=A.index,s=t.MAs(17),l=t.MAs(24),o=t.MAs(27),r=t.MAs(38),a=t.MAs(50),_=t.MAs(61),m=t.MAs(72),T=t.MAs(88),f=t.MAs(100),C=t.MAs(113),d=t.oxw();t.xp6(3),t.AsE("",t.lcZ(4,49,"Time Slot")," ",c+1,""),t.xp6(9),t.hij(" ",t.lcZ(13,51,"Time Range"),": "),t.xp6(4),t.MGl("name","fromTime",c,""),t.Q6J("ngModel",h.from)("nzUse12Hours",!0),t.xp6(2),t.Q6J("ngIf",s.invalid&&(s.dirty||s.touched||d.formRef.submitted)),t.xp6(2),t.hij(" ",t.lcZ(21,53,"to")," "),t.xp6(3),t.MGl("name","endTime",c,""),t.Q6J("ngModel",h.to)("nzUse12Hours",!0),t.xp6(2),t.Q6J("ngIf",l.invalid&&(l.dirty||l.touched||d.formRef.submitted)),t.xp6(4),t.MGl("for","exampleInputEmail",c,""),t.xp6(3),t.hij(" ",t.lcZ(33,55,"Rate"),": "),t.xp6(3),t.hYB("nzAddOnAfter","/",h.rateType,"",t.lcZ(36,57,"mins"),""),t.Q6J("nzAddOnBefore",o),t.xp6(2),t.MGl("name","rate",c,""),t.Q6J("ngModel",h.rate),t.xp6(2),t.Q6J("ngIf",r.invalid&&(r.dirty||r.touched||d.formRef.submitted)),t.xp6(5),t.hij(" ",t.lcZ(45,59,"First Charging Period"),": "),t.xp6(3),t.s9C("nzAddOnAfter",t.lcZ(48,61,"min")),t.xp6(2),t.MGl("name","chargingPeriod",c,""),t.Q6J("ngModel",h.firstChargingPeriod),t.xp6(2),t.Q6J("ngIf",a.invalid&&(a.dirty||a.touched||d.formRef.submitted)),t.xp6(5),t.hij(" ",t.lcZ(57,63,"Minimum Per Entry"),": "),t.xp6(3),t.Q6J("nzAddOnBefore",o),t.xp6(1),t.MGl("name","minimumPerEntry",c,""),t.Q6J("ngModel",h.minimumPerEntry),t.xp6(2),t.Q6J("ngIf",_.invalid&&(_.dirty||_.touched||d.formRef.submitted)),t.xp6(6),t.hij(" ",t.lcZ(69,65,"Rate Type"),": "),t.xp6(3),t.MGl("name","rateType",c,""),t.Q6J("ngModel",h.rateType),t.xp6(6),t.Q6J("ngIf",m.invalid&&(m.dirty||m.touched||d.formRef.submitted)),t.xp6(5),t.hij(" ",t.lcZ(83,67,"Grace Time"),": "),t.xp6(3),t.s9C("nzAddOnAfter",t.lcZ(86,69,"min")),t.xp6(2),t.MGl("name","graceTime",c,""),t.Q6J("ngModel",h.graceTime),t.xp6(2),t.Q6J("ngIf",T.invalid&&(T.dirty||T.touched||d.formRef.submitted)),t.xp6(5),t.hij(" ",t.lcZ(95,71,"First Charging Rate"),": "),t.xp6(3),t.s9C("nzAddOnAfter",t.lcZ(98,73,"min")),t.Q6J("nzAddOnBefore",o),t.xp6(2),t.Q6J("ngModel",h.firstChargingRate),t.xp6(2),t.Q6J("ngIf",f.invalid&&(f.dirty||f.touched||d.formRef.submitted)),t.xp6(7),t.hij(" ",t.lcZ(109,75,"Max Per Day"),": "),t.xp6(3),t.Q6J("nzAddOnBefore",o),t.xp6(1),t.MGl("name","maxPerDate",c,""),t.Q6J("ngModel",h.maxPerDate),t.xp6(2),t.Q6J("ngIf",C.invalid&&(C.dirty||C.touched||d.formRef.submitted))}}let I=(()=>{class p{constructor(){this.form=(0,e.jqJ)()}ngOnInit(){this.form={...this.form,effectiveStartDate:new Date(this.form.effectiveStartDate),effectiveEndDate:new Date(this.form.effectiveEndDate)}}addNewTimeSlot(){this.form.timeSlots.push((0,e.z5G)())}deleteChip(h,c,s,l){h.stopPropagation(),c.removeItem(s,l)}}return p.\u0275fac=function(h){return new(h||p)},p.\u0275cmp=t.Xpm({type:p,selectors:[["app-tariffs-form-adhoc"]],inputs:{form:"form",formRef:"formRef"},decls:16,vars:7,consts:[["appProvideParentForm",""],[1,"m-portlet"],[1,"m-portlet__head","d-flex","align-items-center"],[1,"row","m--marginless"],[1,"m-portlet__head-caption"],[1,"m-portlet__head-title"],[1,"m-portlet__head-text"],["class","m-portlet__body row",4,"ngFor","ngForOf"],[1,"m-portlet__foot"],["type","button","nz-button","","nzType","primary","nzGhost","","nzShape","round",3,"click"],[1,"la","la-plus"],[1,"m-portlet__body","row"],[1,"col-12","d-flex","justify-content-between","m--margin-bottom-20"],["type","button","nz-button","",3,"click"],[1,"la","la-trash"],[1,"col-6"],[1,"row","form-group"],[1,"col-form-label","text-right","col-4"],[1,"m--font-danger"],[1,"input-group","col-8"],[1,"col","m--padding-0"],["nzFormat","h:mm a","required","",2,"width","100%",3,"name","ngModel","nzUse12Hours","ngModelChange"],["fromTime","ngModel"],["class","form-control-feedback",4,"ngIf"],[1,"input-group-append",2,"line-height","35px","padding","0 6px"],["endTime","ngModel"],["addOnBeforeTemplate",""],[1,"col-form-label","text-right","col-4",3,"for"],[3,"nzAddOnBefore","nzAddOnAfter"],["type","text","nz-input","","required","",3,"name","ngModel","ngModelChange"],["rate","ngModel"],["class","form-control-feedback m--font-danger",4,"ngIf"],[3,"nzAddOnAfter"],["chargingPeriod","ngModel"],["class","w-100 form-control-feedback m--font-danger",4,"ngIf"],[3,"nzAddOnBefore"],["minimumPerEntry","ngModel"],[1,"col-8"],["required","",2,"width","100%",3,"name","ngModel","ngModelChange"],["rateType","ngModel"],["nzValue","15","nzLabel","15"],["nzValue","30","nzLabel","30"],["nzValue","45","nzLabel","45"],["nzValue","60","nzLabel","60"],["graceTime","ngModel"],["type","text","nz-input","","name","chargingRate","required","",3,"ngModel","ngModelChange"],["chargingRate","ngModel"],[1,"col-11"],["maxPerDate","ngModel"],[1,"form-control-feedback"],[1,"la","la-usd"],[1,"form-control-feedback","m--font-danger"],[1,"w-100","form-control-feedback","m--font-danger"]],template:function(h,c){1&h&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h3",6),t._uU(8),t.ALo(9,"translate"),t.qZA()()()()(),t.YNc(10,O,115,77,"div",7),t.TgZ(11,"div",8)(12,"button",9),t.NdJ("click",function(){return c.addNewTimeSlot()}),t._UZ(13,"i",10),t._uU(14),t.ALo(15,"translate"),t.qZA()()()()),2&h&&(t.xp6(8),t.hij(" ",t.lcZ(9,3,"Tariff")," "),t.xp6(2),t.Q6J("ngForOf",c.form.timeSlots),t.xp6(4),t.hij(" ",t.lcZ(15,5,"Add New Time Slot")," "))},dependencies:[y.sg,y.O5,n.Fj,n.JJ,n.Q7,n.On,Z.h,x.Ip,x.Vq,u.Zp,u.gB,F.ix,M.w,z.dQ,L.m4,v.X$],encapsulation:2}),p})()},42883:(w,B,i)=>{i.d(B,{f:()=>c});var e=i(79118),t=i(15439),n=i(94650),Z=i(34793),x=i(89383),u=i(67556),F=i(50007),M=i(49651),z=i(36895),L=i(24006),v=i(40269),S=i(38231),P=i(35635),J=i(66616),b=i(47044),R=i(21811),W=i(34984);function Q(s,l){1&s&&(n.TgZ(0,"div",31),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&s&&(n.xp6(1),n.hij(" ",n.lcZ(2,1," Field is required.")," "))}function q(s,l){if(1&s&&(n.TgZ(0,"th"),n._uU(1),n.qZA()),2&s){const o=l.$implicit;n.xp6(1),n.Oqu(o.text)}}function E(s,l){if(1&s&&n._UZ(0,"nz-option",36),2&s){const o=l.$implicit;n.Q6J("nzValue",o)("nzLabel",o)}}function K(s,l){if(1&s&&n._UZ(0,"nz-option",36),2&s){const o=l.$implicit;n.Q6J("nzValue",o)("nzLabel",o)}}function O(s,l){if(1&s&&n._UZ(0,"nz-option",36),2&s){const o=l.$implicit;n.Q6J("nzValue",l.index)("nzLabel",o.name)}}function I(s,l){if(1&s){const o=n.EpF();n.TgZ(0,"i",37),n.NdJ("click",function(){n.CHM(o);const a=n.oxw().index,_=n.oxw();return n.KtG(_.delete(a))}),n.qZA()}}function p(s,l){if(1&s){const o=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2),n.qZA(),n.TgZ(3,"td")(4,"nz-select",32),n.NdJ("ngModelChange",function(a){const m=n.CHM(o).$implicit;return n.KtG(m.startTime=a)}),n.YNc(5,E,1,2,"nz-option",33),n.qZA()(),n.TgZ(6,"td")(7,"nz-select",32),n.NdJ("ngModelChange",function(a){const m=n.CHM(o).$implicit;return n.KtG(m.endTime=a)})("ngModelChange",function(){const _=n.CHM(o).index,m=n.oxw();return n.KtG(m.revisedECharts("endTime",_))}),n.YNc(8,K,1,2,"nz-option",33),n.qZA()(),n.TgZ(9,"td"),n._uU(10),n.qZA(),n.TgZ(11,"td")(12,"nz-select",34),n.NdJ("ngModelChange",function(a){const m=n.CHM(o).$implicit;return n.KtG(m.costType=a)})("ngModelChange",function(){n.CHM(o);const a=n.oxw();return n.KtG(a.revisedECharts())}),n.YNc(13,O,1,2,"nz-option",33),n.qZA()(),n.TgZ(14,"td"),n._uU(15),n.qZA(),n.TgZ(16,"td"),n._uU(17),n.qZA(),n.TgZ(18,"td"),n.YNc(19,I,1,0,"i",35),n.qZA()()}if(2&s){const o=l.$implicit,r=l.index,a=n.oxw();n.xp6(2),n.Oqu(r),n.xp6(2),n.MGl("name","startTime",r,""),n.Q6J("nzDisabled",!0)("ngModel",o.startTime),n.xp6(1),n.Q6J("ngForOf",a.periodTimeList),n.xp6(2),n.MGl("name","endTime",r,""),n.Q6J("nzDisabled",!0)("ngModel",o.endTime)("nzDisabled",a.saveInfos.items.length-1===r),n.xp6(1),n.Q6J("ngForOf",a.periodTimeList),n.xp6(2),n.Oqu(o.duration),n.xp6(2),n.MGl("name","costType",r,""),n.Q6J("ngModel",o.costType),n.xp6(1),n.Q6J("ngForOf",a.feeModelList),n.xp6(2),n.Oqu(o.powerPrice?o.powerPrice:"please edit model"),n.xp6(2),n.Oqu(o.serviceFee?o.serviceFee:"please edit model"),n.xp6(2),n.Q6J("ngIf",0!==r)}}function A(s,l){if(1&s){const o=n.EpF();n.TgZ(0,"div",6)(1,"label",39)(2,"span",8),n._uU(3,"*"),n.qZA(),n._uU(4),n.ALo(5,"translate"),n.qZA(),n.TgZ(6,"div",40)(7,"input",41),n.NdJ("ngModelChange",function(a){const m=n.CHM(o).index,T=n.oxw(2);return n.KtG(T.editFeeModelList[m].powerPrice=a)}),n.qZA()(),n.TgZ(8,"label",42)(9,"span",8),n._uU(10,"*"),n.qZA(),n._uU(11),n.ALo(12,"translate"),n.qZA(),n.TgZ(13,"div",43)(14,"input",41),n.NdJ("ngModelChange",function(a){const m=n.CHM(o).index,T=n.oxw(2);return n.KtG(T.editFeeModelList[m].serviceFee=a)}),n.qZA()()()}if(2&s){const o=l.$implicit,r=l.index,a=n.oxw(2);n.xp6(4),n.hij(" ",n.lcZ(5,4,o.name+" Power Price"),": "),n.xp6(3),n.Q6J("ngModel",a.editFeeModelList[r].powerPrice),n.xp6(4),n.hij(" ",n.lcZ(12,6,o.name+" Service Price"),": "),n.xp6(3),n.Q6J("ngModel",a.editFeeModelList[r].serviceFee)}}function h(s,l){if(1&s&&n.YNc(0,A,15,8,"div",38),2&s){const o=n.oxw();n.Q6J("ngForOf",o.editFeeModelList)}}let c=(()=>{class s{constructor(o,r,a,_,m,T){let f;for(this.router=o,this.translate=r,this.evcService=a,this.nzModalService=_,this.nzMessageService=m,this.route=T,this.periodTimeList=[],this.tableHeaders=[{text:"#",align:e.iW.Center,width:"7%"},{text:"Start Time",width:"15%"},{text:"End Time",width:"15%"},{text:"Duration(hrs)",width:"14%"},{text:"Fee model",width:"13%"},{text:"Power Price",width:"15%"},{text:"Service Fee",width:"15%"},{text:"Action",width:"6%"}],this.constant={time24:"24:00"},this.feeModelList=[{name:"Peak",powerPrice:null,serviceFee:null},{name:"High",powerPrice:null,serviceFee:null},{name:"Normal",powerPrice:null,serviceFee:null},{name:"Low",powerPrice:null,serviceFee:null}],this.editFeeModelList=[],this.saveInfos={companyId:null,costmodeId:"",costmodeName:null,delete_items:[],note:null,items:[],createBy:null},this.model=this.route.snapshot.queryParams.model,f=0;f<25;f++){let C;C=f+":00",this.periodTimeList.push(C)}this.periodTimeList[f-1]=this.constant.time24,this.pushDefaultPrice(),"update"===this.model&&this.setDataWhUpdate(),this.routeName=this.route.snapshot.queryParams.routeName}openModal(o){this.editFeeModelList=[...this.feeModelList],this.nzModalService.create({nzTitle:"Edit Model",nzContent:o,nzWidth:800,nzOnOk:()=>this.saveModel()})}ngOnInit(){const o=this.tableHeaders.map(r=>r.text);this.translate.get(o).subscribe(r=>{this.tableHeaders.forEach(a=>{for(const _ in r)r.hasOwnProperty(_)&&a.text===_&&(a.text=r[_])})})}ngAfterViewInit(){setTimeout(()=>{this.modifyECharts()},3e3)}ngOnDestroy(){"update"===this.model&&localStorage.removeItem("curCostmode")}setDataWhUpdate(){const o=localStorage.getItem("curCostmode");o&&(this.saveInfos=JSON.parse(o),this.saveInfos.items[this.saveInfos.items.length-1].endTime=this.constant.time24),this.evcService.getAllElectricPrice({companyName:"",pageNum:1,pageSize:99999}).subscribe(a=>{if("00000"==a.messageCode){const _=a.data.content.filter(m=>m.companyId===this.saveInfos.companyId);0!==_.length&&(this.feeModelList[0].powerPrice=_[0].topPrice,this.feeModelList[0].serviceFee=_[0].serviceTopFee,this.feeModelList[1].powerPrice=_[0].peakPrice,this.feeModelList[1].serviceFee=_[0].servicePeakFee,this.feeModelList[2].powerPrice=_[0].norPrice,this.feeModelList[2].serviceFee=_[0].serviceNorFee,this.feeModelList[3].powerPrice=_[0].lowPrice,this.feeModelList[3].serviceFee=_[0].serviceLowFee),this.revisedECharts()}else this.message="Get data error..."})}saveModel(){this.feeModelList=[...this.editFeeModelList],this.revisedECharts()}pushDefaultPrice(){this.saveInfos.items.push({id:"",costType:0,startTime:this.periodTimeList[0],endTime:this.constant.time24,duration:24,powerPrice:null,serviceFee:null})}goBack(){this.routeName?this.router.navigate(["/evc/tariffs"],{queryParams:{id:1,routeName:"tariff"}}):this.router.navigate(["./tariffs"])}addCharts(){const o=this.saveInfos.items,r=o.length;if(0!==r){if("23:00"===o[r-1].startTime)return void this.alert("Warn : time cannot more than 24hours");this.pushDefaultPrice(),this.revisedECharts()}}revisedECharts(o,r){let a;const _=this.saveInfos.items;if("endTime"===o&&r<_.length-1&&(this.compare2Time(_[r].endTime,_[r].startTime)||this.compare2Time(_[r+1].endTime,_[r].endTime)))return void setTimeout(()=>{_[r].endTime=_[r+1].startTime},500);_.forEach(T=>{if(T.powerPrice=this.feeModelList[T.costType].powerPrice,T.serviceFee=this.feeModelList[T.costType].serviceFee,a&&T.startTime!==a.endTime){if(a.endTime===this.constant.time24){const f=this.periodTimeList.indexOf(a.startTime);T.startTime=this.periodTimeList[f+1],a.endTime=T.startTime}else"endTime"===o?T.startTime=a.endTime:a.endTime=T.startTime;a.duration=t(a.endTime,"hh:mm").diff(t(a.startTime,"hh:mm"),"hour"),T.duration=t(T.endTime,"hh:mm").diff(t(T.startTime,"hh:mm"),"hour")}a=T});const m=this.saveInfos.items[this.saveInfos.items.length-1];m.endTime=this.constant.time24,m.duration=t(m.endTime,"hh:mm").diff(t(m.startTime,"hh:mm"),"hour"),this.modifyECharts()}compare2Time(o,r){return parseFloat(o.replace(":","."))<=parseFloat(r.replace(":","."))}getDefaultFeeArr(){const o=[];for(let r=0;r<24;r++)o.push("-");return o}modifyECharts(){const o=this.saveInfos.items.map(r=>{const a=this.getDefaultFeeArr(),_=this.periodTimeList.indexOf(r.startTime),T=this.periodTimeList.indexOf(r.endTime)-_,f=parseFloat(r.powerPrice)+parseFloat(r.serviceFee);for(let C=0;C<=T;C++)a[_+C]=f;return{data:a,type:"line",areaStyle:{type:"default",color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"red"},{offset:1,color:"#fff"}])},lineStyle:{color:"red"}}});this.option={series:o,xAxis:{type:"category",boundaryGap:!1,data:this.periodTimeList},yAxis:{type:"value"}}}delete(o){0!==o&&(this.saveInfos.items[o].id&&this.saveInfos.delete_items.push(this.saveInfos.items[o].id),this.saveInfos.items.splice(o,1),this.revisedECharts())}editPrice(){this.revisedECharts()}submit(){const o=this.getBasicPrice(),r={basicPrice:o,companyName:this.saveInfos.costmodeName,peakRate:this.getPriceRate(this.feeModelList[1].powerPrice,o),topRate:this.getPriceRate(this.feeModelList[0].powerPrice,o),norRate:this.getPriceRate(this.feeModelList[2].powerPrice,o),lowRate:this.getPriceRate(this.feeModelList[3].powerPrice,o),otherRate:"0%",note:this.saveInfos.note,serviceTopFee:this.feeModelList[0].serviceFee,servicePeakFee:this.feeModelList[1].serviceFee,serviceLowFee:this.feeModelList[3].serviceFee,serviceNorFee:this.feeModelList[2].serviceFee,companyId:"",lowPrice:this.feeModelList[3].powerPrice,norPrice:this.feeModelList[2].powerPrice,operatorId:"1",peakPrice:this.feeModelList[1].powerPrice,topPrice:this.feeModelList[0].powerPrice};let a="add";this.saveInfos.companyId&&(r.companyId=this.saveInfos.companyId,a="update"),this.saveInfos.items=this.saveInfos.items.map(_=>({..._,startTime:_.startTime+":00",endTime:"24:00"==_.endTime?"23:59:59":_.endTime+":00"})),this.evcService.addElectricPrice(r).subscribe(_=>{if("00000"==_.messageCode){"add"==a&&(this.saveInfos.companyId=_.data.id);const m={costmodeName:this.saveInfos.costmodeName,costmodeId:this.saveInfos.costmodeId,companyId:this.saveInfos.companyId,note:this.saveInfos.note,periodArr:this.saveInfos.items,delete_items:this.saveInfos.delete_items,createBy:"add"==a?JSON.parse(localStorage.getItem("user")).firstName:null,updateBy:"add"==a?null:JSON.parse(localStorage.getItem("user")).firstName};this.evcService.addCostModel(m,this.model).subscribe(T=>{"00000"==T.messageCode?this.goBack():this.alert(`${_.messageCode} : Save EVC tariffs failed`)},()=>{this.alert("Exception : Delete EVC tariffs failed")})}else this.alert(`${_.messageCode} : Save EVC tariffs failed`)},()=>{this.alert("Exception : Delete EVC tariffs failed")})}alert(o){this.nzMessageService.warning(o)}getBasicPrice(){let o=1,r=1;return this.feeModelList.forEach(a=>{a.powerPrice&&(a.powerPrice>o&&(o=+a.powerPrice),a.powerPrice<r&&(r=+a.powerPrice))}),o+r===0?1:o!==r?(o+r)/2:o}getPriceRate(o,r){return(o-r)/r*100+"%"}}return s.\u0275fac=function(o){return new(o||s)(n.Y36(Z.F0),n.Y36(x.sK),n.Y36(u.z$),n.Y36(F.Sf),n.Y36(M.dD),n.Y36(Z.gz))},s.\u0275cmp=n.Xpm({type:s,selectors:[["app-tariffs-form-evc"]],inputs:{model:"model"},decls:51,vars:22,consts:[[1,"m-portlet","m-portlet--bordered-semi","m--padding-top-30"],[1,"m-portlet__body"],[1,"row","form-group","m-form__group","m--margin-bottom-30",3,"ngSubmit"],["formRef","ngForm"],[1,"col-xl-12","order-2","order-xl-1"],[1,"m-form","m-form--fit","m-form--label-align-right"],[1,"row","form-group"],[1,"col-form-label","col-2","text-right"],[1,"m--font-danger"],["class","form-control-feedback",4,"ngIf"],[1,"col-4"],["type","text","nz-input","","required","","name","costmodeName",3,"ngModel","disabled","ngModelChange"],["costmodeName","ngModel"],[1,"col-form-label","col-lg-2","col-sm-12","text-right"],[1,"col-lg-4","col-sm-12"],["type","text","name","note","nz-input","",3,"ngModel","ngModelChange"],["id","EvcChart","echarts","",2,"height","400px","width","100%",3,"options"],[1,"col-xl-12","order-2","order-xl-1",2,"display","flex","justify-content","flex-end"],["type","button","nz-button","",3,"click"],[1,"la","la-arrow-left"],["type","button","nz-button","",1,"mgl16",3,"click"],[1,"la","la-pencil"],["type","submit","nz-button","","nzType","primary",1,"mgl16"],[1,"col-xl-12","order-2","order-xl-1",2,"padding-top","50px"],[1,"m-datatable","m-datatable--default","m-datatable--brand","m-datatable--loaded"],["nzTemplateMode",""],[4,"ngFor","ngForOf"],[1,"col-xl-12","order-2","order-xl-1",2,"display","flex","justify-content","center","padding-top","20px"],["type","button","nz-button","","nzType","link",3,"click"],[1,"la","la-plus-circle"],["template",""],[1,"form-control-feedback"],[2,"width","80px",3,"nzDisabled","ngModel","name","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[2,"width","100px",3,"ngModel","name","ngModelChange"],["class","la la-close",3,"click",4,"ngIf"],[3,"nzValue","nzLabel"],[1,"la","la-close",3,"click"],["class","row form-group",4,"ngFor","ngForOf"],[1,"col-form-label","col-3","text-right"],[1,"col-3"],["type","text","nz-input","",3,"ngModel","ngModelChange"],[1,"col-form-label","col-lg-3","col-sm-12","text-right"],[1,"col-lg-3","col-sm-12"]],template:function(o,r){if(1&o){const a=n.EpF();n.TgZ(0,"div",0)(1,"div",1)(2,"form",2,3),n.NdJ("ngSubmit",function(){n.CHM(a);const m=n.MAs(3);return n.KtG(m.valid&&r.submit())}),n.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"label",7)(8,"span",8),n._uU(9,"*"),n.qZA(),n._uU(10),n.ALo(11,"translate"),n.YNc(12,Q,3,3,"div",9),n._uU(13,": "),n.qZA(),n.TgZ(14,"div",10)(15,"input",11,12),n.NdJ("ngModelChange",function(m){return r.saveInfos.costmodeName=m}),n.qZA()(),n.TgZ(17,"label",13),n._uU(18),n.ALo(19,"translate"),n.qZA(),n.TgZ(20,"div",14)(21,"input",15),n.NdJ("ngModelChange",function(m){return r.saveInfos.note=m}),n.qZA()()()()(),n.TgZ(22,"div",4),n._UZ(23,"div",16),n.qZA(),n.TgZ(24,"div",17)(25,"button",18),n.NdJ("click",function(){return r.goBack()}),n.TgZ(26,"span"),n._UZ(27,"i",19),n._uU(28),n.ALo(29,"translate"),n.qZA()(),n.TgZ(30,"button",20),n.NdJ("click",function(){n.CHM(a);const m=n.MAs(50);return n.KtG(r.openModal(m))}),n.TgZ(31,"span"),n._UZ(32,"i",21),n._uU(33),n.ALo(34,"translate"),n.qZA()(),n.TgZ(35,"button",22),n._uU(36),n.ALo(37,"translate"),n.qZA()(),n.TgZ(38,"div",23)(39,"div",24)(40,"nz-table",25)(41,"thead")(42,"tr"),n.YNc(43,q,2,1,"th",26),n.qZA()(),n.TgZ(44,"tbody"),n.YNc(45,p,20,17,"tr",26),n.qZA()()()(),n.TgZ(46,"div",27)(47,"button",28),n.NdJ("click",function(){return r.addCharts()}),n._UZ(48,"i",29),n.qZA()()()()(),n.YNc(49,h,1,1,"ng-template",null,30,n.W1O)}if(2&o){const a=n.MAs(3),_=n.MAs(16);n.xp6(10),n.hij(" ",n.lcZ(11,12,"Tariff Name")," "),n.xp6(2),n.Q6J("ngIf",_.invalid&&(_.dirty||_.touched||a.submitted)),n.xp6(3),n.Q6J("ngModel",r.saveInfos.costmodeName)("disabled","update"===r.model),n.xp6(3),n.hij(" ",n.lcZ(19,14,"Note"),": "),n.xp6(3),n.Q6J("ngModel",r.saveInfos.note),n.xp6(2),n.Q6J("options",r.option),n.xp6(5),n.hij(" ",n.lcZ(29,16,"Back"),""),n.xp6(5),n.hij(" ",n.lcZ(34,18,"Model"),""),n.xp6(3),n.Oqu(n.lcZ(37,20,"Submit")),n.xp6(7),n.Q6J("ngForOf",r.tableHeaders),n.xp6(2),n.Q6J("ngForOf",r.saveInfos.items)}},dependencies:[z.sg,z.O5,L._Y,L.Fj,L.JJ,L.JL,L.Q7,L.On,L.F,v.N8,v.Uo,v._C,v.Om,v.p0,v.$Z,S.Ip,S.Vq,P.Zp,J.ix,b.w,R.dQ,W._w,x.X$],styles:["[_nghost-%COMP%]     .m-datatable__table{min-height:initial!important}.btn-color-white[_ngcontent-%COMP%], .btn-color-purple[_ngcontent-%COMP%]{width:120px!important}.btn-color-white[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #dcdcdc;color:#6f6f6f;margin-right:30px}.btn-color-purple[_ngcontent-%COMP%]{background-color:#5866dd;border:1px solid #5866dd;color:#fff}.btn-color-purple[_ngcontent-%COMP%]:active{background-color:#5866dd}.la-plus-circle[_ngcontent-%COMP%]:hover, .la-close[_ngcontent-%COMP%]:hover, .la-pencil[_ngcontent-%COMP%]:hover{color:#5866dd;cursor:pointer}.myModelClass[_ngcontent-%COMP%]{max-width:600px!important}"]}),s})()},3947:(w,B,i)=>{i.d(B,{O:()=>T});var e=i(94650),t=i(38014),y=i(8929),n=i(24850),Z=i(72986),x=i(1059),u=i(80013),F=i(75778),M=i(2994),z=i(87545),L=i(88117),v=i(73071),S=i(36511),P=i(34793),J=i(89383),b=i(36895),R=i(24006),W=i(38231),Q=i(35635),q=i(66616),E=i(47044),K=i(21811),O=i(48942),I=i(85611),p=i(32311),A=i(42265);function h(f,C){1&f&&(e.TgZ(0,"div",31),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&f&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function c(f,C){if(1&f&&(e._UZ(0,"nz-option",32),e.ALo(1,"titlecase")),2&f){const d=C.$implicit;e.Q6J("nzValue",d.id)("nzLabel",e.lcZ(1,2,d.value))}}function s(f,C){if(1&f&&(e._UZ(0,"nz-option",32),e.ALo(1,"titlecase")),2&f){const d=C.$implicit;e.Q6J("nzValue",d.id)("nzLabel",e.lcZ(1,2,d.value))}}function l(f,C){if(1&f&&(e._UZ(0,"nz-option",32),e.ALo(1,"titlecase")),2&f){const d=C.$implicit;e.Q6J("nzValue",d.id)("nzLabel",e.lcZ(1,2,d.value))}}function o(f,C){if(1&f&&e._UZ(0,"nz-option",32),2&f){const d=C.$implicit;e.Q6J("nzValue",d.id)("nzLabel",d.name)}}function r(f,C){if(1&f&&e._UZ(0,"nz-option",32),2&f){const d=C.$implicit;e.Q6J("nzValue",d.id)("nzLabel",d.name)}}function a(f,C){if(1&f){const d=e.EpF();e.TgZ(0,"app-tariffs-form-normal",33),e.NdJ("formChange",function(N){e.CHM(d);const U=e.oxw();return e.KtG(U.form=N)}),e.qZA()}if(2&f){const d=e.oxw(),g=e.MAs(1);e.Q6J("form",d.form)("formRef",g)}}function _(f,C){if(1&f){const d=e.EpF();e.TgZ(0,"app-tariffs-form-season",33),e.NdJ("formChange",function(N){e.CHM(d);const U=e.oxw();return e.KtG(U.form=N)}),e.qZA()}if(2&f){const d=e.oxw(),g=e.MAs(1);e.Q6J("form",d.form)("formRef",g)}}function m(f,C){if(1&f){const d=e.EpF();e.TgZ(0,"app-tariffs-form-adhoc",33),e.NdJ("formChange",function(N){e.CHM(d);const U=e.oxw();return e.KtG(U.form=N)}),e.qZA()}if(2&f){const d=e.oxw(),g=e.MAs(1);e.Q6J("form",d.form)("formRef",g)}}let T=(()=>{class f{constructor(d,g,N,U,D){this.userService=d,this.codeTablesService=g,this.route=N,this.router=U,this.translate=D,this.form=(0,t.jqJ)(),this.submitted=new e.vpe,this.canceled=new e.vpe,this.ownerInput$=new y.xQ,this.operatorInput$=new y.xQ,this.tariffTypes=[],this.vehicleTypes=[]}get type(){return this.route.snapshot.queryParamMap.get("type")||this.form.tariffTypeCode}get vehicleType(){return this.route.snapshot.queryParamMap.get("vehicleType")||this.form.vehicleTypeCode}ngOnInit(){this.vehicleTypes$=this.codeTablesService.filterModelByType(t.BcL.VehicleType).pipe((0,n.U)(d=>{const g=d.find(N=>N.code===this.vehicleType);return this.form={...this.form,vehicleTypeId:g?.id},this.vehicleTypes=d})),this.tariffTypes$=this.codeTablesService.filterModelByType(t.BcL.TariffType).pipe((0,n.U)(d=>{const g=d.find(N=>N.value===this.type);return this.form={...this.form,tariffTypeId:g.id},this.tariffTypes=d})),this.carParkTypes$=this.codeTablesService.filterModelByType(t.BcL.Carpark).pipe((0,Z.q)(1)).map(d=>(this.form.carParkTypeId=this.form.carParkTypeId||d[0]&&d[0].id,d)),this.owner$=this.ownerInput$.pipe((0,x.O)(""),(0,u.b)(200),(0,F.x)(),(0,M.b)(()=>this.ownerLoading=!0),(0,z.w)(d=>this.userService.searchOwners(d).pipe((0,M.b)(()=>this.ownerLoading=!1))),(0,L.B)()),this.owner$.pipe((0,Z.q)(1)).subscribe(d=>this.form.ownerId=this.form.ownerId||d[0]&&d[0].id),this.operator$=this.operatorInput$.pipe((0,x.O)(""),(0,u.b)(200),(0,F.x)(),(0,M.b)(()=>this.operatorLoading=!0),(0,z.w)(d=>this.userService.searchOperators(d).pipe((0,M.b)(()=>this.operatorLoading=!1))),(0,L.B)()),this.operator$.pipe((0,Z.q)(1)).subscribe(d=>this.form.operatorId=this.form.operatorId||d[0]&&d[0].id),this.vehicleTitle=this.vehicleType,this.translate.get(this.vehicleType).subscribe(d=>{this.vehicleTitle=d}),this.translateType=this.type,this.translate.get(this.type).subscribe(d=>{this.translateType=d})}changeTariff(){const d=this.tariffTypes.find(N=>N.id===Number(this.form.tariffTypeId)),g=this.vehicleTypes.find(N=>N.id===Number(this.form.vehicleTypeId));d&&g&&this.router.navigate(["/tariffs","create"],{queryParams:{type:d.value,vehicleType:g.value}})}cancel(){this.canceled.emit()}submit(d){return d.valid&&this.submitted.emit(this.form)}}return f.\u0275fac=function(d){return new(d||f)(e.Y36(v.K),e.Y36(S.I),e.Y36(P.gz),e.Y36(P.F0),e.Y36(J.sK))},f.\u0275cmp=e.Xpm({type:f,selectors:[["app-tariffs-form-main"]],inputs:{form:"form"},outputs:{submitted:"submitted",canceled:"canceled"},decls:76,vars:64,consts:[[1,"m-form","m-form--fit","m-form--label-align-right",2,"margin-bottom","60px",3,"ngSubmit"],["formRef","ngForm"],[1,"m-portlet"],[1,"m-portlet__head"],[1,"m-portlet__head-caption"],[1,"m-portlet__head-title"],[1,"m-portlet__head-text"],[1,"m-portlet__body"],[1,"row","form-group"],[1,"col-form-label","col-2","text-right"],[1,"m--font-danger"],[1,"col-10"],["type","text","nz-input","","name","name","required","",3,"ngModel","ngModelChange"],["name","ngModel"],["class","form-control-feedback",4,"ngIf"],[1,"col-form-label","col-lg-2","col-sm-12","text-right"],[1,"col-lg-4","col-sm-12"],["name","type","nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","nzDisabled","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["name","vehicle","nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","nzDisabled","ngModelChange"],["name","carpark","nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","ngModelChange"],["name","owner","nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","nzLoading","ngModelChange"],["name","operator","nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","nzLoading","ngModelChange"],[3,"ngSwitch"],[3,"form","formRef","formChange",4,"ngSwitchCase"],[3,"form","formChange"],[1,"d-flex","justify-content-between"],["type","button","nz-button","","nzType","primary","nzGhost","","nzShape","round"],[1,"la","la-plus"],["type","reset","nz-button","","nzType","primary","nzGhost","","nzSize","large",1,"btn-form-ops","m--margin-right-20",3,"click"],["type","submit","nz-button","","nzType","primary","nzSize","large",1,"btn-form-ops"],[1,"form-control-feedback"],[3,"nzValue","nzLabel"],[3,"form","formRef","formChange"]],template:function(d,g){if(1&d){const N=e.EpF();e.TgZ(0,"form",0,1),e.NdJ("ngSubmit",function(){e.CHM(N);const D=e.MAs(1);return e.KtG(g.submit(D))}),e.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h3",6),e._uU(7),e.ALo(8,"titlecase"),e.ALo(9,"titlecase"),e.qZA()()()(),e.TgZ(10,"div",7)(11,"div",8)(12,"label",9)(13,"span",10),e._uU(14,"*"),e.qZA(),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",11)(18,"input",12,13),e.NdJ("ngModelChange",function(D){return g.form.name=D}),e.qZA(),e.YNc(20,h,3,3,"div",14),e.qZA()(),e.TgZ(21,"div",8)(22,"label",15),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"div",16)(26,"nz-select",17),e.NdJ("ngModelChange",function(D){return g.form.tariffTypeId=D})("ngModelChange",function(){return g.changeTariff()}),e.YNc(27,c,2,4,"nz-option",18),e.ALo(28,"async"),e.qZA()(),e.TgZ(29,"label",15),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"div",16)(33,"nz-select",19),e.NdJ("ngModelChange",function(D){return g.form.vehicleTypeId=D})("ngModelChange",function(){return g.changeTariff()}),e.YNc(34,s,2,4,"nz-option",18),e.ALo(35,"async"),e.qZA()()(),e.TgZ(36,"div",8)(37,"label",15),e._uU(38),e.ALo(39,"translate"),e.qZA(),e.TgZ(40,"div",16)(41,"nz-select",20),e.NdJ("ngModelChange",function(D){return g.form.carParkTypeId=D}),e.YNc(42,l,2,4,"nz-option",18),e.ALo(43,"async"),e.qZA()(),e.TgZ(44,"label",15),e._uU(45),e.ALo(46,"translate"),e.qZA(),e.TgZ(47,"div",16)(48,"nz-select",21),e.NdJ("ngModelChange",function(D){return g.form.ownerId=D}),e.YNc(49,o,1,2,"nz-option",18),e.ALo(50,"async"),e.qZA()()(),e.TgZ(51,"div",8)(52,"label",15),e._uU(53),e.ALo(54,"translate"),e.qZA(),e.TgZ(55,"div",16)(56,"nz-select",22),e.NdJ("ngModelChange",function(D){return g.form.operatorId=D}),e.YNc(57,r,1,2,"nz-option",18),e.ALo(58,"async"),e.qZA()()()()(),e.ynx(59,23),e.YNc(60,a,1,2,"app-tariffs-form-normal",24),e.YNc(61,_,1,2,"app-tariffs-form-season",24),e.YNc(62,m,1,2,"app-tariffs-form-adhoc",24),e.BQk(),e.TgZ(63,"app-tariffs-form-manage-tag",25),e.NdJ("formChange",function(D){return g.form=D}),e.qZA(),e.TgZ(64,"div",26)(65,"button",27),e._UZ(66,"i",28),e._uU(67),e.ALo(68,"translate"),e.qZA(),e.TgZ(69,"div")(70,"button",29),e.NdJ("click",function(){return g.cancel()}),e._uU(71),e.ALo(72,"translate"),e.qZA(),e.TgZ(73,"button",30),e._uU(74),e.ALo(75,"translate"),e.qZA()()()()}if(2&d){const N=e.MAs(1),U=e.MAs(19);e.xp6(7),e.AsE(" ",e.lcZ(8,32,g.vehicleType)," / ",e.lcZ(9,34,g.type)," "),e.xp6(8),e.hij(" ",e.lcZ(16,36,"Tariff Name"),": "),e.xp6(3),e.Q6J("ngModel",g.form.name),e.xp6(2),e.Q6J("ngIf",U.invalid&&(U.dirty||U.touched||N.submitted)),e.xp6(3),e.hij(" ",e.lcZ(24,38,"Tariff Type"),": "),e.xp6(3),e.Q6J("ngModel",g.form.tariffTypeId)("nzDisabled",g.form.id),e.xp6(1),e.Q6J("ngForOf",e.lcZ(28,40,g.tariffTypes$)),e.xp6(3),e.hij(" ",e.lcZ(31,42,"Vehicle Type"),": "),e.xp6(3),e.Q6J("ngModel",g.form.vehicleTypeId)("nzDisabled",g.form.id),e.xp6(1),e.Q6J("ngForOf",e.lcZ(35,44,g.vehicleTypes$)),e.xp6(4),e.hij(" ",e.lcZ(39,46,"Car Park Type"),": "),e.xp6(3),e.Q6J("ngModel",g.form.carParkTypeId),e.xp6(1),e.Q6J("ngForOf",e.lcZ(43,48,g.carParkTypes$)),e.xp6(3),e.hij(" ",e.lcZ(46,50,"Car Park Owner"),": "),e.xp6(3),e.Q6J("ngModel",g.form.ownerId)("nzLoading",g.ownerLoading),e.xp6(1),e.Q6J("ngForOf",e.lcZ(50,52,g.owner$)),e.xp6(4),e.hij(" ",e.lcZ(54,54,"Car Park Operator"),": "),e.xp6(3),e.Q6J("ngModel",g.form.operatorId)("nzLoading",g.operatorLoading),e.xp6(1),e.Q6J("ngForOf",e.lcZ(58,56,g.operator$)),e.xp6(2),e.Q6J("ngSwitch",g.type),e.xp6(1),e.Q6J("ngSwitchCase","Normal"),e.xp6(1),e.Q6J("ngSwitchCase","Season"),e.xp6(1),e.Q6J("ngSwitchCase","Adhoc"),e.xp6(1),e.Q6J("form",g.form),e.xp6(4),e.hij(" ",e.lcZ(68,58,"Add New Daily Plan")," "),e.xp6(4),e.hij(" ",e.lcZ(72,60,"Cancel")," "),e.xp6(3),e.hij(" ",e.lcZ(75,62,"Submit")," ")}},dependencies:[b.sg,b.O5,b.RF,b.n9,R._Y,R.Fj,R.JJ,R.JL,R.Q7,R.On,R.F,W.Ip,W.Vq,Q.Zp,q.ix,E.w,K.dQ,O.W,I.k,p._,A.S,b.Ov,b.rS,J.X$],encapsulation:2}),f})()},42265:(w,B,i)=>{i.d(B,{S:()=>L});var e=i(38014),t=i(94650),y=i(36895),n=i(24006),Z=i(35635),x=i(66616),u=i(47044),F=i(21811);function M(v,S){if(1&v){const P=t.EpF();t.ynx(0),t.TgZ(1,"div",12)(2,"label",13),t._UZ(3,"span",14),t._uU(4," Key: "),t.qZA(),t.TgZ(5,"div",15)(6,"input",16,17),t.NdJ("ngModelChange",function(b){const W=t.CHM(P).$implicit;return t.KtG(W.key=b)}),t.qZA()(),t.TgZ(8,"label",13),t._UZ(9,"span",14),t._uU(10," Value: "),t.qZA(),t.TgZ(11,"div",15)(12,"input",18,17),t.NdJ("ngModelChange",function(b){const W=t.CHM(P).$implicit;return t.KtG(W.value=b)}),t.qZA()(),t.TgZ(14,"div",19)(15,"button",20),t.NdJ("click",function(){const R=t.CHM(P).index,W=t.oxw(2);return t.KtG(W.form.tags.splice(R,1))}),t._UZ(16,"i",21),t.qZA()()(),t.BQk()}if(2&v){const P=S.$implicit;t.xp6(6),t.Q6J("ngModel",P.key),t.xp6(6),t.Q6J("ngModel",P.value)}}function z(v,S){if(1&v&&(t.TgZ(0,"div",10),t.YNc(1,M,17,2,"ng-container",11),t.qZA()),2&v){const P=t.oxw();t.xp6(1),t.Q6J("ngForOf",P.form.tags)}}let L=(()=>{class v{constructor(){this.form=(0,e.jqJ)()}ngOnInit(){}addNewTag(){this.form.tags.push((0,e.zXo)())}}return v.\u0275fac=function(P){return new(P||v)},v.\u0275cmp=t.Xpm({type:v,selectors:[["app-tariffs-form-manage-tag"]],inputs:{form:"form"},decls:12,vars:1,consts:[[1,"m-portlet"],[1,"m-portlet__head","d-flex","align-items-center"],[1,"row","m--marginless"],[1,"m-portlet__head-caption"],[1,"m-portlet__head-title"],[1,"m-portlet__head-text"],["class","m-portlet__body",4,"ngIf"],[1,"m-portlet__foot"],["type","button","nz-button","","nzType","primary","nzGhost","","nzShape","round",3,"click"],[1,"la","la-plus"],[1,"m-portlet__body"],[4,"ngFor","ngForOf"],[1,"row","form-group"],[1,"col-form-label","col-1","text-right"],[1,"m--font-danger"],[1,"col-4"],["type","text","nz-input","","name","key",3,"ngModel","ngModelChange"],["name","ngModel"],["type","text","nz-input","","name","value",3,"ngModel","ngModelChange"],[1,"col-2","m--margin-bottom-20",2,"text-align","center"],["type","button","nz-button","",3,"click"],[1,"la","la-trash"]],template:function(P,J){1&P&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3",5),t._uU(6," Manage Tags "),t.qZA()()()()(),t.YNc(7,z,2,1,"div",6),t.TgZ(8,"div",7)(9,"button",8),t.NdJ("click",function(){return J.addNewTag()}),t._UZ(10,"i",9),t._uU(11," Add tag "),t.qZA()()()),2&P&&(t.xp6(7),t.Q6J("ngIf",(null==J.form.tags?null:J.form.tags.length)>0))},dependencies:[y.sg,y.O5,n.Fj,n.JJ,n.On,Z.Zp,x.ix,u.w,F.dQ]}),v})()},48942:(w,B,i)=>{i.d(B,{W:()=>c});var e=i(94650),t=i(38014),y=i(34793),n=i(73071),Z=i(36511),x=i(36895),u=i(24006),F=i(56075),M=i(38231),z=i(35635),L=i(66616),v=i(47044),S=i(21811),P=i(14685),J=i(28213),b=i(89383);function R(s,l){1&s&&(e.TgZ(0,"div",47),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function W(s,l){1&s&&(e.TgZ(0,"div",47),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function Q(s,l){1&s&&e._UZ(0,"i",48)}function q(s,l){1&s&&(e.TgZ(0,"div",49),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function E(s,l){1&s&&(e.TgZ(0,"div",50),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function K(s,l){1&s&&(e.TgZ(0,"div",50),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function O(s,l){1&s&&(e.TgZ(0,"div",47),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function I(s,l){1&s&&(e.TgZ(0,"div",50),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function p(s,l){1&s&&(e.TgZ(0,"div",50),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function A(s,l){1&s&&(e.TgZ(0,"div",50),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function h(s,l){if(1&s){const o=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"h5"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"button",10),e.NdJ("click",function(){const _=e.CHM(o).index,m=e.oxw();return e.KtG(m.form.timeSlots.splice(_,1))}),e._UZ(6,"i",11),e.qZA()(),e.TgZ(7,"div",12)(8,"div",13)(9,"label",14)(10,"span",15),e._uU(11,"*"),e.qZA(),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"div",16)(15,"div",17)(16,"nz-time-picker",18,19),e.NdJ("ngModelChange",function(a){const m=e.CHM(o).$implicit;return e.KtG(m.from=a)}),e.qZA(),e.YNc(18,R,3,3,"div",20),e.qZA(),e.TgZ(19,"div",21),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"div",17)(23,"nz-time-picker",18,22),e.NdJ("ngModelChange",function(a){const m=e.CHM(o).$implicit;return e.KtG(m.to=a)}),e.qZA(),e.YNc(25,W,3,3,"div",20),e.qZA()()(),e.YNc(26,Q,1,0,"ng-template",null,23,e.W1O),e.TgZ(28,"div",13)(29,"label",24)(30,"span",15),e._uU(31,"*"),e.qZA(),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"div",16)(35,"nz-input-group",25),e.ALo(36,"translate"),e.TgZ(37,"input",26,27),e.NdJ("ngModelChange",function(a){const m=e.CHM(o).$implicit;return e.KtG(m.rate=a)}),e.qZA()(),e.YNc(39,q,3,3,"div",28),e.qZA()(),e.TgZ(40,"div",13)(41,"label",14)(42,"span",15),e._uU(43,"*"),e.qZA(),e._uU(44),e.ALo(45,"translate"),e.qZA(),e.TgZ(46,"div",16)(47,"nz-input-group",29),e.ALo(48,"translate"),e.TgZ(49,"input",26,30),e.NdJ("ngModelChange",function(a){const m=e.CHM(o).$implicit;return e.KtG(m.firstChargingPeriod=a)}),e.qZA()(),e.YNc(51,E,3,3,"div",31),e.qZA()(),e.TgZ(52,"div",13)(53,"label",14)(54,"span",15),e._uU(55,"*"),e.qZA(),e._uU(56),e.ALo(57,"translate"),e.qZA(),e.TgZ(58,"div",16)(59,"nz-input-group",32)(60,"input",26,33),e.NdJ("ngModelChange",function(a){const m=e.CHM(o).$implicit;return e.KtG(m.minimumPerEntry=a)}),e.qZA()(),e.YNc(62,K,3,3,"div",31),e.qZA()()(),e.TgZ(63,"div",12)(64,"div",13)(65,"label",14)(66,"span",15),e._uU(67,"*"),e.qZA(),e._uU(68),e.ALo(69,"translate"),e.qZA(),e.TgZ(70,"div",34)(71,"nz-select",35,36),e.NdJ("ngModelChange",function(a){const m=e.CHM(o).$implicit;return e.KtG(m.rateType=a)}),e._UZ(73,"nz-option",37)(74,"nz-option",38)(75,"nz-option",39)(76,"nz-option",40),e.qZA(),e.YNc(77,O,3,3,"div",20),e.qZA()(),e.TgZ(78,"div",13)(79,"label",14)(80,"span",15),e._uU(81,"*"),e.qZA(),e._uU(82),e.ALo(83,"translate"),e.qZA(),e.TgZ(84,"div",16)(85,"nz-input-group",29),e.ALo(86,"translate"),e.TgZ(87,"input",26,41),e.NdJ("ngModelChange",function(a){const m=e.CHM(o).$implicit;return e.KtG(m.graceTime=a)}),e.qZA()(),e.YNc(89,I,3,3,"div",31),e.qZA()(),e.TgZ(90,"div",13)(91,"label",14)(92,"span",15),e._uU(93,"*"),e.qZA(),e._uU(94),e.ALo(95,"translate"),e.qZA(),e.TgZ(96,"div",16)(97,"nz-input-group",25),e.ALo(98,"translate"),e.TgZ(99,"input",42,43),e.NdJ("ngModelChange",function(a){const m=e.CHM(o).$implicit;return e.KtG(m.firstChargingRate=a)}),e.qZA()(),e.YNc(101,p,3,3,"div",31),e.qZA()(),e.TgZ(102,"div",13)(103,"label",14)(104,"span",15),e._uU(105,"*"),e.qZA(),e._uU(106),e.ALo(107,"translate"),e.qZA(),e.TgZ(108,"div",16)(109,"nz-input-group",32)(110,"input",26,44),e.NdJ("ngModelChange",function(a){const m=e.CHM(o).$implicit;return e.KtG(m.maxPerDay=a)}),e.qZA()(),e.YNc(112,A,3,3,"div",31),e.qZA()(),e.TgZ(113,"div",13)(114,"label",14),e._uU(115),e.ALo(116,"translate"),e.qZA(),e.TgZ(117,"div",16)(118,"label",45,46),e.NdJ("ngModelChange",function(a){const m=e.CHM(o).$implicit;return e.KtG(m.chargedByRate=a)}),e.qZA()()()()()}if(2&s){const o=l.$implicit,r=l.index,a=e.MAs(17),_=e.MAs(24),m=e.MAs(27),T=e.MAs(38),f=e.MAs(50),C=e.MAs(61),d=e.MAs(72),g=e.MAs(88),N=e.MAs(100),U=e.MAs(111),D=e.oxw();e.xp6(3),e.AsE("",e.lcZ(4,52,"Time Slot"),"",r+1,""),e.xp6(9),e.hij(" ",e.lcZ(13,54,"Time Range"),": "),e.xp6(4),e.MGl("name","fromTime",r,""),e.Q6J("ngModel",o.from)("nzUse12Hours",!0),e.xp6(2),e.Q6J("ngIf",a.invalid&&(a.dirty||a.touched||D.formRef.submitted)),e.xp6(2),e.hij(" ",e.lcZ(21,56,"to")," "),e.xp6(3),e.MGl("name","endTime",r,""),e.Q6J("ngModel",o.to)("nzUse12Hours",!0),e.xp6(2),e.Q6J("ngIf",_.invalid&&(_.dirty||_.touched||D.formRef.submitted)),e.xp6(4),e.MGl("for","exampleInputEmail",r,""),e.xp6(3),e.hij(" ",e.lcZ(33,58,"Rate"),": "),e.xp6(3),e.hYB("nzAddOnAfter","/",o.rateType,"",e.lcZ(36,60,"mins"),""),e.Q6J("nzAddOnBefore",m),e.xp6(2),e.MGl("name","rate",r,""),e.Q6J("ngModel",o.rate),e.xp6(2),e.Q6J("ngIf",T.invalid&&(T.dirty||T.touched||D.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(45,62,"First Charging Period"),": "),e.xp6(3),e.s9C("nzAddOnAfter",e.lcZ(48,64,"mins")),e.xp6(2),e.MGl("name","chargingPeriod",r,""),e.Q6J("ngModel",o.firstChargingPeriod),e.xp6(2),e.Q6J("ngIf",f.invalid&&(f.dirty||f.touched||D.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(57,66,"Minimum Per Entry"),": "),e.xp6(3),e.Q6J("nzAddOnBefore",m),e.xp6(1),e.MGl("name","minimumPerEntry",r,""),e.Q6J("ngModel",o.minimumPerEntry),e.xp6(2),e.Q6J("ngIf",C.invalid&&(C.dirty||C.touched||D.formRef.submitted)),e.xp6(6),e.hij(" ",e.lcZ(69,68,"Rate Type"),": "),e.xp6(3),e.MGl("name","rateType",r,""),e.Q6J("ngModel",o.rateType),e.xp6(6),e.Q6J("ngIf",d.invalid&&(d.dirty||d.touched||D.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(83,70,"Grace Time"),": "),e.xp6(3),e.s9C("nzAddOnAfter",e.lcZ(86,72,"min")),e.xp6(2),e.MGl("name","graceTime",r,""),e.Q6J("ngModel",o.graceTime),e.xp6(2),e.Q6J("ngIf",g.invalid&&(g.dirty||g.touched||D.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(95,74,"First Charging Rate"),": "),e.xp6(3),e.s9C("nzAddOnAfter",e.lcZ(98,76,"min")),e.Q6J("nzAddOnBefore",m),e.xp6(2),e.Q6J("ngModel",o.firstChargingRate),e.xp6(2),e.Q6J("ngIf",N.invalid&&(N.dirty||N.touched||D.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(107,78,"Maximum Per Session"),": "),e.xp6(3),e.Q6J("nzAddOnBefore",m),e.xp6(1),e.MGl("name","maximumPerSession",r,""),e.Q6J("ngModel",o.maxPerDay),e.xp6(2),e.Q6J("ngIf",U.invalid&&(U.dirty||U.touched||D.formRef.submitted)),e.xp6(3),e.hij(" ",e.lcZ(116,80,"Charged By Rate Type"),": "),e.xp6(3),e.MGl("name","chargedByRate",r,""),e.Q6J("ngModel",o.chargedByRate)}}let c=(()=>{class s{constructor(o,r,a){this.route=o,this.userService=r,this.codeTablesService=a,this.form=(0,t.jqJ)(),this.formChange=new e.vpe,this.datePickerConfig={containerClass:"theme-red"},this.rateTypes=(0,t.RV7)(),this.weekdays={},this.dayList=[]}ngOnInit(){this.form.weekdays.forEach(o=>this.weekdays[o]=!0),this.codeTablesService.filterModelByType(t.BcL.DayType).subscribe(o=>{this.dayList=o,this.dayList.forEach(r=>{const a=this.form.weekdays.find(_=>r.value===_);r.checked=!!a,r.label=r.name})})}onChangeDay(){this.form.weekdays=this.dayList.filter(o=>o.checked).map(o=>o.value)}addNewTimeSlot(){this.form.timeSlots.push((0,t.z5G)())}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(y.gz),e.Y36(n.K),e.Y36(Z.I))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-tariffs-form-normal"]],inputs:{formRef:"formRef",form:"form"},outputs:{formChange:"formChange"},decls:10,vars:5,consts:[["appProvideParentForm","",1,"m-portlet"],[1,"m-portlet__head","d-flex","align-items-center"],[1,"row","m--marginless"],["name","day",3,"ngModel","ngModelChange"],["class","m-portlet__body row",4,"ngFor","ngForOf"],[1,"m-portlet__foot"],["type","button","nz-button","","nzType","primary","nzGhost","","nzShape","round",3,"click"],[1,"la","la-plus"],[1,"m-portlet__body","row"],[1,"col-12","d-flex","justify-content-between","m--margin-bottom-20"],["type","button","nz-button","",3,"click"],[1,"la","la-trash"],[1,"col-6"],[1,"row","form-group"],[1,"col-form-label","text-right","col-4"],[1,"m--font-danger"],[1,"input-group","col-8"],[1,"col","m--padding-0"],["nzFormat","h:mm a","required","",2,"width","100%",3,"name","ngModel","nzUse12Hours","ngModelChange"],["fromTime","ngModel"],["class","form-control-feedback",4,"ngIf"],[1,"input-group-append",2,"line-height","35px","padding","0 6px"],["endTime","ngModel"],["addOnBeforeTemplate",""],[1,"col-form-label","text-right","col-4",3,"for"],[3,"nzAddOnBefore","nzAddOnAfter"],["type","text","nz-input","","required","",3,"name","ngModel","ngModelChange"],["rate","ngModel"],["class","form-control-feedback m--font-danger",4,"ngIf"],[3,"nzAddOnAfter"],["chargingPeriod","ngModel"],["class","w-100 form-control-feedback m--font-danger",4,"ngIf"],[3,"nzAddOnBefore"],["minimumPerEntry","ngModel"],[1,"col-8"],["required","",2,"width","100%",3,"name","ngModel","ngModelChange"],["rateType","ngModel"],["nzValue","15","nzLabel","15"],["nzValue","30","nzLabel","30"],["nzValue","45","nzLabel","45"],["nzValue","60","nzLabel","60"],["graceTime","ngModel"],["type","text","nz-input","","name","chargingRate","required","",3,"ngModel","ngModelChange"],["chargingRate","ngModel"],["maximumPerSession","ngModel"],["nz-checkbox","",3,"name","ngModel","ngModelChange"],["chargedByRate","ngModel"],[1,"form-control-feedback"],[1,"la","la-usd"],[1,"form-control-feedback","m--font-danger"],[1,"w-100","form-control-feedback","m--font-danger"]],template:function(o,r){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"nz-checkbox-group",3),e.NdJ("ngModelChange",function(_){return r.dayList=_})("ngModelChange",function(){return r.onChangeDay()}),e.qZA()()(),e.YNc(4,h,120,82,"div",4),e.TgZ(5,"div",5)(6,"button",6),e.NdJ("click",function(){return r.addNewTimeSlot()}),e._UZ(7,"i",7),e._uU(8),e.ALo(9,"translate"),e.qZA()()()),2&o&&(e.xp6(3),e.Q6J("ngModel",r.dayList),e.xp6(1),e.Q6J("ngForOf",r.form.timeSlots),e.xp6(4),e.hij("",e.lcZ(9,3,"Add New Time Slot")," "))},dependencies:[x.sg,x.O5,u.Fj,u.JJ,u.Q7,u.On,F.h,M.Ip,M.Vq,z.Zp,z.gB,L.ix,v.w,S.dQ,P.m4,J.Ie,J.ub,b.X$],encapsulation:2}),s})()},85611:(w,B,i)=>{i.d(B,{k:()=>q});var e=i(38014),t=i(94650),y=i(34793),n=i(73071),Z=i(36511),x=i(36895),u=i(24006),F=i(56075),M=i(35635),z=i(66616),L=i(47044),v=i(21811),S=i(14685),P=i(89383);function J(E,K){1&E&&(t.TgZ(0,"div",29),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&E&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function b(E,K){1&E&&(t.TgZ(0,"div",29),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&E&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function R(E,K){1&E&&t._UZ(0,"i",30)}function W(E,K){1&E&&(t.TgZ(0,"div",31),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&E&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function Q(E,K){if(1&E){const O=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"h5"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",11),t.NdJ("click",function(){const A=t.CHM(O).index,h=t.oxw();return t.KtG(h.form.timeSlots.splice(A,1))}),t._UZ(6,"i",12),t.qZA()(),t.TgZ(7,"div",13)(8,"div",14)(9,"label",15)(10,"span",16),t._uU(11,"*"),t.qZA(),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"div",17)(15,"div",18)(16,"nz-time-picker",19,20),t.NdJ("ngModelChange",function(p){const h=t.CHM(O).$implicit;return t.KtG(h.from=p)}),t.qZA(),t.YNc(18,J,3,3,"div",21),t.qZA(),t.TgZ(19,"div",22),t._uU(20),t.ALo(21,"translate"),t.qZA(),t.TgZ(22,"div",18)(23,"nz-time-picker",19,23),t.NdJ("ngModelChange",function(p){const h=t.CHM(O).$implicit;return t.KtG(h.to=p)}),t.qZA(),t.YNc(25,b,3,3,"div",21),t.qZA()()()(),t.YNc(26,R,1,0,"ng-template",null,24,t.W1O),t.TgZ(28,"div",13)(29,"div",14)(30,"label",15)(31,"span",16),t._uU(32,"*"),t.qZA(),t._uU(33),t.ALo(34,"translate"),t.qZA(),t.TgZ(35,"div",17)(36,"nz-input-group",25),t.ALo(37,"translate"),t.TgZ(38,"input",26,27),t.NdJ("ngModelChange",function(p){const h=t.CHM(O).$implicit;return t.KtG(h.rate=p)}),t.qZA()(),t.YNc(40,W,3,3,"div",28),t.qZA()()()()}if(2&E){const O=K.$implicit,I=K.index,p=t.MAs(17),A=t.MAs(24),h=t.MAs(27),c=t.MAs(39),s=t.oxw();t.xp6(3),t.AsE("",t.lcZ(4,18,"Season Parking Type")," ",I+1,""),t.xp6(9),t.hij(" ",t.lcZ(13,20,"Time Range"),": "),t.xp6(4),t.MGl("name","fromTime",I,""),t.Q6J("ngModel",O.from)("nzUse12Hours",!0),t.xp6(2),t.Q6J("ngIf",p.invalid&&(p.dirty||p.touched||s.formRef.submitted)),t.xp6(2),t.hij(" ",t.lcZ(21,22,"to")," "),t.xp6(3),t.MGl("name","endTime",I,""),t.Q6J("ngModel",O.to)("nzUse12Hours",!0),t.xp6(2),t.Q6J("ngIf",A.invalid&&(A.dirty||A.touched||s.formRef.submitted)),t.xp6(8),t.hij(" ",t.lcZ(34,24,"Rate"),": "),t.xp6(3),t.MGl("nzAddOnAfter","/30",t.lcZ(37,26,"mins"),""),t.Q6J("nzAddOnBefore",h),t.xp6(2),t.MGl("name","rate",I,""),t.Q6J("ngModel",O.rate),t.xp6(2),t.Q6J("ngIf",c.invalid&&(c.dirty||c.touched||s.formRef.submitted))}}let q=(()=>{class E{constructor(O,I,p){this.route=O,this.userService=I,this.codeTablesService=p,this.wholeDay=!1,this.form=(0,e.jqJ)()}addNewTimeSlot(){this.form.timeSlots.push((0,e.z5G)())}}return E.\u0275fac=function(O){return new(O||E)(t.Y36(y.gz),t.Y36(n.K),t.Y36(Z.I))},E.\u0275cmp=t.Xpm({type:E,selectors:[["app-tariffs-form-season"]],inputs:{form:"form",formRef:"formRef"},decls:13,vars:7,consts:[["appProvideParentForm","",1,"m-portlet"],[1,"m-portlet__head","d-flex","align-items-center"],[1,"m-portlet__head-caption"],[1,"m-portlet__head-title"],[1,"m-portlet__head-text"],["class","m-portlet__body row",4,"ngFor","ngForOf"],[1,"m-portlet__foot"],["type","button","nz-button","","nzType","primary","nzGhost","","nzShape","round",3,"click"],[1,"la","la-plus"],[1,"m-portlet__body","row"],[1,"col-12","d-flex","justify-content-between","m--margin-bottom-20"],["type","button","nz-button","",3,"click"],[1,"la","la-trash"],[1,"col-6"],[1,"row","form-group"],[1,"col-form-label","text-right","col-4"],[1,"m--font-danger"],[1,"input-group","col-8"],[1,"col","m--padding-0"],["nzFormat","h:mm a","required","",2,"width","100%",3,"name","ngModel","nzUse12Hours","ngModelChange"],["fromTime","ngModel"],["class","form-control-feedback",4,"ngIf"],[1,"input-group-append",2,"line-height","35px","padding","0 6px"],["endTime","ngModel"],["addOnBeforeTemplate",""],[3,"nzAddOnBefore","nzAddOnAfter"],["type","text","nz-input","","required","",3,"name","ngModel","ngModelChange"],["rate","ngModel"],["class","form-control-feedback m--font-danger",4,"ngIf"],[1,"form-control-feedback"],[1,"la","la-usd"],[1,"form-control-feedback","m--font-danger"]],template:function(O,I){1&O&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),t._uU(5),t.ALo(6,"translate"),t.qZA()()()(),t.YNc(7,Q,41,28,"div",5),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return I.addNewTimeSlot()}),t._UZ(10,"i",8),t._uU(11),t.ALo(12,"translate"),t.qZA()()()),2&O&&(t.xp6(5),t.hij(" ",t.lcZ(6,3,"Tariff")," "),t.xp6(2),t.Q6J("ngForOf",I.form.timeSlots),t.xp6(4),t.hij(" ",t.lcZ(12,5,"Add Season Parking Type")," "))},dependencies:[x.sg,x.O5,u.Fj,u.JJ,u.Q7,u.On,F.h,M.Zp,M.gB,z.ix,L.w,v.dQ,S.m4,P.X$],encapsulation:2}),E})()},69659:(w,B,i)=>{i.d(B,{q:()=>h});var e=i(94650),t=i(79118),y=i(15439),Z=i(52746),x=i(36895),u=i(67556),F=i(34793),M=i(50007),z=i(49651),L=i(24006),v=i(40269),S=i(28213),P=i(89383);function J(c,s){if(1&c&&e._uU(0),2&c){const l=s.range;e.lnq(" ",l[0],"-",l[1]," of ",s.$implicit," items ")}}function b(c,s){if(1&c&&(e.TgZ(0,"th",5),e._uU(1),e.qZA()),2&c){const l=s.$implicit;e.Q6J("nzWidth",s.first?"60px":""),e.xp6(1),e.Oqu(l.text)}}function R(c,s){if(1&c&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&c){const l=e.oxw().index;e.xp6(1),e.Oqu(l)}}function W(c,s){if(1&c){const l=e.EpF();e.TgZ(0,"td")(1,"label",9),e.NdJ("ngModelChange",function(r){e.CHM(l);const a=e.oxw().$implicit;return e.KtG(a._checked=r)})("ngModelChange",function(){e.CHM(l);const r=e.oxw().$implicit,a=e.oxw();return e.KtG(a.onlyOneValue(r))}),e.qZA()()}if(2&c){const l=e.oxw().$implicit;e.xp6(1),e.MGl("name","tariff",l.costmodeId,""),e.Q6J("ngModel",l._checked)}}function Q(c,s){if(1&c){const l=e.EpF();e.TgZ(0,"a",14),e.NdJ("click",function(){e.CHM(l);const r=e.oxw(2).$implicit,a=e.oxw();return e.KtG(a.openModal(r))}),e._UZ(1,"i",15),e.qZA()}}const q=function(){return["/tariffs/edit"]},E=function(){return{type:"evc",vehicleType:"evc",model:"update"}};function K(c,s){if(1&c){const l=e.EpF();e.TgZ(0,"td")(1,"div",10)(2,"a",11),e.NdJ("click",function(){e.CHM(l);const r=e.oxw().index,a=e.oxw();return e.KtG(a.setValueToDetail(r))}),e._UZ(3,"i",12),e.qZA(),e.YNc(4,Q,2,0,"a",13),e.qZA()()}if(2&c){const l=e.oxw(2);e.xp6(2),e.Q6J("routerLink",e.DdM(3,q))("queryParams",e.DdM(4,E)),e.xp6(2),e.Q6J("ngIf",l.showDelete)}}const O=function(){return["/tariffs/create"]};function I(c,s){if(1&c){const l=e.EpF();e.TgZ(0,"td")(1,"a",11),e.NdJ("click",function(){e.CHM(l);const r=e.oxw().index,a=e.oxw();return e.KtG(a.setValueToDetail(r))}),e._UZ(2,"i",16),e.qZA()()}2&c&&(e.xp6(1),e.Q6J("routerLink",e.DdM(2,O))("queryParams",e.DdM(3,E)))}function p(c,s){if(1&c&&(e.ynx(0),e.TgZ(1,"tr"),e.YNc(2,R,2,1,"td",6),e.YNc(3,W,2,2,"td",6),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e._UZ(8,"td"),e.TgZ(9,"td")(10,"span",7),e._UZ(11,"span",8),e._uU(12),e.ALo(13,"translate"),e.qZA()(),e.TgZ(14,"td"),e._uU(15),e.ALo(16,"date"),e.qZA(),e.YNc(17,K,5,5,"td",6),e.YNc(18,I,3,4,"td",6),e.qZA(),e.BQk()),2&c){const l=s.$implicit,o=s.index,r=e.oxw();e.xp6(1),e.ekj("ant-table-row-odd",o%2==1),e.xp6(1),e.Q6J("ngIf",!r.createCarpark),e.xp6(1),e.Q6J("ngIf",r.createCarpark),e.xp6(2),e.Oqu(l.costmodeId),e.xp6(2),e.Oqu(l.costmodeName),e.xp6(5),e.hij(" \xa0",e.lcZ(13,10,"EVC")," "),e.xp6(3),e.Oqu(e.lcZ(16,12,l.createDate)),e.xp6(2),e.Q6J("ngIf",!r.createCarpark),e.xp6(1),e.Q6J("ngIf",r.createCarpark&&!r.selectTariff)}}const A=function(){return{y:"240px"}};let h=(()=>{class c extends Z.t{constructor(l,o,r,a,_){super(),this.evcService=l,this.router=o,this.nzModalService=r,this.nzMessageService=a,this.datePipe=_,this.tableHeaders=[{text:"#",align:t.iW.Center,width:"40px"},{text:"Tariff ID",width:"120px"},{text:"Tariff Name",width:"100px"},{text:"Vehicle Type",width:"120px"},{text:"Tariff Type",width:"100px"},{text:"Car Parks",width:"100px"},{text:"Date Created",width:"100px"},{text:"Actions",width:"80px"}],this.selected=new e.vpe,this.isPopMode=!1,this.pageSize=this.pagination.rowsPerPage,this.deleteModalOptions={title:"Do you want to delete this tariff?",message:"This can not be reverted"},this.showDelete=!0,-1!==this.router.url.indexOf("carparks")&&(this.showDelete=!1)}ngOnInit(){console.log("csdf"),this.carparkId&&this.getInitialData(),this.selectedCostmode&&0!==this.selectedCostmode.length&&(this.costmodeId=this.selectedCostmode[0].costmodeId),this.createCarpark&&(this.tableHeaders[0].text="",this.tableHeaders.splice(5,1)),this.selectTariff&&(this.tableHeaders[0].text="",this.tableHeaders=this.tableHeaders.filter(l=>"Car Parks"!==l.text&&"Actions"!==l.text)),this.reloadData()}get filterParams(){let l=JSON.parse(localStorage.getItem("user"));return{companyName:"",costmodeName:"",pageNum:this.pagination.page,pageSize:this.pageSize,ownerId:l.ownerId||""}}reloadData(l){this.loading=!0;const o=l?l.replace(/^\s+|\s+$/g,""):"",r={...this.filterParams,costmodeName:o};this.evcService.getAllCostModel(r).subscribe(a=>{this.loading=!1,"00000"==a.messageCode?(this.pagination.totalCount=a.data.totalElements,this.pagination.page=a.data.pageNumber,this.pagination.rowsPerPage=a.data.pageSize,this.costmodeId&&!this.selectTariff?(this.listData=a.data.content.filter(_=>_.costmodeId==this.costmodeId),this.pagination.totalCount=this.listData.length,this.pagination.page=a.data.pageNumber,this.pagination.rowsPerPage=a.data.pageSize>50?20:a.data.pageSize):this.listData=a.data.content,this.currentlyChecked=this.costmodeId):(this.loading=!1,this.listData=[],this.pagination={...this.pagination,totalCount:0})},()=>{this.loading=!1,this.listData=[],this.pagination={...this.pagination,totalCount:0}})}pageChanged(l){this.pagination=l,this.pageSize=this.pagination.rowsPerPage,this.reloadData()}setValueToDetail(l){const{companyId:o,costmodeDescription:r,costmodeId:a,costmodeName:_,list:m}=this.listData[l],T=m.map(f=>{const C=this.timeFormat(f.startTime),d=this.timeFormat(f.endTime);return{startTime:C,endTime:d,id:f.id,costType:f.costType,duration:y(d,"hh:mm").diff(y(C,"hh:mm"),"hour"),powerPrice:f.price,serviceFee:f.servcieFee}});localStorage.setItem("curCostmode",JSON.stringify({companyId:o,costmodeId:a,costmodeName:_,note:r,items:T,delete_items:[]}))}timeFormat(l){const o=new Date(l);let r=o.getMinutes();return 1===r.toString().length&&(r="0"+r),r=`${o.getHours()}:${r}`,r}evcEvcTariff(){return this.listData.filter(o=>this.currentlyChecked==o.costmodeId)}onlyOneValue(l){const o=l.costmodeId;l._checked?(this.listData.filter(r=>r.costmodeId!==l.costmodeId).forEach(r=>r._checked=!1),this.currentlyChecked=o):this.currentlyChecked="",console.log(this.currentlyChecked)}alert(l){this.nzMessageService.error(l)}deleteEvcTariff(){const{costmodeId:l,companyId:o}=this.selectedTariff;this.evcService.delCostModel({delete_arr:[l]}).subscribe(r=>{"00000"==r.messageCode?this.evcService.delElectricPrice({delete_arr:[o]}).subscribe(a=>{"00000"==a.messageCode?this.reloadData():this.alert(`${a.messageCode} : Delete EVC tariffs failed`)}):this.alert(`${r.messageCode} : Delete EVC tariffs failed`)},()=>{this.alert("Exception : Delete EVC tariffs failed")})}getInitialData(){this.evcService.getCarparkEvc({carparkId:this.carparkId}).subscribe(o=>{"00000"==o.messageCode?this.costmodeId=o.data.costmodeId:"99999"==o.messageCode&&(this.costmodeId="null")})}openModal(l){this.selectedTariff=l,this.nzModalService.confirm({nzTitle:"Do you want to delete this tariff?",nzContent:"This can not be reverted",nzOnOk:()=>this.deleteEvcTariff()})}}return c.\u0275fac=function(l){return new(l||c)(e.Y36(u.z$),e.Y36(F.F0),e.Y36(M.Sf),e.Y36(z.dD),e.Y36(x.uU))},c.\u0275cmp=e.Xpm({type:c,selectors:[["app-evc-tariff-table"]],inputs:{createCarpark:"createCarpark",selectTariff:"selectTariff",carparkId:"carparkId",selectedCostmode:"selectedCostmode",isPopMode:"isPopMode",pageSize:"pageSize"},outputs:{selected:"selected"},features:[e._Bn([x.uU]),e.qOj],decls:9,vars:13,consts:[["rangeTemplate",""],[3,"nzData","nzScroll","nzSize","nzFrontPagination","nzLoading","nzTotal","nzPageSize","nzPageIndex","nzShowSizeChanger","nzShowTotal","nzQueryParams"],["basicTable",""],[3,"nzWidth",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"nzWidth"],[4,"ngIf"],[1,"m--font-success"],[1,"m-badge","m-badge--success","m-badge--dot"],["nz-checkbox","",3,"name","ngModel","ngModelChange"],[2,"width","82px"],[1,"btn","btn-outline-primary","m-btn","m-btn--icon","m-btn--icon-only","m-btn--custom","m-btn--pill","no-border",3,"routerLink","queryParams","click"],[1,"la","la-edit"],["class","btn btn-outline-primary m-btn m-btn--icon m-btn--icon-only m-btn--custom m-btn--pill no-border",3,"click",4,"ngIf"],[1,"btn","btn-outline-primary","m-btn","m-btn--icon","m-btn--icon-only","m-btn--custom","m-btn--pill","no-border",3,"click"],[1,"la","la-close"],[1,"la","la-eye"]],template:function(l,o){if(1&l&&(e.YNc(0,J,1,3,"ng-template",null,0,e.W1O),e.TgZ(2,"nz-table",1,2),e.NdJ("nzQueryParams",function(a){return o.onQueryParamsChange(a)}),e.TgZ(4,"thead")(5,"tr"),e.YNc(6,b,2,2,"th",3),e.qZA()(),e.TgZ(7,"tbody"),e.YNc(8,p,19,14,"ng-container",4),e.qZA()()),2&l){const r=e.MAs(1),a=e.MAs(3);e.xp6(2),e.Q6J("nzData",o.listData)("nzScroll",o.isPopMode?e.DdM(12,A):null)("nzSize",o.isPopMode?"small":"default")("nzFrontPagination",!1)("nzLoading",o.loading)("nzTotal",o.pagination.totalCount)("nzPageSize",o.pagination.rowsPerPage)("nzPageIndex",o.pagination.page)("nzShowSizeChanger",!0)("nzShowTotal",r),e.xp6(4),e.Q6J("ngForOf",o.tableHeaders),e.xp6(2),e.Q6J("ngForOf",a.data)}},dependencies:[x.sg,x.O5,L.JJ,L.On,v.N8,v.Uo,v._C,v.Om,v.p0,v.$Z,S.Ie,F.yS,x.uU,P.X$]}),c})()}}]);