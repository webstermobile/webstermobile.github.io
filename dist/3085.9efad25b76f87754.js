"use strict";(self.webpackChunkst_admin=self.webpackChunkst_admin||[]).push([[3085],{33085:(kt,u,r)=>{r.r(u),r.d(u,{TenantDriverPageModule:()=>Zt});var g=r(36895),O=r(34793),Z=r(59501),k=r(21532),A=r(88796),c=r(24006),I=r(372),w=r(30329),S=r(34984),v=r(20388),N=r(59245),f=(r(86181),r(8929)),U=r(591),x=r(15439),q=r(94327),J=r(52746),t=r(94650),D=r(15770),T=r(4483),C=r(37037),b=r(49651),p=r(50007),Q=r(76916),L=r(35635),H=r(47423),M=r(66616),G=r(47044),E=r(21811),P=r(834),F=r(37570),d=r(40269),z=r(136),y=r(2577);const Y=["confirmModal"],K=["confirmModalImportant"],j=["inputfilePDF"],R=["inputfile"],V=["inputfileDriver"],$=["confirmDeleteDriver"];function B(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",15)(1,"h6"),t._uU(2,"tips"),t.qZA(),t.TgZ(3,"p"),t._uU(4),t.qZA(),t.TgZ(5,"div",16)(6,"button",17),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.closeModal())}),t._uU(7,"No"),t.qZA(),t.TgZ(8,"button",18),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.closeModalYes())}),t._uU(9,"Yes"),t.qZA()()()}if(2&a){const e=t.oxw();t.xp6(4),t.Oqu(e.errMsg)}}function W(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",15)(1,"h6"),t._uU(2,"tips"),t.qZA(),t.TgZ(3,"p"),t._uU(4),t.qZA(),t.TgZ(5,"div",16)(6,"button",19),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.closeModal())}),t._uU(7,"ok"),t.qZA()()()}if(2&a){const e=t.oxw();t.xp6(4),t.Oqu(e.importantMsg)}}function X(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",20)(1,"div",21)(2,"button",22),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.downloadImportTemplateDriver())}),t._UZ(3,"span",23),t._uU(4,"Download Template"),t.qZA(),t.TgZ(5,"div",24)(6,"input",25,26),t.NdJ("change",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.importDriver(i.target.files[0]))}),t.qZA(),t.TgZ(8,"button",27),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.loadDriver())}),t._UZ(9,"span",28),t._uU(10," Load Driver(s) "),t.qZA()(),t.TgZ(11,"button",29),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.addDriverOne())}),t._UZ(12,"span",30),t._uU(13,"Driver"),t.qZA()(),t.TgZ(14,"div",31)(15,"div",32)(16,"div",33)(17,"span",34),t._uU(18,"Search:"),t.qZA(),t.TgZ(19,"input",35),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.driverKeyword=i)})("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.driverKeyword$.next(i))}),t.qZA()()(),t.TgZ(20,"div",32)(21,"div",33)(22,"span",34),t._uU(23,"Created On:"),t.qZA(),t.TgZ(24,"nz-range-picker",36),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.timeRangeDriver=i)})("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.getVisitDateDriver(i))}),t.qZA()()()()()}if(2&a){const e=t.oxw();t.xp6(19),t.Q6J("ngModel",e.driverKeyword),t.xp6(5),t.Q6J("ngModel",e.timeRangeDriver)}}function tt(a,s){if(1&a&&t._uU(0),2&a){const e=s.range;t.lnq(" ",e[0],"-",e[1]," of ",s.$implicit," items ")}}function et(a,s){if(1&a&&(t.TgZ(0,"th"),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.xp6(1),t.Oqu(e.text)}}function nt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"span",48),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,o=t.oxw(2);return t.KtG(o.unBindingCard(i.tenantDriverId))}),t.qZA()}}function it(a,s){1&a&&t._UZ(0,"nz-divider",42)}function at(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.ALo(13,"date"),t.ALo(14,"date"),t.qZA(),t.TgZ(15,"td",41),t._UZ(16,"nz-divider",42),t.TgZ(17,"span",43),t.NdJ("click",function(){const o=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.editDriver(o,!1))}),t.qZA(),t._UZ(18,"nz-divider",42),t.TgZ(19,"span",44),t.NdJ("click",function(){const o=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.editDriver(o,!0))}),t.qZA(),t._UZ(20,"nz-divider",42),t.YNc(21,nt,1,0,"span",45),t.YNc(22,it,1,0,"nz-divider",46),t.TgZ(23,"span",47),t.NdJ("click",function(){const o=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.deleteDriver(o))}),t.qZA(),t._UZ(24,"nz-divider",42),t.qZA()()}if(2&a){const e=s.$implicit;t.ekj("ant-table-row-odd",s.index%2==1),t.xp6(2),t.Oqu(e.tenantDriverId),t.xp6(2),t.Oqu(e.employeeId),t.xp6(2),t.Oqu(e.driverHpNumber),t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.cardSn),t.xp6(2),t.AsE(" ",t.xi3(13,11,e.createTime,"d LLL yyyy")," ",t.xi3(14,14,e.createTime,"h:mm:ss a")," "),t.xp6(9),t.Q6J("ngIf",e.cardSn),t.xp6(1),t.Q6J("ngIf",e.cardSn)}}function ot(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"nz-table",37,38),t.NdJ("nzPageSizeChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.handlePageSizeChange(i))})("nzPageIndexChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.handlePageIndexChange(i))}),t.TgZ(2,"thead")(3,"tr"),t.YNc(4,et,2,1,"th",39),t.qZA()(),t.TgZ(5,"tbody"),t.YNc(6,at,25,17,"tr",40),t.qZA()()}if(2&a){const e=t.MAs(1),n=t.oxw(),i=t.MAs(34);t.Q6J("nzData",n.listData)("nzFrontPagination",!1)("nzLoading",n.loading)("nzTotal",n.pagination.totalCount)("nzPageSize",n.pagination.rowsPerPage)("nzPageIndex",n.pagination.page)("nzShowSizeChanger",!0)("nzShowTotal",i),t.xp6(4),t.Q6J("ngForOf",n.tableHeadersDriver),t.xp6(2),t.Q6J("ngForOf",e.data)}}function rt(a,s){1&a&&(t.TgZ(0,"h5"),t._uU(1,"Add Driver"),t.qZA())}function st(a,s){1&a&&(t.TgZ(0,"h5"),t._uU(1,"View Driver"),t.qZA())}function lt(a,s){1&a&&(t.TgZ(0,"h5"),t._uU(1,"Edit Driver"),t.qZA())}function ct(a,s){1&a&&(t.TgZ(0,"h5",63),t._uU(1,"Driver Details"),t.qZA())}function dt(a,s){1&a&&(t.TgZ(0,"div",64),t._uU(1),t.qZA()),2&a&&(t.xp6(1),t.hij(" ","Field is required."," "))}function gt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",51)(1,"label",52),t._uU(2),t.qZA(),t.TgZ(3,"div",54)(4,"input",65),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw(3);return t.KtG(o.actionDriverMoreData.status=i)}),t.qZA()()()}if(2&a){const e=t.oxw(3);t.xp6(2),t.hij(" ","Status",": "),t.xp6(2),t.Q6J("ngModel",e.actionDriverMoreData.status)}}function pt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",50)(1,"div",51)(2,"label",52),t._uU(3),t.qZA(),t.TgZ(4,"div",54)(5,"input",65),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw(2);return t.KtG(o.actionDriverMoreData.name=i)}),t.qZA()()(),t.YNc(6,gt,5,2,"div",66),t.qZA()}if(2&a){const e=t.oxw(2);t.xp6(3),t.hij(" ","Name",": "),t.xp6(2),t.Q6J("ngModel",e.actionDriverMoreData.name),t.xp6(1),t.Q6J("ngIf",!1)}}function mt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",50)(1,"div",51)(2,"label",52),t._uU(3," Remaining Quota: "),t.qZA(),t.TgZ(4,"div",54)(5,"p-inputNumber",67),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw(2);return t.KtG(o.actionDriverData.consumptionQuota=i)}),t.qZA()()()()}if(2&a){const e=t.oxw(2);t.xp6(5),t.Q6J("ngModel",e.actionDriverData.consumptionQuota)("showButtons",!1)("min",0)("max",e.quotaAvailable)}}function _t(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",68),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.toEditDriver())}),t._uU(1," Edit "),t.qZA()}}function ht(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",69),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.sureAddDriver())}),t._uU(1),t.qZA()}if(2&a){const e=t.oxw(2);t.Q6J("disabled",!e.actionDriverData.hpNumber),t.xp6(1),t.hij(" ",e.isEdit?"Update":"Save"," ")}}function ut(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div"),t.YNc(1,rt,2,0,"h5",11),t.YNc(2,st,2,0,"h5",11),t.YNc(3,lt,2,0,"h5",11),t.YNc(4,ct,2,0,"h5",49),t.TgZ(5,"div",50)(6,"div",51)(7,"label",52)(8,"span",53),t._uU(9,"*"),t.qZA(),t._uU(10),t.qZA(),t.TgZ(11,"div",54)(12,"input",55,56),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.actionDriverData.hpNumber=i)}),t.qZA(),t.YNc(14,dt,2,1,"div",57),t.qZA()(),t.TgZ(15,"div",51)(16,"label",52),t._uU(17),t.qZA(),t.TgZ(18,"div",54)(19,"input",58),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.actionDriverData.employeeId=i)}),t.qZA()()()(),t.YNc(20,pt,7,3,"div",59),t.YNc(21,mt,6,4,"div",59),t.TgZ(22,"div",60)(23,"button",22),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.gobackDriverList())}),t._uU(24," Back "),t.qZA(),t.YNc(25,_t,2,0,"button",61),t.YNc(26,ht,2,2,"button",62),t.qZA()()}if(2&a){const e=t.MAs(13),n=t.oxw();t.xp6(1),t.Q6J("ngIf",!n.isTableAction),t.xp6(1),t.Q6J("ngIf",n.isTableAction&&n.isView),t.xp6(1),t.Q6J("ngIf",n.isTableAction&&n.isEdit),t.xp6(1),t.Q6J("ngIf",n.isTableAction),t.xp6(6),t.hij(" ","Mobile No.",": "),t.xp6(2),t.Q6J("disabled",n.isTableAction)("ngModel",n.actionDriverData.hpNumber),t.xp6(2),t.Q6J("ngIf",e.invalid&&(e.dirty||e.touched)),t.xp6(3),t.hij(" ","Employee ID.",": "),t.xp6(2),t.Q6J("disabled",n.isTableAction&&!n.isEdit)("ngModel",n.actionDriverData.employeeId),t.xp6(1),t.Q6J("ngIf",n.isTableAction),t.xp6(1),t.Q6J("ngIf",!n.isTableAction),t.xp6(4),t.Q6J("ngIf",n.isView),t.xp6(1),t.Q6J("ngIf",!n.isView)}}function vt(a,s){if(1&a&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA()()),2&a){const e=s.$implicit,n=s.index;t.ekj("ant-table-row-odd",n%2==1),t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(e.hpNumber),t.xp6(2),t.Oqu(e.errorMsg)}}function ft(a,s){if(1&a&&(t.TgZ(0,"nz-table",73,38)(2,"thead")(3,"tr")(4,"th",74),t._uU(5,"#"),t.qZA(),t.TgZ(6,"th"),t._uU(7,"Mobile No."),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Failed Reason"),t.qZA()()(),t.TgZ(10,"tbody"),t.YNc(11,vt,7,5,"tr",40),t.qZA()()),2&a){const e=t.MAs(1),n=t.oxw(2);t.Q6J("nzScroll",n.scrollHeight)("nzShowPagination",!1)("nzData",n.loadDetailTableData),t.xp6(4),t.Q6J("nzWidth","60px"),t.xp6(7),t.Q6J("ngForOf",e.data)}}function xt(a,s){if(1&a&&(t.ynx(0),t.TgZ(1,"div",70)(2,"h4"),t._uU(3),t.qZA()(),t.TgZ(4,"div",71),t.YNc(5,ft,12,5,"nz-table",72),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(3),t.Oqu(e.loadDetailTtitle),t.xp6(2),t.Q6J("ngIf",e.loadDetailTableData.length)}}function Dt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",75)(1,"button",76),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.closeLoadDetailModal())}),t._uU(2,"ok"),t.qZA()()}}const Tt=function(){return{"background-color":"#a6a6a6"}},Ct=function(){return{"background-color":"#692475"}},bt=function(){return{"background-color":"#0061a8"}},Mt=function(){return{"background-color":"#5f9460"}};let Pt=(()=>{class a extends J.t{constructor(e,n,i,o,l,m){super(),this.tenantManagementPageservicetService=e,this.ticketManagementPageservicetService=n,this.driverManagementPageservicetService=i,this.modalService=o,this.message=l,this.modal=m,this.keyword="",this.keyword$=new f.xQ,this.ticketKeyword="",this.startDate="",this.endDate="",this.ticketsDashboardData=[],this.tenantsDashboardData=[],this.ticketStatus="list",this.deleteOneTicket="true",this.ticketAssignAimTenant=[],this.ticketAssignAimTenantChoose="",this.tenantId$=new U.X(""),this.ticketStatusSearch=[{name:"UNASSIGNED",value:0},{name:"ASSIGNED ",value:1},{name:"INACTIVE ",value:2},{name:"ACTIVE ",value:3},{name:"LOST ",value:4},{name:"DEACTIVATED ",value:5}],this.ticketStatusChoose="",this.ticketListChoose=[],this.importantMsg="",this.errMsg="Confirm Delete Tenant?",this.actionTenantId=null,this.waitActionTicket=[],this.tableHeadersThree=[{text:"Tower",column:"",width:"130px"},{text:"Level",column:"",width:"110px"}],this.AllCarpark=[],this.dialogChooseCarparks=[],this.data=[],this.driverKeyword="",this.driverKeyword$=new f.xQ,this.driverStatusChoose="",this.timeRangeDriver=[],this.driverShow="list",this.actionDriverData={employeeId:"",hpNumber:"",tenantId:"",consumptionQuota:0},this.actionDriverMoreData={name:void 0,status:void 0,cardSn:void 0,isDeLink:!1},this.startDriverDate="",this.endDriverDate="",this.tableHeadersDriver=[{text:"#",column:"",width:"50px"},{text:"Employee ID",column:"",width:"110px"},{text:"Mobile No.",column:"",width:"110px"},{text:"Name",column:"name",width:"110px"},{text:"Ticket No.",column:"",width:"110px"},{text:"Created On",column:"",width:"110px"},{text:"Action",column:"",width:"110px"}],this.actionDriver={},this.quotaAvailable=0,this.isTableAction=!1,this.isEdit=!1,this.isView=!1,this.editTenantDriverId="",this.showDeLinkBtn=!0,this.showLoadDetailModal=!1,this.loadDetailTtitle="",this.loadDetailTableData=[],this.scrollHeight={y:"400px"}}get filterParams(){return{beginTime:this.startDriverDate,endTime:this.endDriverDate,keyword:this.driverKeyword,tenantId:localStorage.getItem("tenantId")?localStorage.getItem("tenantId"):this.tenantId$.getValue()}}reloadData(){this.ticketManagementPageservicetService.getTicketDashboardData(localStorage.getItem("tenantId")).subscribe(e=>{this.ticketsDashboardData=e.data}),this.ticketManagementPageservicetService.getTenantDriverDashboardData(localStorage.getItem("tenantId")).subscribe(e=>{this.tenantsDashboardData=e}),this.reloadDataService(this.driverManagementPageservicetService),this.actionDriverData.tenantId=localStorage.getItem("tenantId")}pageChanged(e){this.pagination=e,this.reloadData()}handlePageSizeChange(e){this.pagination={...this.pagination,rowsPerPage:e},this.reloadData()}handlePageIndexChange(e){this.pagination={...this.pagination,page:e},this.reloadData()}ngOnInit(){this.reloadData(),this.keywordListener=this.keyword$?.debounceTime(500).subscribe(()=>{this.reloadData()}),localStorage.getItem("tenantId")||(this.tenantIdListener=this.tenantId$.subscribe(e=>{this.reloadData()}),this.ticketManagementPageservicetService.getTenantsInformation().subscribe(e=>{localStorage.setItem("tenantId",e.data.tenantId),this.tenantId$.next(e.data.tenantId)})),this.driverKeyword$.debounceTime(500).subscribe(()=>{this.reloadData()})}ngOnDestroy(){this.tenantIdListener?.unsubscribe(),this.keywordListener?.unsubscribe()}ticketCheckChange(e){this.waitActionTicket.push(e)}deleteTicketSure(){this.modalRef.hide(),this.ticketManagementPageservicetService.deleteTicket(this.waitActionTicket[0].cardId).subscribe(n=>{200==n.code&&(this.waitActionTicket=[],this.reloadData())})}deleteManyTicketSure(){let e="";this.waitActionTicket.forEach(i=>{e+=i.cardId+","});let n=e.substring(0,e.length-1);this.ticketManagementPageservicetService.deleteTicket(n).subscribe(i=>{200==i.code&&(this.waitActionTicket=[],this.closeModal(),this.reloadData())})}SureAssign(){let e=[];this.waitActionTicket.forEach(o=>{e.push(o.cardId)});let i=this;i.ticketManagementPageservicetService.assignTicketToTenant({cardIdList:e,tenantId:this.ticketAssignAimTenantChoose}).subscribe(o=>{200==o.code?(i.modalRef.hide(),i.reloadData()):(i.modalRef.hide(),i.importantMsg=o.msg,i.modalRef=this.modalService.show(this.confirmModalImportant,{class:"modal-md"}))})}stopUse(e){this.ticketManagementPageservicetService.stopUse(e.cardId).subscribe(n=>{200==n.code&&this.reloadData()})}lost(e){this.ticketManagementPageservicetService.lostHandle(e.cardId).subscribe(n=>{200==n.code&&this.reloadData()})}cancelLost(e){this.ticketManagementPageservicetService.cancellostHandle(e.cardId).subscribe(n=>{200==n.code&&this.reloadData()})}deleteTantentHandle(e){this.actionTenantId=e.tenantId,this.modalRef=this.modalService.show(this.confirmModal,{class:"modal-md"})}closeModal(){this.modalRef.hide()}closeModalYes(){this.modalRef.hide(),this.tenantManagementPageservicetService.deleteOneTenant(this.actionTenantId).subscribe(e=>{console.log(e,"\u7ed3\u679c"),200==e.code&&this.reloadData()})}downLoadTenants(){console.log("===================================="),console.log("\u56e2\u961f\u4e0b\u8f7d"),console.log("====================================")}chooseTenantCarpark(e){this.dialogChooseCarparks.push(e),this.AllCarpark.forEach(i=>{i.id==e.id&&(i.disabled=!0)})}reduceCur(e){this.AllCarpark.forEach(i=>{i.id==e.id&&(i.disabled=!1)});let n=-1;for(let i=0;i<this.dialogChooseCarparks.length;i++)this.dialogChooseCarparks[i].id==e.id&&(n=i);n>-1&&this.dialogChooseCarparks.splice(n,1)}addDriverOne(){this.ticketManagementPageservicetService.getTenantsInformation().subscribe(e=>{if(200===e.code){let n=e.data.consumptionQuota?e.data.consumptionQuota:0;this.quotaAvailable=n,this.actionDriverData.consumptionQuota=n,this.actionDriverData.tenantId=localStorage.getItem("tenantId")?localStorage.getItem("tenantId"):e.data.tenantId}else this.message.create("error","Failed to obtain quota info"),this.quotaAvailable=0,this.actionDriverData.consumptionQuota=0,this.actionDriverData.tenantId=localStorage.getItem("tenantId")?localStorage.getItem("tenantId"):e.data.tenantId;this.driverShow="addDriver"},e=>{this.message.create("error","Failed to obtain quota info"),this.quotaAvailable=0,this.actionDriverData.consumptionQuota=0,this.driverShow="addDriver"})}gobackDriverList(){this.driverShow="list",this.isTableAction=!1,this.isEdit=!1,this.isView=!1,this.actionDriverData={employeeId:"",hpNumber:"",tenantId:"",consumptionQuota:0},this.actionDriverMoreData={name:void 0,status:void 0,cardSn:void 0,isDeLink:!1}}sureAddDriver(){if(this.isTableAction&&this.isEdit)this.driverManagementPageservicetService.postUpdateDriverInfo({tenantDriverId:this.editTenantDriverId,employeeId:this.actionDriverData.employeeId}).subscribe(n=>{200===n.code?(this.message.success(n.msg),this.reloadData(),this.gobackDriverList()):this.message.error(n.msg)});else{let e=this;e.driverManagementPageservicetService.sureAddDriver(e.actionDriverData).subscribe(n=>{200===n.code?(this.message.success(n.msg||"Success add driver!"),this.reloadData(),this.gobackDriverList()):this.message.error(n.msg||"Failed add driver!")})}}deleteDriver(e){this.actionDriver=e,this.modal.confirm({nzTitle:"Confirm Delete?",nzContent:'<b style="color: red;">Remove employee from list of drivers? Ticket will be removed from driver.</b>',nzOkText:"Delete",nzOkType:"primary",nzOkDanger:!0,nzOnOk:()=>{this.okDeleteDriver()},nzCancelText:"Cancel"})}okDeleteDriver(){let e=this;e.driverManagementPageservicetService.deleteDriver(e.actionDriver.tenantDriverId).subscribe(n=>{200===n.code?(this.message.success(n.msg||"Success!"),e.reloadData()):this.message.error(n.msg||"Failed!")})}downloadImportTemplateDriver(){this.driverManagementPageservicetService.exportTemplate().subscribe(e=>{(0,q.saveAs)(e,"Driver Import Template.xlsx")})}getVisitDateDriver(e){this.startDriverDate=e.length?x(e[0]).format("YYYY-MM-DD HH:mm:ss"):"",this.endDriverDate=e.length?x(e[1]).format("YYYY-MM-DD HH:mm:ss"):"",this.reloadData()}loadDriver(){this.inputfileDriver.nativeElement.click()}closeLoadDetailModal(){this.showLoadDetailModal=!1}importDriver(e){let n=this;n.driverManagementPageservicetService.importManyDriver(e,8).subscribe(i=>{let o=0,l=0,m=0,h=i.data??[];200===i.code?(m=h.length,this.loadDetailTableData=h.filter(_=>_.errorMsg),h.forEach(_=>{_.errorMsg?l+=1:_.errMsg||(o+=1)}),this.loadDetailTtitle=`${o} of ${m} added`,this.showLoadDetailModal=!0,n.reloadData()):this.message.error(i.msg||"Import error,Incorrect information!")})}editDriver(e,n){console.log("data==============>",e),this.isTableAction=!0;let i=this.ticketStatusSearch.filter(o=>o.value===e.status);this.actionDriverMoreData.name=e.name??void 0,this.actionDriverMoreData.status=i[0].name,this.actionDriverMoreData.cardSn=e.cardSn??void 0,this.actionDriverMoreData.isDeLink=!e.cardSn,this.editTenantDriverId=e.tenantDriverId,this.showDeLinkBtn=!!e.cardSn,this.actionDriverData={employeeId:e.employeeId,hpNumber:e.driverHpNumber,tenantId:e.tenantId,consumptionQuota:e.consumptionQuota},n?(this.isView=!1,this.isEdit=!0):(this.isView=!0,this.isEdit=!1),this.driverShow="addDriver"}toEditDriver(){this.isView=!1,this.isEdit=!0}unBindingCard(e){this.editTenantDriverId=e,this.modal.confirm({nzTitle:"Confirm De-link?",nzContent:'<b style="color: red;">Remove ticket from driver?</b>',nzOkText:"De-link",nzOkType:"primary",nzOkDanger:!0,nzOnOk:()=>{this.checkUnbingCard()},nzCancelText:"Cancel"})}checkUnbingCard(){this.driverManagementPageservicetService.getDeLinkDriver(this.editTenantDriverId).subscribe(e=>{200===e.code?(this.message.success(e.msg??"Delink Success!"),this.reloadData()):this.message.error(e.msg)})}confirmDeLink(){this.actionDriverMoreData.cardSn="",this.actionDriverMoreData.isDeLink=!0,this.showDeLinkBtn=!1}cancelDeLink(){}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(D.D),t.Y36(T.y),t.Y36(C.p),t.Y36(v.tT),t.Y36(b.dD),t.Y36(p.Sf))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-tenant-driver-page"]],viewQuery:function(e,n){if(1&e&&(t.Gf(Y,5),t.Gf(K,5),t.Gf(j,5),t.Gf(R,5),t.Gf(V,5),t.Gf($,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.confirmModal=i.first),t.iGM(i=t.CRH())&&(n.confirmModalImportant=i.first),t.iGM(i=t.CRH())&&(n.inputfilePDF=i.first),t.iGM(i=t.CRH())&&(n.inputfile=i.first),t.iGM(i=t.CRH())&&(n.inputfileDriver=i.first),t.iGM(i=t.CRH())&&(n.confirmDeleteDriver=i.first)}},features:[t.qOj],decls:41,vars:22,consts:[[1,"body-wrapper"],["confirmModal",""],["confirmModalImportant",""],[1,"m-content"],[1,"m-portlet","m-portlet--tabs"],[1,"m-portlet__body","m-portlet__body--scrollable"],[1,"dash-box"],[1,"border-none","box-normal"],["class","action-line",4,"ngIf"],["rangeTemplate",""],[3,"nzData","nzFrontPagination","nzLoading","nzTotal","nzPageSize","nzPageIndex","nzShowSizeChanger","nzShowTotal","nzPageSizeChange","nzPageIndexChange",4,"ngIf"],[4,"ngIf"],[3,"nzVisible","nzTitle","nzFooter","nzVisibleChange","nzOnCancel"],[4,"nzModalContent"],["modalFooter",""],[1,"modal-body","text-center"],[2,"display","flex","justify-content","space-evenly"],["nz-button","","nzType","primary","nzGhost","","type","button",3,"click"],["nz-button","","nzType","primary","type","button",1,"mgl16",3,"click"],["nz-button","","nzGhost","","nzType","primary","type","button",3,"click"],[1,"action-line"],[2,"display","flex","justify-content","flex-end"],["nz-button","","nzType","primary","nzGhost","","nzShape","round",3,"click"],["nz-icon","","nzType","download","nzTheme","outline"],[1,"m-portlet__filter","tit-options-40","mgl16"],["type","file","name","video","id","video","accept","image/*,video/*,image/*MIME_type",2,"display","none",3,"change"],["inputfileDriver",""],["nz-button","","nzType","primary","nzShape","round",3,"click"],["nz-icon","","nzType","upload","nzTheme","outline"],["nz-button","","nzType","primary","nzShape","round",1,"mgl16",3,"click"],["nz-icon","","nzType","plus","nzTheme","outline"],[2,"display","flex","margin-top","16px"],[1,"filter-wrap"],[1,"filter-item"],[1,"filter-label"],["nz-input","","type","text","placeholder","Keywords",2,"width","160px",3,"ngModel","ngModelChange"],["nzFormat","dd/MM/yyyy",3,"ngModel","ngModelChange"],[3,"nzData","nzFrontPagination","nzLoading","nzTotal","nzPageSize","nzPageIndex","nzShowSizeChanger","nzShowTotal","nzPageSizeChange","nzPageIndexChange"],["basicTable",""],[4,"ngFor","ngForOf"],[3,"ant-table-row-odd",4,"ngFor","ngForOf"],[1,"tb-act"],["nzType","vertical",1,"nz-divider-style"],["nz-tooltip","","nzTooltipTitle","View",1,"la","la-eye",3,"click"],["nz-tooltip","","nzTooltipTitle","Edit",1,"la","la-edit",3,"click"],["nz-tooltip","","nzTooltipTitle","Delink","class","la la-unlink",3,"click",4,"ngIf"],["nzType","vertical","class","nz-divider-style",4,"ngIf"],["nz-tooltip","","nzTooltipTitle","Delete",1,"la","la-trash",3,"click"],["nz-tooltip","","nzTooltipTitle","Delink",1,"la","la-unlink",3,"click"],["class","mt-3 mb-3",4,"ngIf"],[2,"display","flex"],[1,"row","form-group","col-6"],[1,"col-form-label","col-4","text-right"],[1,"m--font-danger"],[1,"col-8"],["nz-input","","type","text","name","driverMobileNo","required","",3,"disabled","ngModel","ngModelChange"],["driverMobileNo","ngModel"],["class","form-control-feedback",4,"ngIf"],["nz-input","","type","text","name","employeeId",3,"disabled","ngModel","ngModelChange"],["style","display: flex;",4,"ngIf"],[2,"display","flex","justify-content","flex-end","margin-top","100px"],["nz-button","","nzShape","round","nzType","primary","class","mgl16",3,"click",4,"ngIf"],["class","mgl16","nz-button","","nzType","primary","nzShape","round",3,"disabled","click",4,"ngIf"],[1,"mt-3","mb-3"],[1,"form-control-feedback"],["nz-input","","disabled","","type","text",3,"ngModel","ngModelChange"],["class","row form-group col-6",4,"ngIf"],["ngDefaultControl","","mode","decimal","readonly","","disabled","",1,"readonly-input",3,"ngModel","showButtons","min","max","ngModelChange"],["nz-button","","nzShape","round","nzType","primary",1,"mgl16",3,"click"],["nz-button","","nzType","primary","nzShape","round",1,"mgl16",3,"disabled","click"],[1,"load-detail-title","mb-3","mt-3"],[1,"load-detail-body"],[3,"nzScroll","nzShowPagination","nzData",4,"ngIf"],[3,"nzScroll","nzShowPagination","nzData"],[3,"nzWidth"],[1,"load-detail-footer"],["nz-button","","nzType","primary",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0),t._UZ(1,"app-title-bar"),t.YNc(2,B,10,1,"ng-template",null,1,t.W1O),t.YNc(4,W,8,1,"ng-template",null,2,t.W1O),t.TgZ(6,"div",3)(7,"div",4)(8,"section")(9,"div",5)(10,"div",6)(11,"div",7)(12,"span"),t._uU(13,"Lots Quota"),t.qZA(),t.TgZ(14,"span"),t._uU(15),t.qZA()(),t.TgZ(16,"div",7)(17,"span"),t._uU(18,"Tickets Tickets"),t.qZA(),t.TgZ(19,"span"),t._uU(20),t.qZA()(),t.TgZ(21,"div",7)(22,"span"),t._uU(23,"Total Drivers"),t.qZA(),t.TgZ(24,"span"),t._uU(25),t.qZA()(),t.TgZ(26,"div",7)(27,"span"),t._uU(28,"Remaining Tickets"),t.qZA(),t.TgZ(29,"span"),t._uU(30),t.qZA()()(),t._UZ(31,"hr"),t.YNc(32,X,25,2,"div",8),t.YNc(33,tt,1,3,"ng-template",null,9,t.W1O),t.YNc(35,ot,7,10,"nz-table",10),t.YNc(36,ut,27,15,"div",11),t.qZA()()()()(),t.TgZ(37,"nz-modal",12),t.NdJ("nzVisibleChange",function(o){return n.showLoadDetailModal=o})("nzOnCancel",function(){return n.closeLoadDetailModal()}),t.YNc(38,xt,6,2,"ng-container",13),t.YNc(39,Dt,3,0,"ng-template",null,14,t.W1O),t.qZA()),2&e){const i=t.MAs(40);t.xp6(11),t.Akn(t.DdM(18,Tt)),t.xp6(4),t.Oqu(n.ticketsDashboardData.active||0),t.xp6(1),t.Akn(t.DdM(19,Ct)),t.xp6(4),t.Oqu(n.ticketsDashboardData.total||0),t.xp6(1),t.Akn(t.DdM(20,bt)),t.xp6(4),t.Oqu(n.tenantsDashboardData.data||0),t.xp6(1),t.Akn(t.DdM(21,Mt)),t.xp6(4),t.Oqu(n.ticketsDashboardData.assigned||0),t.xp6(2),t.Q6J("ngIf","list"==n.driverShow),t.xp6(3),t.Q6J("ngIf","list"==n.driverShow),t.xp6(1),t.Q6J("ngIf","addDriver"==n.driverShow),t.xp6(1),t.Q6J("nzVisible",n.showLoadDetailModal)("nzTitle","")("nzFooter",i)}},dependencies:[g.sg,g.O5,Q.G,L.Zp,H.Ls,M.ix,G.w,E.dQ,P.uw,P.wS,F.SY,d.N8,d.Uo,d._C,d.Om,d.p0,d.$Z,c.Fj,c.JJ,c.Q7,c.On,z.Rn,p.du,p.Hf,y.g,g.uU],styles:[".dash-box[_ngcontent-%COMP%]{display:flex;justify-content:space-between;color:#fff}.box-normal[_ngcontent-%COMP%]{height:120px;display:flex;flex-direction:column;justify-content:space-evenly;margin-bottom:12px;width:24%;padding:15px}.box-normal[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-size:16px}.box-normal[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{text-align:right;font-size:28px}.border-none[_ngcontent-%COMP%]{box-sizing:border-box;border:none}.modal-header-unbingding[_ngcontent-%COMP%]{position:relative}.modal-header-unbingding[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0 auto}.modal-header-unbingding[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;top:0;right:0;cursor:pointer;font-size:20px;font-weight:700}.de-link-input[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.de-link-input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:100%;display:flex;justify-content:center;align-items:center}.readonly-input[_ngcontent-%COMP%]{background-color:#d3d3d3}.tb-act[_ngcontent-%COMP%]{display:flex;align-items:center}.tb-act[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{cursor:pointer}.load-detail-title[_ngcontent-%COMP%]{text-align:center}.load-detail-footer[_ngcontent-%COMP%]{display:flex;justify-content:center}",'@charset "UTF-8";.backbtn[_ngcontent-%COMP%]:hover{color:#000!important}.text-right[_ngcontent-%COMP%]{font-weight:500!important;font-size:16px!important}.CilckStyle[_ngcontent-%COMP%]{border-bottom:3px solid #00bdb5}.top-line[_ngcontent-%COMP%]{display:flex}.top-line-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin-right:40px}.top-line-right[_ngcontent-%COMP%]{display:flex}.top-line-right-options[_ngcontent-%COMP%]{margin:0 20px;font-weight:500}.action-line[_ngcontent-%COMP%]{margin-bottom:6px;display:flex;align-items:center;justify-content:space-between}.SearchBox[_ngcontent-%COMP%]{display:flex;width:25%;margin:0 20px;font-size:16px;font-weight:500;position:relative;padding-bottom:0!important}.time-search[_ngcontent-%COMP%]{display:flex;width:20%;margin:0 20px 0 0;font-size:16px;font-weight:500;position:relative}.SearchLabel[_ngcontent-%COMP%]{margin-right:16px;font-size:16px;font-weight:500}.addCardTitle[_ngcontent-%COMP%]{margin:0 16px}.actionLineBtn[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.actionLineBtn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:16px}.addCardFooter[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.addCardFooter[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]{margin:0 16px}.assignSelectTitle[_ngcontent-%COMP%]{display:flex;align-items:center}.assignSelect[_ngcontent-%COMP%]{margin-left:20px}.assignSelect-topLine[_ngcontent-%COMP%]{margin:16px 0}.action-btn[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-bottom:16px}.action-btn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:16px}.editAction[_ngcontent-%COMP%], .view-icon[_ngcontent-%COMP%], .deleteAction[_ngcontent-%COMP%], .lostAction[_ngcontent-%COMP%], .stopUseAction[_ngcontent-%COMP%], .cancellostAction[_ngcontent-%COMP%]{cursor:pointer}.reduceBtn[_ngcontent-%COMP%]{line-height:40px!important;justify-content:center!important;border-radius:40px!important;width:40px!important;height:40px!important;background-color:#fff!important;border:2px solid #00bdb5!important;color:#00bdb5!important;font-size:1px}.border-none[_ngcontent-%COMP%]{box-sizing:border-box;border:none}.border-style[_ngcontent-%COMP%]{border-bottom:1px solid white}.dash-box[_ngcontent-%COMP%]{display:flex;justify-content:space-between;color:#fff}.box-unnormal[_ngcontent-%COMP%]{height:120px;margin-bottom:12px;padding:12px}.box-unnormal[_ngcontent-%COMP%]   .ticket-info[_ngcontent-%COMP%]{box-sizing:border-box;padding:0 1px 0 0;border-right:1px solid white;display:flex;flex-direction:column;justify-content:space-between}.box-unnormal[_ngcontent-%COMP%]   .ticket-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-size:16px}.box-unnormal[_ngcontent-%COMP%]   .ticket-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{font-size:28px}.box-unnormal[_ngcontent-%COMP%]   .assign-info-box[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-evenly}.box-unnormal[_ngcontent-%COMP%]   .assign-info-box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-size:16px}.box-unnormal[_ngcontent-%COMP%]   .assign-info-box[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:0}.box-normal[_ngcontent-%COMP%]{height:120px;display:flex;flex-direction:column;justify-content:space-evenly;margin-bottom:12px;padding:15px}.box-normal[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-size:16px}.box-normal[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{text-align:right;font-size:28px}.status-box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;width:100%;border-radius:30%;text-align:center;font-weight:600}.modal-header[_ngcontent-%COMP%]{position:relative}.modal-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0 auto}.modal-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;top:0;right:0;cursor:pointer;font-size:20px;font-weight:700}.tenant-table-action[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.tenant-table-action[_ngcontent-%COMP%]   .tenant-btn-group[_ngcontent-%COMP%]{display:flex;width:auto}.m-font-weight-600[_ngcontent-%COMP%]{font-weight:600}.m-font-weight-500[_ngcontent-%COMP%]{font-weight:500}.td-word-wrap[_ngcontent-%COMP%]{word-break:break-all!important}.action-btn-font[_ngcontent-%COMP%]{font-size:16px}.tenant-admin-info[_ngcontent-%COMP%]{display:flex;align-items:center}.tenant-admin-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:6px}.tenant-info[_ngcontent-%COMP%]{display:flex;align-items:center}.tenant-info[_ngcontent-%COMP%]   .email-act[_ngcontent-%COMP%]{cursor:pointer}.edit-tenant-main[_ngcontent-%COMP%]{position:relative}.edit-tenant-main[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px;cursor:pointer}.btn-form-ops[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.btn-form-ops[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{margin-left:6px}.ticket-tb-act[_ngcontent-%COMP%]{display:flex;align-items:center}.ticket-tb-act[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{cursor:pointer}']}),a})();var zt=r(77750),yt=r(6497);const Ot=[{path:"",component:Z.f,children:[{path:"",component:Pt}]}];let Zt=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({providers:[D.D,T.y,C.p],imports:[g.ez,k.x,O.Bz.forChild(Ot),A.A0,c.u5,c.UX,w.D,I.kn,N.mr,S.Ns.forRoot({echarts:()=>r.e(4734).then(r.bind(r,14734))}),v.zk,z.L$,zt.z,M.sL,yt._p,b.gR,p.Qp,y.S]}),a})()}}]);