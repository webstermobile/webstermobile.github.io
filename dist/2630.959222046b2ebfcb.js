"use strict";(self.webpackChunkst_admin=self.webpackChunkst_admin||[]).push([[2630],{56075:(j,J,i)=>{i.d(J,{h:()=>y});var e=i(24006),t=i(94650);let y=(()=>{class n{}return n.\u0275fac=function(P){return new(P||n)},n.\u0275dir=t.lG2({type:n,selectors:[["","appProvideParentForm",""]],features:[t._Bn([{provide:e.gN,useFactory:z=>z,deps:[e.F]}])]}),n})()},73071:(j,J,i)=>{i.d(J,{K:()=>P});var e=i(3927),t=i(94650),y=i(80529),n=i(28555),z=i(91599);let P=(()=>{class E extends e.su{constructor(A,I,U){super(A,I),this.http=A,this.store=I,this.modelName="User",this.baseUrl="",this.handleError=U.createHandleError(`${this.modelName}Service`)}searchOwners(A){const I=this.getUrl("carpark/api/car-park-owners");return this.get(I)}searchOperators(A){const I=this.getUrl("carpark/api/car-park-operators");return this.get(I)}}return E.\u0275fac=function(A){return new(A||E)(t.LFG(y.eN),t.LFG(n.yh),t.LFG(z.k))},E.\u0275prov=t.Yz7({token:E,factory:E.\u0275fac}),E})()},52746:(j,J,i)=>{i.d(J,{t:()=>n});var e=i(72986),t=i(591),y=i(94650);let n=(()=>{class z{constructor(){this.loading=!1,this.pagination={totalCount:0,rowsPerPage:20,page:1,sortBy:null,descending:!0,totalPages:1},this.listData=[],this.hadGetData$=new t.X(!1)}get hadGetData(){return this.hadGetData$.getValue()}get filterParams(){return this._filterParams}set filterParams(E){this._filterParams=E}reloadDataService(E,N="filterModel"){this.loading=!0,this.hadGetData$.next(!1),E[N](this.filterParams,this.pagination).pipe((0,e.q)(1)).subscribe(A=>{if(A.pagination.page>A.pagination.totalPages)return this.pagination={...this.pagination,page:A.pagination.totalPages},this.reloadDataService(E);this.loading=!1,this.pagination={...this.pagination,totalCount:A.pagination.totalCount||A.pagination.totalElements},this.listData=A.data,this.hadGetData$.next(!0)},()=>{this.loading=!1,this.listData=[],this.pagination={...this.pagination,totalCount:0}})}onQueryParamsChange(E){const{pageSize:N,pageIndex:A}=E;this.pagination={...this.pagination,rowsPerPage:N,page:A},this.reloadData()}reloadData(){}ngOnInit(){}}return z.\u0275fac=function(E){return new(E||z)},z.\u0275cmp=y.Xpm({type:z,selectors:[["ng-component"]],decls:0,vars:0,template:function(E,N){},encapsulation:2}),z})()},22630:(j,J,i)=>{i.d(J,{z:()=>T});var e=i(36895),t=i(80529),y=i(24006),n=i(30329),z=i(34793),P=i(372),E=i(73071),N=i(21532),K=(i(32311),i(3947),i(48942),i(85611),i(88796)),M=i(89383),C=i(19832),d=i(43056),u=i(56776),Z=i(90355),Q=(i(42883),i(20388)),L=i(34984),S=(i(69659),i(42265),i(94650));function p(v){return new C.w(v,"../assets/i18n/",".json")}let T=(()=>{class v{}return v.\u0275fac=function(f){return new(f||v)},v.\u0275mod=S.oAB({type:v}),v.\u0275inj=S.cJS({providers:[E.K],imports:[e.ez,y.u5,n.D,z.Bz,P.kn,u.Db,d.UU,N.x,Z.vO,K.A0,L.Ns.forRoot({echarts:()=>i.e(4734).then(i.bind(i,14734))}),Q.zk.forRoot(),M.aw.forChild({loader:{provide:M.Zw,useFactory:p,deps:[t.eN]}})]}),v})()},32311:(j,J,i)=>{i.d(J,{_:()=>S});var e=i(38014),t=i(94650),y=i(36895),n=i(24006),z=i(56075),P=i(38231),E=i(35635),N=i(66616),A=i(47044),I=i(21811),U=i(14685),x=i(89383);function K(p,O){1&p&&(t.TgZ(0,"div",49),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function M(p,O){1&p&&(t.TgZ(0,"div",49),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function C(p,O){1&p&&t._UZ(0,"i",50)}function d(p,O){1&p&&(t.TgZ(0,"div",51),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function u(p,O){1&p&&(t.TgZ(0,"div",52),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function Z(p,O){1&p&&(t.TgZ(0,"div",52),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function w(p,O){1&p&&(t.TgZ(0,"div",49),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function Q(p,O){1&p&&(t.TgZ(0,"div",52),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function L(p,O){1&p&&(t.TgZ(0,"div",52),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function W(p,O){1&p&&(t.TgZ(0,"div",52),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function F(p,O){if(1&p){const T=t.EpF();t.TgZ(0,"div",11)(1,"div",12)(2,"h5"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",13),t.NdJ("click",function(){const f=t.CHM(T).index,o=t.oxw();return t.KtG(o.form.timeSlots.splice(f,1))}),t._UZ(6,"i",14),t.qZA()(),t.TgZ(7,"div",15)(8,"div",16)(9,"label",17)(10,"span",18),t._uU(11,"*"),t.qZA(),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"div",19)(15,"div",20)(16,"nz-time-picker",21,22),t.NdJ("ngModelChange",function(l){const o=t.CHM(T).$implicit;return t.KtG(o.from=l)}),t.qZA(),t.YNc(18,K,3,3,"div",23),t.qZA(),t.TgZ(19,"div",24),t._uU(20),t.ALo(21,"translate"),t.qZA(),t.TgZ(22,"div",20)(23,"nz-time-picker",21,25),t.NdJ("ngModelChange",function(l){const o=t.CHM(T).$implicit;return t.KtG(o.to=l)}),t.qZA(),t.YNc(25,M,3,3,"div",23),t.qZA()()(),t.YNc(26,C,1,0,"ng-template",null,26,t.W1O),t.TgZ(28,"div",16)(29,"label",27)(30,"span",18),t._uU(31,"*"),t.qZA(),t._uU(32),t.ALo(33,"translate"),t.qZA(),t.TgZ(34,"div",19)(35,"nz-input-group",28),t.ALo(36,"translate"),t.TgZ(37,"input",29,30),t.NdJ("ngModelChange",function(l){const o=t.CHM(T).$implicit;return t.KtG(o.rate=l)}),t.qZA()(),t.YNc(39,d,3,3,"div",31),t.qZA()(),t.TgZ(40,"div",16)(41,"label",17)(42,"span",18),t._uU(43,"*"),t.qZA(),t._uU(44),t.ALo(45,"translate"),t.qZA(),t.TgZ(46,"div",19)(47,"nz-input-group",32),t.ALo(48,"translate"),t.TgZ(49,"input",29,33),t.NdJ("ngModelChange",function(l){const o=t.CHM(T).$implicit;return t.KtG(o.firstChargingPeriod=l)}),t.qZA()(),t.YNc(51,u,3,3,"div",34),t.qZA()(),t.TgZ(52,"div",16)(53,"label",17)(54,"span",18),t._uU(55,"*"),t.qZA(),t._uU(56),t.ALo(57,"translate"),t.qZA(),t.TgZ(58,"div",19)(59,"nz-input-group",35)(60,"input",29,36),t.NdJ("ngModelChange",function(l){const o=t.CHM(T).$implicit;return t.KtG(o.minimumPerEntry=l)}),t.qZA()(),t.YNc(62,Z,3,3,"div",34),t.qZA()()(),t.TgZ(63,"div",15)(64,"div",16)(65,"label",17)(66,"span",18),t._uU(67,"*"),t.qZA(),t._uU(68),t.ALo(69,"translate"),t.qZA(),t.TgZ(70,"div",37)(71,"nz-select",38,39),t.NdJ("ngModelChange",function(l){const o=t.CHM(T).$implicit;return t.KtG(o.rateType=l)}),t._UZ(73,"nz-option",40)(74,"nz-option",41)(75,"nz-option",42)(76,"nz-option",43),t.qZA(),t.YNc(77,w,3,3,"div",23),t.qZA()(),t.TgZ(78,"div",16)(79,"label",17)(80,"span",18),t._uU(81,"*"),t.qZA(),t._uU(82),t.ALo(83,"translate"),t.qZA(),t.TgZ(84,"div",19)(85,"nz-input-group",32),t.ALo(86,"translate"),t.TgZ(87,"input",29,44),t.NdJ("ngModelChange",function(l){const o=t.CHM(T).$implicit;return t.KtG(o.graceTime=l)}),t.qZA()(),t.YNc(89,Q,3,3,"div",34),t.qZA()(),t.TgZ(90,"div",16)(91,"label",17)(92,"span",18),t._uU(93,"*"),t.qZA(),t._uU(94),t.ALo(95,"translate"),t.qZA(),t.TgZ(96,"div",19)(97,"nz-input-group",28),t.ALo(98,"translate"),t.TgZ(99,"input",45,46),t.NdJ("ngModelChange",function(l){const o=t.CHM(T).$implicit;return t.KtG(o.firstChargingRate=l)}),t.qZA()(),t.YNc(101,L,3,3,"div",34),t.qZA()()(),t._UZ(102,"hr",47),t.TgZ(103,"div",15)(104,"div",16)(105,"label",17)(106,"span",18),t._uU(107,"*"),t.qZA(),t._uU(108),t.ALo(109,"translate"),t.qZA(),t.TgZ(110,"div",19)(111,"nz-input-group",35)(112,"input",29,48),t.NdJ("ngModelChange",function(l){const o=t.CHM(T).$implicit;return t.KtG(o.maxPerDate=l)}),t.qZA()(),t.YNc(114,W,3,3,"div",34),t.qZA()()()()}if(2&p){const T=O.$implicit,v=O.index,l=t.MAs(17),f=t.MAs(24),o=t.MAs(27),r=t.MAs(38),a=t.MAs(50),s=t.MAs(61),_=t.MAs(72),m=t.MAs(88),g=t.MAs(100),D=t.MAs(113),c=t.oxw();t.xp6(3),t.AsE("",t.lcZ(4,49,"Time Slot")," ",v+1,""),t.xp6(9),t.hij(" ",t.lcZ(13,51,"Time Range"),": "),t.xp6(4),t.MGl("name","fromTime",v,""),t.Q6J("ngModel",T.from)("nzUse12Hours",!0),t.xp6(2),t.Q6J("ngIf",l.invalid&&(l.dirty||l.touched||c.formRef.submitted)),t.xp6(2),t.hij(" ",t.lcZ(21,53,"to")," "),t.xp6(3),t.MGl("name","endTime",v,""),t.Q6J("ngModel",T.to)("nzUse12Hours",!0),t.xp6(2),t.Q6J("ngIf",f.invalid&&(f.dirty||f.touched||c.formRef.submitted)),t.xp6(4),t.MGl("for","exampleInputEmail",v,""),t.xp6(3),t.hij(" ",t.lcZ(33,55,"Rate"),": "),t.xp6(3),t.hYB("nzAddOnAfter","/",T.rateType,"",t.lcZ(36,57,"mins"),""),t.Q6J("nzAddOnBefore",o),t.xp6(2),t.MGl("name","rate",v,""),t.Q6J("ngModel",T.rate),t.xp6(2),t.Q6J("ngIf",r.invalid&&(r.dirty||r.touched||c.formRef.submitted)),t.xp6(5),t.hij(" ",t.lcZ(45,59,"First Charging Period"),": "),t.xp6(3),t.s9C("nzAddOnAfter",t.lcZ(48,61,"min")),t.xp6(2),t.MGl("name","chargingPeriod",v,""),t.Q6J("ngModel",T.firstChargingPeriod),t.xp6(2),t.Q6J("ngIf",a.invalid&&(a.dirty||a.touched||c.formRef.submitted)),t.xp6(5),t.hij(" ",t.lcZ(57,63,"Minimum Per Entry"),": "),t.xp6(3),t.Q6J("nzAddOnBefore",o),t.xp6(1),t.MGl("name","minimumPerEntry",v,""),t.Q6J("ngModel",T.minimumPerEntry),t.xp6(2),t.Q6J("ngIf",s.invalid&&(s.dirty||s.touched||c.formRef.submitted)),t.xp6(6),t.hij(" ",t.lcZ(69,65,"Rate Type"),": "),t.xp6(3),t.MGl("name","rateType",v,""),t.Q6J("ngModel",T.rateType),t.xp6(6),t.Q6J("ngIf",_.invalid&&(_.dirty||_.touched||c.formRef.submitted)),t.xp6(5),t.hij(" ",t.lcZ(83,67,"Grace Time"),": "),t.xp6(3),t.s9C("nzAddOnAfter",t.lcZ(86,69,"min")),t.xp6(2),t.MGl("name","graceTime",v,""),t.Q6J("ngModel",T.graceTime),t.xp6(2),t.Q6J("ngIf",m.invalid&&(m.dirty||m.touched||c.formRef.submitted)),t.xp6(5),t.hij(" ",t.lcZ(95,71,"First Charging Rate"),": "),t.xp6(3),t.s9C("nzAddOnAfter",t.lcZ(98,73,"min")),t.Q6J("nzAddOnBefore",o),t.xp6(2),t.Q6J("ngModel",T.firstChargingRate),t.xp6(2),t.Q6J("ngIf",g.invalid&&(g.dirty||g.touched||c.formRef.submitted)),t.xp6(7),t.hij(" ",t.lcZ(109,75,"Max Per Day"),": "),t.xp6(3),t.Q6J("nzAddOnBefore",o),t.xp6(1),t.MGl("name","maxPerDate",v,""),t.Q6J("ngModel",T.maxPerDate),t.xp6(2),t.Q6J("ngIf",D.invalid&&(D.dirty||D.touched||c.formRef.submitted))}}let S=(()=>{class p{constructor(){this.form=(0,e.jqJ)()}ngOnInit(){this.form={...this.form,effectiveStartDate:new Date(this.form.effectiveStartDate),effectiveEndDate:new Date(this.form.effectiveEndDate)}}addNewTimeSlot(){this.form.timeSlots.push((0,e.z5G)())}deleteChip(T,v,l,f){T.stopPropagation(),v.removeItem(l,f)}}return p.\u0275fac=function(T){return new(T||p)},p.\u0275cmp=t.Xpm({type:p,selectors:[["app-tariffs-form-adhoc"]],inputs:{form:"form",formRef:"formRef"},decls:16,vars:7,consts:[["appProvideParentForm",""],[1,"m-portlet"],[1,"m-portlet__head","d-flex","align-items-center"],[1,"row","m--marginless"],[1,"m-portlet__head-caption"],[1,"m-portlet__head-title"],[1,"m-portlet__head-text"],["class","m-portlet__body row",4,"ngFor","ngForOf"],[1,"m-portlet__foot"],["type","button","nz-button","","nzType","primary","nzGhost","","nzShape","round",3,"click"],[1,"la","la-plus"],[1,"m-portlet__body","row"],[1,"col-12","d-flex","justify-content-between","m--margin-bottom-20"],["type","button","nz-button","",3,"click"],[1,"la","la-trash"],[1,"col-6"],[1,"row","form-group"],[1,"col-form-label","text-right","col-4"],[1,"m--font-danger"],[1,"input-group","col-8"],[1,"col","m--padding-0"],["nzFormat","h:mm a","required","",2,"width","100%",3,"name","ngModel","nzUse12Hours","ngModelChange"],["fromTime","ngModel"],["class","form-control-feedback",4,"ngIf"],[1,"input-group-append",2,"line-height","35px","padding","0 6px"],["endTime","ngModel"],["addOnBeforeTemplate",""],[1,"col-form-label","text-right","col-4",3,"for"],[3,"nzAddOnBefore","nzAddOnAfter"],["type","text","nz-input","","required","",3,"name","ngModel","ngModelChange"],["rate","ngModel"],["class","form-control-feedback m--font-danger",4,"ngIf"],[3,"nzAddOnAfter"],["chargingPeriod","ngModel"],["class","w-100 form-control-feedback m--font-danger",4,"ngIf"],[3,"nzAddOnBefore"],["minimumPerEntry","ngModel"],[1,"col-8"],["required","",2,"width","100%",3,"name","ngModel","ngModelChange"],["rateType","ngModel"],["nzValue","15","nzLabel","15"],["nzValue","30","nzLabel","30"],["nzValue","45","nzLabel","45"],["nzValue","60","nzLabel","60"],["graceTime","ngModel"],["type","text","nz-input","","name","chargingRate","required","",3,"ngModel","ngModelChange"],["chargingRate","ngModel"],[1,"col-11"],["maxPerDate","ngModel"],[1,"form-control-feedback"],[1,"la","la-usd"],[1,"form-control-feedback","m--font-danger"],[1,"w-100","form-control-feedback","m--font-danger"]],template:function(T,v){1&T&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h3",6),t._uU(8),t.ALo(9,"translate"),t.qZA()()()()(),t.YNc(10,F,115,77,"div",7),t.TgZ(11,"div",8)(12,"button",9),t.NdJ("click",function(){return v.addNewTimeSlot()}),t._UZ(13,"i",10),t._uU(14),t.ALo(15,"translate"),t.qZA()()()()),2&T&&(t.xp6(8),t.hij(" ",t.lcZ(9,3,"Tariff")," "),t.xp6(2),t.Q6J("ngForOf",v.form.timeSlots),t.xp6(4),t.hij(" ",t.lcZ(15,5,"Add New Time Slot")," "))},dependencies:[y.sg,y.O5,n.Fj,n.JJ,n.Q7,n.On,z.h,P.Ip,P.Vq,E.Zp,E.gB,N.ix,A.w,I.dQ,U.m4,x.X$],encapsulation:2}),p})()},42883:(j,J,i)=>{i.d(J,{f:()=>v});var e=i(79118),t=i(15439),n=i(94650),z=i(34793),P=i(89383),E=i(67556),N=i(50007),A=i(49651),I=i(36895),U=i(24006),x=i(40269),K=i(38231),M=i(35635),C=i(66616),d=i(47044),u=i(21811),Z=i(34984);function w(l,f){1&l&&(n.TgZ(0,"div",31),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&l&&(n.xp6(1),n.hij(" ",n.lcZ(2,1," Field is required.")," "))}function Q(l,f){if(1&l&&(n.TgZ(0,"th"),n._uU(1),n.qZA()),2&l){const o=f.$implicit;n.xp6(1),n.Oqu(o.text)}}function L(l,f){if(1&l&&n._UZ(0,"nz-option",36),2&l){const o=f.$implicit;n.Q6J("nzValue",o)("nzLabel",o)}}function W(l,f){if(1&l&&n._UZ(0,"nz-option",36),2&l){const o=f.$implicit;n.Q6J("nzValue",o)("nzLabel",o)}}function F(l,f){if(1&l&&n._UZ(0,"nz-option",36),2&l){const o=f.$implicit;n.Q6J("nzValue",f.index)("nzLabel",o.name)}}function S(l,f){if(1&l){const o=n.EpF();n.TgZ(0,"i",37),n.NdJ("click",function(){n.CHM(o);const a=n.oxw().index,s=n.oxw();return n.KtG(s.delete(a))}),n.qZA()}}function p(l,f){if(1&l){const o=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2),n.qZA(),n.TgZ(3,"td")(4,"nz-select",32),n.NdJ("ngModelChange",function(a){const _=n.CHM(o).$implicit;return n.KtG(_.startTime=a)}),n.YNc(5,L,1,2,"nz-option",33),n.qZA()(),n.TgZ(6,"td")(7,"nz-select",32),n.NdJ("ngModelChange",function(a){const _=n.CHM(o).$implicit;return n.KtG(_.endTime=a)})("ngModelChange",function(){const s=n.CHM(o).index,_=n.oxw();return n.KtG(_.revisedECharts("endTime",s))}),n.YNc(8,W,1,2,"nz-option",33),n.qZA()(),n.TgZ(9,"td"),n._uU(10),n.qZA(),n.TgZ(11,"td")(12,"nz-select",34),n.NdJ("ngModelChange",function(a){const _=n.CHM(o).$implicit;return n.KtG(_.costType=a)})("ngModelChange",function(){n.CHM(o);const a=n.oxw();return n.KtG(a.revisedECharts())}),n.YNc(13,F,1,2,"nz-option",33),n.qZA()(),n.TgZ(14,"td"),n._uU(15),n.qZA(),n.TgZ(16,"td"),n._uU(17),n.qZA(),n.TgZ(18,"td"),n.YNc(19,S,1,0,"i",35),n.qZA()()}if(2&l){const o=f.$implicit,r=f.index,a=n.oxw();n.xp6(2),n.Oqu(r),n.xp6(2),n.MGl("name","startTime",r,""),n.Q6J("nzDisabled",!0)("ngModel",o.startTime),n.xp6(1),n.Q6J("ngForOf",a.periodTimeList),n.xp6(2),n.MGl("name","endTime",r,""),n.Q6J("nzDisabled",!0)("ngModel",o.endTime)("nzDisabled",a.saveInfos.items.length-1===r),n.xp6(1),n.Q6J("ngForOf",a.periodTimeList),n.xp6(2),n.Oqu(o.duration),n.xp6(2),n.MGl("name","costType",r,""),n.Q6J("ngModel",o.costType),n.xp6(1),n.Q6J("ngForOf",a.feeModelList),n.xp6(2),n.Oqu(o.powerPrice?o.powerPrice:"please edit model"),n.xp6(2),n.Oqu(o.serviceFee?o.serviceFee:"please edit model"),n.xp6(2),n.Q6J("ngIf",0!==r)}}function O(l,f){if(1&l){const o=n.EpF();n.TgZ(0,"div",6)(1,"label",39)(2,"span",8),n._uU(3,"*"),n.qZA(),n._uU(4),n.ALo(5,"translate"),n.qZA(),n.TgZ(6,"div",40)(7,"input",41),n.NdJ("ngModelChange",function(a){const _=n.CHM(o).index,m=n.oxw(2);return n.KtG(m.editFeeModelList[_].powerPrice=a)}),n.qZA()(),n.TgZ(8,"label",42)(9,"span",8),n._uU(10,"*"),n.qZA(),n._uU(11),n.ALo(12,"translate"),n.qZA(),n.TgZ(13,"div",43)(14,"input",41),n.NdJ("ngModelChange",function(a){const _=n.CHM(o).index,m=n.oxw(2);return n.KtG(m.editFeeModelList[_].serviceFee=a)}),n.qZA()()()}if(2&l){const o=f.$implicit,r=f.index,a=n.oxw(2);n.xp6(4),n.hij(" ",n.lcZ(5,4,o.name+" Power Price"),": "),n.xp6(3),n.Q6J("ngModel",a.editFeeModelList[r].powerPrice),n.xp6(4),n.hij(" ",n.lcZ(12,6,o.name+" Service Price"),": "),n.xp6(3),n.Q6J("ngModel",a.editFeeModelList[r].serviceFee)}}function T(l,f){if(1&l&&n.YNc(0,O,15,8,"div",38),2&l){const o=n.oxw();n.Q6J("ngForOf",o.editFeeModelList)}}let v=(()=>{class l{constructor(o,r,a,s,_,m){let g;for(this.router=o,this.translate=r,this.evcService=a,this.nzModalService=s,this.nzMessageService=_,this.route=m,this.periodTimeList=[],this.tableHeaders=[{text:"#",align:e.iW.Center,width:"7%"},{text:"Start Time",width:"15%"},{text:"End Time",width:"15%"},{text:"Duration(hrs)",width:"14%"},{text:"Fee model",width:"13%"},{text:"Power Price",width:"15%"},{text:"Service Fee",width:"15%"},{text:"Action",width:"6%"}],this.constant={time24:"24:00"},this.feeModelList=[{name:"Peak",powerPrice:null,serviceFee:null},{name:"High",powerPrice:null,serviceFee:null},{name:"Normal",powerPrice:null,serviceFee:null},{name:"Low",powerPrice:null,serviceFee:null}],this.editFeeModelList=[],this.saveInfos={companyId:null,costmodeId:"",costmodeName:null,delete_items:[],note:null,items:[],createBy:null},this.model=this.route.snapshot.queryParams.model,g=0;g<25;g++){let D;D=g+":00",this.periodTimeList.push(D)}this.periodTimeList[g-1]=this.constant.time24,this.pushDefaultPrice(),"update"===this.model&&this.setDataWhUpdate(),this.routeName=this.route.snapshot.queryParams.routeName}openModal(o){this.editFeeModelList=[...this.feeModelList],this.nzModalService.create({nzTitle:"Edit Model",nzContent:o,nzWidth:800,nzOnOk:()=>this.saveModel()})}ngOnInit(){const o=this.tableHeaders.map(r=>r.text);this.translate.get(o).subscribe(r=>{this.tableHeaders.forEach(a=>{for(const s in r)r.hasOwnProperty(s)&&a.text===s&&(a.text=r[s])})})}ngAfterViewInit(){setTimeout(()=>{this.modifyECharts()},3e3)}ngOnDestroy(){"update"===this.model&&localStorage.removeItem("curCostmode")}setDataWhUpdate(){const o=localStorage.getItem("curCostmode");o&&(this.saveInfos=JSON.parse(o),this.saveInfos.items[this.saveInfos.items.length-1].endTime=this.constant.time24),this.evcService.getAllElectricPrice({companyName:"",pageNum:1,pageSize:99999}).subscribe(a=>{if("00000"==a.messageCode){const s=a.data.content.filter(_=>_.companyId===this.saveInfos.companyId);0!==s.length&&(this.feeModelList[0].powerPrice=s[0].topPrice,this.feeModelList[0].serviceFee=s[0].serviceTopFee,this.feeModelList[1].powerPrice=s[0].peakPrice,this.feeModelList[1].serviceFee=s[0].servicePeakFee,this.feeModelList[2].powerPrice=s[0].norPrice,this.feeModelList[2].serviceFee=s[0].serviceNorFee,this.feeModelList[3].powerPrice=s[0].lowPrice,this.feeModelList[3].serviceFee=s[0].serviceLowFee),this.revisedECharts()}else this.message="Get data error..."})}saveModel(){this.feeModelList=[...this.editFeeModelList],this.revisedECharts()}pushDefaultPrice(){this.saveInfos.items.push({id:"",costType:0,startTime:this.periodTimeList[0],endTime:this.constant.time24,duration:24,powerPrice:null,serviceFee:null})}goBack(){this.routeName?this.router.navigate(["/evc/tariffs"],{queryParams:{id:1,routeName:"tariff"}}):this.router.navigate(["./tariffs"])}addCharts(){const o=this.saveInfos.items,r=o.length;if(0!==r){if("23:00"===o[r-1].startTime)return void this.alert("Warn : time cannot more than 24hours");this.pushDefaultPrice(),this.revisedECharts()}}revisedECharts(o,r){let a;const s=this.saveInfos.items;if("endTime"===o&&r<s.length-1&&(this.compare2Time(s[r].endTime,s[r].startTime)||this.compare2Time(s[r+1].endTime,s[r].endTime)))return void setTimeout(()=>{s[r].endTime=s[r+1].startTime},500);s.forEach(m=>{if(m.powerPrice=this.feeModelList[m.costType].powerPrice,m.serviceFee=this.feeModelList[m.costType].serviceFee,a&&m.startTime!==a.endTime){if(a.endTime===this.constant.time24){const g=this.periodTimeList.indexOf(a.startTime);m.startTime=this.periodTimeList[g+1],a.endTime=m.startTime}else"endTime"===o?m.startTime=a.endTime:a.endTime=m.startTime;a.duration=t(a.endTime,"hh:mm").diff(t(a.startTime,"hh:mm"),"hour"),m.duration=t(m.endTime,"hh:mm").diff(t(m.startTime,"hh:mm"),"hour")}a=m});const _=this.saveInfos.items[this.saveInfos.items.length-1];_.endTime=this.constant.time24,_.duration=t(_.endTime,"hh:mm").diff(t(_.startTime,"hh:mm"),"hour"),this.modifyECharts()}compare2Time(o,r){return parseFloat(o.replace(":","."))<=parseFloat(r.replace(":","."))}getDefaultFeeArr(){const o=[];for(let r=0;r<24;r++)o.push("-");return o}modifyECharts(){const o=this.saveInfos.items.map(r=>{const a=this.getDefaultFeeArr(),s=this.periodTimeList.indexOf(r.startTime),m=this.periodTimeList.indexOf(r.endTime)-s,g=parseFloat(r.powerPrice)+parseFloat(r.serviceFee);for(let D=0;D<=m;D++)a[s+D]=g;return{data:a,type:"line",areaStyle:{type:"default",color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"red"},{offset:1,color:"#fff"}])},lineStyle:{color:"red"}}});this.option={series:o,xAxis:{type:"category",boundaryGap:!1,data:this.periodTimeList},yAxis:{type:"value"}}}delete(o){0!==o&&(this.saveInfos.items[o].id&&this.saveInfos.delete_items.push(this.saveInfos.items[o].id),this.saveInfos.items.splice(o,1),this.revisedECharts())}editPrice(){this.revisedECharts()}submit(){const o=this.getBasicPrice(),r={basicPrice:o,companyName:this.saveInfos.costmodeName,peakRate:this.getPriceRate(this.feeModelList[1].powerPrice,o),topRate:this.getPriceRate(this.feeModelList[0].powerPrice,o),norRate:this.getPriceRate(this.feeModelList[2].powerPrice,o),lowRate:this.getPriceRate(this.feeModelList[3].powerPrice,o),otherRate:"0%",note:this.saveInfos.note,serviceTopFee:this.feeModelList[0].serviceFee,servicePeakFee:this.feeModelList[1].serviceFee,serviceLowFee:this.feeModelList[3].serviceFee,serviceNorFee:this.feeModelList[2].serviceFee,companyId:"",lowPrice:this.feeModelList[3].powerPrice,norPrice:this.feeModelList[2].powerPrice,operatorId:"1",peakPrice:this.feeModelList[1].powerPrice,topPrice:this.feeModelList[0].powerPrice};let a="add";this.saveInfos.companyId&&(r.companyId=this.saveInfos.companyId,a="update"),this.saveInfos.items=this.saveInfos.items.map(s=>({...s,startTime:s.startTime+":00",endTime:"24:00"==s.endTime?"23:59:59":s.endTime+":00"})),this.evcService.addElectricPrice(r).subscribe(s=>{if("00000"==s.messageCode){"add"==a&&(this.saveInfos.companyId=s.data.id);const _={costmodeName:this.saveInfos.costmodeName,costmodeId:this.saveInfos.costmodeId,companyId:this.saveInfos.companyId,note:this.saveInfos.note,periodArr:this.saveInfos.items,delete_items:this.saveInfos.delete_items,createBy:"add"==a?JSON.parse(localStorage.getItem("user")).firstName:null,updateBy:"add"==a?null:JSON.parse(localStorage.getItem("user")).firstName};this.evcService.addCostModel(_,this.model).subscribe(m=>{"00000"==m.messageCode?this.goBack():this.alert(`${s.messageCode} : Save EVC tariffs failed`)},()=>{this.alert("Exception : Delete EVC tariffs failed")})}else this.alert(`${s.messageCode} : Save EVC tariffs failed`)},()=>{this.alert("Exception : Delete EVC tariffs failed")})}alert(o){this.nzMessageService.warning(o)}getBasicPrice(){let o=1,r=1;return this.feeModelList.forEach(a=>{a.powerPrice&&(a.powerPrice>o&&(o=+a.powerPrice),a.powerPrice<r&&(r=+a.powerPrice))}),o+r===0?1:o!==r?(o+r)/2:o}getPriceRate(o,r){return(o-r)/r*100+"%"}}return l.\u0275fac=function(o){return new(o||l)(n.Y36(z.F0),n.Y36(P.sK),n.Y36(E.z$),n.Y36(N.Sf),n.Y36(A.dD),n.Y36(z.gz))},l.\u0275cmp=n.Xpm({type:l,selectors:[["app-tariffs-form-evc"]],inputs:{model:"model"},decls:51,vars:22,consts:[[1,"m-portlet","m-portlet--bordered-semi","m--padding-top-30"],[1,"m-portlet__body"],[1,"row","form-group","m-form__group","m--margin-bottom-30",3,"ngSubmit"],["formRef","ngForm"],[1,"col-xl-12","order-2","order-xl-1"],[1,"m-form","m-form--fit","m-form--label-align-right"],[1,"row","form-group"],[1,"col-form-label","col-2","text-right"],[1,"m--font-danger"],["class","form-control-feedback",4,"ngIf"],[1,"col-4"],["type","text","nz-input","","required","","name","costmodeName",3,"ngModel","disabled","ngModelChange"],["costmodeName","ngModel"],[1,"col-form-label","col-lg-2","col-sm-12","text-right"],[1,"col-lg-4","col-sm-12"],["type","text","name","note","nz-input","",3,"ngModel","ngModelChange"],["id","EvcChart","echarts","",2,"height","400px","width","100%",3,"options"],[1,"col-xl-12","order-2","order-xl-1",2,"display","flex","justify-content","flex-end"],["type","button","nz-button","",3,"click"],[1,"la","la-arrow-left"],["type","button","nz-button","",1,"mgl16",3,"click"],[1,"la","la-pencil"],["type","submit","nz-button","","nzType","primary",1,"mgl16"],[1,"col-xl-12","order-2","order-xl-1",2,"padding-top","50px"],[1,"m-datatable","m-datatable--default","m-datatable--brand","m-datatable--loaded"],["nzTemplateMode",""],[4,"ngFor","ngForOf"],[1,"col-xl-12","order-2","order-xl-1",2,"display","flex","justify-content","center","padding-top","20px"],["type","button","nz-button","","nzType","link",3,"click"],[1,"la","la-plus-circle"],["template",""],[1,"form-control-feedback"],[2,"width","80px",3,"nzDisabled","ngModel","name","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[2,"width","100px",3,"ngModel","name","ngModelChange"],["class","la la-close",3,"click",4,"ngIf"],[3,"nzValue","nzLabel"],[1,"la","la-close",3,"click"],["class","row form-group",4,"ngFor","ngForOf"],[1,"col-form-label","col-3","text-right"],[1,"col-3"],["type","text","nz-input","",3,"ngModel","ngModelChange"],[1,"col-form-label","col-lg-3","col-sm-12","text-right"],[1,"col-lg-3","col-sm-12"]],template:function(o,r){if(1&o){const a=n.EpF();n.TgZ(0,"div",0)(1,"div",1)(2,"form",2,3),n.NdJ("ngSubmit",function(){n.CHM(a);const _=n.MAs(3);return n.KtG(_.valid&&r.submit())}),n.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"label",7)(8,"span",8),n._uU(9,"*"),n.qZA(),n._uU(10),n.ALo(11,"translate"),n.YNc(12,w,3,3,"div",9),n._uU(13,": "),n.qZA(),n.TgZ(14,"div",10)(15,"input",11,12),n.NdJ("ngModelChange",function(_){return r.saveInfos.costmodeName=_}),n.qZA()(),n.TgZ(17,"label",13),n._uU(18),n.ALo(19,"translate"),n.qZA(),n.TgZ(20,"div",14)(21,"input",15),n.NdJ("ngModelChange",function(_){return r.saveInfos.note=_}),n.qZA()()()()(),n.TgZ(22,"div",4),n._UZ(23,"div",16),n.qZA(),n.TgZ(24,"div",17)(25,"button",18),n.NdJ("click",function(){return r.goBack()}),n.TgZ(26,"span"),n._UZ(27,"i",19),n._uU(28),n.ALo(29,"translate"),n.qZA()(),n.TgZ(30,"button",20),n.NdJ("click",function(){n.CHM(a);const _=n.MAs(50);return n.KtG(r.openModal(_))}),n.TgZ(31,"span"),n._UZ(32,"i",21),n._uU(33),n.ALo(34,"translate"),n.qZA()(),n.TgZ(35,"button",22),n._uU(36),n.ALo(37,"translate"),n.qZA()(),n.TgZ(38,"div",23)(39,"div",24)(40,"nz-table",25)(41,"thead")(42,"tr"),n.YNc(43,Q,2,1,"th",26),n.qZA()(),n.TgZ(44,"tbody"),n.YNc(45,p,20,17,"tr",26),n.qZA()()()(),n.TgZ(46,"div",27)(47,"button",28),n.NdJ("click",function(){return r.addCharts()}),n._UZ(48,"i",29),n.qZA()()()()(),n.YNc(49,T,1,1,"ng-template",null,30,n.W1O)}if(2&o){const a=n.MAs(3),s=n.MAs(16);n.xp6(10),n.hij(" ",n.lcZ(11,12,"Tariff Name")," "),n.xp6(2),n.Q6J("ngIf",s.invalid&&(s.dirty||s.touched||a.submitted)),n.xp6(3),n.Q6J("ngModel",r.saveInfos.costmodeName)("disabled","update"===r.model),n.xp6(3),n.hij(" ",n.lcZ(19,14,"Note"),": "),n.xp6(3),n.Q6J("ngModel",r.saveInfos.note),n.xp6(2),n.Q6J("options",r.option),n.xp6(5),n.hij(" ",n.lcZ(29,16,"Back"),""),n.xp6(5),n.hij(" ",n.lcZ(34,18,"Model"),""),n.xp6(3),n.Oqu(n.lcZ(37,20,"Submit")),n.xp6(7),n.Q6J("ngForOf",r.tableHeaders),n.xp6(2),n.Q6J("ngForOf",r.saveInfos.items)}},dependencies:[I.sg,I.O5,U._Y,U.Fj,U.JJ,U.JL,U.Q7,U.On,U.F,x.N8,x.Uo,x._C,x.Om,x.p0,x.$Z,K.Ip,K.Vq,M.Zp,C.ix,d.w,u.dQ,Z._w,P.X$],styles:["[_nghost-%COMP%]     .m-datatable__table{min-height:initial!important}.btn-color-white[_ngcontent-%COMP%], .btn-color-purple[_ngcontent-%COMP%]{width:120px!important}.btn-color-white[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #dcdcdc;color:#6f6f6f;margin-right:30px}.btn-color-purple[_ngcontent-%COMP%]{background-color:#5866dd;border:1px solid #5866dd;color:#fff}.btn-color-purple[_ngcontent-%COMP%]:active{background-color:#5866dd}.la-plus-circle[_ngcontent-%COMP%]:hover, .la-close[_ngcontent-%COMP%]:hover, .la-pencil[_ngcontent-%COMP%]:hover{color:#5866dd;cursor:pointer}.myModelClass[_ngcontent-%COMP%]{max-width:600px!important}"]}),l})()},3947:(j,J,i)=>{i.d(J,{O:()=>m});var e=i(94650),t=i(38014),y=i(8929),n=i(24850),z=i(72986),P=i(1059),E=i(80013),N=i(75778),A=i(2994),I=i(87545),U=i(88117),x=i(73071),K=i(36511),M=i(34793),C=i(89383),d=i(36895),u=i(24006),Z=i(38231),w=i(35635),Q=i(66616),L=i(47044),W=i(21811),F=i(48942),S=i(85611),p=i(32311),O=i(42265);function T(g,D){1&g&&(e.TgZ(0,"div",31),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&g&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function v(g,D){if(1&g&&(e._UZ(0,"nz-option",32),e.ALo(1,"titlecase")),2&g){const c=D.$implicit;e.Q6J("nzValue",c.id)("nzLabel",e.lcZ(1,2,c.value))}}function l(g,D){if(1&g&&(e._UZ(0,"nz-option",32),e.ALo(1,"titlecase")),2&g){const c=D.$implicit;e.Q6J("nzValue",c.id)("nzLabel",e.lcZ(1,2,c.value))}}function f(g,D){if(1&g&&(e._UZ(0,"nz-option",32),e.ALo(1,"titlecase")),2&g){const c=D.$implicit;e.Q6J("nzValue",c.id)("nzLabel",e.lcZ(1,2,c.value))}}function o(g,D){if(1&g&&e._UZ(0,"nz-option",32),2&g){const c=D.$implicit;e.Q6J("nzValue",c.id)("nzLabel",c.name)}}function r(g,D){if(1&g&&e._UZ(0,"nz-option",32),2&g){const c=D.$implicit;e.Q6J("nzValue",c.id)("nzLabel",c.name)}}function a(g,D){if(1&g){const c=e.EpF();e.TgZ(0,"app-tariffs-form-normal",33),e.NdJ("formChange",function(B){e.CHM(c);const b=e.oxw();return e.KtG(b.form=B)}),e.qZA()}if(2&g){const c=e.oxw(),h=e.MAs(1);e.Q6J("form",c.form)("formRef",h)}}function s(g,D){if(1&g){const c=e.EpF();e.TgZ(0,"app-tariffs-form-season",33),e.NdJ("formChange",function(B){e.CHM(c);const b=e.oxw();return e.KtG(b.form=B)}),e.qZA()}if(2&g){const c=e.oxw(),h=e.MAs(1);e.Q6J("form",c.form)("formRef",h)}}function _(g,D){if(1&g){const c=e.EpF();e.TgZ(0,"app-tariffs-form-adhoc",33),e.NdJ("formChange",function(B){e.CHM(c);const b=e.oxw();return e.KtG(b.form=B)}),e.qZA()}if(2&g){const c=e.oxw(),h=e.MAs(1);e.Q6J("form",c.form)("formRef",h)}}let m=(()=>{class g{constructor(c,h,B,b,R){this.userService=c,this.codeTablesService=h,this.route=B,this.router=b,this.translate=R,this.form=(0,t.jqJ)(),this.submitted=new e.vpe,this.canceled=new e.vpe,this.ownerInput$=new y.xQ,this.operatorInput$=new y.xQ,this.tariffTypes=[],this.vehicleTypes=[]}get type(){return this.route.snapshot.queryParamMap.get("type")||this.form.tariffTypeCode}get vehicleType(){return this.route.snapshot.queryParamMap.get("vehicleType")||this.form.vehicleTypeCode}ngOnInit(){this.vehicleTypes$=this.codeTablesService.filterModelByType(t.BcL.VehicleType).pipe((0,n.U)(c=>{const h=c.find(B=>B.code===this.vehicleType);return this.form={...this.form,vehicleTypeId:h?.id},this.vehicleTypes=c})),this.tariffTypes$=this.codeTablesService.filterModelByType(t.BcL.TariffType).pipe((0,n.U)(c=>{const h=c.find(B=>B.value===this.type);return this.form={...this.form,tariffTypeId:h.id},this.tariffTypes=c})),this.carParkTypes$=this.codeTablesService.filterModelByType(t.BcL.Carpark).pipe((0,z.q)(1)).map(c=>(this.form.carParkTypeId=this.form.carParkTypeId||c[0]&&c[0].id,c)),this.owner$=this.ownerInput$.pipe((0,P.O)(""),(0,E.b)(200),(0,N.x)(),(0,A.b)(()=>this.ownerLoading=!0),(0,I.w)(c=>this.userService.searchOwners(c).pipe((0,A.b)(()=>this.ownerLoading=!1))),(0,U.B)()),this.owner$.pipe((0,z.q)(1)).subscribe(c=>this.form.ownerId=this.form.ownerId||c[0]&&c[0].id),this.operator$=this.operatorInput$.pipe((0,P.O)(""),(0,E.b)(200),(0,N.x)(),(0,A.b)(()=>this.operatorLoading=!0),(0,I.w)(c=>this.userService.searchOperators(c).pipe((0,A.b)(()=>this.operatorLoading=!1))),(0,U.B)()),this.operator$.pipe((0,z.q)(1)).subscribe(c=>this.form.operatorId=this.form.operatorId||c[0]&&c[0].id),this.vehicleTitle=this.vehicleType,this.translate.get(this.vehicleType).subscribe(c=>{this.vehicleTitle=c}),this.translateType=this.type,this.translate.get(this.type).subscribe(c=>{this.translateType=c})}changeTariff(){const c=this.tariffTypes.find(B=>B.id===Number(this.form.tariffTypeId)),h=this.vehicleTypes.find(B=>B.id===Number(this.form.vehicleTypeId));c&&h&&this.router.navigate(["/tariffs","create"],{queryParams:{type:c.value,vehicleType:h.value}})}cancel(){this.canceled.emit()}submit(c){return c.valid&&this.submitted.emit(this.form)}}return g.\u0275fac=function(c){return new(c||g)(e.Y36(x.K),e.Y36(K.I),e.Y36(M.gz),e.Y36(M.F0),e.Y36(C.sK))},g.\u0275cmp=e.Xpm({type:g,selectors:[["app-tariffs-form-main"]],inputs:{form:"form"},outputs:{submitted:"submitted",canceled:"canceled"},decls:76,vars:64,consts:[[1,"m-form","m-form--fit","m-form--label-align-right",2,"margin-bottom","60px",3,"ngSubmit"],["formRef","ngForm"],[1,"m-portlet"],[1,"m-portlet__head"],[1,"m-portlet__head-caption"],[1,"m-portlet__head-title"],[1,"m-portlet__head-text"],[1,"m-portlet__body"],[1,"row","form-group"],[1,"col-form-label","col-2","text-right"],[1,"m--font-danger"],[1,"col-10"],["type","text","nz-input","","name","name","required","",3,"ngModel","ngModelChange"],["name","ngModel"],["class","form-control-feedback",4,"ngIf"],[1,"col-form-label","col-lg-2","col-sm-12","text-right"],[1,"col-lg-4","col-sm-12"],["name","type","nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","nzDisabled","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["name","vehicle","nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","nzDisabled","ngModelChange"],["name","carpark","nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","ngModelChange"],["name","owner","nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","nzLoading","ngModelChange"],["name","operator","nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","nzLoading","ngModelChange"],[3,"ngSwitch"],[3,"form","formRef","formChange",4,"ngSwitchCase"],[3,"form","formChange"],[1,"d-flex","justify-content-between"],["type","button","nz-button","","nzType","primary","nzGhost","","nzShape","round"],[1,"la","la-plus"],["type","reset","nz-button","","nzType","primary","nzGhost","","nzSize","large",1,"btn-form-ops","m--margin-right-20",3,"click"],["type","submit","nz-button","","nzType","primary","nzSize","large",1,"btn-form-ops"],[1,"form-control-feedback"],[3,"nzValue","nzLabel"],[3,"form","formRef","formChange"]],template:function(c,h){if(1&c){const B=e.EpF();e.TgZ(0,"form",0,1),e.NdJ("ngSubmit",function(){e.CHM(B);const R=e.MAs(1);return e.KtG(h.submit(R))}),e.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h3",6),e._uU(7),e.ALo(8,"titlecase"),e.ALo(9,"titlecase"),e.qZA()()()(),e.TgZ(10,"div",7)(11,"div",8)(12,"label",9)(13,"span",10),e._uU(14,"*"),e.qZA(),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",11)(18,"input",12,13),e.NdJ("ngModelChange",function(R){return h.form.name=R}),e.qZA(),e.YNc(20,T,3,3,"div",14),e.qZA()(),e.TgZ(21,"div",8)(22,"label",15),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"div",16)(26,"nz-select",17),e.NdJ("ngModelChange",function(R){return h.form.tariffTypeId=R})("ngModelChange",function(){return h.changeTariff()}),e.YNc(27,v,2,4,"nz-option",18),e.ALo(28,"async"),e.qZA()(),e.TgZ(29,"label",15),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"div",16)(33,"nz-select",19),e.NdJ("ngModelChange",function(R){return h.form.vehicleTypeId=R})("ngModelChange",function(){return h.changeTariff()}),e.YNc(34,l,2,4,"nz-option",18),e.ALo(35,"async"),e.qZA()()(),e.TgZ(36,"div",8)(37,"label",15),e._uU(38),e.ALo(39,"translate"),e.qZA(),e.TgZ(40,"div",16)(41,"nz-select",20),e.NdJ("ngModelChange",function(R){return h.form.carParkTypeId=R}),e.YNc(42,f,2,4,"nz-option",18),e.ALo(43,"async"),e.qZA()(),e.TgZ(44,"label",15),e._uU(45),e.ALo(46,"translate"),e.qZA(),e.TgZ(47,"div",16)(48,"nz-select",21),e.NdJ("ngModelChange",function(R){return h.form.ownerId=R}),e.YNc(49,o,1,2,"nz-option",18),e.ALo(50,"async"),e.qZA()()(),e.TgZ(51,"div",8)(52,"label",15),e._uU(53),e.ALo(54,"translate"),e.qZA(),e.TgZ(55,"div",16)(56,"nz-select",22),e.NdJ("ngModelChange",function(R){return h.form.operatorId=R}),e.YNc(57,r,1,2,"nz-option",18),e.ALo(58,"async"),e.qZA()()()()(),e.ynx(59,23),e.YNc(60,a,1,2,"app-tariffs-form-normal",24),e.YNc(61,s,1,2,"app-tariffs-form-season",24),e.YNc(62,_,1,2,"app-tariffs-form-adhoc",24),e.BQk(),e.TgZ(63,"app-tariffs-form-manage-tag",25),e.NdJ("formChange",function(R){return h.form=R}),e.qZA(),e.TgZ(64,"div",26)(65,"button",27),e._UZ(66,"i",28),e._uU(67),e.ALo(68,"translate"),e.qZA(),e.TgZ(69,"div")(70,"button",29),e.NdJ("click",function(){return h.cancel()}),e._uU(71),e.ALo(72,"translate"),e.qZA(),e.TgZ(73,"button",30),e._uU(74),e.ALo(75,"translate"),e.qZA()()()()}if(2&c){const B=e.MAs(1),b=e.MAs(19);e.xp6(7),e.AsE(" ",e.lcZ(8,32,h.vehicleType)," / ",e.lcZ(9,34,h.type)," "),e.xp6(8),e.hij(" ",e.lcZ(16,36,"Tariff Name"),": "),e.xp6(3),e.Q6J("ngModel",h.form.name),e.xp6(2),e.Q6J("ngIf",b.invalid&&(b.dirty||b.touched||B.submitted)),e.xp6(3),e.hij(" ",e.lcZ(24,38,"Tariff Type"),": "),e.xp6(3),e.Q6J("ngModel",h.form.tariffTypeId)("nzDisabled",h.form.id),e.xp6(1),e.Q6J("ngForOf",e.lcZ(28,40,h.tariffTypes$)),e.xp6(3),e.hij(" ",e.lcZ(31,42,"Vehicle Type"),": "),e.xp6(3),e.Q6J("ngModel",h.form.vehicleTypeId)("nzDisabled",h.form.id),e.xp6(1),e.Q6J("ngForOf",e.lcZ(35,44,h.vehicleTypes$)),e.xp6(4),e.hij(" ",e.lcZ(39,46,"Car Park Type"),": "),e.xp6(3),e.Q6J("ngModel",h.form.carParkTypeId),e.xp6(1),e.Q6J("ngForOf",e.lcZ(43,48,h.carParkTypes$)),e.xp6(3),e.hij(" ",e.lcZ(46,50,"Car Park Owner"),": "),e.xp6(3),e.Q6J("ngModel",h.form.ownerId)("nzLoading",h.ownerLoading),e.xp6(1),e.Q6J("ngForOf",e.lcZ(50,52,h.owner$)),e.xp6(4),e.hij(" ",e.lcZ(54,54,"Car Park Operator"),": "),e.xp6(3),e.Q6J("ngModel",h.form.operatorId)("nzLoading",h.operatorLoading),e.xp6(1),e.Q6J("ngForOf",e.lcZ(58,56,h.operator$)),e.xp6(2),e.Q6J("ngSwitch",h.type),e.xp6(1),e.Q6J("ngSwitchCase","Normal"),e.xp6(1),e.Q6J("ngSwitchCase","Season"),e.xp6(1),e.Q6J("ngSwitchCase","Adhoc"),e.xp6(1),e.Q6J("form",h.form),e.xp6(4),e.hij(" ",e.lcZ(68,58,"Add New Daily Plan")," "),e.xp6(4),e.hij(" ",e.lcZ(72,60,"Cancel")," "),e.xp6(3),e.hij(" ",e.lcZ(75,62,"Submit")," ")}},dependencies:[d.sg,d.O5,d.RF,d.n9,u._Y,u.Fj,u.JJ,u.JL,u.Q7,u.On,u.F,Z.Ip,Z.Vq,w.Zp,Q.ix,L.w,W.dQ,F.W,S.k,p._,O.S,d.Ov,d.rS,C.X$],encapsulation:2}),g})()},42265:(j,J,i)=>{i.d(J,{S:()=>U});var e=i(38014),t=i(94650),y=i(36895),n=i(24006),z=i(35635),P=i(66616),E=i(47044),N=i(21811);function A(x,K){if(1&x){const M=t.EpF();t.ynx(0),t.TgZ(1,"div",12)(2,"label",13),t._UZ(3,"span",14),t._uU(4," Key: "),t.qZA(),t.TgZ(5,"div",15)(6,"input",16,17),t.NdJ("ngModelChange",function(d){const Z=t.CHM(M).$implicit;return t.KtG(Z.key=d)}),t.qZA()(),t.TgZ(8,"label",13),t._UZ(9,"span",14),t._uU(10," Value: "),t.qZA(),t.TgZ(11,"div",15)(12,"input",18,17),t.NdJ("ngModelChange",function(d){const Z=t.CHM(M).$implicit;return t.KtG(Z.value=d)}),t.qZA()(),t.TgZ(14,"div",19)(15,"button",20),t.NdJ("click",function(){const u=t.CHM(M).index,Z=t.oxw(2);return t.KtG(Z.form.tags.splice(u,1))}),t._UZ(16,"i",21),t.qZA()()(),t.BQk()}if(2&x){const M=K.$implicit;t.xp6(6),t.Q6J("ngModel",M.key),t.xp6(6),t.Q6J("ngModel",M.value)}}function I(x,K){if(1&x&&(t.TgZ(0,"div",10),t.YNc(1,A,17,2,"ng-container",11),t.qZA()),2&x){const M=t.oxw();t.xp6(1),t.Q6J("ngForOf",M.form.tags)}}let U=(()=>{class x{constructor(){this.form=(0,e.jqJ)()}ngOnInit(){}addNewTag(){this.form.tags.push((0,e.zXo)())}}return x.\u0275fac=function(M){return new(M||x)},x.\u0275cmp=t.Xpm({type:x,selectors:[["app-tariffs-form-manage-tag"]],inputs:{form:"form"},decls:12,vars:1,consts:[[1,"m-portlet"],[1,"m-portlet__head","d-flex","align-items-center"],[1,"row","m--marginless"],[1,"m-portlet__head-caption"],[1,"m-portlet__head-title"],[1,"m-portlet__head-text"],["class","m-portlet__body",4,"ngIf"],[1,"m-portlet__foot"],["type","button","nz-button","","nzType","primary","nzGhost","","nzShape","round",3,"click"],[1,"la","la-plus"],[1,"m-portlet__body"],[4,"ngFor","ngForOf"],[1,"row","form-group"],[1,"col-form-label","col-1","text-right"],[1,"m--font-danger"],[1,"col-4"],["type","text","nz-input","","name","key",3,"ngModel","ngModelChange"],["name","ngModel"],["type","text","nz-input","","name","value",3,"ngModel","ngModelChange"],[1,"col-2","m--margin-bottom-20",2,"text-align","center"],["type","button","nz-button","",3,"click"],[1,"la","la-trash"]],template:function(M,C){1&M&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3",5),t._uU(6," Manage Tags "),t.qZA()()()()(),t.YNc(7,I,2,1,"div",6),t.TgZ(8,"div",7)(9,"button",8),t.NdJ("click",function(){return C.addNewTag()}),t._UZ(10,"i",9),t._uU(11," Add tag "),t.qZA()()()),2&M&&(t.xp6(7),t.Q6J("ngIf",(null==C.form.tags?null:C.form.tags.length)>0))},dependencies:[y.sg,y.O5,n.Fj,n.JJ,n.On,z.Zp,P.ix,E.w,N.dQ]}),x})()},48942:(j,J,i)=>{i.d(J,{W:()=>v});var e=i(94650),t=i(38014),y=i(34793),n=i(73071),z=i(36511),P=i(36895),E=i(24006),N=i(56075),A=i(38231),I=i(35635),U=i(66616),x=i(47044),K=i(21811),M=i(14685),C=i(28213),d=i(89383);function u(l,f){1&l&&(e.TgZ(0,"div",47),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&l&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function Z(l,f){1&l&&(e.TgZ(0,"div",47),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&l&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function w(l,f){1&l&&e._UZ(0,"i",48)}function Q(l,f){1&l&&(e.TgZ(0,"div",49),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&l&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function L(l,f){1&l&&(e.TgZ(0,"div",50),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&l&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function W(l,f){1&l&&(e.TgZ(0,"div",50),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&l&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function F(l,f){1&l&&(e.TgZ(0,"div",47),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&l&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function S(l,f){1&l&&(e.TgZ(0,"div",50),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&l&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function p(l,f){1&l&&(e.TgZ(0,"div",50),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&l&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function O(l,f){1&l&&(e.TgZ(0,"div",50),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&l&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function T(l,f){if(1&l){const o=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"h5"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"button",10),e.NdJ("click",function(){const s=e.CHM(o).index,_=e.oxw();return e.KtG(_.form.timeSlots.splice(s,1))}),e._UZ(6,"i",11),e.qZA()(),e.TgZ(7,"div",12)(8,"div",13)(9,"label",14)(10,"span",15),e._uU(11,"*"),e.qZA(),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"div",16)(15,"div",17)(16,"nz-time-picker",18,19),e.NdJ("ngModelChange",function(a){const _=e.CHM(o).$implicit;return e.KtG(_.from=a)}),e.qZA(),e.YNc(18,u,3,3,"div",20),e.qZA(),e.TgZ(19,"div",21),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"div",17)(23,"nz-time-picker",18,22),e.NdJ("ngModelChange",function(a){const _=e.CHM(o).$implicit;return e.KtG(_.to=a)}),e.qZA(),e.YNc(25,Z,3,3,"div",20),e.qZA()()(),e.YNc(26,w,1,0,"ng-template",null,23,e.W1O),e.TgZ(28,"div",13)(29,"label",24)(30,"span",15),e._uU(31,"*"),e.qZA(),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"div",16)(35,"nz-input-group",25),e.ALo(36,"translate"),e.TgZ(37,"input",26,27),e.NdJ("ngModelChange",function(a){const _=e.CHM(o).$implicit;return e.KtG(_.rate=a)}),e.qZA()(),e.YNc(39,Q,3,3,"div",28),e.qZA()(),e.TgZ(40,"div",13)(41,"label",14)(42,"span",15),e._uU(43,"*"),e.qZA(),e._uU(44),e.ALo(45,"translate"),e.qZA(),e.TgZ(46,"div",16)(47,"nz-input-group",29),e.ALo(48,"translate"),e.TgZ(49,"input",26,30),e.NdJ("ngModelChange",function(a){const _=e.CHM(o).$implicit;return e.KtG(_.firstChargingPeriod=a)}),e.qZA()(),e.YNc(51,L,3,3,"div",31),e.qZA()(),e.TgZ(52,"div",13)(53,"label",14)(54,"span",15),e._uU(55,"*"),e.qZA(),e._uU(56),e.ALo(57,"translate"),e.qZA(),e.TgZ(58,"div",16)(59,"nz-input-group",32)(60,"input",26,33),e.NdJ("ngModelChange",function(a){const _=e.CHM(o).$implicit;return e.KtG(_.minimumPerEntry=a)}),e.qZA()(),e.YNc(62,W,3,3,"div",31),e.qZA()()(),e.TgZ(63,"div",12)(64,"div",13)(65,"label",14)(66,"span",15),e._uU(67,"*"),e.qZA(),e._uU(68),e.ALo(69,"translate"),e.qZA(),e.TgZ(70,"div",34)(71,"nz-select",35,36),e.NdJ("ngModelChange",function(a){const _=e.CHM(o).$implicit;return e.KtG(_.rateType=a)}),e._UZ(73,"nz-option",37)(74,"nz-option",38)(75,"nz-option",39)(76,"nz-option",40),e.qZA(),e.YNc(77,F,3,3,"div",20),e.qZA()(),e.TgZ(78,"div",13)(79,"label",14)(80,"span",15),e._uU(81,"*"),e.qZA(),e._uU(82),e.ALo(83,"translate"),e.qZA(),e.TgZ(84,"div",16)(85,"nz-input-group",29),e.ALo(86,"translate"),e.TgZ(87,"input",26,41),e.NdJ("ngModelChange",function(a){const _=e.CHM(o).$implicit;return e.KtG(_.graceTime=a)}),e.qZA()(),e.YNc(89,S,3,3,"div",31),e.qZA()(),e.TgZ(90,"div",13)(91,"label",14)(92,"span",15),e._uU(93,"*"),e.qZA(),e._uU(94),e.ALo(95,"translate"),e.qZA(),e.TgZ(96,"div",16)(97,"nz-input-group",25),e.ALo(98,"translate"),e.TgZ(99,"input",42,43),e.NdJ("ngModelChange",function(a){const _=e.CHM(o).$implicit;return e.KtG(_.firstChargingRate=a)}),e.qZA()(),e.YNc(101,p,3,3,"div",31),e.qZA()(),e.TgZ(102,"div",13)(103,"label",14)(104,"span",15),e._uU(105,"*"),e.qZA(),e._uU(106),e.ALo(107,"translate"),e.qZA(),e.TgZ(108,"div",16)(109,"nz-input-group",32)(110,"input",26,44),e.NdJ("ngModelChange",function(a){const _=e.CHM(o).$implicit;return e.KtG(_.maxPerDay=a)}),e.qZA()(),e.YNc(112,O,3,3,"div",31),e.qZA()(),e.TgZ(113,"div",13)(114,"label",14),e._uU(115),e.ALo(116,"translate"),e.qZA(),e.TgZ(117,"div",16)(118,"label",45,46),e.NdJ("ngModelChange",function(a){const _=e.CHM(o).$implicit;return e.KtG(_.chargedByRate=a)}),e.qZA()()()()()}if(2&l){const o=f.$implicit,r=f.index,a=e.MAs(17),s=e.MAs(24),_=e.MAs(27),m=e.MAs(38),g=e.MAs(50),D=e.MAs(61),c=e.MAs(72),h=e.MAs(88),B=e.MAs(100),b=e.MAs(111),R=e.oxw();e.xp6(3),e.AsE("",e.lcZ(4,52,"Time Slot"),"",r+1,""),e.xp6(9),e.hij(" ",e.lcZ(13,54,"Time Range"),": "),e.xp6(4),e.MGl("name","fromTime",r,""),e.Q6J("ngModel",o.from)("nzUse12Hours",!0),e.xp6(2),e.Q6J("ngIf",a.invalid&&(a.dirty||a.touched||R.formRef.submitted)),e.xp6(2),e.hij(" ",e.lcZ(21,56,"to")," "),e.xp6(3),e.MGl("name","endTime",r,""),e.Q6J("ngModel",o.to)("nzUse12Hours",!0),e.xp6(2),e.Q6J("ngIf",s.invalid&&(s.dirty||s.touched||R.formRef.submitted)),e.xp6(4),e.MGl("for","exampleInputEmail",r,""),e.xp6(3),e.hij(" ",e.lcZ(33,58,"Rate"),": "),e.xp6(3),e.hYB("nzAddOnAfter","/",o.rateType,"",e.lcZ(36,60,"mins"),""),e.Q6J("nzAddOnBefore",_),e.xp6(2),e.MGl("name","rate",r,""),e.Q6J("ngModel",o.rate),e.xp6(2),e.Q6J("ngIf",m.invalid&&(m.dirty||m.touched||R.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(45,62,"First Charging Period"),": "),e.xp6(3),e.s9C("nzAddOnAfter",e.lcZ(48,64,"mins")),e.xp6(2),e.MGl("name","chargingPeriod",r,""),e.Q6J("ngModel",o.firstChargingPeriod),e.xp6(2),e.Q6J("ngIf",g.invalid&&(g.dirty||g.touched||R.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(57,66,"Minimum Per Entry"),": "),e.xp6(3),e.Q6J("nzAddOnBefore",_),e.xp6(1),e.MGl("name","minimumPerEntry",r,""),e.Q6J("ngModel",o.minimumPerEntry),e.xp6(2),e.Q6J("ngIf",D.invalid&&(D.dirty||D.touched||R.formRef.submitted)),e.xp6(6),e.hij(" ",e.lcZ(69,68,"Rate Type"),": "),e.xp6(3),e.MGl("name","rateType",r,""),e.Q6J("ngModel",o.rateType),e.xp6(6),e.Q6J("ngIf",c.invalid&&(c.dirty||c.touched||R.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(83,70,"Grace Time"),": "),e.xp6(3),e.s9C("nzAddOnAfter",e.lcZ(86,72,"min")),e.xp6(2),e.MGl("name","graceTime",r,""),e.Q6J("ngModel",o.graceTime),e.xp6(2),e.Q6J("ngIf",h.invalid&&(h.dirty||h.touched||R.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(95,74,"First Charging Rate"),": "),e.xp6(3),e.s9C("nzAddOnAfter",e.lcZ(98,76,"min")),e.Q6J("nzAddOnBefore",_),e.xp6(2),e.Q6J("ngModel",o.firstChargingRate),e.xp6(2),e.Q6J("ngIf",B.invalid&&(B.dirty||B.touched||R.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(107,78,"Maximum Per Session"),": "),e.xp6(3),e.Q6J("nzAddOnBefore",_),e.xp6(1),e.MGl("name","maximumPerSession",r,""),e.Q6J("ngModel",o.maxPerDay),e.xp6(2),e.Q6J("ngIf",b.invalid&&(b.dirty||b.touched||R.formRef.submitted)),e.xp6(3),e.hij(" ",e.lcZ(116,80,"Charged By Rate Type"),": "),e.xp6(3),e.MGl("name","chargedByRate",r,""),e.Q6J("ngModel",o.chargedByRate)}}let v=(()=>{class l{constructor(o,r,a){this.route=o,this.userService=r,this.codeTablesService=a,this.form=(0,t.jqJ)(),this.formChange=new e.vpe,this.datePickerConfig={containerClass:"theme-red"},this.rateTypes=(0,t.RV7)(),this.weekdays={},this.dayList=[]}ngOnInit(){this.form.weekdays.forEach(o=>this.weekdays[o]=!0),this.codeTablesService.filterModelByType(t.BcL.DayType).subscribe(o=>{this.dayList=o,this.dayList.forEach(r=>{const a=this.form.weekdays.find(s=>r.value===s);r.checked=!!a,r.label=r.name})})}onChangeDay(){this.form.weekdays=this.dayList.filter(o=>o.checked).map(o=>o.value)}addNewTimeSlot(){this.form.timeSlots.push((0,t.z5G)())}}return l.\u0275fac=function(o){return new(o||l)(e.Y36(y.gz),e.Y36(n.K),e.Y36(z.I))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-tariffs-form-normal"]],inputs:{formRef:"formRef",form:"form"},outputs:{formChange:"formChange"},decls:10,vars:5,consts:[["appProvideParentForm","",1,"m-portlet"],[1,"m-portlet__head","d-flex","align-items-center"],[1,"row","m--marginless"],["name","day",3,"ngModel","ngModelChange"],["class","m-portlet__body row",4,"ngFor","ngForOf"],[1,"m-portlet__foot"],["type","button","nz-button","","nzType","primary","nzGhost","","nzShape","round",3,"click"],[1,"la","la-plus"],[1,"m-portlet__body","row"],[1,"col-12","d-flex","justify-content-between","m--margin-bottom-20"],["type","button","nz-button","",3,"click"],[1,"la","la-trash"],[1,"col-6"],[1,"row","form-group"],[1,"col-form-label","text-right","col-4"],[1,"m--font-danger"],[1,"input-group","col-8"],[1,"col","m--padding-0"],["nzFormat","h:mm a","required","",2,"width","100%",3,"name","ngModel","nzUse12Hours","ngModelChange"],["fromTime","ngModel"],["class","form-control-feedback",4,"ngIf"],[1,"input-group-append",2,"line-height","35px","padding","0 6px"],["endTime","ngModel"],["addOnBeforeTemplate",""],[1,"col-form-label","text-right","col-4",3,"for"],[3,"nzAddOnBefore","nzAddOnAfter"],["type","text","nz-input","","required","",3,"name","ngModel","ngModelChange"],["rate","ngModel"],["class","form-control-feedback m--font-danger",4,"ngIf"],[3,"nzAddOnAfter"],["chargingPeriod","ngModel"],["class","w-100 form-control-feedback m--font-danger",4,"ngIf"],[3,"nzAddOnBefore"],["minimumPerEntry","ngModel"],[1,"col-8"],["required","",2,"width","100%",3,"name","ngModel","ngModelChange"],["rateType","ngModel"],["nzValue","15","nzLabel","15"],["nzValue","30","nzLabel","30"],["nzValue","45","nzLabel","45"],["nzValue","60","nzLabel","60"],["graceTime","ngModel"],["type","text","nz-input","","name","chargingRate","required","",3,"ngModel","ngModelChange"],["chargingRate","ngModel"],["maximumPerSession","ngModel"],["nz-checkbox","",3,"name","ngModel","ngModelChange"],["chargedByRate","ngModel"],[1,"form-control-feedback"],[1,"la","la-usd"],[1,"form-control-feedback","m--font-danger"],[1,"w-100","form-control-feedback","m--font-danger"]],template:function(o,r){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"nz-checkbox-group",3),e.NdJ("ngModelChange",function(s){return r.dayList=s})("ngModelChange",function(){return r.onChangeDay()}),e.qZA()()(),e.YNc(4,T,120,82,"div",4),e.TgZ(5,"div",5)(6,"button",6),e.NdJ("click",function(){return r.addNewTimeSlot()}),e._UZ(7,"i",7),e._uU(8),e.ALo(9,"translate"),e.qZA()()()),2&o&&(e.xp6(3),e.Q6J("ngModel",r.dayList),e.xp6(1),e.Q6J("ngForOf",r.form.timeSlots),e.xp6(4),e.hij("",e.lcZ(9,3,"Add New Time Slot")," "))},dependencies:[P.sg,P.O5,E.Fj,E.JJ,E.Q7,E.On,N.h,A.Ip,A.Vq,I.Zp,I.gB,U.ix,x.w,K.dQ,M.m4,C.Ie,C.ub,d.X$],encapsulation:2}),l})()},85611:(j,J,i)=>{i.d(J,{k:()=>Q});var e=i(38014),t=i(94650),y=i(34793),n=i(73071),z=i(36511),P=i(36895),E=i(24006),N=i(56075),A=i(35635),I=i(66616),U=i(47044),x=i(21811),K=i(14685),M=i(89383);function C(L,W){1&L&&(t.TgZ(0,"div",29),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&L&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function d(L,W){1&L&&(t.TgZ(0,"div",29),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&L&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function u(L,W){1&L&&t._UZ(0,"i",30)}function Z(L,W){1&L&&(t.TgZ(0,"div",31),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&L&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Field is required.")," "))}function w(L,W){if(1&L){const F=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"h5"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",11),t.NdJ("click",function(){const O=t.CHM(F).index,T=t.oxw();return t.KtG(T.form.timeSlots.splice(O,1))}),t._UZ(6,"i",12),t.qZA()(),t.TgZ(7,"div",13)(8,"div",14)(9,"label",15)(10,"span",16),t._uU(11,"*"),t.qZA(),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"div",17)(15,"div",18)(16,"nz-time-picker",19,20),t.NdJ("ngModelChange",function(p){const T=t.CHM(F).$implicit;return t.KtG(T.from=p)}),t.qZA(),t.YNc(18,C,3,3,"div",21),t.qZA(),t.TgZ(19,"div",22),t._uU(20),t.ALo(21,"translate"),t.qZA(),t.TgZ(22,"div",18)(23,"nz-time-picker",19,23),t.NdJ("ngModelChange",function(p){const T=t.CHM(F).$implicit;return t.KtG(T.to=p)}),t.qZA(),t.YNc(25,d,3,3,"div",21),t.qZA()()()(),t.YNc(26,u,1,0,"ng-template",null,24,t.W1O),t.TgZ(28,"div",13)(29,"div",14)(30,"label",15)(31,"span",16),t._uU(32,"*"),t.qZA(),t._uU(33),t.ALo(34,"translate"),t.qZA(),t.TgZ(35,"div",17)(36,"nz-input-group",25),t.ALo(37,"translate"),t.TgZ(38,"input",26,27),t.NdJ("ngModelChange",function(p){const T=t.CHM(F).$implicit;return t.KtG(T.rate=p)}),t.qZA()(),t.YNc(40,Z,3,3,"div",28),t.qZA()()()()}if(2&L){const F=W.$implicit,S=W.index,p=t.MAs(17),O=t.MAs(24),T=t.MAs(27),v=t.MAs(39),l=t.oxw();t.xp6(3),t.AsE("",t.lcZ(4,18,"Season Parking Type")," ",S+1,""),t.xp6(9),t.hij(" ",t.lcZ(13,20,"Time Range"),": "),t.xp6(4),t.MGl("name","fromTime",S,""),t.Q6J("ngModel",F.from)("nzUse12Hours",!0),t.xp6(2),t.Q6J("ngIf",p.invalid&&(p.dirty||p.touched||l.formRef.submitted)),t.xp6(2),t.hij(" ",t.lcZ(21,22,"to")," "),t.xp6(3),t.MGl("name","endTime",S,""),t.Q6J("ngModel",F.to)("nzUse12Hours",!0),t.xp6(2),t.Q6J("ngIf",O.invalid&&(O.dirty||O.touched||l.formRef.submitted)),t.xp6(8),t.hij(" ",t.lcZ(34,24,"Rate"),": "),t.xp6(3),t.MGl("nzAddOnAfter","/30",t.lcZ(37,26,"mins"),""),t.Q6J("nzAddOnBefore",T),t.xp6(2),t.MGl("name","rate",S,""),t.Q6J("ngModel",F.rate),t.xp6(2),t.Q6J("ngIf",v.invalid&&(v.dirty||v.touched||l.formRef.submitted))}}let Q=(()=>{class L{constructor(F,S,p){this.route=F,this.userService=S,this.codeTablesService=p,this.wholeDay=!1,this.form=(0,e.jqJ)()}addNewTimeSlot(){this.form.timeSlots.push((0,e.z5G)())}}return L.\u0275fac=function(F){return new(F||L)(t.Y36(y.gz),t.Y36(n.K),t.Y36(z.I))},L.\u0275cmp=t.Xpm({type:L,selectors:[["app-tariffs-form-season"]],inputs:{form:"form",formRef:"formRef"},decls:13,vars:7,consts:[["appProvideParentForm","",1,"m-portlet"],[1,"m-portlet__head","d-flex","align-items-center"],[1,"m-portlet__head-caption"],[1,"m-portlet__head-title"],[1,"m-portlet__head-text"],["class","m-portlet__body row",4,"ngFor","ngForOf"],[1,"m-portlet__foot"],["type","button","nz-button","","nzType","primary","nzGhost","","nzShape","round",3,"click"],[1,"la","la-plus"],[1,"m-portlet__body","row"],[1,"col-12","d-flex","justify-content-between","m--margin-bottom-20"],["type","button","nz-button","",3,"click"],[1,"la","la-trash"],[1,"col-6"],[1,"row","form-group"],[1,"col-form-label","text-right","col-4"],[1,"m--font-danger"],[1,"input-group","col-8"],[1,"col","m--padding-0"],["nzFormat","h:mm a","required","",2,"width","100%",3,"name","ngModel","nzUse12Hours","ngModelChange"],["fromTime","ngModel"],["class","form-control-feedback",4,"ngIf"],[1,"input-group-append",2,"line-height","35px","padding","0 6px"],["endTime","ngModel"],["addOnBeforeTemplate",""],[3,"nzAddOnBefore","nzAddOnAfter"],["type","text","nz-input","","required","",3,"name","ngModel","ngModelChange"],["rate","ngModel"],["class","form-control-feedback m--font-danger",4,"ngIf"],[1,"form-control-feedback"],[1,"la","la-usd"],[1,"form-control-feedback","m--font-danger"]],template:function(F,S){1&F&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),t._uU(5),t.ALo(6,"translate"),t.qZA()()()(),t.YNc(7,w,41,28,"div",5),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return S.addNewTimeSlot()}),t._UZ(10,"i",8),t._uU(11),t.ALo(12,"translate"),t.qZA()()()),2&F&&(t.xp6(5),t.hij(" ",t.lcZ(6,3,"Tariff")," "),t.xp6(2),t.Q6J("ngForOf",S.form.timeSlots),t.xp6(4),t.hij(" ",t.lcZ(12,5,"Add Season Parking Type")," "))},dependencies:[P.sg,P.O5,E.Fj,E.JJ,E.Q7,E.On,N.h,A.Zp,A.gB,I.ix,U.w,x.dQ,K.m4,M.X$],encapsulation:2}),L})()},69659:(j,J,i)=>{i.d(J,{q:()=>f});var e=i(94650),t=i(79118),y=i(15439),z=i(52746),P=i(36895),E=i(67556),N=i(34793),A=i(50007),I=i(49651),U=i(24006),x=i(40269),K=i(28213);function M(o,r){if(1&o&&e._uU(0),2&o){const a=r.range;e.lnq(" ",a[0],"-",a[1]," of ",r.$implicit," items ")}}function C(o,r){if(1&o&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&o){const a=r.$implicit;e.xp6(1),e.Oqu(a.text)}}function d(o,r){if(1&o){const a=e.EpF();e.TgZ(0,"span")(1,"label",7),e.NdJ("ngModelChange",function(_){e.CHM(a);const m=e.oxw(2).$implicit;return e.KtG(m._checked=_)})("ngModelChange",function(){e.CHM(a);const _=e.oxw(2).$implicit,m=e.oxw();return e.KtG(m.onlyOneValue(_))}),e.qZA()()}if(2&o){const a=e.oxw().$implicit,s=e.oxw().$implicit;e.xp6(1),e.MGl("name","tariff",s[a.column],""),e.Q6J("ngModel",s._checked)}}function u(o,r){if(1&o&&(e.TgZ(0,"span")(1,"span"),e._uU(2),e.qZA()()),2&o){const a=e.oxw().$implicit,s=e.oxw().$implicit;e.xp6(2),e.Oqu(s[a.column]?s[a.column].join():"")}}function Z(o,r){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&o){const a=e.oxw().$implicit,s=e.oxw().$implicit;let _;e.xp6(1),e.hij(" ",e.lcZ(2,1,null!==(_=s[a.column])&&void 0!==_?_:s.createdDate)," ")}}function w(o,r){if(1&o){const a=e.EpF();e.TgZ(0,"a",14),e.NdJ("click",function(){e.CHM(a);const _=e.oxw(4).$implicit,m=e.oxw();return e.KtG(m.openModal(_))}),e._UZ(1,"i",15),e.qZA()}}const Q=function(){return["/tariffs/edit"]},L=function(){return{type:"evc",vehicleType:"evc",model:"update"}};function W(o,r){if(1&o){const a=e.EpF();e.TgZ(0,"div",10)(1,"a",11),e.NdJ("click",function(){e.CHM(a);const _=e.oxw(3).index,m=e.oxw();return e.KtG(m.setValueToDetail(_))}),e._UZ(2,"i",12),e.qZA(),e.YNc(3,w,2,0,"a",13),e.qZA()}if(2&o){const a=e.oxw(4);e.xp6(1),e.Q6J("routerLink",e.DdM(3,Q))("queryParams",e.DdM(4,L)),e.xp6(2),e.Q6J("ngIf",a.showDelete)}}const F=function(){return["/tariffs/create"]};function S(o,r){if(1&o){const a=e.EpF();e.TgZ(0,"a",11),e.NdJ("click",function(){e.CHM(a);const _=e.oxw(3).index,m=e.oxw();return e.KtG(m.setValueToDetail(_))}),e._UZ(1,"i",16),e.qZA()}2&o&&e.Q6J("routerLink",e.DdM(2,F))("queryParams",e.DdM(3,L))}function p(o,r){if(1&o&&(e.TgZ(0,"span"),e.YNc(1,W,4,5,"div",8),e.YNc(2,S,2,4,"a",9),e.qZA()),2&o){const a=e.oxw(3);e.xp6(1),e.Q6J("ngIf",!a.createCarpark),e.xp6(1),e.Q6J("ngIf",a.createCarpark&&!a.selectTariff)}}function O(o,r){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const a=e.oxw().$implicit,s=e.oxw().$implicit;e.xp6(1),e.Oqu(s[a.column])}}function T(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"td"),e.ynx(2,4),e.YNc(3,d,2,2,"span",5),e.YNc(4,u,3,1,"span",5),e.YNc(5,Z,3,3,"span",5),e.YNc(6,p,3,2,"span",5),e.YNc(7,O,2,1,"span",6),e.BQk(),e.qZA(),e.BQk()),2&o){const a=r.$implicit;e.xp6(2),e.Q6J("ngSwitch",a.column),e.xp6(1),e.Q6J("ngSwitchCase","checkbox"),e.xp6(1),e.Q6J("ngSwitchCase","carParkList"),e.xp6(1),e.Q6J("ngSwitchCase","createDate"),e.xp6(1),e.Q6J("ngSwitchCase","action")}}function v(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"tr"),e.YNc(2,T,8,5,"ng-container",3),e.qZA(),e.BQk()),2&o){const a=r.index,s=e.oxw();e.xp6(1),e.ekj("ant-table-row-odd",a%2==1),e.xp6(1),e.Q6J("ngForOf",s.tableHeaders)}}const l=function(){return{y:"240px"}};let f=(()=>{class o extends z.t{constructor(a,s,_,m,g){super(),this.evcService=a,this.router=s,this.nzModalService=_,this.nzMessageService=m,this.datePipe=g,this.tableHeaders=[{text:"Tariff Name",width:"150px",column:"costmodeName"},{text:"Vehicle Type",width:"150px",column:"vehicleTypeCode"},{text:"Tariff Type",width:"150px",column:"tariffTypeCode"},{text:"Car Parks",width:"150px",column:"carParkList"},{text:"Date Created",width:"150px",column:"createDate"},{text:"Actions",width:"80px",column:"action"}],this.selected=new e.vpe,this.isPopMode=!1,this.pageSize=this.pagination.rowsPerPage,this.deleteModalOptions={title:"Do you want to delete this tariff?",message:"This can not be reverted"},this.showDelete=!0,-1!==this.router.url.indexOf("carparks")&&(this.showDelete=!1)}ngOnInit(){console.log("csdf"),this.carparkId&&this.getInitialData(),this.selectedCostmode&&0!==this.selectedCostmode.length&&(this.costmodeId=this.selectedCostmode[0].costmodeId),this.createCarpark&&(this.tableHeaders.unshift({text:"",align:t.iW.Center,width:"40px",column:"checkbox"}),this.tableHeaders.splice(4,1)),this.selectTariff&&(this.tableHeaders.unshift({text:"",align:t.iW.Center,width:"40px",column:"checkbox"}),this.tableHeaders=this.tableHeaders.filter(a=>"Car Parks"!==a.text&&"Actions"!==a.text)),this.reloadData()}get filterParams(){let a=JSON.parse(localStorage.getItem("user"));return{companyName:"",costmodeName:"",pageNum:this.pagination.page,pageSize:this.pageSize,ownerId:a.ownerId||""}}reloadData(a){this.loading=!0;const s=a?a.replace(/^\s+|\s+$/g,""):"",_={...this.filterParams,costmodeName:s};this.evcService.getAllCostModel(_).subscribe(m=>{this.loading=!1,"00000"==m.messageCode?(this.pagination.totalCount=m.data.totalElements,this.pagination.page=m.data.pageNumber,this.pagination.rowsPerPage=m.data.pageSize,this.costmodeId&&!this.selectTariff?(this.listData=m.data.content.filter(g=>g.costmodeId==this.costmodeId),this.pagination.totalCount=this.listData.length,this.pagination.page=m.data.pageNumber,this.pagination.rowsPerPage=m.data.pageSize>50?20:m.data.pageSize):this.listData=m.data.content,this.currentlyChecked=this.costmodeId):(this.loading=!1,this.listData=[],this.pagination={...this.pagination,totalCount:0})},()=>{this.loading=!1,this.listData=[],this.pagination={...this.pagination,totalCount:0}})}pageChanged(a){this.pagination=a,this.pageSize=this.pagination.rowsPerPage,this.reloadData()}setValueToDetail(a){const{companyId:s,costmodeDescription:_,costmodeId:m,costmodeName:g,list:D}=this.listData[a],c=D.map(h=>{const B=this.timeFormat(h.startTime),b=this.timeFormat(h.endTime);return{startTime:B,endTime:b,id:h.id,costType:h.costType,duration:y(b,"hh:mm").diff(y(B,"hh:mm"),"hour"),powerPrice:h.price,serviceFee:h.servcieFee}});localStorage.setItem("curCostmode",JSON.stringify({companyId:s,costmodeId:m,costmodeName:g,note:_,items:c,delete_items:[]}))}timeFormat(a){const s=new Date(a);let _=s.getMinutes();return 1===_.toString().length&&(_="0"+_),_=`${s.getHours()}:${_}`,_}evcEvcTariff(){return this.listData.filter(s=>this.currentlyChecked==s.costmodeId)}onlyOneValue(a){const s=a.costmodeId;a._checked?(this.listData.filter(_=>_.costmodeId!==a.costmodeId).forEach(_=>_._checked=!1),this.currentlyChecked=s):this.currentlyChecked="",console.log(this.currentlyChecked)}alert(a){this.nzMessageService.error(a)}deleteEvcTariff(){const{costmodeId:a,companyId:s}=this.selectedTariff;this.evcService.delCostModel({delete_arr:[a]}).subscribe(_=>{"00000"==_.messageCode?this.evcService.delElectricPrice({delete_arr:[s]}).subscribe(m=>{"00000"==m.messageCode?this.reloadData():this.alert(`${m.messageCode} : Delete EVC tariffs failed`)}):this.alert(`${_.messageCode} : Delete EVC tariffs failed`)},()=>{this.alert("Exception : Delete EVC tariffs failed")})}getInitialData(){this.evcService.getCarparkEvc({carparkId:this.carparkId}).subscribe(s=>{"00000"==s.messageCode?this.costmodeId=s.data.costmodeId:"99999"==s.messageCode&&(this.costmodeId="null")})}openModal(a){this.selectedTariff=a,this.nzModalService.confirm({nzTitle:"Do you want to delete this tariff?",nzContent:"This can not be reverted",nzOnOk:()=>this.deleteEvcTariff()})}}return o.\u0275fac=function(a){return new(a||o)(e.Y36(E.z$),e.Y36(N.F0),e.Y36(A.Sf),e.Y36(I.dD),e.Y36(P.uU))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-evc-tariff-table"]],inputs:{createCarpark:"createCarpark",selectTariff:"selectTariff",carparkId:"carparkId",selectedCostmode:"selectedCostmode",isPopMode:"isPopMode",pageSize:"pageSize"},outputs:{selected:"selected"},features:[e._Bn([P.uU]),e.qOj],decls:9,vars:13,consts:[["rangeTemplate",""],[3,"nzData","nzScroll","nzSize","nzFrontPagination","nzLoading","nzTotal","nzPageSize","nzPageIndex","nzShowSizeChanger","nzShowTotal","nzQueryParams"],["basicTable",""],[4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["nz-checkbox","",3,"name","ngModel","ngModelChange"],["style","width: 82px",4,"ngIf"],["class","btn btn-outline-primary m-btn m-btn--icon m-btn--icon-only m-btn--custom m-btn--pill no-border",3,"routerLink","queryParams","click",4,"ngIf"],[2,"width","82px"],[1,"btn","btn-outline-primary","m-btn","m-btn--icon","m-btn--icon-only","m-btn--custom","m-btn--pill","no-border",3,"routerLink","queryParams","click"],[1,"la","la-edit"],["class","btn btn-outline-primary m-btn m-btn--icon m-btn--icon-only m-btn--custom m-btn--pill no-border",3,"click",4,"ngIf"],[1,"btn","btn-outline-primary","m-btn","m-btn--icon","m-btn--icon-only","m-btn--custom","m-btn--pill","no-border",3,"click"],[1,"la","la-close"],[1,"la","la-eye"]],template:function(a,s){if(1&a&&(e.YNc(0,M,1,3,"ng-template",null,0,e.W1O),e.TgZ(2,"nz-table",1,2),e.NdJ("nzQueryParams",function(m){return s.onQueryParamsChange(m)}),e.TgZ(4,"thead")(5,"tr"),e.YNc(6,C,2,1,"th",3),e.qZA()(),e.TgZ(7,"tbody"),e.YNc(8,v,3,3,"ng-container",3),e.qZA()()),2&a){const _=e.MAs(1),m=e.MAs(3);e.xp6(2),e.Q6J("nzData",s.listData)("nzScroll",s.isPopMode?e.DdM(12,l):null)("nzSize",s.isPopMode?"small":"default")("nzFrontPagination",!1)("nzLoading",s.loading)("nzTotal",s.pagination.totalCount)("nzPageSize",s.pagination.rowsPerPage)("nzPageIndex",s.pagination.page)("nzShowSizeChanger",!0)("nzShowTotal",_),e.xp6(4),e.Q6J("ngForOf",s.tableHeaders),e.xp6(2),e.Q6J("ngForOf",m.data)}},dependencies:[P.sg,P.O5,P.RF,P.n9,P.ED,U.JJ,U.On,x.N8,x.Uo,x._C,x.Om,x.p0,x.$Z,K.Ie,N.yS,P.uU]}),o})()},34984:(j,J,i)=>{i.d(J,{Ns:()=>K,_w:()=>x});var e=i(15861),t=i(94650),y=i(21086),n=i(68896),z=i(8929),P=i(20353),E=i(34202),N=i(66753),A=i(87545);class I{constructor(C){this.changes=C}static of(C){return new I(C)}notEmpty(C){if(this.changes[C]){const d=this.changes[C].currentValue;if(null!=d)return(0,y.of)(d)}return n.E}has(C){return this.changes[C]?(0,y.of)(this.changes[C].currentValue):n.E}notFirst(C){return this.changes[C]&&!this.changes[C].isFirstChange()?(0,y.of)(this.changes[C].currentValue):n.E}notFirstAndEmpty(C){if(this.changes[C]&&!this.changes[C].isFirstChange()){const d=this.changes[C].currentValue;if(null!=d)return(0,y.of)(d)}return n.E}}const U=new t.OlP("NGX_ECHARTS_CONFIG");let x=(()=>{class M{constructor(d,u,Z){this.el=u,this.ngZone=Z,this.autoResize=!0,this.loadingType="default",this.chartInit=new t.vpe,this.optionsError=new t.vpe,this.chartClick=this.createLazyEvent("click"),this.chartDblClick=this.createLazyEvent("dblclick"),this.chartMouseDown=this.createLazyEvent("mousedown"),this.chartMouseMove=this.createLazyEvent("mousemove"),this.chartMouseUp=this.createLazyEvent("mouseup"),this.chartMouseOver=this.createLazyEvent("mouseover"),this.chartMouseOut=this.createLazyEvent("mouseout"),this.chartGlobalOut=this.createLazyEvent("globalout"),this.chartContextMenu=this.createLazyEvent("contextmenu"),this.chartLegendSelectChanged=this.createLazyEvent("legendselectchanged"),this.chartLegendSelected=this.createLazyEvent("legendselected"),this.chartLegendUnselected=this.createLazyEvent("legendunselected"),this.chartLegendScroll=this.createLazyEvent("legendscroll"),this.chartDataZoom=this.createLazyEvent("datazoom"),this.chartDataRangeSelected=this.createLazyEvent("datarangeselected"),this.chartTimelineChanged=this.createLazyEvent("timelinechanged"),this.chartTimelinePlayChanged=this.createLazyEvent("timelineplaychanged"),this.chartRestore=this.createLazyEvent("restore"),this.chartDataViewChanged=this.createLazyEvent("dataviewchanged"),this.chartMagicTypeChanged=this.createLazyEvent("magictypechanged"),this.chartPieSelectChanged=this.createLazyEvent("pieselectchanged"),this.chartPieSelected=this.createLazyEvent("pieselected"),this.chartPieUnselected=this.createLazyEvent("pieunselected"),this.chartMapSelectChanged=this.createLazyEvent("mapselectchanged"),this.chartMapSelected=this.createLazyEvent("mapselected"),this.chartMapUnselected=this.createLazyEvent("mapunselected"),this.chartAxisAreaSelected=this.createLazyEvent("axisareaselected"),this.chartFocusNodeAdjacency=this.createLazyEvent("focusnodeadjacency"),this.chartUnfocusNodeAdjacency=this.createLazyEvent("unfocusnodeadjacency"),this.chartBrush=this.createLazyEvent("brush"),this.chartBrushEnd=this.createLazyEvent("brushend"),this.chartBrushSelected=this.createLazyEvent("brushselected"),this.chartRendered=this.createLazyEvent("rendered"),this.chartFinished=this.createLazyEvent("finished"),this.animationFrameID=null,this.resize$=new z.xQ,this.echarts=d.echarts}ngOnChanges(d){const u=I.of(d);u.notFirstAndEmpty("options").subscribe(Z=>this.onOptionsChange(Z)),u.notFirstAndEmpty("merge").subscribe(Z=>this.setOption(Z)),u.has("loading").subscribe(Z=>this.toggleLoading(!!Z)),u.notFirst("theme").subscribe(()=>this.refreshChart())}ngOnInit(){if(!window.ResizeObserver)throw new Error("please install a polyfill for ResizeObserver");this.resizeSub=this.resize$.pipe((0,N.p)(100,P.z,{leading:!1,trailing:!0})).subscribe(()=>this.resize()),this.autoResize&&(this.resizeOb=this.ngZone.runOutsideAngular(()=>new window.ResizeObserver(()=>{this.animationFrameID=window.requestAnimationFrame(()=>this.resize$.next())})),this.resizeOb.observe(this.el.nativeElement))}ngOnDestroy(){window.clearTimeout(this.initChartTimer),this.resizeSub&&this.resizeSub.unsubscribe(),this.animationFrameID&&window.cancelAnimationFrame(this.animationFrameID),this.resizeOb&&this.resizeOb.unobserve(this.el.nativeElement),this.dispose()}ngAfterViewInit(){this.initChartTimer=window.setTimeout(()=>this.initChart())}dispose(){this.chart&&(this.chart.isDisposed()||this.chart.dispose(),this.chart=null)}resize(){this.chart&&this.chart.resize()}toggleLoading(d){this.chart&&(d?this.chart.showLoading(this.loadingType,this.loadingOpts):this.chart.hideLoading())}setOption(d,u){if(this.chart)try{this.chart.setOption(d,u)}catch(Z){console.error(Z),this.optionsError.emit(Z)}}refreshChart(){var d=this;return(0,e.Z)(function*(){d.dispose(),yield d.initChart()})()}createChart(){const d=this.el.nativeElement;if(window&&window.getComputedStyle){const u=window.getComputedStyle(d,null).getPropertyValue("height");(!u||"0px"===u)&&(!d.style.height||"0px"===d.style.height)&&(d.style.height="400px")}return this.ngZone.runOutsideAngular(()=>("function"==typeof this.echarts?this.echarts:()=>Promise.resolve(this.echarts))().then(({init:Z})=>Z(d,this.theme,this.initOpts)))}initChart(){var d=this;return(0,e.Z)(function*(){yield d.onOptionsChange(d.options),d.merge&&d.chart&&d.setOption(d.merge)})()}onOptionsChange(d){var u=this;return(0,e.Z)(function*(){!d||(u.chart||(u.chart=yield u.createChart(),u.chartInit.emit(u.chart)),u.setOption(u.options,!0))})()}createLazyEvent(d){return this.chartInit.pipe((0,A.w)(u=>new E.y(Z=>(u.on(d,w=>this.ngZone.run(()=>Z.next(w))),()=>{this.chart&&(this.chart.isDisposed()||u.off(d))}))))}}return M.\u0275fac=function(d){return new(d||M)(t.Y36(U),t.Y36(t.SBq),t.Y36(t.R0b))},M.\u0275dir=t.lG2({type:M,selectors:[["echarts"],["","echarts",""]],inputs:{options:"options",theme:"theme",loading:"loading",initOpts:"initOpts",merge:"merge",autoResize:"autoResize",loadingType:"loadingType",loadingOpts:"loadingOpts"},outputs:{chartInit:"chartInit",optionsError:"optionsError",chartClick:"chartClick",chartDblClick:"chartDblClick",chartMouseDown:"chartMouseDown",chartMouseMove:"chartMouseMove",chartMouseUp:"chartMouseUp",chartMouseOver:"chartMouseOver",chartMouseOut:"chartMouseOut",chartGlobalOut:"chartGlobalOut",chartContextMenu:"chartContextMenu",chartLegendSelectChanged:"chartLegendSelectChanged",chartLegendSelected:"chartLegendSelected",chartLegendUnselected:"chartLegendUnselected",chartLegendScroll:"chartLegendScroll",chartDataZoom:"chartDataZoom",chartDataRangeSelected:"chartDataRangeSelected",chartTimelineChanged:"chartTimelineChanged",chartTimelinePlayChanged:"chartTimelinePlayChanged",chartRestore:"chartRestore",chartDataViewChanged:"chartDataViewChanged",chartMagicTypeChanged:"chartMagicTypeChanged",chartPieSelectChanged:"chartPieSelectChanged",chartPieSelected:"chartPieSelected",chartPieUnselected:"chartPieUnselected",chartMapSelectChanged:"chartMapSelectChanged",chartMapSelected:"chartMapSelected",chartMapUnselected:"chartMapUnselected",chartAxisAreaSelected:"chartAxisAreaSelected",chartFocusNodeAdjacency:"chartFocusNodeAdjacency",chartUnfocusNodeAdjacency:"chartUnfocusNodeAdjacency",chartBrush:"chartBrush",chartBrushEnd:"chartBrushEnd",chartBrushSelected:"chartBrushSelected",chartRendered:"chartRendered",chartFinished:"chartFinished"},exportAs:["echarts"],features:[t.TTD]}),M})(),K=(()=>{class M{static forRoot(d){return{ngModule:M,providers:[{provide:U,useValue:d}]}}static forChild(){return{ngModule:M}}}return M.\u0275fac=function(d){return new(d||M)},M.\u0275mod=t.oAB({type:M}),M.\u0275inj=t.cJS({}),M})()}}]);