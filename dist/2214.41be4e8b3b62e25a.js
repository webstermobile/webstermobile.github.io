"use strict";(self.webpackChunkst_admin=self.webpackChunkst_admin||[]).push([[2214],{52214:(nn,H,s)=>{s.r(H),s.d(H,{TariffsModule:()=>tn,createTranslateLoader:()=>se});var p=s(36895),c=s(24006),_=s(34793),j=s(16754),y=s(36511),ce=s(91599),de=s(42684),w=s(31289),O=s(30329),$=s(21532),Y=s(80529),pe=s(372),q=s(73071),h=s(38014),e=s(94650),S=s(56075),N=s(56776),J=s(43056),u=s(89383);function me(i,r){1&i&&(e.TgZ(0,"div",53),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function fe(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"timepicker",54),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw().$implicit;return e.KtG(a.from=o)}),e.qZA()}if(2&i){const t=e.oxw().$implicit;e.Q6J("ngModel",t.from)("showMeridian",!1)}}function _e(i,r){1&i&&(e.TgZ(0,"div",53),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function ge(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"timepicker",55),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw().$implicit;return e.KtG(a.to=o)}),e.qZA()}if(2&i){const t=e.oxw().$implicit;e.Q6J("ngModel",t.to)("showMeridian",!1)}}function he(i,r){1&i&&(e.TgZ(0,"div",56),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function ue(i,r){1&i&&(e.TgZ(0,"div",57),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function Te(i,r){1&i&&(e.TgZ(0,"div",57),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function ve(i,r){1&i&&(e.TgZ(0,"div",53),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function Ce(i,r){1&i&&(e.TgZ(0,"div",57),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function Ze(i,r){1&i&&(e.TgZ(0,"div",57),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function xe(i,r){1&i&&(e.TgZ(0,"div",57),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function Me(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",11)(1,"div",12)(2,"h5"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"button",13),e.NdJ("click",function(){const a=e.CHM(t).index,l=e.oxw();return e.KtG(l.form.timeSlots.splice(a,1))}),e._UZ(6,"i",14),e.qZA()(),e.TgZ(7,"div",15)(8,"div",16)(9,"label",17)(10,"span",18),e._uU(11,"*"),e.qZA(),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"div",19)(15,"div",20)(16,"input",21,22),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.from=o)}),e.ALo(18,"date"),e.qZA(),e.YNc(19,me,3,3,"div",23),e.qZA(),e.YNc(20,fe,1,2,"ng-template",null,24,e.W1O),e.TgZ(22,"div",25)(23,"span",26),e._uU(24),e.ALo(25,"translate"),e.qZA()(),e.TgZ(26,"div",20),e._UZ(27,"input",27,28),e.ALo(29,"date"),e.YNc(30,_e,3,3,"div",23),e.qZA(),e.YNc(31,ge,1,2,"ng-template",null,29,e.W1O),e.qZA()(),e.TgZ(33,"div",16)(34,"label",30)(35,"span",18),e._uU(36,"*"),e.qZA(),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.TgZ(39,"div",19)(40,"div",31)(41,"span",32),e._UZ(42,"i",33),e.qZA()(),e.TgZ(43,"div",20)(44,"input",34,35),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.rate=o)}),e.qZA()(),e.TgZ(46,"div",25)(47,"span",32),e._uU(48),e.ALo(49,"translate"),e.qZA()(),e.YNc(50,he,3,3,"div",36),e.qZA()(),e.TgZ(51,"div",16)(52,"label",17)(53,"span",18),e._uU(54,"*"),e.qZA(),e._uU(55),e.ALo(56,"translate"),e.qZA(),e.TgZ(57,"div",19)(58,"div",20)(59,"input",34,37),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.firstChargingPeriod=o)}),e.qZA()(),e.TgZ(61,"div",25)(62,"span",38),e._uU(63),e.ALo(64,"translate"),e.qZA()(),e.YNc(65,ue,3,3,"div",39),e.qZA()(),e.TgZ(66,"div",16)(67,"label",17)(68,"span",18),e._uU(69,"*"),e.qZA(),e._uU(70),e.ALo(71,"translate"),e.qZA(),e.TgZ(72,"div",19)(73,"div",31)(74,"span",32),e._UZ(75,"i",33),e.qZA()(),e.TgZ(76,"div",20)(77,"input",34,40),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.minimumPerEntry=o)}),e.qZA()(),e.YNc(79,Te,3,3,"div",39),e.qZA()()(),e.TgZ(80,"div",15)(81,"div",16)(82,"label",17)(83,"span",18),e._uU(84,"*"),e.qZA(),e._uU(85),e.ALo(86,"translate"),e.qZA(),e.TgZ(87,"div",41)(88,"select",42,43),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.rateType=o)}),e.TgZ(90,"option",44),e._uU(91,"15"),e.qZA(),e.TgZ(92,"option",45),e._uU(93,"30"),e.qZA(),e.TgZ(94,"option",46),e._uU(95,"45"),e.qZA(),e.TgZ(96,"option",47),e._uU(97,"60"),e.qZA()(),e.YNc(98,ve,3,3,"div",23),e.qZA()(),e.TgZ(99,"div",16)(100,"label",17)(101,"span",18),e._uU(102,"*"),e.qZA(),e._uU(103),e.ALo(104,"translate"),e.qZA(),e.TgZ(105,"div",19)(106,"div",20)(107,"input",34,48),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.graceTime=o)}),e.qZA()(),e.TgZ(109,"div",25)(110,"span",32),e._uU(111),e.ALo(112,"translate"),e.qZA()(),e.YNc(113,Ce,3,3,"div",39),e.qZA()(),e.TgZ(114,"div",16)(115,"label",17)(116,"span",18),e._uU(117,"*"),e.qZA(),e._uU(118),e.ALo(119,"translate"),e.qZA(),e.TgZ(120,"div",19)(121,"div",31)(122,"span",32),e._UZ(123,"i",33),e.qZA()(),e.TgZ(124,"div",20)(125,"input",49,50),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.firstChargingRate=o)}),e.qZA()(),e.TgZ(127,"div",25)(128,"span",32),e._uU(129),e.ALo(130,"translate"),e.qZA()(),e.YNc(131,Ze,3,3,"div",39),e.qZA()()(),e._UZ(132,"hr",51),e.TgZ(133,"div",15)(134,"div",16)(135,"label",17)(136,"span",18),e._uU(137,"*"),e.qZA(),e._uU(138),e.ALo(139,"translate"),e.qZA(),e.TgZ(140,"div",19)(141,"div",31)(142,"span",32),e._UZ(143,"i",33),e.qZA()(),e.TgZ(144,"input",34,52),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.form.maxPerDate=o)}),e.qZA(),e.YNc(146,xe,3,3,"div",39),e.qZA()()()()}if(2&i){const t=r.$implicit,n=r.index,o=e.MAs(17),a=e.MAs(21),l=e.MAs(28),d=e.MAs(32),m=e.MAs(45),f=e.MAs(60),T=e.MAs(78),v=e.MAs(89),M=e.MAs(108),b=e.MAs(126),A=e.MAs(145),g=e.oxw();e.xp6(3),e.AsE("",e.lcZ(4,47,"Time Slot")," ",n+1,""),e.xp6(9),e.hij(" ",e.lcZ(13,49,"Time Range"),": "),e.xp6(4),e.MGl("name","fromTime",n,""),e.Q6J("ngModel",e.xi3(18,51,t.from,"shortTime"))("popover",a)("outsideClick",!0),e.xp6(3),e.Q6J("ngIf",o.invalid&&(o.dirty||o.touched||g.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(25,54,"to")," "),e.xp6(3),e.MGl("name","endTime",n,""),e.Q6J("ngModel",e.xi3(29,56,t.to,"shortTime"))("popover",d)("outsideClick",!0),e.xp6(3),e.Q6J("ngIf",l.invalid&&(l.dirty||l.touched||g.formRef.submitted)),e.xp6(4),e.MGl("for","exampleInputEmail",n,""),e.xp6(3),e.hij(" ",e.lcZ(38,59,"Rate"),": "),e.xp6(7),e.MGl("name","rate",n,""),e.Q6J("ngModel",t.rate),e.xp6(4),e.AsE(" /",t.rateType,"",e.lcZ(49,61,"mins")," "),e.xp6(2),e.Q6J("ngIf",m.invalid&&(m.dirty||m.touched||g.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(56,63,"First Charging Period"),": "),e.xp6(4),e.MGl("name","chargingPeriod",n,""),e.Q6J("ngModel",t.firstChargingPeriod),e.xp6(4),e.hij(" ",e.lcZ(64,65,"min")," "),e.xp6(2),e.Q6J("ngIf",f.invalid&&(f.dirty||f.touched||g.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(71,67,"Minimum Per Entry"),": "),e.xp6(7),e.MGl("name","minimumPerEntry",n,""),e.Q6J("ngModel",t.minimumPerEntry),e.xp6(2),e.Q6J("ngIf",T.invalid&&(T.dirty||T.touched||g.formRef.submitted)),e.xp6(6),e.hij(" ",e.lcZ(86,69,"Rate Type"),": "),e.xp6(3),e.MGl("name","rateType",n,""),e.Q6J("ngModel",t.rateType),e.xp6(10),e.Q6J("ngIf",v.invalid&&(v.dirty||v.touched||g.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(104,71,"Grace Time"),": "),e.xp6(4),e.MGl("name","graceTime",n,""),e.Q6J("ngModel",t.graceTime),e.xp6(4),e.hij(" ",e.lcZ(112,73,"min")," "),e.xp6(2),e.Q6J("ngIf",M.invalid&&(M.dirty||M.touched||g.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(119,75,"First Charging Rate"),": "),e.xp6(7),e.Q6J("ngModel",t.firstChargingRate),e.xp6(4),e.hij(" ",e.lcZ(130,77,"min")," "),e.xp6(2),e.Q6J("ngIf",b.invalid&&(b.dirty||b.touched||g.formRef.submitted)),e.xp6(7),e.hij(" ",e.lcZ(139,79,"Max Per Day"),": "),e.xp6(6),e.MGl("name","maxPerDate",n,""),e.Q6J("ngModel",g.form.maxPerDate),e.xp6(2),e.Q6J("ngIf",A.invalid&&(A.dirty||A.touched||g.formRef.submitted))}}let z=(()=>{class i{constructor(){this.form=(0,h.jqJ)()}ngOnInit(){this.form={...this.form,effectiveStartDate:new Date(this.form.effectiveStartDate),effectiveEndDate:new Date(this.form.effectiveEndDate)}}addNewTimeSlot(){this.form.timeSlots.push((0,h.z5G)())}deleteChip(t,n,o,a){t.stopPropagation(),n.removeItem(o,a)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-tariffs-form-adhoc"]],inputs:{form:"form",formRef:"formRef"},decls:16,vars:7,consts:[["appProvideParentForm",""],[1,"m-portlet"],[1,"m-portlet__head","d-flex","align-items-center"],[1,"row","m--marginless"],[1,"m-portlet__head-caption"],[1,"m-portlet__head-title"],[1,"m-portlet__head-text"],["class","m-portlet__body row",4,"ngFor","ngForOf"],[1,"m-portlet__foot"],["type","button",1,"btn","m-btn--pill","btn-outline-primary","m-btn","m-btn--custom","btn-sm",3,"click"],[1,"la","la-plus"],[1,"m-portlet__body","row"],[1,"col-12","d-flex","justify-content-between","m--margin-bottom-20"],["type","button",1,"btn","btn-default",3,"click"],[1,"la","la-trash"],[1,"col-6"],[1,"row","form-group"],[1,"col-form-label","text-right","col-4"],[1,"m--font-danger"],[1,"input-group","col-8"],[1,"col","m--padding-0"],["type","text","placeholder","","readonly","","required","",1,"form-control","m-input",3,"ngModel","name","popover","outsideClick","ngModelChange"],["fromTime","ngModel"],["class","form-control-feedback",4,"ngIf"],["startTimeTpl",""],[1,"input-group-append"],[1,"input-group-text","fit-content"],["type","text","placeholder","","readonly","","required","",1,"form-control","m-input",3,"ngModel","name","popover","outsideClick"],["endTime","ngModel"],["endTimeTpl",""],[1,"col-form-label","text-right","col-4",3,"for"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"la","la-usd"],["type","text","placeholder","","required","",1,"form-control","m-input",3,"name","ngModel","ngModelChange"],["rate","ngModel"],["class","form-control-feedback m--font-danger",4,"ngIf"],["chargingPeriod","ngModel"],["id","basic-addon2",1,"input-group-text"],["class","w-100 form-control-feedback m--font-danger",4,"ngIf"],["minimumPerEntry","ngModel"],[1,"col-8"],["required","",1,"form-control","m-input",3,"name","ngModel","ngModelChange"],["rateType","ngModel"],["value","15"],["value","30"],["value","45"],["value","60"],["graceTime","ngModel"],["type","text","placeholder","","name","chargingRate","required","",1,"form-control","m-input",3,"ngModel","ngModelChange"],["chargingRate","ngModel"],[1,"col-11"],["maxPerDate","ngModel"],[1,"form-control-feedback"],["name","fromTimePicker",3,"ngModel","showMeridian","ngModelChange"],["name","endTimePicker",3,"ngModel","showMeridian","ngModelChange"],[1,"form-control-feedback","m--font-danger"],[1,"w-100","form-control-feedback","m--font-danger"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h3",6),e._uU(8),e.ALo(9,"translate"),e.qZA()()()()(),e.YNc(10,Me,147,81,"div",7),e.TgZ(11,"div",8)(12,"button",9),e.NdJ("click",function(){return n.addNewTimeSlot()}),e._UZ(13,"i",10),e._uU(14),e.ALo(15,"translate"),e.qZA()()()()),2&t&&(e.xp6(8),e.hij(" ",e.lcZ(9,3,"Tariff")," "),e.xp6(2),e.Q6J("ngForOf",n.form.timeSlots),e.xp6(4),e.hij(" ",e.lcZ(15,5,"Add New Time Slot")," "))},dependencies:[p.sg,p.O5,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.Q7,c.On,S.h,N.EV,J.k5,p.uU,u.X$],encapsulation:2}),i})();var F=s(8929),G=s(24850),U=s(72986),D=s(1059),R=s(80013),K=s(75778),L=s(2994),V=s(87545),B=s(88117),W=s(88796);function be(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"label",8)(1,"input",9),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.onChangeDay(o,l.value))}),e.qZA(),e._uU(2),e._UZ(3,"span"),e.qZA()}if(2&i){const t=r.$implicit,n=r.index,o=e.oxw();e.xp6(1),e.s9C("value",t.value),e.MGl("name","day",n,""),e.Q6J("ngModel",o.weekdays[t.value]),e.xp6(1),e.hij("",t.value," ")}}function Ae(i,r){1&i&&(e.TgZ(0,"div",53),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function ye(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"timepicker",54),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw().$implicit;return e.KtG(a.from=o)}),e.qZA()}if(2&i){const t=e.oxw().$implicit;e.Q6J("ngModel",t.from)("showMeridian",!1)}}function we(i,r){1&i&&(e.TgZ(0,"div",53),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function Fe(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"timepicker",55),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw().$implicit;return e.KtG(a.to=o)}),e.qZA()}if(2&i){const t=e.oxw().$implicit;e.Q6J("ngModel",t.to)("showMeridian",!1)}}function qe(i,r){1&i&&(e.TgZ(0,"div",56),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function Ne(i,r){1&i&&(e.TgZ(0,"div",57),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function Je(i,r){1&i&&(e.TgZ(0,"div",57),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function Ue(i,r){1&i&&(e.TgZ(0,"div",53),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function Le(i,r){1&i&&(e.TgZ(0,"div",57),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function ke(i,r){1&i&&(e.TgZ(0,"div",57),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function Se(i,r){1&i&&(e.TgZ(0,"div",57),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function Ie(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",10)(1,"div",11)(2,"h5"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"button",12),e.NdJ("click",function(){const a=e.CHM(t).index,l=e.oxw();return e.KtG(l.form.timeSlots.splice(a,1))}),e._UZ(6,"i",13),e.qZA()(),e.TgZ(7,"div",14)(8,"div",15)(9,"label",16)(10,"span",17),e._uU(11,"*"),e.qZA(),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"div",18)(15,"div",19)(16,"input",20,21),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.from=o)}),e.ALo(18,"date"),e.qZA(),e.YNc(19,Ae,3,3,"div",22),e.qZA(),e.YNc(20,ye,1,2,"ng-template",null,23,e.W1O),e.TgZ(22,"div",24)(23,"span",25),e._uU(24),e.ALo(25,"translate"),e.qZA()(),e.TgZ(26,"div",19),e._UZ(27,"input",26,27),e.ALo(29,"date"),e.YNc(30,we,3,3,"div",22),e.qZA(),e.YNc(31,Fe,1,2,"ng-template",null,28,e.W1O),e.qZA()(),e.TgZ(33,"div",15)(34,"label",29)(35,"span",17),e._uU(36,"*"),e.qZA(),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.TgZ(39,"div",18)(40,"div",30)(41,"span",31),e._UZ(42,"i",32),e.qZA()(),e.TgZ(43,"div",19)(44,"input",33,34),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.rate=o)}),e.qZA()(),e.TgZ(46,"div",24)(47,"span",31),e._uU(48),e.ALo(49,"translate"),e.qZA()(),e.YNc(50,qe,3,3,"div",35),e.qZA()(),e.TgZ(51,"div",15)(52,"label",16)(53,"span",17),e._uU(54,"*"),e.qZA(),e._uU(55),e.ALo(56,"translate"),e.qZA(),e.TgZ(57,"div",18)(58,"div",19)(59,"input",33,36),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.firstChargingPeriod=o)}),e.qZA()(),e.TgZ(61,"div",24)(62,"span",37),e._uU(63),e.ALo(64,"translate"),e.qZA()(),e.YNc(65,Ne,3,3,"div",38),e.qZA()(),e.TgZ(66,"div",15)(67,"label",16)(68,"span",17),e._uU(69,"*"),e.qZA(),e._uU(70),e.ALo(71,"translate"),e.qZA(),e.TgZ(72,"div",18)(73,"div",30)(74,"span",31),e._UZ(75,"i",32),e.qZA()(),e.TgZ(76,"div",19)(77,"input",33,39),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.minimumPerEntry=o)}),e.qZA()(),e.YNc(79,Je,3,3,"div",38),e.qZA()()(),e.TgZ(80,"div",14)(81,"div",15)(82,"label",16)(83,"span",17),e._uU(84,"*"),e.qZA(),e._uU(85),e.ALo(86,"translate"),e.qZA(),e.TgZ(87,"div",40)(88,"select",41,42),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.rateType=o)}),e.TgZ(90,"option",43),e._uU(91,"15"),e.qZA(),e.TgZ(92,"option",44),e._uU(93,"30"),e.qZA(),e.TgZ(94,"option",45),e._uU(95,"45"),e.qZA(),e.TgZ(96,"option",46),e._uU(97,"60"),e.qZA()(),e.YNc(98,Ue,3,3,"div",22),e.qZA()(),e.TgZ(99,"div",15)(100,"label",16)(101,"span",17),e._uU(102,"*"),e.qZA(),e._uU(103),e.ALo(104,"translate"),e.qZA(),e.TgZ(105,"div",18)(106,"div",19)(107,"input",33,47),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.graceTime=o)}),e.qZA()(),e.TgZ(109,"div",24)(110,"span",31),e._uU(111),e.ALo(112,"translate"),e.qZA()(),e.YNc(113,Le,3,3,"div",38),e.qZA()(),e.TgZ(114,"div",15)(115,"label",16)(116,"span",17),e._uU(117,"*"),e.qZA(),e._uU(118),e.ALo(119,"translate"),e.qZA(),e.TgZ(120,"div",18)(121,"div",30)(122,"span",31),e._UZ(123,"i",32),e.qZA()(),e.TgZ(124,"div",19)(125,"input",48,49),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.firstChargingRate=o)}),e.qZA()(),e.TgZ(127,"div",24)(128,"span",31),e._uU(129),e.ALo(130,"translate"),e.qZA()(),e.YNc(131,ke,3,3,"div",38),e.qZA()(),e.TgZ(132,"div",15)(133,"label",16)(134,"span",17),e._uU(135,"*"),e.qZA(),e._uU(136),e.ALo(137,"translate"),e.qZA(),e.TgZ(138,"div",18)(139,"div",30)(140,"span",31),e._UZ(141,"i",32),e.qZA()(),e.TgZ(142,"div",19)(143,"input",33,50),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.maxPerDay=o)}),e.qZA()(),e.YNc(145,Se,3,3,"div",38),e.qZA()(),e.TgZ(146,"div",15)(147,"label",16),e._uU(148),e.ALo(149,"translate"),e.qZA(),e.TgZ(150,"div",18)(151,"input",51,52),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.chargedByRate=o)}),e.qZA()()()()()}if(2&i){const t=r.$implicit,n=r.index,o=e.MAs(17),a=e.MAs(21),l=e.MAs(28),d=e.MAs(32),m=e.MAs(45),f=e.MAs(60),T=e.MAs(78),v=e.MAs(89),M=e.MAs(108),b=e.MAs(126),A=e.MAs(144),g=e.oxw();e.xp6(3),e.AsE("",e.lcZ(4,50,"Time Slot"),"",n+1,""),e.xp6(9),e.hij(" ",e.lcZ(13,52,"Time Range"),": "),e.xp6(4),e.MGl("name","fromTime",n,""),e.Q6J("ngModel",e.xi3(18,54,t.from,"shortTime"))("popover",a)("outsideClick",!0),e.xp6(3),e.Q6J("ngIf",o.invalid&&(o.dirty||o.touched||g.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(25,57,"to")," "),e.xp6(3),e.MGl("name","endTime",n,""),e.Q6J("ngModel",e.xi3(29,59,t.to,"shortTime"))("popover",d)("outsideClick",!0),e.xp6(3),e.Q6J("ngIf",l.invalid&&(l.dirty||l.touched||g.formRef.submitted)),e.xp6(4),e.MGl("for","exampleInputEmail",n,""),e.xp6(3),e.hij(" ",e.lcZ(38,62,"Rate"),": "),e.xp6(7),e.MGl("name","rate",n,""),e.Q6J("ngModel",t.rate),e.xp6(4),e.AsE(" /",t.rateType,"",e.lcZ(49,64,"mins")," "),e.xp6(2),e.Q6J("ngIf",m.invalid&&(m.dirty||m.touched||g.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(56,66,"First Charging Period"),": "),e.xp6(4),e.MGl("name","chargingPeriod",n,""),e.Q6J("ngModel",t.firstChargingPeriod),e.xp6(4),e.hij(" ",e.lcZ(64,68,"min")," "),e.xp6(2),e.Q6J("ngIf",f.invalid&&(f.dirty||f.touched||g.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(71,70,"Minimum Per Entry"),": "),e.xp6(7),e.MGl("name","minimumPerEntry",n,""),e.Q6J("ngModel",t.minimumPerEntry),e.xp6(2),e.Q6J("ngIf",T.invalid&&(T.dirty||T.touched||g.formRef.submitted)),e.xp6(6),e.hij(" ",e.lcZ(86,72,"Rate Type"),": "),e.xp6(3),e.MGl("name","rateType",n,""),e.Q6J("ngModel",t.rateType),e.xp6(10),e.Q6J("ngIf",v.invalid&&(v.dirty||v.touched||g.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(104,74,"Grace Time"),": "),e.xp6(4),e.MGl("name","graceTime",n,""),e.Q6J("ngModel",t.graceTime),e.xp6(4),e.hij(" ",e.lcZ(112,76,"min")," "),e.xp6(2),e.Q6J("ngIf",M.invalid&&(M.dirty||M.touched||g.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(119,78,"First Charging Rate"),": "),e.xp6(7),e.Q6J("ngModel",t.firstChargingRate),e.xp6(4),e.hij(" ",e.lcZ(130,80,"min")," "),e.xp6(2),e.Q6J("ngIf",b.invalid&&(b.dirty||b.touched||g.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(137,82,"Maximum Per Session"),": "),e.xp6(7),e.MGl("name","maximumPerSession",n,""),e.Q6J("ngModel",t.maxPerDay),e.xp6(2),e.Q6J("ngIf",A.invalid&&(A.dirty||A.touched||g.formRef.submitted)),e.xp6(3),e.hij(" ",e.lcZ(149,84,"Charged By Rate Type"),": "),e.xp6(3),e.MGl("name","chargedByRate",n,""),e.Q6J("ngModel",t.chargedByRate)}}let X=(()=>{class i{constructor(t,n,o){this.route=t,this.userService=n,this.codeTablesService=o,this.form=(0,h.jqJ)(),this.formChange=new e.vpe,this.datePickerConfig={containerClass:"theme-red"},this.rateTypes=(0,h.RV7)(),this.weekdays={}}ngOnInit(){this.days$=this.codeTablesService.filterModelByType(h.BcL.DayType).pipe((0,U.q)(1)),this.form.weekdays.forEach(n=>this.weekdays[n]=!0),this.days$.map(n=>n)}onChangeDay(t,n){this.weekdays[n]=t,this.form.weekdays=Object.keys(this.weekdays).filter(o=>this.weekdays[o])}addNewTimeSlot(){this.form.timeSlots.push((0,h.z5G)())}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.gz),e.Y36(q.K),e.Y36(y.I))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-tariffs-form-normal"]],inputs:{formRef:"formRef",form:"form"},outputs:{formChange:"formChange"},decls:11,vars:7,consts:[["appProvideParentForm","",1,"m-portlet"],[1,"m-portlet__head","d-flex","align-items-center"],[1,"row","m--marginless"],["class","m-checkbox m-checkbox--brand m--margin-right-20",4,"ngFor","ngForOf"],["class","m-portlet__body row",4,"ngFor","ngForOf"],[1,"m-portlet__foot"],["type","button",1,"btn","m-btn--pill","btn-outline-primary","m-btn","m-btn--custom","btn-sm",3,"click"],[1,"la","la-plus"],[1,"m-checkbox","m-checkbox--brand","m--margin-right-20"],["type","checkbox",3,"value","name","ngModel","ngModelChange"],[1,"m-portlet__body","row"],[1,"col-12","d-flex","justify-content-between","m--margin-bottom-20"],["type","button",1,"btn","btn-default",3,"click"],[1,"la","la-trash"],[1,"col-6"],[1,"row","form-group"],[1,"col-form-label","text-right","col-4"],[1,"m--font-danger"],[1,"input-group","col-8"],[1,"col","m--padding-0"],["type","text","placeholder","","readonly","","required","",1,"form-control","m-input",3,"ngModel","name","popover","outsideClick","ngModelChange"],["fromTime","ngModel"],["class","form-control-feedback",4,"ngIf"],["startTimeTpl",""],[1,"input-group-append"],[1,"input-group-text","fit-content"],["type","text","placeholder","","readonly","","required","",1,"form-control","m-input",3,"ngModel","name","popover","outsideClick"],["endTime","ngModel"],["endTimeTpl",""],[1,"col-form-label","text-right","col-4",3,"for"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"la","la-usd"],["type","text","placeholder","","required","",1,"form-control","m-input",3,"name","ngModel","ngModelChange"],["rate","ngModel"],["class","form-control-feedback m--font-danger",4,"ngIf"],["chargingPeriod","ngModel"],["id","basic-addon2",1,"input-group-text"],["class","w-100 form-control-feedback m--font-danger",4,"ngIf"],["minimumPerEntry","ngModel"],[1,"col-8"],["required","",1,"form-control","m-input",3,"name","ngModel","ngModelChange"],["rateType","ngModel"],["value","15"],["value","30"],["value","45"],["value","60"],["graceTime","ngModel"],["type","text","placeholder","","name","chargingRate","required","",1,"form-control","m-input",3,"ngModel","ngModelChange"],["chargingRate","ngModel"],["maximumPerSession","ngModel"],["type","checkbox",3,"name","ngModel","ngModelChange"],["chargedByRate","ngModel"],[1,"form-control-feedback"],["name","fromTimePicker",3,"ngModel","showMeridian","ngModelChange"],["name","endTimePicker",3,"ngModel","showMeridian","ngModelChange"],[1,"form-control-feedback","m--font-danger"],[1,"w-100","form-control-feedback","m--font-danger"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,be,4,4,"label",3),e.ALo(4,"async"),e.qZA()(),e.YNc(5,Ie,153,86,"div",4),e.TgZ(6,"div",5)(7,"button",6),e.NdJ("click",function(){return n.addNewTimeSlot()}),e._UZ(8,"i",7),e._uU(9),e.ALo(10,"translate"),e.qZA()()()),2&t&&(e.xp6(3),e.Q6J("ngForOf",e.lcZ(4,3,n.days$)),e.xp6(2),e.Q6J("ngForOf",n.form.timeSlots),e.xp6(4),e.hij("",e.lcZ(10,5,"Add New Time Slot")," "))},dependencies:[p.sg,p.O5,c.YN,c.Kr,c.Fj,c.Wl,c.EJ,c.JJ,c.Q7,c.On,S.h,N.EV,J.k5,p.Ov,p.uU,u.X$],encapsulation:2}),i})();function Pe(i,r){1&i&&(e.TgZ(0,"div",34),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function Ee(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"timepicker",35),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw().$implicit;return e.KtG(a.from=o)}),e.qZA()}if(2&i){const t=e.oxw().$implicit;e.Q6J("ngModel",t.from)("showMeridian",!1)}}function Qe(i,r){1&i&&(e.TgZ(0,"div",34),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function He(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"timepicker",36),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw().$implicit;return e.KtG(a.to=o)}),e.qZA()}if(2&i){const t=e.oxw().$implicit;e.Q6J("ngModel",t.to)("showMeridian",!1)}}function je(i,r){1&i&&(e.TgZ(0,"div",37),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function Oe(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",9)(1,"div",10)(2,"h5"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"button",11),e.NdJ("click",function(){const a=e.CHM(t).index,l=e.oxw();return e.KtG(l.form.timeSlots.splice(a,1))}),e._UZ(6,"i",12),e.qZA()(),e.TgZ(7,"div",13)(8,"div",14)(9,"label",15)(10,"span",16),e._uU(11,"*"),e.qZA(),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"div",17)(15,"div",18)(16,"input",19,20),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.from=o)}),e.ALo(18,"date"),e.qZA(),e.YNc(19,Pe,3,3,"div",21),e.qZA(),e.YNc(20,Ee,1,2,"ng-template",null,22,e.W1O),e.TgZ(22,"div",23)(23,"span",24),e._uU(24),e.ALo(25,"translate"),e.qZA()(),e.TgZ(26,"div",18),e._UZ(27,"input",25,26),e.ALo(29,"date"),e.YNc(30,Qe,3,3,"div",21),e.qZA(),e.YNc(31,He,1,2,"ng-template",null,27,e.W1O),e.qZA()()(),e.TgZ(33,"div",13)(34,"div",14)(35,"label",15)(36,"span",16),e._uU(37,"*"),e.qZA(),e._uU(38),e.ALo(39,"translate"),e.qZA(),e.TgZ(40,"div",17)(41,"div",28)(42,"span",29),e._UZ(43,"i",30),e.qZA()(),e.TgZ(44,"div",18)(45,"input",31,32),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.rate=o)}),e.qZA()(),e.TgZ(47,"div",23)(48,"span",29),e._uU(49),e.ALo(50,"translate"),e.qZA()(),e.YNc(51,je,3,3,"div",33),e.qZA()()()()}if(2&i){const t=r.$implicit,n=r.index,o=e.MAs(17),a=e.MAs(21),l=e.MAs(28),d=e.MAs(32),m=e.MAs(46),f=e.oxw();e.xp6(3),e.AsE("",e.lcZ(4,19,"Season Parking Type")," ",n+1,""),e.xp6(9),e.hij(" ",e.lcZ(13,21,"Time Range"),": "),e.xp6(4),e.MGl("name","fromTime",n,""),e.Q6J("ngModel",e.xi3(18,23,t.from,"shortTime"))("popover",a)("outsideClick",!0),e.xp6(3),e.Q6J("ngIf",o.invalid&&(o.dirty||o.touched||f.formRef.submitted)),e.xp6(5),e.hij(" ",e.lcZ(25,26,"to")," "),e.xp6(3),e.MGl("name","endTime",n,""),e.Q6J("ngModel",e.xi3(29,28,t.to,"shortTime"))("popover",d)("outsideClick",!0),e.xp6(3),e.Q6J("ngIf",l.invalid&&(l.dirty||l.touched||f.formRef.submitted)),e.xp6(8),e.hij(" ",e.lcZ(39,31,"Rate"),": "),e.xp6(7),e.MGl("name","rate",n,""),e.Q6J("ngModel",t.rate),e.xp6(4),e.hij(" /30",e.lcZ(50,33,"mins")," "),e.xp6(2),e.Q6J("ngIf",m.invalid&&(m.dirty||m.touched||f.formRef.submitted))}}let ee=(()=>{class i{constructor(t,n,o){this.route=t,this.userService=n,this.codeTablesService=o,this.wholeDay=!1,this.form=(0,h.jqJ)()}addNewTimeSlot(){this.form.timeSlots.push((0,h.z5G)())}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.gz),e.Y36(q.K),e.Y36(y.I))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-tariffs-form-season"]],inputs:{form:"form",formRef:"formRef"},decls:13,vars:7,consts:[["appProvideParentForm","",1,"m-portlet"],[1,"m-portlet__head","d-flex","align-items-center"],[1,"m-portlet__head-caption"],[1,"m-portlet__head-title"],[1,"m-portlet__head-text"],["class","m-portlet__body row",4,"ngFor","ngForOf"],[1,"m-portlet__foot"],["type","button",1,"btn","m-btn--pill","btn-outline-primary","m-btn","m-btn--custom","btn-sm",3,"click"],[1,"la","la-plus"],[1,"m-portlet__body","row"],[1,"col-12","d-flex","justify-content-between","m--margin-bottom-20"],["type","button",1,"btn","btn-default",3,"click"],[1,"la","la-trash"],[1,"col-6"],[1,"row","form-group"],[1,"col-form-label","text-right","col-4"],[1,"m--font-danger"],[1,"input-group","col-8"],[1,"col","m--padding-0"],["type","text","placeholder","","readonly","","required","",1,"form-control","m-input",3,"ngModel","name","popover","outsideClick","ngModelChange"],["fromTime","ngModel"],["class","form-control-feedback",4,"ngIf"],["startTimeTpl",""],[1,"input-group-append"],[1,"input-group-text","fit-content"],["type","text","placeholder","","readonly","","required","",1,"form-control","m-input",3,"ngModel","name","popover","outsideClick"],["endTime","ngModel"],["endTimeTpl",""],[1,"input-group-prepend"],[1,"input-group-text"],[1,"la","la-usd"],["type","text","placeholder","","required","",1,"form-control","m-input",3,"name","ngModel","ngModelChange"],["rate","ngModel"],["class","form-control-feedback m--font-danger",4,"ngIf"],[1,"form-control-feedback"],["name","fromTimePicker",3,"ngModel","showMeridian","ngModelChange"],["name","endTimePicker",3,"ngModel","showMeridian","ngModelChange"],[1,"form-control-feedback","m--font-danger"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),e._uU(5),e.ALo(6,"translate"),e.qZA()()()(),e.YNc(7,Oe,52,35,"div",5),e.TgZ(8,"div",6)(9,"button",7),e.NdJ("click",function(){return n.addNewTimeSlot()}),e._UZ(10,"i",8),e._uU(11),e.ALo(12,"translate"),e.qZA()()()),2&t&&(e.xp6(5),e.hij(" ",e.lcZ(6,3,"Tariff")," "),e.xp6(2),e.Q6J("ngForOf",n.form.timeSlots),e.xp6(4),e.hij(" ",e.lcZ(12,5,"Add Season Parking Type")," "))},dependencies:[p.sg,p.O5,c.Fj,c.JJ,c.Q7,c.On,S.h,N.EV,J.k5,p.uU,u.X$],encapsulation:2}),i})();function $e(i,r){1&i&&(e.TgZ(0,"div",30),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function Ye(i,r){if(1&i&&(e.TgZ(0,"option",31),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.value)," ")}}function ze(i,r){if(1&i&&(e.TgZ(0,"option",31),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.value)," ")}}function Ge(i,r){if(1&i&&(e.TgZ(0,"option",31),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.value)," ")}}function De(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-tariffs-form-normal",32),e.NdJ("formChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.form=o)}),e.qZA()}if(2&i){const t=e.oxw(),n=e.MAs(1);e.Q6J("form",t.form)("formRef",n)}}function Re(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-tariffs-form-season",32),e.NdJ("formChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.form=o)}),e.qZA()}if(2&i){const t=e.oxw(),n=e.MAs(1);e.Q6J("form",t.form)("formRef",n)}}function Ke(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-tariffs-form-adhoc",32),e.NdJ("formChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.form=o)}),e.qZA()}if(2&i){const t=e.oxw(),n=e.MAs(1);e.Q6J("form",t.form)("formRef",n)}}let I=(()=>{class i{constructor(t,n,o,a,l){this.userService=t,this.codeTablesService=n,this.route=o,this.router=a,this.translate=l,this.form=(0,h.jqJ)(),this.submitted=new e.vpe,this.canceled=new e.vpe,this.ownerInput$=new F.xQ,this.operatorInput$=new F.xQ,this.tariffTypes=[],this.vehicleTypes=[]}get type(){return this.route.snapshot.queryParamMap.get("type")||this.form.tariffTypeCode}get vehicleType(){return this.route.snapshot.queryParamMap.get("vehicleType")||this.form.vehicleTypeCode}ngOnInit(){this.vehicleTypes$=this.codeTablesService.filterModelByType(h.BcL.VehicleType).pipe((0,G.U)(t=>{const n=t.find(o=>o.value===this.vehicleType);return this.form={...this.form,vehicleTypeId:n.id},this.vehicleTypes=t})),this.tariffTypes$=this.codeTablesService.filterModelByType(h.BcL.TariffType).pipe((0,G.U)(t=>{const n=t.find(o=>o.value===this.type);return this.form={...this.form,tariffTypeId:n.id},this.tariffTypes=t})),this.carParkTypes$=this.codeTablesService.filterModelByType(h.BcL.Carpark).pipe((0,U.q)(1)).map(t=>(this.form.carParkTypeId=this.form.carParkTypeId||t[0]&&t[0].id,t)),this.owner$=this.ownerInput$.pipe((0,D.O)(""),(0,R.b)(200),(0,K.x)(),(0,L.b)(()=>this.ownerLoading=!0),(0,V.w)(t=>this.userService.searchOwners(t).pipe((0,L.b)(()=>this.ownerLoading=!1))),(0,B.B)()),this.owner$.pipe((0,U.q)(1)).subscribe(t=>this.form.ownerId=this.form.ownerId||t[0]&&t[0].id),this.operator$=this.operatorInput$.pipe((0,D.O)(""),(0,R.b)(200),(0,K.x)(),(0,L.b)(()=>this.operatorLoading=!0),(0,V.w)(t=>this.userService.searchOperators(t).pipe((0,L.b)(()=>this.operatorLoading=!1))),(0,B.B)()),this.operator$.pipe((0,U.q)(1)).subscribe(t=>this.form.operatorId=this.form.operatorId||t[0]&&t[0].id),this.vehicleTitle=this.vehicleType,this.translate.get(this.vehicleType).subscribe(t=>{this.vehicleTitle=t}),this.translateType=this.type,this.translate.get(this.type).subscribe(t=>{this.translateType=t})}changeTariff(){const t=this.tariffTypes.find(o=>o.id===Number(this.form.tariffTypeId)),n=this.vehicleTypes.find(o=>o.id===Number(this.form.vehicleTypeId));t&&n&&this.router.navigate(["/tariffs","create"],{queryParams:{type:t.value,vehicleType:n.value}})}cancel(){this.canceled.emit()}submit(t){return t.valid&&this.submitted.emit(this.form)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(q.K),e.Y36(y.I),e.Y36(_.gz),e.Y36(_.F0),e.Y36(u.sK))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-tariffs-form-main"]],inputs:{form:"form"},outputs:{submitted:"submitted",canceled:"canceled"},decls:73,vars:65,consts:[[1,"m-form","m-form--fit","m-form--label-align-right",2,"margin-bottom","60px",3,"ngSubmit"],["formRef","ngForm"],[1,"m-portlet"],[1,"m-portlet__head"],[1,"m-portlet__head-caption"],[1,"m-portlet__head-title"],[1,"m-portlet__head-text"],[1,"m-portlet__body"],[1,"row","form-group"],[1,"col-form-label","col-2","text-right"],[1,"m--font-danger"],[1,"col-10"],["type","text","name","name","required","",1,"form-control","m-input",3,"ngModel","ngModelChange"],["name","ngModel"],["class","form-control-feedback",4,"ngIf"],[1,"col-form-label","col-lg-2","col-sm-12","text-right"],[1,"col-lg-4","col-sm-12"],["name","type",1,"form-control","m-input",3,"ngModel","disabled","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],["name","vehicle",1,"form-control","m-input",3,"ngModel","disabled","ngModelChange","change"],["name","carpark",1,"form-control","m-input",3,"ngModel","ngModelChange"],["name","owner","bindLabel","name","bindValue","id",3,"items","ngModel","typeahead","loading","ngModelChange"],["name","operator","bindLabel","name","bindValue","id",3,"items","ngModel","typeahead","loading","ngModelChange"],[3,"ngSwitch"],[3,"form","formRef","formChange",4,"ngSwitchCase"],[1,"d-flex","justify-content-between"],["type","button",1,"btn","btn-warning"],[1,"la","la-plus"],["type","reset",1,"btn","btn-outline-main","m--margin-right-20",3,"click"],["type","submit",1,"btn","btn-main"],[1,"form-control-feedback"],[3,"value"],[3,"form","formRef","formChange"]],template:function(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"form",0,1),e.NdJ("ngSubmit",function(){e.CHM(o);const l=e.MAs(1);return e.KtG(n.submit(l))}),e.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h3",6),e._uU(7),e.ALo(8,"titlecase"),e.ALo(9,"titlecase"),e.qZA()()()(),e.TgZ(10,"div",7)(11,"div",8)(12,"label",9)(13,"span",10),e._uU(14,"*"),e.qZA(),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",11)(18,"input",12,13),e.NdJ("ngModelChange",function(l){return n.form.name=l}),e.qZA(),e.YNc(20,$e,3,3,"div",14),e.qZA()(),e.TgZ(21,"div",8)(22,"label",15),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"div",16)(26,"select",17),e.NdJ("ngModelChange",function(l){return n.form.tariffTypeId=l})("change",function(){return n.changeTariff()}),e.YNc(27,Ye,3,4,"option",18),e.ALo(28,"async"),e.qZA()(),e.TgZ(29,"label",15),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"div",16)(33,"select",19),e.NdJ("ngModelChange",function(l){return n.form.vehicleTypeId=l})("change",function(){return n.changeTariff()}),e.YNc(34,ze,3,4,"option",18),e.ALo(35,"async"),e.qZA()()(),e.TgZ(36,"div",8)(37,"label",15),e._uU(38),e.ALo(39,"translate"),e.qZA(),e.TgZ(40,"div",16)(41,"select",20),e.NdJ("ngModelChange",function(l){return n.form.carParkTypeId=l}),e.YNc(42,Ge,3,4,"option",18),e.ALo(43,"async"),e.qZA()(),e.TgZ(44,"label",15),e._uU(45),e.ALo(46,"translate"),e.qZA(),e.TgZ(47,"div",16)(48,"ng-select",21),e.NdJ("ngModelChange",function(l){return n.form.ownerId=l}),e.ALo(49,"async"),e.qZA()()(),e.TgZ(50,"div",8)(51,"label",15),e._uU(52),e.ALo(53,"translate"),e.qZA(),e.TgZ(54,"div",16)(55,"ng-select",22),e.NdJ("ngModelChange",function(l){return n.form.operatorId=l}),e.ALo(56,"async"),e.qZA()()()()(),e.ynx(57,23),e.YNc(58,De,1,2,"app-tariffs-form-normal",24),e.YNc(59,Re,1,2,"app-tariffs-form-season",24),e.YNc(60,Ke,1,2,"app-tariffs-form-adhoc",24),e.BQk(),e.TgZ(61,"div",25)(62,"button",26),e._UZ(63,"i",27),e._uU(64),e.ALo(65,"translate"),e.qZA(),e.TgZ(66,"div")(67,"button",28),e.NdJ("click",function(){return n.cancel()}),e._uU(68),e.ALo(69,"translate"),e.qZA(),e.TgZ(70,"button",29),e._uU(71),e.ALo(72,"translate"),e.qZA()()()()}if(2&t){const o=e.MAs(1),a=e.MAs(19);e.xp6(7),e.AsE(" ",e.lcZ(8,33,n.vehicleType)," / ",e.lcZ(9,35,n.type)," "),e.xp6(8),e.hij(" ",e.lcZ(16,37,"Tariff Name"),": "),e.xp6(3),e.Q6J("ngModel",n.form.name),e.xp6(2),e.Q6J("ngIf",a.invalid&&(a.dirty||a.touched||o.submitted)),e.xp6(3),e.hij(" ",e.lcZ(24,39,"Tariff Type"),": "),e.xp6(3),e.Q6J("ngModel",n.form.tariffTypeId)("disabled",n.form.id),e.xp6(1),e.Q6J("ngForOf",e.lcZ(28,41,n.tariffTypes$)),e.xp6(3),e.hij(" ",e.lcZ(31,43,"Vehicle Type"),": "),e.xp6(3),e.Q6J("ngModel",n.form.vehicleTypeId)("disabled",n.form.id),e.xp6(1),e.Q6J("ngForOf",e.lcZ(35,45,n.vehicleTypes$)),e.xp6(4),e.hij(" ",e.lcZ(39,47,"Car Park Type"),": "),e.xp6(3),e.Q6J("ngModel",n.form.carParkTypeId),e.xp6(1),e.Q6J("ngForOf",e.lcZ(43,49,n.carParkTypes$)),e.xp6(3),e.hij(" ",e.lcZ(46,51,"Car Park Owner"),": "),e.xp6(3),e.Q6J("items",e.lcZ(49,53,n.owner$))("ngModel",n.form.ownerId)("typeahead",n.ownerInput$)("loading",n.ownerLoading),e.xp6(4),e.hij(" ",e.lcZ(53,55,"Car Park Operator"),": "),e.xp6(3),e.Q6J("items",e.lcZ(56,57,n.operator$))("ngModel",n.form.operatorId)("typeahead",n.operatorInput$)("loading",n.operatorLoading),e.xp6(2),e.Q6J("ngSwitch",n.type),e.xp6(1),e.Q6J("ngSwitchCase","Normal"),e.xp6(1),e.Q6J("ngSwitchCase","Season"),e.xp6(1),e.Q6J("ngSwitchCase","Adhoc"),e.xp6(4),e.hij(" ",e.lcZ(65,59,"Add New Daily Plan")," "),e.xp6(4),e.hij(" ",e.lcZ(69,61,"Cancel")," "),e.xp6(3),e.hij(" ",e.lcZ(72,63,"Submit")," ")}},dependencies:[p.sg,p.O5,p.RF,p.n9,c._Y,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.JL,c.Q7,c.On,c.F,W.w9,X,ee,z,p.Ov,p.rS,u.X$],encapsulation:2}),i})();var te=s(19832),Ve=s(90355),Z=s(79118),x=s(15439),P=s(67556),k=s(20388),C=s(40269),ne=s(34984);const Be=["childModal"];function We(i,r){1&i&&(e.TgZ(0,"div",40),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1," Field is required.")," "))}function Xe(i,r){if(1&i&&(e.TgZ(0,"th",44),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Udp("width",t.width),e.xp6(1),e.hij(" ",t.text," ")}}function et(i,r){if(1&i&&(e.TgZ(0,"thead",41)(1,"tr",42),e.YNc(2,Xe,2,3,"th",43),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.tableHeaders)}}function tt(i,r){if(1&i&&(e.TgZ(0,"option",54),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function nt(i,r){if(1&i&&(e.TgZ(0,"option",54),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function it(i,r){if(1&i&&(e.TgZ(0,"option",54),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",r.index),e.xp6(1),e.hij(" ",t.name," ")}}function ot(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"i",55),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().index,a=e.oxw();return e.KtG(a.delete(o))}),e.qZA()}}function at(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"tr",45)(1,"td",46)(2,"span"),e._uU(3),e.qZA()(),e.TgZ(4,"td",47)(5,"select",48),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.startTime=o)}),e.YNc(6,tt,2,2,"option",49),e.qZA()(),e.TgZ(7,"td",47)(8,"select",50),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.endTime=o)})("ngModelChange",function(){const a=e.CHM(t).index,l=e.oxw();return e.KtG(l.revisedECharts("endTime",a))}),e.YNc(9,nt,2,2,"option",49),e.qZA()(),e.TgZ(10,"td",47)(11,"span",51),e._uU(12),e.qZA()(),e.TgZ(13,"td",47)(14,"select",52),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).$implicit;return e.KtG(l.costType=o)})("ngModelChange",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.revisedECharts())}),e.YNc(15,it,2,2,"option",49),e.qZA()(),e.TgZ(16,"td",46)(17,"span",51),e._uU(18),e.qZA()(),e.TgZ(19,"td",47)(20,"span",51),e._uU(21),e.qZA()(),e.TgZ(22,"td",47)(23,"span",51),e.YNc(24,ot,1,0,"i",53),e.qZA()()()}if(2&i){const t=r.$implicit,n=r.index,o=e.oxw();e.Q6J("ngClass",n%2>0?"m-datatable__row--even":""),e.xp6(1),e.Udp("width",o.tableHeaders[0].width),e.xp6(2),e.hij(" ",n," "),e.xp6(1),e.Udp("width",o.tableHeaders[1].width),e.xp6(1),e.MGl("name","startTime",n,""),e.Q6J("ngModel",t.startTime),e.xp6(1),e.Q6J("ngForOf",o.periodTimeList),e.xp6(1),e.Udp("width",o.tableHeaders[2].width),e.xp6(1),e.MGl("name","endTime",n,""),e.Q6J("ngModel",t.endTime)("disabled",o.saveInfos.items.length-1===n),e.xp6(1),e.Q6J("ngForOf",o.periodTimeList),e.xp6(1),e.Udp("width",o.tableHeaders[3].width),e.xp6(2),e.hij(" ",t.duration," "),e.xp6(1),e.Udp("width",o.tableHeaders[4].width),e.xp6(1),e.MGl("name","costType",n,""),e.Q6J("ngModel",t.costType),e.xp6(1),e.Q6J("ngForOf",o.feeModelList),e.xp6(1),e.Udp("width",o.tableHeaders[5].width),e.xp6(2),e.hij(" ",t.powerPrice?t.powerPrice:"please edit model"," "),e.xp6(1),e.Udp("width",o.tableHeaders[6].width),e.xp6(2),e.hij(" ",t.serviceFee?t.serviceFee:"please edit model"," "),e.xp6(1),e.Udp("width",o.tableHeaders[7].width),e.xp6(2),e.Q6J("ngIf",0!==n)}}function rt(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",6)(1,"label",61)(2,"span",8),e._uU(3,"*"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"div",62)(7,"input",63),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).index,d=e.oxw(2);return e.KtG(d.editFeeModelList[l].powerPrice=o)}),e.qZA()(),e.TgZ(8,"label",64)(9,"span",8),e._uU(10,"*"),e.qZA(),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"div",65)(14,"input",63),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).index,d=e.oxw(2);return e.KtG(d.editFeeModelList[l].serviceFee=o)}),e.qZA()()()}if(2&i){const t=r.$implicit,n=r.index,o=e.oxw(2);e.xp6(4),e.hij(" ",e.lcZ(5,4,t.name+" Power Price"),": "),e.xp6(3),e.Q6J("ngModel",o.editFeeModelList[n].powerPrice),e.xp6(4),e.hij(" ",e.lcZ(12,6,t.name+" Service Price"),": "),e.xp6(3),e.Q6J("ngModel",o.editFeeModelList[n].serviceFee)}}function lt(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",35)(1,"h4",56),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",37),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.modalRef.hide())}),e.TgZ(5,"span",38),e._uU(6,"\xd7"),e.qZA()()(),e.TgZ(7,"div",39),e.YNc(8,rt,15,8,"div",57),e.qZA(),e.TgZ(9,"div",58)(10,"button",59),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.modalRef.hide())}),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"button",60),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.saveModel())}),e._uU(14),e.ALo(15,"translate"),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,4,"Create Tariff")),e.xp6(6),e.Q6J("ngForOf",t.editFeeModelList),e.xp6(3),e.hij(" ",e.lcZ(12,6,"Cancel")," "),e.xp6(3),e.hij(" ",e.lcZ(15,8,"Save")," ")}}let ie=(()=>{class i{constructor(t,n,o,a,l){let d;for(this.router=t,this.translate=n,this.evcService=o,this.modalService=a,this.route=l,this.periodTimeList=[],this.tableHeaders=[{text:"#",align:Z.iW.Center,width:"7%"},{text:"Start Time",width:"15%"},{text:"End Time",width:"15%"},{text:"Duration(hrs)",width:"14%"},{text:"Fee model",width:"13%"},{text:"Power Price",width:"15%"},{text:"Service Fee",width:"15%"},{text:"Action",width:"6%"}],this.constant={time24:"24:00"},this.feeModelList=[{name:"Peak",powerPrice:null,serviceFee:null},{name:"High",powerPrice:null,serviceFee:null},{name:"Normal",powerPrice:null,serviceFee:null},{name:"Low",powerPrice:null,serviceFee:null}],this.editFeeModelList=[],this.saveInfos={companyId:null,costmodeId:"",costmodeName:null,delete_items:[],note:null,items:[],createBy:null},this.model=this.route.snapshot.queryParams.model,d=0;d<25;d++){let m;m=d+":00",this.periodTimeList.push(m)}this.periodTimeList[d-1]=this.constant.time24,this.pushDefaultPrice(),"update"===this.model&&this.setDataWhUpdate(),this.routeName=this.route.snapshot.queryParams.routeName}openModal(t){this.editFeeModelList=[...this.feeModelList],this.modalRef=this.modalService.show(t),this.modalRef.setClass("modal-lg")}ngOnInit(){const t=this.tableHeaders.map(n=>n.text);this.translate.get(t).subscribe(n=>{this.tableHeaders.forEach(o=>{for(const a in n)n.hasOwnProperty(a)&&o.text===a&&(o.text=n[a])})})}ngAfterViewInit(){setTimeout(()=>{this.modifyECharts()},3e3)}ngOnDestroy(){"update"===this.model&&localStorage.removeItem("curCostmode")}setDataWhUpdate(){const t=localStorage.getItem("curCostmode");t&&(this.saveInfos=JSON.parse(t),this.saveInfos.items[this.saveInfos.items.length-1].endTime=this.constant.time24),this.evcService.getAllElectricPrice({companyName:"",pageNum:1,pageSize:99999}).subscribe(o=>{if("00000"==o.messageCode){const a=o.data.content.filter(l=>l.companyId===this.saveInfos.companyId);0!==a.length&&(this.feeModelList[0].powerPrice=a[0].topPrice,this.feeModelList[0].serviceFee=a[0].serviceTopFee,this.feeModelList[1].powerPrice=a[0].peakPrice,this.feeModelList[1].serviceFee=a[0].servicePeakFee,this.feeModelList[2].powerPrice=a[0].norPrice,this.feeModelList[2].serviceFee=a[0].serviceNorFee,this.feeModelList[3].powerPrice=a[0].lowPrice,this.feeModelList[3].serviceFee=a[0].serviceLowFee),this.revisedECharts()}else this.message="Get data error..."})}saveModel(){this.feeModelList=[...this.editFeeModelList],this.revisedECharts(),this.modalRef.hide()}pushDefaultPrice(){this.saveInfos.items.push({id:"",costType:0,startTime:this.periodTimeList[0],endTime:this.constant.time24,duration:24,powerPrice:null,serviceFee:null})}goBack(){this.routeName?this.router.navigate(["/evc/tariffs"],{queryParams:{id:1,routeName:"tariff"}}):this.router.navigate(["./tariffs"])}addCharts(){const t=this.saveInfos.items,n=t.length;if(0!==n){if("23:00"===t[n-1].startTime)return void this.alert("Warn : time cannot more than 24hours");this.pushDefaultPrice(),this.revisedECharts()}}revisedECharts(t,n){let o;const a=this.saveInfos.items;if("endTime"===t&&n<a.length-1&&(this.compare2Time(a[n].endTime,a[n].startTime)||this.compare2Time(a[n+1].endTime,a[n].endTime)))return void setTimeout(()=>{a[n].endTime=a[n+1].startTime},500);a.forEach(d=>{if(d.powerPrice=this.feeModelList[d.costType].powerPrice,d.serviceFee=this.feeModelList[d.costType].serviceFee,o&&d.startTime!==o.endTime){if(o.endTime===this.constant.time24){const m=this.periodTimeList.indexOf(o.startTime);d.startTime=this.periodTimeList[m+1],o.endTime=d.startTime}else"endTime"===t?d.startTime=o.endTime:o.endTime=d.startTime;o.duration=x(o.endTime,"hh:mm").diff(x(o.startTime,"hh:mm"),"hour"),d.duration=x(d.endTime,"hh:mm").diff(x(d.startTime,"hh:mm"),"hour")}o=d});const l=this.saveInfos.items[this.saveInfos.items.length-1];l.endTime=this.constant.time24,l.duration=x(l.endTime,"hh:mm").diff(x(l.startTime,"hh:mm"),"hour"),this.modifyECharts()}compare2Time(t,n){return parseFloat(t.replace(":","."))<=parseFloat(n.replace(":","."))}getDefaultFeeArr(){const t=[];for(let n=0;n<24;n++)t.push("-");return t}modifyECharts(){const t=this.saveInfos.items.map(n=>{const o=this.getDefaultFeeArr(),a=this.periodTimeList.indexOf(n.startTime),d=this.periodTimeList.indexOf(n.endTime)-a,m=parseFloat(n.powerPrice)+parseFloat(n.serviceFee);for(let f=0;f<=d;f++)o[a+f]=m;return{data:o,type:"line",areaStyle:{type:"default",color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"red"},{offset:1,color:"#fff"}])},lineStyle:{color:"red"}}});this.option={series:t,xAxis:{type:"category",boundaryGap:!1,data:this.periodTimeList},yAxis:{type:"value"}}}delete(t){0!==t&&(this.saveInfos.items[t].id&&this.saveInfos.delete_items.push(this.saveInfos.items[t].id),this.saveInfos.items.splice(t,1),this.revisedECharts())}editPrice(){this.revisedECharts()}submit(){const t=this.getBasicPrice(),n={basicPrice:t,companyName:this.saveInfos.costmodeName,peakRate:this.getPriceRate(this.feeModelList[1].powerPrice,t),topRate:this.getPriceRate(this.feeModelList[0].powerPrice,t),norRate:this.getPriceRate(this.feeModelList[2].powerPrice,t),lowRate:this.getPriceRate(this.feeModelList[3].powerPrice,t),otherRate:"0%",note:this.saveInfos.note,serviceTopFee:this.feeModelList[0].serviceFee,servicePeakFee:this.feeModelList[1].serviceFee,serviceLowFee:this.feeModelList[3].serviceFee,serviceNorFee:this.feeModelList[2].serviceFee,companyId:"",lowPrice:this.feeModelList[3].powerPrice,norPrice:this.feeModelList[2].powerPrice,operatorId:"1",peakPrice:this.feeModelList[1].powerPrice,topPrice:this.feeModelList[0].powerPrice};let o="add";this.saveInfos.companyId&&(n.companyId=this.saveInfos.companyId,o="update"),this.saveInfos.items=this.saveInfos.items.map(a=>({...a,startTime:a.startTime+":00",endTime:"24:00"==a.endTime?"23:59:59":a.endTime+":00"})),this.evcService.addElectricPrice(n).subscribe(a=>{if("00000"==a.messageCode){"add"==o&&(this.saveInfos.companyId=a.data.id);const l={costmodeName:this.saveInfos.costmodeName,costmodeId:this.saveInfos.costmodeId,companyId:this.saveInfos.companyId,note:this.saveInfos.note,periodArr:this.saveInfos.items,delete_items:this.saveInfos.delete_items,createBy:"add"==o?JSON.parse(localStorage.getItem("user")).firstName:null,updateBy:"add"==o?null:JSON.parse(localStorage.getItem("user")).firstName};this.evcService.addCostModel(l,this.model).subscribe(d=>{"00000"==d.messageCode?this.goBack():this.alert(`${a.messageCode} : Save EVC tariffs failed`)},()=>{this.alert("Exception : Delete EVC tariffs failed")})}else this.alert(`${a.messageCode} : Save EVC tariffs failed`)},()=>{this.alert("Exception : Delete EVC tariffs failed")})}alert(t){this.message=t,this.childModal.show()}getBasicPrice(){let t=1,n=1;return this.feeModelList.forEach(o=>{o.powerPrice&&(o.powerPrice>t&&(t=+o.powerPrice),o.powerPrice<n&&(n=+o.powerPrice))}),t+n===0?1:t!==n?(t+n)/2:t}getPriceRate(t,n){return(t-n)/n*100+"%"}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.F0),e.Y36(u.sK),e.Y36(P.z$),e.Y36(k.tT),e.Y36(_.gz))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-tariffs-form-evc"]],viewQuery:function(t,n){if(1&t&&e.Gf(Be,5),2&t){let o;e.iGM(o=e.CRH())&&(n.childModal=o.first)}},inputs:{model:"model"},decls:60,vars:23,consts:[[1,"m-portlet","m-portlet--bordered-semi","m--padding-top-30"],[1,"m-portlet__body"],[1,"row","form-group","m-form__group","m--margin-bottom-30",3,"ngSubmit"],["formRef","ngForm"],[1,"col-xl-12","order-2","order-xl-1"],[1,"m-form","m-form--fit","m-form--label-align-right"],[1,"row","form-group"],[1,"col-form-label","col-2","text-right"],[1,"m--font-danger"],["class","form-control-feedback",4,"ngIf"],[1,"col-4"],["type","text","required","","name","costmodeName",1,"form-control","m-input",3,"ngModel","disabled","ngModelChange"],["costmodeName","ngModel"],[1,"col-form-label","col-lg-2","col-sm-12","text-right"],[1,"col-lg-4","col-sm-12"],["type","text","name","note",1,"form-control","m-input",3,"ngModel","ngModelChange"],["id","EvcChart","echarts","",2,"height","400px","width","100%",3,"options"],[1,"col-xl-12","order-2","order-xl-1",2,"display","flex","justify-content","flex-end"],["type","button",1,"btn","btn-color-white",3,"click"],[1,"la","la-arrow-left",2,"color","#6f6f6f"],[1,"la","la-pencil",2,"color","#6f6f6f"],["type","submit",1,"btn","btn-main"],[1,"col-xl-12","order-2","order-xl-1",2,"padding-top","50px"],[1,"m-datatable","m-datatable--default","m-datatable--brand","m-datatable--loaded"],[1,"m-datatable__table"],["class","m-datatable__head",4,"ngIf"],[1,"m-datatable__body"],["class","m-datatable__row",3,"ngClass",4,"ngFor","ngForOf"],[1,"col-xl-12","order-2","order-xl-1",2,"display","flex","justify-content","center","padding-top","20px"],[1,"la","la-plus-circle",3,"click"],["template",""],["bsModal","","tabindex","-1","role","dialog","aria-labelledby","dialog-child-name",1,"modal","fade"],["childModal","bs-modal"],[1,"modal-dialog","modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","dialog-child-name",1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"close","pull-right",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-control-feedback"],[1,"m-datatable__head"],[1,"m-datatable__row"],["class","m-datatable__cell col","style","text-align: center",3,"width",4,"ngFor","ngForOf"],[1,"m-datatable__cell","col",2,"text-align","center"],[1,"m-datatable__row",3,"ngClass"],[1,"m-datatable__cell","text-center"],[1,"m-datatable__cell"],["disabled","disabled",1,"form-control","m-input",3,"ngModel","name","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"form-control","m-input",3,"ngModel","disabled","name","ngModelChange"],[1,"text-center"],[1,"form-control","m-input",3,"ngModel","name","ngModelChange"],["class","la la-close",3,"click",4,"ngIf"],[3,"value"],[1,"la","la-close",3,"click"],[1,"modal-title","pull-left"],["class","row form-group",4,"ngFor","ngForOf"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-main",3,"click"],[1,"col-form-label","col-3","text-right"],[1,"col-3"],["type","text",1,"form-control","m-input",3,"ngModel","ngModelChange"],[1,"col-form-label","col-lg-3","col-sm-12","text-right"],[1,"col-lg-3","col-sm-12"]],template:function(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"form",2,3),e.NdJ("ngSubmit",function(){e.CHM(o);const l=e.MAs(3);return e.KtG(l.valid&&n.submit())}),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"label",7)(8,"span",8),e._uU(9,"*"),e.qZA(),e._uU(10),e.ALo(11,"translate"),e.YNc(12,We,3,3,"div",9),e._uU(13,": "),e.qZA(),e.TgZ(14,"div",10)(15,"input",11,12),e.NdJ("ngModelChange",function(l){return n.saveInfos.costmodeName=l}),e.qZA()(),e.TgZ(17,"label",13),e._uU(18),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"div",14)(21,"input",15),e.NdJ("ngModelChange",function(l){return n.saveInfos.note=l}),e.qZA()()()()(),e.TgZ(22,"div",4),e._UZ(23,"div",16),e.qZA(),e.TgZ(24,"div",17)(25,"button",18),e.NdJ("click",function(){return n.goBack()}),e.TgZ(26,"span"),e._UZ(27,"i",19),e._uU(28),e.ALo(29,"translate"),e.qZA()(),e.TgZ(30,"button",18),e.NdJ("click",function(){e.CHM(o);const l=e.MAs(47);return e.KtG(n.openModal(l))}),e.TgZ(31,"span"),e._UZ(32,"i",20),e._uU(33),e.ALo(34,"translate"),e.qZA()(),e.TgZ(35,"button",21),e._uU(36),e.ALo(37,"translate"),e.qZA()(),e.TgZ(38,"div",22)(39,"div",23)(40,"table",24),e.YNc(41,et,3,1,"thead",25),e.TgZ(42,"tbody",26),e.YNc(43,at,25,32,"tr",27),e.qZA()()()(),e.TgZ(44,"div",28)(45,"i",29),e.NdJ("click",function(){return n.addCharts()}),e.qZA()()()()(),e.YNc(46,lt,16,10,"ng-template",null,30,e.W1O),e.TgZ(48,"div",31,32)(50,"div",33)(51,"div",34)(52,"div",35)(53,"h4",36),e._uU(54,"Message"),e.qZA(),e.TgZ(55,"button",37),e.NdJ("click",function(){e.CHM(o);const l=e.MAs(49);return e.KtG(l.hide())}),e.TgZ(56,"span",38),e._uU(57,"\xd7"),e.qZA()()(),e.TgZ(58,"div",39),e._uU(59),e.qZA()()()()}if(2&t){const o=e.MAs(3),a=e.MAs(16);e.xp6(10),e.hij(" ",e.lcZ(11,13,"Tariff Name")," "),e.xp6(2),e.Q6J("ngIf",a.invalid&&(a.dirty||a.touched||o.submitted)),e.xp6(3),e.Q6J("ngModel",n.saveInfos.costmodeName)("disabled","update"===n.model),e.xp6(3),e.hij(" ",e.lcZ(19,15,"Note"),": "),e.xp6(3),e.Q6J("ngModel",n.saveInfos.note),e.xp6(2),e.Q6J("options",n.option),e.xp6(5),e.Oqu(e.lcZ(29,17,"Back")),e.xp6(5),e.Oqu(e.lcZ(34,19,"Model")),e.xp6(3),e.Oqu(e.lcZ(37,21,"Submit")),e.xp6(5),e.Q6J("ngIf",n.tableHeaders&&n.tableHeaders.length),e.xp6(2),e.Q6J("ngForOf",n.saveInfos.items),e.xp6(16),e.hij(" ",n.message," ")}},dependencies:[p.mk,p.sg,p.O5,c._Y,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.JL,c.Q7,c.On,c.F,C.Uo,C._C,C.Om,C.p0,C.$Z,ne._w,k.oB,u.X$],styles:["[_nghost-%COMP%]     .m-datatable__table{min-height:initial!important}.btn-color-white[_ngcontent-%COMP%], .btn-color-purple[_ngcontent-%COMP%]{width:120px!important}.btn-color-white[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #dcdcdc;color:#6f6f6f;margin-right:30px}.btn-color-purple[_ngcontent-%COMP%]{background-color:#5866dd;border:1px solid #5866dd;color:#fff}.btn-color-purple[_ngcontent-%COMP%]:active{background-color:#5866dd}.la-plus-circle[_ngcontent-%COMP%]:hover, .la-close[_ngcontent-%COMP%]:hover, .la-pencil[_ngcontent-%COMP%]:hover{color:#5866dd;cursor:pointer}.myModelClass[_ngcontent-%COMP%]{max-width:600px!important}"]}),i})();var st=s(52746),oe=s(50007),ct=s(49651);function dt(i,r){if(1&i&&e._uU(0),2&i){const t=r.range;e.lnq(" ",t[0],"-",t[1]," of ",r.$implicit," items ")}}function pt(i,r){if(1&i&&(e.TgZ(0,"th",5),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("nzWidth",r.last?"100px":""),e.xp6(1),e.Oqu(t.text)}}function mt(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"span")(1,"label",9)(2,"input",10),e.NdJ("change",function(){e.CHM(t);const o=e.oxw(2).$implicit,a=e.oxw();return e.KtG(a.onlyOneValue(o.costmodeId))}),e.qZA()()()}if(2&i){const t=e.oxw(2).$implicit,n=e.oxw();e.xp6(2),e.MGl("name","tariff",t.costmodeId,""),e.s9C("value",t.costmodeId),e.Q6J("checked",n.currentlyChecked==t.costmodeId)}}function ft(i,r){if(1&i&&(e.TgZ(0,"span")(1,"span"),e._uU(2),e.qZA()()),2&i){const t=e.oxw().$implicit,n=e.oxw().$implicit;e.xp6(2),e.Oqu(n[t.column]?n[t.column].join():"")}}function _t(i,r){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&i){const t=e.oxw().$implicit,n=e.oxw().$implicit;let o;e.xp6(1),e.hij(" ",e.lcZ(2,1,null!==(o=n[t.column])&&void 0!==o?o:n.createdDate)," ")}}function gt(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",17),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(4).$implicit,a=e.oxw();return e.KtG(a.openModal(o))}),e._UZ(1,"i",18),e.qZA()}}const ht=function(){return["/tariffs/edit"]},ae=function(){return{type:"evc",vehicleType:"evc",model:"update"}};function ut(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",13)(1,"a",14),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3).index,a=e.oxw();return e.KtG(a.setValueToDetail(o))}),e._UZ(2,"i",15),e.qZA(),e.YNc(3,gt,2,0,"a",16),e.qZA()}if(2&i){const t=e.oxw(4);e.xp6(1),e.Q6J("routerLink",e.DdM(3,ht))("queryParams",e.DdM(4,ae)),e.xp6(2),e.Q6J("ngIf",t.showDelete)}}const Tt=function(){return["/tariffs/create"]};function vt(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",14),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3).index,a=e.oxw();return e.KtG(a.setValueToDetail(o))}),e._UZ(1,"i",19),e.qZA()}2&i&&e.Q6J("routerLink",e.DdM(2,Tt))("queryParams",e.DdM(3,ae))}function Ct(i,r){if(1&i&&(e.TgZ(0,"span"),e.YNc(1,ut,4,5,"div",11),e.YNc(2,vt,2,4,"a",12),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",!t.createCarpark),e.xp6(1),e.Q6J("ngIf",t.createCarpark&&!t.selectTariff)}}function Zt(i,r){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit,n=e.oxw().$implicit;e.xp6(1),e.Oqu(n[t.column])}}function xt(i,r){if(1&i&&(e.ynx(0),e.TgZ(1,"td"),e.ynx(2,6),e.YNc(3,mt,3,3,"span",7),e.YNc(4,ft,3,1,"span",7),e.YNc(5,_t,3,3,"span",7),e.YNc(6,Ct,3,2,"span",7),e.YNc(7,Zt,2,1,"span",8),e.BQk(),e.qZA(),e.BQk()),2&i){const t=r.$implicit;e.xp6(2),e.Q6J("ngSwitch",t.column),e.xp6(1),e.Q6J("ngSwitchCase","checkbox"),e.xp6(1),e.Q6J("ngSwitchCase","carParkList"),e.xp6(1),e.Q6J("ngSwitchCase","createDate"),e.xp6(1),e.Q6J("ngSwitchCase","action")}}function Mt(i,r){if(1&i&&(e.ynx(0),e.TgZ(1,"tr"),e.YNc(2,xt,8,5,"ng-container",4),e.qZA(),e.BQk()),2&i){const t=r.index,n=e.oxw();e.xp6(1),e.ekj("ant-table-row-odd",t%2==1),e.xp6(1),e.Q6J("ngForOf",n.tableHeaders)}}let re=(()=>{class i extends st.t{constructor(t,n,o,a,l){super(),this.evcService=t,this.router=n,this.nzModalService=o,this.nzMessageService=a,this.datePipe=l,this.tableHeaders=[{text:"Tariff Name",width:"100px",column:"costmodeName"},{text:"Vehicle Type",width:"120px",column:"vehicleTypeCode"},{text:"Tariff Type",width:"100px",column:"tariffTypeCode"},{text:"Car Parks",width:"100px",column:"carParkList"},{text:"Date Created",width:"100px",column:"createDate"},{text:"Actions",width:"80px",column:"action"}],this.selected=new e.vpe,this.deleteModalOptions={title:"Do you want to delete this tariff?",message:"This can not be reverted"},this.showDelete=!0,-1!==this.router.url.indexOf("carparks")&&(this.showDelete=!1)}ngOnInit(){this.carparkId&&this.getInitialData(),this.selectedCostmode&&0!==this.selectedCostmode.length&&(this.costmodeId=this.selectedCostmode[0].costmodeId),this.createCarpark&&(this.tableHeaders.unshift({text:"",align:Z.iW.Center,width:"40px",column:"checkbox"}),this.tableHeaders.splice(4,1)),this.selectTariff&&(this.tableHeaders.unshift({text:"",align:Z.iW.Center,width:"40px",column:"checkbox"}),this.tableHeaders=this.tableHeaders.filter(t=>"Car Parks"!==t.text&&"Actions"!==t.text)),this.reloadData()}get filterParams(){let t=JSON.parse(localStorage.getItem("user"));return{companyName:"",costmodeName:"",pageNum:this.pagination.page,pageSize:this.pagination.rowsPerPage,ownerId:t.ownerId||""}}reloadData(t){this.loading=!0;const n=t?t.replace(/^\s+|\s+$/g,""):"",o={...this.filterParams,costmodeName:n};this.evcService.getAllCostModel(o).subscribe(a=>{this.loading=!1,"00000"==a.messageCode?(this.pagination.totalCount=a.data.totalElements,this.pagination.page=a.data.pageNumber,this.pagination.rowsPerPage=a.data.pageSize,this.costmodeId&&!this.selectTariff?(this.listData=a.data.content.filter(l=>l.costmodeId==this.costmodeId),this.pagination.totalCount=this.listData.length,this.pagination.page=a.data.pageNumber,this.pagination.rowsPerPage=a.data.pageSize):this.listData=a.data.content,this.currentlyChecked=this.costmodeId):(this.loading=!1,this.listData=[],this.pagination={...this.pagination,totalCount:0})},()=>{this.loading=!1,this.listData=[],this.pagination={...this.pagination,totalCount:0}})}pageChanged(t){this.pagination=t,this.reloadData()}setValueToDetail(t){const{companyId:n,costmodeDescription:o,costmodeId:a,costmodeName:l,list:d}=this.listData[t],m=d.map(f=>{const T=this.timeFormat(f.startTime),v=this.timeFormat(f.endTime);return{startTime:T,endTime:v,id:f.id,costType:f.costType,duration:x(v,"hh:mm").diff(x(T,"hh:mm"),"hour"),powerPrice:f.price,serviceFee:f.servcieFee}});localStorage.setItem("curCostmode",JSON.stringify({companyId:n,costmodeId:a,costmodeName:l,note:o,items:m,delete_items:[]}))}timeFormat(t){const n=new Date(t);let o=n.getMinutes();return 1===o.toString().length&&(o="0"+o),o=`${n.getHours()}:${o}`,o}evcEvcTariff(){return this.listData.filter(n=>this.currentlyChecked==n.costmodeId)}onlyOneValue(t){this.currentlyChecked=this.currentlyChecked!==t?t:""}alert(t){this.nzMessageService.error(t)}deleteEvcTariff(){const{costmodeId:t,companyId:n}=this.selectedTariff;this.evcService.delCostModel({delete_arr:[t]}).subscribe(o=>{"00000"==o.messageCode?this.evcService.delElectricPrice({delete_arr:[n]}).subscribe(a=>{"00000"==a.messageCode?this.reloadData():this.alert(`${a.messageCode} : Delete EVC tariffs failed`)}):this.alert(`${o.messageCode} : Delete EVC tariffs failed`)},()=>{this.alert("Exception : Delete EVC tariffs failed")})}getInitialData(){this.evcService.getCarparkEvc({carparkId:this.carparkId}).subscribe(n=>{"00000"==n.messageCode?this.costmodeId=n.data.costmodeId:"99999"==n.messageCode&&(this.costmodeId="null")})}openModal(t){this.selectedTariff=t,this.nzModalService.confirm({nzTitle:"Do you want to delete this tariff?",nzContent:"This can not be reverted",nzOnOk:()=>this.deleteEvcTariff()})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(P.z$),e.Y36(_.F0),e.Y36(oe.Sf),e.Y36(ct.dD),e.Y36(p.uU))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-evc-tariff-table"]],inputs:{createCarpark:"createCarpark",selectTariff:"selectTariff",carparkId:"carparkId",selectedCostmode:"selectedCostmode"},outputs:{selected:"selected"},features:[e._Bn([p.uU]),e.qOj],decls:9,vars:10,consts:[["rangeTemplate",""],[3,"nzData","nzFrontPagination","nzLoading","nzTotal","nzPageSize","nzPageIndex","nzShowSizeChanger","nzShowTotal","nzQueryParams"],["basicTable",""],[3,"nzWidth",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"nzWidth"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"m-checkbox","m-checkbox--single","m-checkbox--solid","m-checkbox--brand","m--valign-middle"],["type","checkbox",3,"name","value","checked","change"],["style","width: 82px",4,"ngIf"],["class","btn btn-outline-primary m-btn m-btn--icon m-btn--icon-only m-btn--custom m-btn--pill no-border",3,"routerLink","queryParams","click",4,"ngIf"],[2,"width","82px"],[1,"btn","btn-outline-primary","m-btn","m-btn--icon","m-btn--icon-only","m-btn--custom","m-btn--pill","no-border",3,"routerLink","queryParams","click"],[1,"la","la-edit"],["class","btn btn-outline-primary m-btn m-btn--icon m-btn--icon-only m-btn--custom m-btn--pill no-border",3,"click",4,"ngIf"],[1,"btn","btn-outline-primary","m-btn","m-btn--icon","m-btn--icon-only","m-btn--custom","m-btn--pill","no-border",3,"click"],[1,"la","la-close"],[1,"la","la-eye"]],template:function(t,n){if(1&t&&(e.YNc(0,dt,1,3,"ng-template",null,0,e.W1O),e.TgZ(2,"nz-table",1,2),e.NdJ("nzQueryParams",function(a){return n.onQueryParamsChange(a)}),e.TgZ(4,"thead")(5,"tr"),e.YNc(6,pt,2,2,"th",3),e.qZA()(),e.TgZ(7,"tbody"),e.YNc(8,Mt,3,3,"ng-container",4),e.qZA()()),2&t){const o=e.MAs(1),a=e.MAs(3);e.xp6(2),e.Q6J("nzData",n.listData)("nzFrontPagination",!1)("nzLoading",n.loading)("nzTotal",n.pagination.totalCount)("nzPageSize",n.pagination.rowsPerPage)("nzPageIndex",n.pagination.page)("nzShowSizeChanger",!0)("nzShowTotal",o),e.xp6(4),e.Q6J("ngForOf",n.tableHeaders),e.xp6(2),e.Q6J("ngForOf",a.data)}},dependencies:[p.sg,p.O5,p.RF,p.n9,p.ED,C.N8,C.Uo,C._C,C.Om,C.p0,C.$Z,_.yS,p.uU]}),i})();function bt(i){return new te.w(i,"../assets/i18n/",".json")}let At=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[q.K],imports:[p.ez,c.u5,O.D,_.Bz,pe.kn,N.Db,J.UU,$.x,Ve.vO,W.A0,ne.Ns.forRoot({echarts:()=>s.e(4734).then(s.bind(s,14734))}),k.zk.forRoot(),u.aw.forChild({loader:{provide:u.Zw,useFactory:bt,deps:[Y.eN]}})]}),i})();function yt(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-tariffs-form-main",2),e.NdJ("submitted",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.submit(o))})("canceled",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.cancel())}),e.qZA()}}function wt(i,r){if(1&i&&e._UZ(0,"app-tariffs-form-evc",3),2&i){const t=e.oxw();e.Q6J("model",t.model)}}let E=(()=>{class i{constructor(t,n,o){this.router=t,this.route=n,this.tariffService=o}ngOnInit(){this.type=this.route.snapshot.queryParams.type,this.model=this.route.snapshot.queryParams.model}submit(t){this.tariffService.createModel(t).subscribe(()=>{this.router.navigate(["/tariffs"])})}cancel(){this.router.navigate(["/tariffs"])}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.F0),e.Y36(_.gz),e.Y36(w.K))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-tariffs-create"]],decls:2,vars:2,consts:[[3,"submitted","canceled",4,"ngIf"],[3,"model",4,"ngIf"],[3,"submitted","canceled"],[3,"model"]],template:function(t,n){1&t&&(e.YNc(0,yt,1,0,"app-tariffs-form-main",0),e.YNc(1,wt,1,1,"app-tariffs-form-evc",1)),2&t&&(e.Q6J("ngIf","evc"!==n.type),e.xp6(1),e.Q6J("ngIf","evc"===n.type))},dependencies:[p.O5,I,ie],encapsulation:2}),i})();var Ft=s(76916),qt=s(47423),Nt=s(66616),Jt=s(47044),Ut=s(21811),le=s(38231);function Lt(i,r){if(1&i&&(e._UZ(0,"nz-option",18),e.ALo(1,"titlecase")),2&i){const t=r.$implicit;e.Q6J("nzValue",t.value)("nzLabel",e.lcZ(1,2,t.value))}}function kt(i,r){if(1&i&&e._UZ(0,"nz-option",18),2&i){const t=r.$implicit;e.Q6J("nzValue",t.value)("nzLabel",t.value)}}function St(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",14)(1,"span",15),e._uU(2,"*"),e.qZA(),e.TgZ(3,"label"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"nz-select",16),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.vehicleType=o)}),e.YNc(7,Lt,2,4,"nz-option",17),e._UZ(8,"nz-option",18),e.qZA()(),e.TgZ(9,"div",14)(10,"span",15),e._uU(11,"*"),e.qZA(),e.TgZ(12,"label"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"nz-select",16),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.type=o)}),e.YNc(16,kt,1,2,"nz-option",17),e._UZ(17,"nz-option",18),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(4),e.hij("",e.lcZ(5,10,"Vehicle Type"),":"),e.xp6(2),e.Q6J("ngModel",t.vehicleType),e.xp6(1),e.Q6J("ngForOf",t.vehicleTypes$),e.xp6(1),e.Q6J("nzValue",t.vehicleTypeEVC.value)("nzLabel","EVC"),e.xp6(5),e.hij("",e.lcZ(14,12,"Tariff Type"),":"),e.xp6(2),e.Q6J("ngModel",t.type),e.xp6(1),e.Q6J("ngForOf",t.tariffTypes$),e.xp6(1),e.Q6J("nzValue",t.tariffTypeEVC.value)("nzLabel","EVC")}}function It(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.handleCancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",20),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.goNext())}),e._uU(4),e.ALo(5,"translate"),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,3,"Cancel")," "),e.xp6(2),e.Q6J("disabled",!t.vehicleType||!t.type),e.xp6(1),e.hij(" ",e.lcZ(5,5,"Next")," ")}}const Pt=function(){return["home-EVC"]};let Et=(()=>{class i extends Z.Gw{constructor(t,n,o,a,l,d){super(),this.router=t,this.route=n,this.tariffService=o,this.codeTablesService=a,this.translate=l,this.nzModalService=d,this.tableHeaders=[{text:"#",align:Z.iW.Center,width:"40px"},{text:"Tariff ID",width:"120px"},{text:"Tariff Name",width:"100px"},{text:"Vehicle Type",width:"120px"},{text:"Tariff Type",width:"100px"},{text:"Car Parks",width:"100px"},{text:"Date Created",width:"110px"},{text:"Actions",width:"80px"}],this.vehicleIcon=h.mts,this.type=null,this.vehicleType=null,this.vehicleTypeFilter="",this.tariffType="",this.keyword$=new F.xQ,this.vehicleTypeEVC=h.wxy,this.tariffTypeEVC=h.oJe,this.codeTablesService.filterModelByType(h.BcL.VehicleType).subscribe(f=>{this.vehicleTypes$=f,this.tariffService.tariffEventer.emit([this.vehicleTypes$,this.tariffTypes$])}),this.codeTablesService.filterModelByType(h.BcL.TariffType).subscribe(f=>{this.tariffTypes$=f,this.tariffService.tariffEventer.emit([this.vehicleTypes$,this.tariffTypes$])}),this.keyword$.debounceTime(500).subscribe(()=>{this.reloadData()});const m=this.tableHeaders.map(f=>f.text);this.translate.get(m).subscribe(f=>{this.tableHeaders.forEach(T=>{for(const v in f)f.hasOwnProperty(v)&&T.text===v&&(T.text=f[v])})})}get filterParams(){return{vehicleTypeId:this.vehicleTypeFilter,tariffTypeId:this.tariffType,keyword:this.keyword}}onSubmitted(){}onCanceled(){}reloadData(){this.reloadDataService(this.tariffService)}openModal(t,n){this.modalIns=this.nzModalService.create({nzTitle:"Create Tariff",nzContent:t,nzFooter:n})}handleCancel(){this.modalIns.destroy()}pageChanged(t){this.pagination=t,this.reloadData()}goNext(){this.modalIns.destroy(),"EVC"===this.vehicleType?this.router.navigate(["createEvc"],{relativeTo:this.route,queryParams:{type:"evc",vehicleType:"evc",model:"add"}}):this.router.navigate(["create"],{relativeTo:this.route,queryParams:{type:this.type,vehicleType:this.vehicleType}})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.F0),e.Y36(_.gz),e.Y36(w.K),e.Y36(y.I),e.Y36(u.sK),e.Y36(oe.Sf))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-tariffs-home"]],features:[e.qOj],decls:21,vars:6,consts:[[1,"body-wrapper"],["nz-button","","nzType","primary","nzSize","large","nzShape","round",3,"click"],["nz-icon","","nzType","plus","nzTheme","outline"],[1,"m-content"],[1,"m-portlet","m-portlet--tabs"],[1,"m-portlet__head"],[1,"m-portlet__head-tools"],["role","tablist",1,"nav","nav-tabs","m-tabs-line","m-tabs-line--primary","m-tabs-line--2x"],[1,"nav-item","m-tabs__item"],[1,"nav-link","m-tabs__link",3,"routerLink","routerLinkActive"],[1,"m-portlet__body","m-portlet__body--scrollable"],[1,"m-portlet__frame"],["template",""],["tplFooter",""],[1,"form-group","m-form__group"],[1,"m--font-danger"],["nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"],["nz-button","",3,"click"],["nz-button","","nzType","primary",2,"margin-left","16px",3,"disabled","click"]],template:function(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"div",0)(1,"app-title-bar")(2,"button",1),e.NdJ("click",function(){e.CHM(o);const l=e.MAs(18),d=e.MAs(20);return e.KtG(n.openModal(l,d))}),e._UZ(3,"span",2),e._uU(4,"Create Tariff "),e.qZA()(),e.TgZ(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"ul",7)(10,"li",8)(11,"a",9),e._uU(12),e.ALo(13,"translate"),e.qZA()()()()(),e.TgZ(14,"div",10)(15,"div",11),e._UZ(16,"router-outlet"),e.qZA()()()()(),e.YNc(17,St,18,14,"ng-template",null,12,e.W1O),e.YNc(19,It,6,7,"ng-template",null,13,e.W1O)}2&t&&(e.xp6(11),e.Q6J("routerLink",e.DdM(5,Pt))("routerLinkActive","active"),e.xp6(1),e.hij(" ",e.lcZ(13,3,"EVC")," "))},dependencies:[p.sg,_.lC,_.yS,_.Od,Ft.G,qt.Ls,Nt.ix,Jt.w,Ut.dQ,le.Ip,le.Vq,c.JJ,c.On,p.rS,u.X$],encapsulation:2}),i})(),Qt=(()=>{class i{constructor(t,n,o){this.router=t,this.route=n,this.tariffService=o}ngOnInit(){this.tariff=this.route.snapshot.data.tariff}submit(t){this.tariffService.updateModel(t).subscribe(()=>{this.router.navigate(["/tariffs"])})}cancel(){this.router.navigate(["/tariffs"])}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.F0),e.Y36(_.gz),e.Y36(w.K))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-tariffs-update"]],decls:1,vars:0,consts:[[3,"submitted","canceled"]],template:function(t,n){1&t&&(e.TgZ(0,"app-tariffs-form-main",0),e.NdJ("submitted",function(a){return n.submit(a)})("canceled",function(){return n.cancel()}),e.qZA())},dependencies:[I],encapsulation:2}),i})();var Ht=s(60097),Q=s(67527),jt=s(35635);const Ot=["childModal"],$t=["evcTable"];function zt(i,r){if(1&i&&(e.TgZ(0,"option",14),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.value)," ")}}function Gt(i,r){if(1&i&&(e.TgZ(0,"option",14),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.value)," ")}}function Dt(i,r){1&i&&(e.TgZ(0,"span",27),e._UZ(1,"span",28),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&i&&(e.xp6(2),e.hij(" \xa0",e.lcZ(3,1,"Normal")," "))}function Rt(i,r){1&i&&(e.TgZ(0,"span",29),e._UZ(1,"span",30),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&i&&(e.xp6(2),e.hij(" \xa0",e.lcZ(3,1,"Season")," "))}function Kt(i,r){1&i&&(e.TgZ(0,"span",31),e._UZ(1,"span",32),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&i&&(e.xp6(2),e.hij(" \xa0",e.lcZ(3,1,"Adhoc")," "))}function Vt(i,r){if(1&i&&(e.TgZ(0,"span",27),e._UZ(1,"span",28),e._uU(2),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(2),e.hij(" \xa0",t.tariffTypeCode," ")}}const Bt=function(i){return[i]};function Wt(i,r){if(1&i&&(e.TgZ(0,"td",15)(1,"span"),e._uU(2),e.qZA()(),e.TgZ(3,"td",16)(4,"span"),e._uU(5),e.qZA()(),e.TgZ(6,"td",16)(7,"span"),e._uU(8),e.qZA()(),e.TgZ(9,"td",16)(10,"span")(11,"span"),e._UZ(12,"img",17),e.qZA(),e.TgZ(13,"span"),e._uU(14),e.qZA()()(),e.TgZ(15,"td",16)(16,"span",18),e.YNc(17,Dt,4,3,"span",19),e.YNc(18,Rt,4,3,"span",20),e.YNc(19,Kt,4,3,"span",21),e.YNc(20,Vt,3,1,"span",22),e.qZA()(),e.TgZ(21,"td",16)(22,"span"),e._uU(23),e.qZA()(),e.TgZ(24,"td",16)(25,"span"),e._uU(26),e.ALo(27,"date"),e.qZA()(),e.TgZ(28,"td",23)(29,"span",24)(30,"a",25),e._UZ(31,"i",26),e.qZA()()()),2&i){const t=r.$implicit,n=e.oxw();e.xp6(1),e.Udp("width",n.tableHeaders[0].width),e.xp6(1),e.hij(" ",t.id," "),e.xp6(2),e.Udp("width",n.tableHeaders[1].width),e.xp6(1),e.hij(" ",t.id," "),e.xp6(2),e.Udp("width",n.tableHeaders[2].width),e.xp6(1),e.hij(" ",t.name," "),e.xp6(2),e.Udp("width",n.tableHeaders[3].width),e.xp6(2),e.Q6J("src",n.vehicleIcon(t.vehicleTypeCode),e.LSH),e.xp6(2),e.Oqu(t.vehicleTypeCode),e.xp6(2),e.Udp("width",n.tableHeaders[4].width),e.Q6J("ngSwitch",t.tariffTypeCode),e.xp6(1),e.Q6J("ngSwitchCase","Normal"),e.xp6(1),e.Q6J("ngSwitchCase","Season"),e.xp6(1),e.Q6J("ngSwitchCase","Adhoc"),e.xp6(3),e.Udp("width",n.tableHeaders[5].width),e.xp6(1),e.hij(" ",null==t?null:t.carParkList.join(", ")," "),e.xp6(2),e.Udp("width",n.tableHeaders[6].width),e.xp6(1),e.hij(" ",e.xi3(27,28,t.createdDate,"d LLL yyyy")," "),e.xp6(3),e.Udp("width",n.tableHeaders[7].width),e.xp6(1),e.Q6J("routerLink",e.VKq(31,Bt,"/tariffs/"+t.id))}}function se(i){return new te.w(i,"../assets/i18n/",".json")}const en=[{path:"",component:Et,children:[{path:"",redirectTo:"home-EVC",pathMatch:"full"},{path:"home-EVC",component:(()=>{class i{constructor(t,n,o){this.route=t,this.translate=n,this.communicationWithHeader=o,this.tableHeaders=[{text:"#",align:Z.iW.Center,width:"40px"},{text:"Tariff ID",width:"120px"},{text:"Tariff Name",width:"100px"},{text:"Vehicle Type",width:"120px"},{text:"Tariff Type",width:"100px"},{text:"Car Parks",width:"100px"},{text:"Date Created",width:"100px"},{text:"Actions",width:"80px"}],this.vehicleIcon=h.mts,this.type=null,this.vehicleTypeFilter="",this.tariffType="",this.keyword="",this.keyword$=new F.xQ;const a=this.tableHeaders.map(l=>l.text);this.translate.get(a).subscribe(l=>{this.tableHeaders.forEach(d=>{for(const m in l)l.hasOwnProperty(m)&&d.text===m&&(d.text=l[m])})})}alert(t){this.message=t,this.childModal.show()}ngOnInit(){this.route.data.subscribe(t=>{this.communicationWithHeader.sentMessages(t.breadcrumb.title)})}searchTariff(t){this.evcTable.reloadData(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.gz),e.Y36(u.sK),e.Y36(Q.Z))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-tariffs-home-evc"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Ot,5),e.Gf($t,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.childModal=o.first),e.iGM(o=e.CRH())&&(n.evcTable=o.first)}},decls:9,vars:4,consts:[[1,"form-group","m-form__group","m-portlet__filters"],[1,"filter-wrap"],[1,"filter-item"],[1,"filter-label"],["type","text","nz-input","","placeholder","Tariff Name",2,"width","160px",3,"ngModel","ngModelChange"],["evcTable",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"input",4),e.NdJ("ngModelChange",function(a){return n.keyword=a})("ngModelChange",function(a){return n.searchTariff(a)}),e.qZA()()()(),e._UZ(7,"app-evc-tariff-table",null,5)),2&t&&(e.xp6(4),e.hij("",e.lcZ(5,2,"Tariff Name"),":"),e.xp6(2),e.Q6J("ngModel",n.keyword))},dependencies:[jt.Zp,re,c.Fj,c.JJ,c.On,u.X$],encapsulation:2}),i})(),data:{breadcrumb:{label:"EVC"}}},{path:"home-carpark",component:(()=>{class i extends Z.Gw{constructor(t,n,o,a,l){super(),this.route=t,this.tariffService=n,this.codeTablesService=o,this.translate=a,this.communicationWithHeader=l,this.tableHeaders=[{text:"#",align:Z.iW.Center,width:"40px"},{text:"Tariff ID",width:"120px"},{text:"Tariff Name",width:"100px"},{text:"Vehicle Type",width:"120px"},{text:"Tariff Type",width:"100px"},{text:"Car Parks",width:"100px"},{text:"Date Created",width:"100px"},{text:"Actions",width:"80px"}],this.vehicleIcon=h.mts,this.type=null,this.vehicleTypeFilter="",this.tariffType="",this.keyword$=new F.xQ,this.defaultValue="All",this.keyword$.debounceTime(500).subscribe(()=>{this.reloadData()});const d=this.tableHeaders.map(m=>m.text);this.translate.get(d).subscribe(m=>{this.tableHeaders.forEach(f=>{for(const T in m)m.hasOwnProperty(T)&&f.text===T&&(f.text=m[T])})}),n.tariffEventer.subscribe(m=>{this.vehicleTypes$=m[0],this.tariffTypes$=m[1]})}get filterParams(){return{vehicleTypeId:"All"==this.vehicleTypeFilter?"":this.vehicleTypeFilter,tariffTypeId:"All"==this.tariffType?"":this.tariffType,keyword:this.keyword}}onSubmitted(){}onCanceled(){}reloadData(){this.reloadDataService(this.tariffService)}pageChanged(t){this.pagination=t,this.reloadData()}ngOnInit(){this.reloadData(),this.route.data.subscribe(t=>{this.communicationWithHeader.sentMessages(t.breadcrumb.title)})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.gz),e.Y36(w.K),e.Y36(y.I),e.Y36(u.sK),e.Y36(Q.Z))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-tariffs-home-carpark"]],features:[e.qOj],decls:35,vars:25,consts:[[1,"form-group","m-form__group","m-portlet__filters"],[1,"m-portlet__filter"],[1,"col-form-label"],["name","vehicle",1,"form-control","m-input",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["name","tariff",1,"form-control","m-input",3,"ngModel","ngModelChange"],[1,"m-input-icon","m-input-icon--left"],["type","text","placeholder","",1,"form-control","m-input",3,"ngModel","ngModelChange"],[1,"m-input-icon__icon","m-input-icon__icon--left"],[1,"la","la-search"],[3,"headers","items","loading","scrollingDisabled","pagination","pageChanged"],["listTable",""],["rowTemplate",""],[3,"value"],[1,"m-datatable__cell","text-center"],[1,"m-datatable__cell"],["alt","",3,"src"],[1,"m--font-bolder",3,"ngSwitch"],["class","m--font-info",4,"ngSwitchCase"],["class","m--font-primary",4,"ngSwitchCase"],["class","m--font-warning",4,"ngSwitchCase"],["class","m--font-info",4,"ngSwitchDefault"],[1,"m-datatable__cell","action-cell"],[1,"cell-actions"],[1,"btn","btn-outline-primary","m-btn","m-btn--icon","m-btn--icon-only","m-btn--custom","m-btn--pill","no-border",3,"routerLink"],[1,"la","la-edit"],[1,"m--font-info"],[1,"m-badge","m-badge--info","m-badge--dot"],[1,"m--font-primary"],[1,"m-badge","m-badge--primary","m-badge--dot"],[1,"m--font-warning"],[1,"m-badge","m-badge--warning","m-badge--dot"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div")(6,"select",3),e.NdJ("ngModelChange",function(a){return n.vehicleTypeFilter=a})("ngModelChange",function(){return n.reloadData()}),e.TgZ(7,"option",4),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.YNc(10,zt,3,4,"option",5),e.qZA()()(),e.TgZ(11,"div",1)(12,"label",2),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"div")(16,"select",6),e.NdJ("ngModelChange",function(a){return n.tariffType=a})("ngModelChange",function(){return n.reloadData()}),e.TgZ(17,"option",4),e._uU(18),e.ALo(19,"translate"),e.qZA(),e.YNc(20,Gt,3,4,"option",5),e.qZA()()(),e.TgZ(21,"div",1)(22,"label",2),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"div")(26,"div",7)(27,"input",8),e.NdJ("ngModelChange",function(a){return n.keyword=a})("ngModelChange",function(a){return n.keyword$.next(a)}),e.qZA(),e.TgZ(28,"span",9)(29,"span"),e._UZ(30,"i",10),e.qZA()()()()()(),e.TgZ(31,"app-datatable",11,12),e.NdJ("pageChanged",function(a){return n.pageChanged(a)}),e.YNc(33,Wt,32,33,"ng-template",null,13,e.W1O),e.qZA()),2&t&&(e.xp6(3),e.hij(" ",e.lcZ(4,15,"Vehicle Type"),": "),e.xp6(3),e.Q6J("ngModel",n.vehicleTypeFilter),e.xp6(2),e.hij(" ",e.lcZ(9,17,"All")," "),e.xp6(2),e.Q6J("ngForOf",n.vehicleTypes$),e.xp6(3),e.hij(" ",e.lcZ(14,19,"Tariff Type"),": "),e.xp6(3),e.Q6J("ngModel",n.tariffType),e.xp6(2),e.hij(" ",e.lcZ(19,21,"All")," "),e.xp6(2),e.Q6J("ngForOf",n.tariffTypes$),e.xp6(3),e.hij(" ",e.lcZ(24,23,"Tariff Name"),": "),e.xp6(4),e.Q6J("ngModel",n.keyword),e.xp6(4),e.Q6J("headers",n.tableHeaders)("items",n.data)("loading",n.loading)("scrollingDisabled",!0)("pagination",n.pagination))},dependencies:[p.sg,p.RF,p.n9,p.ED,_.yS,C.Uo,Z.nE,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.On,p.rS,p.uU,u.X$],encapsulation:2}),i})(),data:{breadcrumb:{label:"Carpark"}}},{path:"create",component:E,data:{breadcrumb:{label:"Create"}}},{path:"createEvc",component:E,data:{breadcrumb:{label:"Create"}}},{path:"edit",component:E,data:{breadcrumb:{label:"Edit"}}},{path:":id",component:Qt,data:{breadcrumb:{label:"Update"}},resolve:{tariff:j.E}}]}];let tn=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[ce.k,de.e,w.K,j.E,y.I,Ht.x,Q.Z,P.z$],imports:[p.ez,_.Bz.forChild(en),$.x,O.D,At,k.zk.forRoot(),c.u5,u.aw.forChild({loader:{provide:u.Zw,useFactory:se,deps:[Y.eN]}}),_.Bz]}),i})()}}]);