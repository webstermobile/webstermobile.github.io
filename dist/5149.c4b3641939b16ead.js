"use strict";(self.webpackChunkst_admin=self.webpackChunkst_admin||[]).push([[5149,2946],{77407:(L,A,n)=>{n.d(A,{B:()=>Z});var C=n(65136),p=n(92340),_=n(94650),y=n(80529),M=n(28555),E=n(91599);let Z=(()=>{class x extends C.b{constructor(s,c,u){super(s,c),this.http=s,this.store=c,this.baseUrl="carpark/api/dashboard-statistics",this.baseUrl02="batchservice/api/dashboard-statistics",this.baseUr3="carpark/api/evDashboard",this.handleError=u.createHandleError("StatisticService")}getOverallStatistics(s){const c=this.getUrl(`${this.baseUrl02}/overall-statistics`);return this.post(c,s)}getDurationStatistics(s){const c=this.getUrl(`${this.baseUrl02}/overall-statistics`);return this.post(c,s)}getFaultStatistics(s){const c=this.getUrl(`${this.baseUrl}/fault`);return this.post(c,s)}getOccupancyStatistics(s){const c=this.getUrl(`${this.baseUrl02}/occupancy`);return this.post(c,s)}getOccupancyPrediction(s){const c=this.getUrl(`${this.baseUrl}/occupancy-prediction`);return this.post(c,s)}getDailyOccupancyStatistics(s){const c=this.getUrl(`${this.baseUrl02}/occupancy-per-day`);return this.post(c,s)}getMaxNormalSeasonalLotsStatistics(s){const c=this.getUrl(`${this.baseUrl02}/max-normal-seasonal-slots`);return this.post(c,s)}getRevenueStatistics(s){const c=this.getUrl(`${this.baseUrl02}/revenue`);return this.post(c,s).map(u=>({carParkId:u.carParkId,carParkCode:u.carParkCode,carParkRevenue:u.carParkRevenue}))}getTransactionStatistics(s){const c=this.getUrl(`${this.baseUrl02}/transaction`);return this.post(c,s)}getVehicleTypeStatistics(s){const c=this.getUrl(`${this.baseUrl02}/overall-statistics`);return this.post(c,s)}dashboardGetData(){return this.get(`${p.N.apiHost}/scp-mg-report/report/report/getHomePageReport`)}getDashboardFlag(){return this.get(`${p.N.apiHost}/carpark/api/userDashboardConfig`)}putDashboardFlag(s){return this.put(`${p.N.apiHost}/carpark/api/userDashboardConfig`,s)}getTransactionsEnergyRevenue(s,c){const u=this.getUrl(`carpark/api/evDashboard/totalAnalysisTransactionsEnergyRevenue?endDate=${c}&startDate=${s}`);return this.get(u)}getChargersUpDown(s,c){const u=this.getUrl(`carpark/api/evDashboard/totalAnalysisChargersUpDown?endDate=${c}&startDate=${s}`);return this.get(u)}getConnectorsTotalAvailableInuseDown(s,c){const u=this.getUrl(`carpark/api/evDashboard/totalAnalysisConnectorsTotalAvailableInuseDown?endDate=${c}&startDate=${s}`);return this.get(u)}getgetAverageFirst(s,c){const u=this.getUrl(`carpark/api/evDashboard/averageAnalysisEnergyRevenueOfSession?endDate=${c}&startDate=${s}`);return this.get(u)}getevRevenueAnalysis(s,c){const u=this.getUrl(`carpark/api/evDashboard/evRevenueAnalysis?endDate=${c}&startDate=${s}`);return this.get(u)}top10CarparwithHighest(s,c){const u=this.getUrl(`carpark/api/evDashboard/top10CarParkWithHighestRevenue?endDate=${c}&startDate=${s}`);return this.get(u)}}return x.\u0275fac=function(s){return new(s||x)(_.LFG(y.eN),_.LFG(M.yh),_.LFG(E.k))},x.\u0275prov=_.Yz7({token:x,factory:x.\u0275fac}),x})()},65149:(L,A,n)=>{n.r(A),n.d(A,{BusDashboardModule:()=>nt,createTranslateLoader:()=>k});var C=n(36895),p=n(80529),_=n(24006),y=n(34793),M=n(372),E=n(60097),Z=n(77407),x=n(30329),S=n(88796),s=n(89383),c=n(19832),u=n(70853),U=n(97640),b=n(20388),g=n(34984),o=n(21532),d=n(59501),f=n(80330),h=n(38014),B=n(21837),I=n(8929),z=n(72986),F=n(15439),t=n(94650),R=n(76916),w=n(40269),N=n(96599);const $=["barChartElement"];function j(r,m){if(1&r&&(t.TgZ(0,"div")(1,"div",15)(2,"div",16)(3,"div",17)(4,"div",18)(5,"div",19)(6,"div",20),t._uU(7," Total Transactions "),t.qZA(),t.TgZ(8,"div",21),t._uU(9),t.ALo(10,"number"),t.qZA()()()()(),t.TgZ(11,"div",22)(12,"div",23)(13,"div",18)(14,"div",19)(15,"div",20),t._uU(16," Total Number of Chargers "),t.qZA(),t.TgZ(17,"div",15)(18,"div",24)(19,"p",25),t._uU(20),t.qZA(),t.TgZ(21,"p",26),t._uU(22,"Total"),t.qZA()(),t.TgZ(23,"div",24)(24,"p",27),t._uU(25),t.qZA(),t.TgZ(26,"p",26),t._uU(27,"Up"),t.qZA()(),t.TgZ(28,"div",24)(29,"p",28),t._uU(30),t.qZA(),t.TgZ(31,"p",26),t._uU(32,"Down"),t.qZA()()()()()()(),t.TgZ(33,"div",29)(34,"div",30)(35,"div",18)(36,"div",19)(37,"div",20),t._uU(38," Energy Used ("),t.TgZ(39,"span",31),t._uU(40,"kWh"),t.qZA(),t._uU(41,") "),t.qZA(),t.TgZ(42,"div",32),t._uU(43),t.ALo(44,"number"),t.qZA()()()()(),t.TgZ(45,"div",33)(46,"div",30)(47,"div",34)(48,"div",19)(49,"div",35),t._uU(50," Total Number of Connectors "),t.qZA(),t.TgZ(51,"div",15)(52,"div",36)(53,"p",37),t._uU(54),t.qZA(),t.TgZ(55,"p",38),t._uU(56,"Total"),t.qZA()(),t.TgZ(57,"div",36)(58,"p",39),t._uU(59),t.qZA(),t.TgZ(60,"p",38),t._uU(61,"Available "),t.qZA()(),t.TgZ(62,"div",36)(63,"p",40),t._uU(64),t.qZA(),t.TgZ(65,"p",38),t._uU(66,"In-use"),t.qZA()(),t.TgZ(67,"div",36)(68,"p",41),t._uU(69),t.qZA(),t.TgZ(70,"p",38),t._uU(71,"Down"),t.qZA()()()()()()()()()),2&r){const e=t.oxw();t.Gre("m--padding-right-10 flex-column ",e.showDashbord.parking?"col-lg-6":"col-lg-12",""),t.xp6(9),t.hij(" ",t.lcZ(10,12,null==e.dashboardData||null==e.dashboardData.statisticsData?null:e.dashboardData.statisticsData.totalTransactions)||0," "),t.xp6(11),t.Oqu(null==e.dashboardData||null==e.dashboardData.statisticsData?null:e.dashboardData.statisticsData.chargers.total),t.xp6(5),t.Oqu(null==e.dashboardData||null==e.dashboardData.statisticsData?null:e.dashboardData.statisticsData.chargers.up),t.xp6(5),t.Oqu(null==e.dashboardData||null==e.dashboardData.statisticsData?null:e.dashboardData.statisticsData.chargers.down),t.xp6(13),t.hij(" ",t.lcZ(44,14,null==e.dashboardData||null==e.dashboardData.statisticsData||null==e.dashboardData.statisticsData.energyUsed?null:e.dashboardData.statisticsData.energyUsed.value)," "),t.xp6(11),t.Oqu(null==e.dashboardData||null==e.dashboardData.statisticsData||null==e.dashboardData.statisticsData.connectors?null:e.dashboardData.statisticsData.connectors.total),t.xp6(5),t.hij(" ",null==e.dashboardData||null==e.dashboardData.statisticsData||null==e.dashboardData.statisticsData.connectors?null:e.dashboardData.statisticsData.connectors.available,""),t.xp6(5),t.hij("",null==e.dashboardData||null==e.dashboardData.statisticsData||null==e.dashboardData.statisticsData.connectors?null:e.dashboardData.statisticsData.connectors.use," "),t.xp6(5),t.Oqu(null==e.dashboardData||null==e.dashboardData.statisticsData||null==e.dashboardData.statisticsData.connectors?null:e.dashboardData.statisticsData.connectors.down)}}function Y(r,m){if(1&r){const e=t.EpF();t.TgZ(0,"div")(1,"div",42)(2,"div",43)(3,"div",44)(4,"div",45)(5,"h3",46),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"button",47),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.showItem("status",l.showDashbord.status))}),t._UZ(9,"i",48),t.qZA()()()(),t.TgZ(10,"div",49)(11,"div",18)(12,"div",15)(13,"div",24)(14,"p",50),t._uU(15),t.qZA(),t.TgZ(16,"p"),t._uU(17,"Energy consumed (kWh)"),t.qZA()(),t.TgZ(18,"div",24)(19,"p",50),t._uU(20),t.qZA(),t.TgZ(21,"p"),t._uU(22,"Duration (mins)"),t.qZA()(),t.TgZ(23,"div",24)(24,"p",51),t._uU(25),t.qZA(),t.TgZ(26,"p"),t._uU(27,"SOC% at start"),t.qZA()()()()()()()}if(2&r){const e=t.oxw();t.Gre("",e.showDashbord.totalBoard?"col-lg-6":"col-lg-12"," flex-column"),t.xp6(6),t.hij(" ",t.lcZ(7,7,"Average charging session")," "),t.xp6(9),t.Oqu(null==e.dashboardData||null==e.dashboardData.statisticsData||null==e.dashboardData.statisticsData.chargeSession?null:e.dashboardData.statisticsData.chargeSession.consumed),t.xp6(5),t.Oqu(null==e.dashboardData||null==e.dashboardData.statisticsData||null==e.dashboardData.statisticsData.chargeSession?null:e.dashboardData.statisticsData.chargeSession.duration),t.xp6(5),t.hij(" ",null==e.dashboardData||null==e.dashboardData.statisticsData?null:e.dashboardData.statisticsData.chargeSession.soc,"")}}function G(r,m){if(1&r&&(t.TgZ(0,"div")(1,"div",15)(2,"div",52)(3,"div",53)(4,"div",54)(5,"div",43)(6,"div",44)(7,"div",55)(8,"h3",56),t._uU(9," Max temperature In Operation "),t.qZA()()()(),t.TgZ(10,"div")(11,"div",18)(12,"div",57)(13,"div",58),t._UZ(14,"div",59),t.qZA()()()()()(),t.TgZ(15,"div",53)(16,"div",60)(17,"div",43)(18,"div",44)(19,"div",55)(20,"h3",56),t._uU(21," Max temperature While Charging "),t.qZA()()()(),t.TgZ(22,"div")(23,"div",18)(24,"div",57)(25,"div",58),t._UZ(26,"div",59),t.qZA()()()()()()()()()),2&r){const e=t.oxw();t.Gre("",e.showDashbord.analysis?"col-lg-6":"col-lg-12"," m--padding-right-10"),t.xp6(14),t.Q6J("options",e.MaxTemperatureOperation),t.xp6(12),t.Q6J("options",e.MaxTemperatureCharging)}}function J(r,m){if(1&r){const e=t.EpF();t.TgZ(0,"div")(1,"div",30)(2,"div",43)(3,"div",44)(4,"div",45)(5,"h3",56),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"button",47),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.showItem("analysis",l.showDashbord.analysis))}),t._UZ(9,"i",48),t.qZA()()()(),t.TgZ(10,"div",18)(11,"div",57)(12,"div",52),t._UZ(13,"div",61),t.qZA()()()()()}if(2&r){const e=t.oxw();t.Gre("",e.showDashbord.status?"col-lg-6":"col-lg-12"," m--padding-right-10"),t.xp6(6),t.hij(" ",t.lcZ(7,5,"Maximum Temperatures by Day (\xb0C)")," "),t.xp6(7),t.Q6J("options",e.leakageOption)}}function H(r,m){if(1&r&&(t.TgZ(0,"th",72),t._uU(1),t.qZA()),2&r){const e=m.$implicit;t.xp6(1),t.hij(" ",e," ")}}function q(r,m){if(1&r&&(t.ynx(0),t.TgZ(1,"tr",73)(2,"td",74),t._uU(3),t.qZA(),t.TgZ(4,"td",75),t._uU(5),t.qZA(),t.TgZ(6,"td",75),t._uU(7),t.qZA(),t.TgZ(8,"td",75),t._uU(9),t.qZA(),t.TgZ(10,"td",75),t._uU(11),t.qZA(),t.TgZ(12,"td",75),t._uU(13),t.qZA(),t.TgZ(14,"td",75),t._uU(15),t.qZA(),t.TgZ(16,"td",75),t._uU(17),t.qZA(),t.TgZ(18,"td",75),t._uU(19),t.qZA(),t.TgZ(20,"td",75),t._uU(21),t.qZA()(),t.BQk()),2&r){const e=m.$implicit;t.xp6(3),t.hij(" ",e.batch," "),t.xp6(2),t.hij(" ",e.description," "),t.xp6(2),t.hij(" ",e.capacity," "),t.xp6(2),t.hij(" ",e.vehicles," "),t.xp6(2),t.hij(" ",e.average_consumption," "),t.xp6(2),t.hij(" ",e.average_regenerated," "),t.xp6(2),t.hij(" ",e.average_consume," "),t.xp6(2),t.hij(" ",e.average_duration," "),t.xp6(2),t.hij(" ",e.average_temp," "),t.xp6(2),t.hij(" ",e.average_temp_charging," ")}}function K(r,m){if(1&r&&(t.TgZ(0,"div",66)(1,"div",57)(2,"table",67)(3,"thead",68)(4,"tr",69),t.YNc(5,H,2,1,"th",70),t.qZA()(),t.TgZ(6,"tbody"),t.YNc(7,q,22,10,"ng-container",71),t.qZA()()()()),2&r){const e=t.oxw(2);t.xp6(5),t.Q6J("ngForOf",e.energyConsumptionHeaders),t.xp6(2),t.Q6J("ngForOf",e.energyReport)}}function W(r,m){if(1&r){const e=t.EpF();t.TgZ(0,"div",62)(1,"div",63)(2,"div",64)(3,"div",44)(4,"div",45)(5,"h3",56),t._uU(6," Energy Consumption by Model "),t.qZA(),t.TgZ(7,"button",47),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.parkingOccupancy.hidden=!l.parkingOccupancy.hidden)}),t._UZ(8,"i"),t.qZA()()()(),t.YNc(9,K,8,2,"div",65),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(8),t.Gre("la ",e.parkingOccupancy.hidden?"la-arrows":"la-minus-square",""),t.xp6(1),t.Q6J("ngIf",!e.parkingOccupancy.hidden)}}function Q(r,m){if(1&r&&(t.TgZ(0,"div",18)(1,"div",57)(2,"div",79)(3,"div",80,81),t._UZ(5,"div",61),t.qZA(),t.TgZ(6,"div",82),t._UZ(7,"div",61),t.qZA()()()()),2&r){const e=t.oxw(2);t.xp6(5),t.Q6J("options",e.energyCostOption),t.xp6(2),t.Q6J("options",e.energyCostChargedOption)}}function V(r,m){if(1&r){const e=t.EpF();t.TgZ(0,"div",76)(1,"div",77)(2,"div",43)(3,"div",44)(4,"div",45)(5,"h3",56),t._uU(6," Energy Cost Comparison "),t.qZA(),t.TgZ(7,"button",47),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.parkingOccupancy.hidden=!l.parkingOccupancy.hidden)}),t._UZ(8,"i"),t.qZA()()()(),t.YNc(9,Q,8,2,"div",78),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(8),t.Gre("la ",e.parkingOccupancy.hidden?"la-arrows":"la-minus-square",""),t.xp6(1),t.Q6J("ngIf",!e.parkingOccupancy.hidden)}}function X(r,m){if(1&r&&(t.TgZ(0,"div",18)(1,"div",57)(2,"div",79)(3,"div",52),t._UZ(4,"div",61),t.qZA()()()()),2&r){const e=t.oxw(2);t.xp6(4),t.Q6J("options",e.energyConsumptioSourceOption)}}function tt(r,m){if(1&r){const e=t.EpF();t.TgZ(0,"div",76)(1,"div",77)(2,"div",43)(3,"div",44)(4,"div",45)(5,"h3",56),t._uU(6," Energy Consumption by Source (kWh) "),t.qZA(),t.TgZ(7,"button",47),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.parkingOccupancy.hidden=!l.parkingOccupancy.hidden)}),t._UZ(8,"i"),t.qZA()()()(),t.YNc(9,X,5,1,"div",78),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(8),t.Gre("la ",e.parkingOccupancy.hidden?"la-arrows":"la-minus-square",""),t.xp6(1),t.Q6J("ngIf",!e.parkingOccupancy.hidden)}}function k(r){return new c.w(r,"../assets/i18n/",".json")}const at=[{path:"",component:d.f,children:[{path:"",component:(()=>{class r{constructor(e,a,l,i,v){this.router=e,this.statisticService=a,this.carparkService=l,this.translate=i,this.busService=v,this.resizeEvent$=new I.xQ,this.selectedCarParkId=null,this.timeRange={value:[B.ou.local().minus({weeks:1}).toJSDate(),new Date],type:h.Nxg.Day},this.barPadding=30,this.barDefaultWidth=12,this.fromCarParks=[],this.toCarParks=[],this.fromCarParkId=null,this.toCarParkId=null,this.dashBoardItem=null,this.compareTimeRange={value:[new Date,new Date],type:h.Nxg.Month},this.MaxTemperatureOperation={series:[{type:"gauge",center:["50%","40%"],startAngle:200,endAngle:-20,min:0,max:100,itemStyle:{color:"#000"},pointer:{show:!1},axisLine:{lineStyle:{width:15,color:[[1,"#ccc"]]}},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{show:!1},anchor:{show:!1},title:{show:!1},detail:{show:!1}},{type:"gauge",center:["50%","40%"],startAngle:200,endAngle:-20,min:0,max:100,itemStyle:{color:"#000"},pointer:{show:!1},axisLine:{lineStyle:{width:15,color:[[.36,"#00c875"]]}},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{show:!1},anchor:{show:!1},title:{show:!1},detail:{valueAnimation:!0,width:"60%",lineHeight:20,height:"15%",borderRadius:8,offsetCenter:[0,"-15%"],fontSize:34,fontWeight:"bolder",formatter:"{value} \xb0C",color:"#777"},data:[{value:36}]}]},this.MaxTemperatureCharging={series:[{type:"gauge",center:["50%","40%"],startAngle:200,endAngle:-20,min:0,max:100,itemStyle:{color:"#000"},pointer:{show:!1},axisLine:{lineStyle:{width:15,color:[[1,"#ccc"]]}},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{show:!1},anchor:{show:!1},title:{show:!1},detail:{show:!1}},{type:"gauge",center:["50%","40%"],startAngle:200,endAngle:-20,min:0,max:100,itemStyle:{color:"#000"},pointer:{show:!1},axisLine:{lineStyle:{width:15,color:[[.36,"#00b0f0"]]}},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{show:!1},anchor:{show:!1},title:{show:!1},detail:{valueAnimation:!0,width:"60%",lineHeight:20,height:"15%",borderRadius:8,offsetCenter:[0,"-15%"],fontSize:34,fontWeight:"bolder",formatter:"{value} \xb0C",color:"#777"},data:[{value:36.5}]}]},this.displayPercentLegend=h.$lo,this.colorScheme={domain:h.DMY},this.occupancyColorScheme={domain:[h.F1,h.Ms$]},this.lineChartColorScheme={domain:[h.Ms$]},this.lineChartVioletScheme={domain:[h.F1]},this.faultChartColorScheme={domain:[h.cEj]},this.occupancyLegend=[{name:"Hourly",color:h.Ms$},{name:"Season",color:h.F1}],this.dailyOccupancyLegend=[{name:"Hourly",color:h.Ms$},{name:"Season",color:h.F1}],this.maxYAxisOccupancy=100,this.chartView=[140,140],this.bsConfig={containerClass:"theme-light",showWeekNumbers:!1},this.vehicleIcon=h.mts,this.overallStatistic=null,this.parkingDurations=null,this.parkingVehicleTypes=[{name:"aa",value:1},{name:"aa1",value:3},{name:"aa2",value:6}],this.carParkTransactions=null,this.carParkRevenue=null,this.carParkFaults=null,this.parkingOccupancy={parkingOccupancyAverage:null,parkingOccupancy:null,maxYAxisOccupancy:null,barPadding:30,lines:[],lineSchema:{domain:[h.F1,h.Ms$,h.K8l]},hidden:!1},this.dailyOccupancy={date:this.timeRange.value[1],parkingOccupancyAverage:null,parkingOccupancy:null,maxYAxisOccupancy:null,barPadding:30,lines:[],lineSchema:{domain:[h.F1,h.Ms$,h.K8l,h.cEj]},hidden:!1},this.maxNormalSeasonalLots={parkingOccupancyAverage:null,parkingOccupancy:null,maxYAxisOccupancy:null,barPadding:30,loading:!1,occupancyLegend:[{name:"Hourly",color:h.Ms$},{name:"Season",color:h.F1}],referenceLines:[],hidden:!1},this.showDashbord={totalBoard:!0,parking:!0,status:!0,analysis:!0,transactions:!0,revenue:!0,seasonal:!0,dailyOccupancy:!0,carparkOccupancy:!0},this.selectList=[],this.content={stakeStatus:{chargingCnt:1,freeCnt:0,notAvailable:49}},this.energyConsumptionHeaders=h.g$7,this.energyReport=[{batch:"2019",capacity:310,vehicles:100,identification:"504",description:"BYD K9 2019",total_consumption:8171,average_consumption:135.6,average_regenerated:23,average_consume:186,average_duration:63,average_temp:35.6,average_temp_charging:35.8},{batch:"2021",capacity:310,vehicles:110,identification:"503",description:"BYD K9 2019",total_consumption:8171,average_consumption:135.6,average_regenerated:17,average_consume:130,average_duration:50,average_temp:36.6,average_temp_charging:35.8},{batch:"2019",capacity:310,vehicles:90,identification:"504",description:"BYD K9 2019",total_consumption:8171,average_consumption:135.6,average_regenerated:57,average_consume:186,average_duration:56,average_temp:35.9,average_temp_charging:35.8},{batch:"2021",capacity:310,vehicles:120,identification:"504",description:"BYD K9 2019",total_consumption:8171,average_consumption:135.6,average_regenerated:31,average_consume:253,average_duration:87,average_temp:34.6,average_temp_charging:35.8},{batch:"2019",capacity:310,vehicles:96,identification:"504",description:"BYD K9 2019",total_consumption:8171,average_consumption:135.6,average_regenerated:53,average_consume:253,average_duration:70,average_temp:37.6,average_temp_charging:35.8},{batch:"2021",capacity:422,vehicles:50,identification:"504",description:"Yutong E12DD",total_consumption:8171,average_consumption:135.6,average_regenerated:53,average_consume:186,average_duration:75,average_temp:35.2,average_temp_charging:35.8},{batch:"2019",capacity:422,vehicles:70,identification:"504",description:"Yutong E12DD",total_consumption:8171,average_consumption:135.6,average_regenerated:53,average_consume:253,average_duration:80,average_temp:36.5,average_temp_charging:35.8},{batch:"2021",capacity:422,vehicles:60,identification:"504",description:"Yutong E12DD",total_consumption:8171,average_consumption:135.6,average_regenerated:53,average_consume:200,average_duration:54,average_temp:35.9,average_temp_charging:35.8},{batch:"2019",capacity:422,vehicles:90,identification:"504",description:"Yutong E12DD",total_consumption:8171,average_consumption:135.6,average_regenerated:53,average_consume:300,average_duration:83,average_temp:37,average_temp_charging:35.8},{batch:"2021",capacity:422,vehicles:80,identification:"504",description:"Yutong E12DD",total_consumption:8171,average_consumption:135.6,average_regenerated:53,average_consume:320,average_duration:90,average_temp:36.6,average_temp_charging:35.8}]}get params(){return{carParkIds:this.selectedCarParkId?this.selectedCarParkId:0,from:this.timeRange.value[0].toISOString(),to:this.timeRange.value[1].toISOString(),rangeType:this.timeRange.type}}onResize(e){this.resizeEvent$.next(e)}lineLegend(e){return e.name}calcBarPadding(e){return e?this.barChartElement.nativeElement.clientWidth/e-this.barDefaultWidth:0}calcMaxYAxisOccupancy(e){return 10*Math.ceil(Math.max(...e.map(a=>a.season+a.normal))/10)}reloadData(){this.busService.getDashboardData().subscribe(e=>{this.dashboardData=e})}parkingOccupancyYAxisFormat(e){return e+"%"}changeDateRange(e){Array.isArray(e)||(this.timeRange=e,this.dailyOccupancy.date=e.value[1])}changeCompareDateRange(e){this.compareTimeRange=e}getChargingAnalysis(){this.statisticService.dashboardGetData().subscribe(e=>{if("10"===e.messageCode.slice(0,2)){this.content=e.data;const a=[],l=[],i=[],v=[],D=[],O=this.content.chargeAnalyze,it=["Charging","Idle","Unavailable"],P=["Power consumption","Charging Degree","Charging Amount","Charging Time"];for(let T=0;T<O.length;T++)a.push(O[T].xaxis),l.push(O[T].chargeCostAmount),v.push(O[T].chargeEnergy),i.push(O[T].chargeCount),D.push(O[T].chargeTime);const{chargingCnt:st,freeCnt:rt,notAvailable:ot}=this.content.stakeStatus,lt=[{name:P[0],type:"line",data:i},{name:P[1],type:"line",data:v},{name:P[2],type:"line",data:l},{name:P[3],type:"line",data:D}];this.option={color:["#2EC7C9","#5AB1EF","#D87A80"],legend:{orient:"horizontal",itemGap:70,itemHeight:6,top:0,bottom:20,data:it,height:50,textStyle:{fontFamily:"Poppins",fontSize:13,color:"#868aa8"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)",textStyle:{fontFamily:"Poppins"}},series:[{name:"Evc Pile Status",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:st,name:"Charging"},{value:rt,name:"Idle"},{value:ot,name:"Unavailable"}],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"},normal:{label:{textStyle:{fontFamily:"Poppins"}}}},label:{normal:{formatter:"{b} : {c} ({d}%)"}}}]},this.analysisOption={tooltip:{trigger:"axis"},legend:{data:P},toolbox:{show:!0},xAxis:{type:"category",boundaryGap:!1,data:a},yAxis:{type:"value"},series:lt}}},()=>{this.getChargingAnalysis_mock()})}getChargingAnalysis_mock(){const a=["Power Consumption","Charging Amount","Charging Time"],l=[{name:a[0],type:"line",data:[8,5,6,9]},{name:a[1],type:"line",data:[30,40,20,50]},{name:a[2],type:"line",data:[100,150,70,90]}];this.option={color:["#2EC7C9","#5AB1EF","#D87A80"],legend:{orient:"horizontal",itemGap:70,itemHeight:6,top:0,bottom:20,data:["Charging","Idle","Unavailable"],height:50,textStyle:{fontFamily:"Poppins",fontSize:13,color:"#868aa8"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)",textStyle:{fontFamily:"Poppins"}},series:[{name:"Evc Pile Status",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:10,name:"Charging"},{value:11,name:"Idle"},{value:12,name:"Unavailable"}],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"},normal:{label:{textStyle:{fontFamily:"Poppins"}}}},label:{normal:{formatter:"{b} : {c} ({d}%)"}}}]},this.analysisOption={tooltip:{trigger:"axis"},legend:{data:a},toolbox:{show:!0},xAxis:{type:"category",boundaryGap:!1,data:["2021-02-15","2021-02-16","2021-02-17","2021-02-18"]},yAxis:{type:"value"},series:l}}getDefaultersOption(){const e=["Model A","Model B","Model C","Model D","Model F"];this.defaultersOption={color:["#007082","#008ea5","#01b3cf","#5cd3e6","#84e1ef"],legend:{orient:"vertical",right:10,top:10},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)",textStyle:{fontFamily:"Poppins"}},series:[{name:"Energy Consumption By Model",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:20,name:e[0]},{value:21,name:e[1]},{value:22,name:e[2]},{value:25,name:e[3]},{value:20,name:e[4]}],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"},normal:{label:{textStyle:{fontFamily:"Poppins"}}}},label:{normal:{show:!1,position:"inside",formatter:"{b} : {c} ({d}%)"}}}]}}getLeakageOption(){const e=[];for(let a=0;a<10;a++)e.push(F().subtract(a,"day").format("DD-MMM-YY"));e.reverse(),this.leakageOption={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["Operation","Charging"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:e,axisTick:{alignWithLabel:!0},axisLabel:{interval:0,rotate:30}}],yAxis:[{type:"value"}],series:[{name:"Operation",type:"bar",data:[28,29,30,35,36,38,40,40,40,45],itemStyle:{color:"#02c876"}},{name:"Charging",type:"bar",data:[30,32,36,30,32,28,30,36,37,36],itemStyle:{color:"#00b0f0"}}]}}getEnergyCostOption(){this.energyCostOption={title:{text:"Energy Costs (Since Last Petrol Tank Top Up)"},tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},legend:{data:["XC40 PHEV Cost /km","XC40 ICE Cost /Km","XC40 PHEV Average Cost / Mth","XC40 ICE Average Cost / Mth"],bottom:0},xAxis:[{type:"category",data:["6-Mar-21","7-Mar-21","8-Mar-21","9-Mar-21","10-Mar-21","11-Mar-21","12-Mar-21","13-Mar-21","14-Mar-21"],axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:"$",min:0,max:10,interval:5,axisLabel:{formatter:"{value} $"}},{type:"value",name:"$",min:0,max:1e3,interval:200,axisLabel:{formatter:"{value} $"}}],series:[{name:"XC40 PHEV Cost /km",type:"bar",data:[6,4.9,7,6,4.9,7,6,4.9,7]},{name:"XC40 ICE Cost /Km",type:"bar",data:[2.6,5.9,9,2.6,5.9,9,2.6,5.9,9]},{name:"XC40 PHEV Average Cost / Mth",type:"line",yAxisIndex:1,data:[502,651,741,640,502,651,741,640,502,651,741,640]},{name:"XC40 ICE Average Cost / Mth",type:"line",yAxisIndex:1,data:[298,282,341,215,298,282,341,215,298,282,341,215]}]}}getEnergyCostChargedOption(){const e=["Home Charging","BlueCharge(Blue5G)","Greenlots","SP Group","Others"];this.energyCostChargedOption={title:{text:"Sources of Charging (Costs, %)"},legend:{orient:"vertical",right:10,top:10},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c}$ ({d}%)",textStyle:{fontFamily:"Poppins"}},series:[{name:"Sources of Charging",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:100,name:e[0]},{value:21,name:e[1]},{value:22,name:e[2]},{value:25,name:e[3]},{value:20,name:e[4]}],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"},normal:{label:{textStyle:{fontFamily:"Poppins"}}}},label:{normal:{show:!1,position:"inside",formatter:"{b} : {c}$ ({d}%)"}}}]}}getEnergyConsumptioOption(){this.energyConsumptioOption={title:{text:"Energy Consumption (Since Last Petrol Tank Top Up)"},tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},legend:{data:["Petrol Consumption Rate(L/100km)","Electricity Consumption Rate(kWh/100km)","Average Distance/Day Since Last Petrol Top Up(km)"],bottom:0},xAxis:[{type:"category",data:["6-Mar-21","7-Mar-21","8-Mar-21","9-Mar-21","10-Mar-21","11-Mar-21","12-Mar-21","13-Mar-21","14-Mar-21"],axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:"$",min:0,max:10,interval:5,axisLabel:{formatter:"{value} $"}},{type:"value",name:"$",min:0,max:1e3,interval:200,axisLabel:{formatter:"{value} $"}}],series:[{name:"Petrol Consumption Rate(L/100km)",type:"bar",data:[6,4.9,7,6,4.9,7,6,4.9,7]},{name:"Electricity Consumption Rate(kWh/100km)",type:"line",yAxisIndex:1,data:[502,651,741,640,502,651,741,640,502,651,741,640]},{name:"Average Distance/Day Since Last Petrol Top Up(km)",type:"line",yAxisIndex:1,data:[298,282,341,215,298,282,341,215,298,282,341,215]}]}}getEnergyConsumptioChargedOption(){const e=["Home Charging","BlueCharge(Blue5G)","Greenlots","SP Group","Others"];this.energyConsumptioChargedOption={title:{text:"Sources of Charging (kWh, %)"},legend:{orient:"vertical",right:10,top:10},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)",textStyle:{fontFamily:"Poppins"}},series:[{name:"Sources of Charging",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:6,name:e[0]},{value:8,name:e[1]},{value:10,name:e[2]},{value:25,name:e[3]},{value:100,name:e[4]}],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"},normal:{label:{textStyle:{fontFamily:"Poppins"}}}},label:{normal:{show:!1,position:"inside",formatter:"{b} : {c} ({d}%)"}}}]}}ngOnInit(){this.getChargingAnalysis(),this.reloadData(),this.statisticService.getDashboardFlag().subscribe(i=>{i.dashboardConfig&&(this.showDashbord=JSON.parse(i.dashboardConfig));for(let v in this.showDashbord)this.selectList.push({name:v,value:this.showDashbord[v]})});const e=this.occupancyLegend.map(i=>i.name);this.translate.get(e).subscribe(i=>{this.occupancyLegend.forEach(v=>{for(let D in i)i.hasOwnProperty(D)&&v.name===D&&(v.name=i[D])})});const a=this.dailyOccupancyLegend.map(i=>i.name);this.translate.get(a).subscribe(i=>{this.dailyOccupancyLegend.forEach(v=>{for(let D in i)i.hasOwnProperty(D)&&v.name===D&&(v.name=i[D])})});const l=this.maxNormalSeasonalLots.occupancyLegend.map(i=>i.name);this.translate.get(l).subscribe(i=>{this.maxNormalSeasonalLots.occupancyLegend.forEach(v=>{for(let D in i)i.hasOwnProperty(D)&&v.name===D&&(v.name=i[D])})}),this.getDefaultersOption(),this.getLeakageOption(),this.getEnergyCostOption(),this.getEnergyCostChargedOption(),this.getEnergyConsumptioSourceOption(),this.getEnergyConsumptioChargedOption()}ngAfterViewInit(){}showItem(e,a){let l=this.showDashbord;l[e]=!a;const i=JSON.stringify(l);this.statisticService.putDashboardFlag({dashboardConfig:i}).subscribe(D=>{this.showDashbord=JSON.parse(i),this.selectList.map(O=>{O.name===e&&(O.value=l[e])})})}selectOccupancy(e){this.dailyOccupancy.date=B.ou.fromFormat(e.series,"yyyyMMdd").toJSDate(),this.statisticService.getDailyOccupancyStatistics({...this.params,rangeType:h.Nxg.Month,to:this.dailyOccupancy.date.toISOString()}).pipe((0,z.q)(1)).subscribe(a=>{const l=(0,h._lv)(a.parkingOccupancy);this.dailyOccupancy.parkingOccupancyAverage=(0,h.ktj)(a.parkingOccupancy),this.dailyOccupancy.parkingOccupancy=l,this.dailyOccupancy.lines=[{name:"In",series:a.parkingInOut.map(i=>({name:i.title,value:i.in}))},{name:"Out",series:a.parkingInOut.map(i=>({name:i.title,value:i.out}))}],this.dailyOccupancy.maxYAxisOccupancy=this.calcMaxYAxisOccupancy(a.parkingOccupancy),this.dailyOccupancy.barPadding=this.calcBarPadding(a.parkingOccupancy.length)})}hotmap(){this.carparkService.filterModel({},{totalCount:0,rowsPerPage:999999,page:1,sortBy:null,descending:!0,totalPages:1}).subscribe(e=>{setTimeout(()=>{var a=new google.maps.Map(document.getElementById("HOT_MAPS"),{zoom:14,center:{lat:1.346987,lng:103.714679}});let l=e.data.map(i=>({location:new google.maps.LatLng(i.geopoint.lat,i.geopoint.lng),weight:(i.live?i.totalLots-i.live.availableLots-i.seasonLots:0)<=0?0:i.totalLots-i.live.availableLots-i.seasonLots}));new google.maps.visualization.HeatmapLayer({map:a,data:l,radius:30,maxIntensity:20})},1e3)})}getEnergyConsumptioSourceOption(){const e=[];for(let a=0;a<23;a++)e.push(`${a+1}:00`);e.push("00:00"),this.energyConsumptioSourceOption={tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},legend:{data:["Grid","BSS"],bottom:0},xAxis:[{type:"category",data:e,axisPointer:{type:"shadow"}}],yAxis:[{type:"value"}],series:[{name:"Grid",type:"bar",stack:"analyze",data:[200,200,150,100,150,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,200],itemStyle:{color:"#5c98d0"}},{name:"BSS",type:"bar",stack:"analyze",data:[400,400,500,400,300,0,0,0,0,0,200,240,0,0,0,0,0,0,0,0,0,0,0,500],itemStyle:{color:"#e27830"}}]}}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(y.F0),t.Y36(Z.B),t.Y36(E.x),t.Y36(s.sK),t.Y36(u.Z))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-bus-dashboard"]],viewQuery:function(e,a){if(1&e&&t.Gf($,5),2&e){let l;t.iGM(l=t.CRH())&&(a.barChartElement=l.first)}},hostBindings:function(e,a){1&e&&t.NdJ("resize",function(i){return a.onResize(i)},!1,t.Jf7)},decls:24,vars:12,consts:[[1,"body-wrapper"],[1,"m-subheader"],[1,"align-items-center"],[1,"row","form-group","m-form__group"],[1,"col-form-label","col-lg-1","col-sm-6"],[1,"col-lg-2"],["bindLabel","name","bindValue","id","placeholder","",1,"rounded",3,"items","ngModel","ngModelChange"],[1,"col-form-label","col-xl-1","col-lg-2","col-sm-6","m--padding-right-0"],[1,"col-lg-3","col-sm-6"],[3,"data","select"],[1,"m-content"],[1,"row","general-statistics"],[3,"class",4,"ngIf"],["class","occupancy-statistics background-transparent",4,"ngIf"],["class","occupancy-statistics",4,"ngIf"],[1,"row"],[1,"col-sm-6","m--padding-left-10","m--padding-right-10","m--margin-bottom-20"],[1,"m-portlet","h-100","m--margin-bottom-20"],[1,"m-portlet__body"],[1,"card-statistics"],[1,"stats-title"],[1,"stats-value","text-main"],[1,"col-sm-6","m--padding-left-10"],[1,"m-portlet","m--margin-bottom-20"],[1,"col-4"],[1,"charger-value"],[1,"charger-title"],[1,"charger-value","charger-value-up"],[1,"charger-value","charger-value-down"],[1,"col-sm-6","m--padding-left-10","m--padding-right-10",2,"margin-bottom","2.2rem"],[1,"m-portlet","h-100"],[2,"font-weight","600"],[1,"stats-value","text-f4"],[1,"col-sm-6","m--padding-left-10",2,"margin-bottom","2.2rem"],[1,"stats-revenue-box"],[1,"stats-title-revenue"],[1,"col-3"],[1,"connector-value"],[1,"connector-title"],[1,"connector-value","connector-value-available"],[1,"connector-value","connector-value-use"],[1,"connector-value","connector-value-down"],[1,"m-portlet","h-100","d-flex","flex-column","justify-content-between"],[1,"m-portlet__head"],[1,"m-portlet__head-caption"],[1,"m-portlet__head-title","w-100"],[1,"m-portlet__head-text","col-6"],[1,"btn","btn-outline-main","m-btn","m-btn--icon","m-btn--icon-only","m-btn--custom","m-btn--pill","m-btn--air","float-right","m--margin-top-20",3,"click"],[1,"fa","fa-times"],[1,"h-100","d-flex","flex-column","justify-content-center"],[1,"charge-session-value"],[1,"charge-session-value","charge-session-value-soc"],[1,"col-12"],[1,"col-12","m--padding-right-10"],[1,"m-portlet","m-portlet--bordered-semi","card-stats-chart","parking-vehicle-chart"],[1,"m-portlet__head-title"],[1,"m-portlet__head-text"],[1,"stats-chart-container"],[1,"col-10"],["echarts","",1,"demo-chart",2,"height","300px",3,"options"],[1,"m-portlet","m-portlet--bordered-semi","card-stats-chart","parking-vehicle-chart","mb-0"],["echarts","",1,"demo-chart",3,"options"],[1,"occupancy-statistics","background-transparent"],[1,"m-portlet","background-transparent"],[1,"m-portlet__head",2,"border-bottom","none"],["class","m-portlet__body","style","padding: 0;",4,"ngIf"],[1,"m-portlet__body",2,"padding","0"],[1,"table","table-striped",2,"border-collapse","separate","border-spacing","0px 10px"],[1,"",2,"color","#b6b9bd"],[1,"text-center"],["scope","col",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["scope","col"],[1,"text-center","bg-white"],["scope","row",1,"py-4"],[1,"py-4"],[1,"occupancy-statistics"],[1,"m-portlet"],["class","m-portlet__body",4,"ngIf"],[1,"row","states-chart"],[1,"col-7"],["barChartElement",""],[1,"col-5","m--padding-0","bar-chart-avg"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"app-title-bar"),t.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"label",4),t._uU(6," Depot "),t.qZA(),t.TgZ(7,"div",5)(8,"ng-select",6),t.NdJ("ngModelChange",function(i){return a.selectedCarParkId=i})("ngModelChange",function(){return a.reloadData()}),t.ALo(9,"async"),t.qZA()(),t.TgZ(10,"label",7),t._uU(11," Time Range "),t.qZA(),t.TgZ(12,"div",8)(13,"app-datepicker-tab",9),t.NdJ("select",function(i){return a.changeDateRange(i)}),t.qZA()()()()(),t.TgZ(14,"div",10)(15,"div",11),t.YNc(16,j,72,16,"div",12),t.YNc(17,Y,28,9,"div",12),t.qZA(),t.TgZ(18,"div",11),t.YNc(19,G,27,5,"div",12),t.YNc(20,J,14,7,"div",12),t.qZA(),t.YNc(21,W,10,4,"div",13),t.YNc(22,V,10,4,"div",14),t.YNc(23,tt,10,4,"div",14),t.qZA()()),2&e&&(t.xp6(8),t.Q6J("items",t.lcZ(9,10,a.carparkOptions$))("ngModel",a.selectedCarParkId),t.xp6(5),t.Q6J("data",a.timeRange),t.xp6(3),t.Q6J("ngIf",a.showDashbord.totalBoard),t.xp6(1),t.Q6J("ngIf",a.showDashbord.parking),t.xp6(2),t.Q6J("ngIf",a.showDashbord.status),t.xp6(1),t.Q6J("ngIf",a.showDashbord.analysis),t.xp6(1),t.Q6J("ngIf",a.showDashbord.carparkOccupancy),t.xp6(1),t.Q6J("ngIf",a.showDashbord.carparkOccupancy),t.xp6(1),t.Q6J("ngIf",a.showDashbord.carparkOccupancy))},dependencies:[C.sg,C.O5,R.G,w.Uo,w._C,w.Om,w.p0,w.$Z,_.JJ,_.On,N.K,g._w,S.w9,C.Ov,C.JJ,s.X$],styles:[".states-chart[_ngcontent-%COMP%]{height:470px}.stats-revenue-box[_ngcontent-%COMP%]{padding-top:12px;padding-bottom:10px;padding-left:35px}.demo-chart[_ngcontent-%COMP%]{height:400px}.flex-column[_ngcontent-%COMP%]{display:flex;flex-direction:column}.felx-right[_ngcontent-%COMP%]{margin-bottom:10px;justify-content:flex-end;visibility:hidden}.flex-column[_ngcontent-%COMP%]:hover   .felx-right[_ngcontent-%COMP%]{visibility:visible}.background-transparent[_ngcontent-%COMP%]{background:transparent;box-shadow:none}.charger-value[_ngcontent-%COMP%], .connector-value[_ngcontent-%COMP%], .charge-session-value[_ngcontent-%COMP%]{font-size:26px;font-weight:600}.charger-value-up[_ngcontent-%COMP%], .connector-value-available[_ngcontent-%COMP%]{color:#00b050}.charger-value-down[_ngcontent-%COMP%], .connector-value-down[_ngcontent-%COMP%]{color:red}.connector-value-use[_ngcontent-%COMP%]{color:#00b0f0}.charge-session-value-soc[_ngcontent-%COMP%]{color:#e66a00}"]}),r})()}]}];let nt=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({providers:[Z.B,E.x,u.Z],imports:[C.ez,y.Bz.forChild(at),o.x,_.u5,x.D,g.Ns.forRoot({echarts:()=>n.e(4734).then(n.bind(n,14734))}),U.a4,S.A0,M.kn,b.zk,f.d,s.aw.forChild({loader:{provide:s.Zw,useFactory:k,deps:[p.eN]}}),y.Bz,f.d]}),r})()},80330:(L,A,n)=>{n.d(A,{d:()=>_});var C=n(36895),p=n(94650);let _=(()=>{class y{}return y.\u0275fac=function(E){return new(E||y)},y.\u0275mod=p.oAB({type:y}),y.\u0275inj=p.cJS({imports:[C.ez]}),y})()},34984:(L,A,n)=>{n.d(A,{Ns:()=>U,_w:()=>u});var C=n(15861),p=n(94650),_=n(21086),y=n(68896),M=n(8929),E=n(20353),Z=n(34202),x=n(66753),S=n(87545);class s{constructor(g){this.changes=g}static of(g){return new s(g)}notEmpty(g){if(this.changes[g]){const o=this.changes[g].currentValue;if(null!=o)return(0,_.of)(o)}return y.E}has(g){return this.changes[g]?(0,_.of)(this.changes[g].currentValue):y.E}notFirst(g){return this.changes[g]&&!this.changes[g].isFirstChange()?(0,_.of)(this.changes[g].currentValue):y.E}notFirstAndEmpty(g){if(this.changes[g]&&!this.changes[g].isFirstChange()){const o=this.changes[g].currentValue;if(null!=o)return(0,_.of)(o)}return y.E}}const c=new p.OlP("NGX_ECHARTS_CONFIG");let u=(()=>{class b{constructor(o,d,f){this.el=d,this.ngZone=f,this.autoResize=!0,this.loadingType="default",this.chartInit=new p.vpe,this.optionsError=new p.vpe,this.chartClick=this.createLazyEvent("click"),this.chartDblClick=this.createLazyEvent("dblclick"),this.chartMouseDown=this.createLazyEvent("mousedown"),this.chartMouseMove=this.createLazyEvent("mousemove"),this.chartMouseUp=this.createLazyEvent("mouseup"),this.chartMouseOver=this.createLazyEvent("mouseover"),this.chartMouseOut=this.createLazyEvent("mouseout"),this.chartGlobalOut=this.createLazyEvent("globalout"),this.chartContextMenu=this.createLazyEvent("contextmenu"),this.chartLegendSelectChanged=this.createLazyEvent("legendselectchanged"),this.chartLegendSelected=this.createLazyEvent("legendselected"),this.chartLegendUnselected=this.createLazyEvent("legendunselected"),this.chartLegendScroll=this.createLazyEvent("legendscroll"),this.chartDataZoom=this.createLazyEvent("datazoom"),this.chartDataRangeSelected=this.createLazyEvent("datarangeselected"),this.chartTimelineChanged=this.createLazyEvent("timelinechanged"),this.chartTimelinePlayChanged=this.createLazyEvent("timelineplaychanged"),this.chartRestore=this.createLazyEvent("restore"),this.chartDataViewChanged=this.createLazyEvent("dataviewchanged"),this.chartMagicTypeChanged=this.createLazyEvent("magictypechanged"),this.chartPieSelectChanged=this.createLazyEvent("pieselectchanged"),this.chartPieSelected=this.createLazyEvent("pieselected"),this.chartPieUnselected=this.createLazyEvent("pieunselected"),this.chartMapSelectChanged=this.createLazyEvent("mapselectchanged"),this.chartMapSelected=this.createLazyEvent("mapselected"),this.chartMapUnselected=this.createLazyEvent("mapunselected"),this.chartAxisAreaSelected=this.createLazyEvent("axisareaselected"),this.chartFocusNodeAdjacency=this.createLazyEvent("focusnodeadjacency"),this.chartUnfocusNodeAdjacency=this.createLazyEvent("unfocusnodeadjacency"),this.chartBrush=this.createLazyEvent("brush"),this.chartBrushEnd=this.createLazyEvent("brushend"),this.chartBrushSelected=this.createLazyEvent("brushselected"),this.chartRendered=this.createLazyEvent("rendered"),this.chartFinished=this.createLazyEvent("finished"),this.animationFrameID=null,this.resize$=new M.xQ,this.echarts=o.echarts}ngOnChanges(o){const d=s.of(o);d.notFirstAndEmpty("options").subscribe(f=>this.onOptionsChange(f)),d.notFirstAndEmpty("merge").subscribe(f=>this.setOption(f)),d.has("loading").subscribe(f=>this.toggleLoading(!!f)),d.notFirst("theme").subscribe(()=>this.refreshChart())}ngOnInit(){if(!window.ResizeObserver)throw new Error("please install a polyfill for ResizeObserver");this.resizeSub=this.resize$.pipe((0,x.p)(100,E.z,{leading:!1,trailing:!0})).subscribe(()=>this.resize()),this.autoResize&&(this.resizeOb=this.ngZone.runOutsideAngular(()=>new window.ResizeObserver(()=>{this.animationFrameID=window.requestAnimationFrame(()=>this.resize$.next())})),this.resizeOb.observe(this.el.nativeElement))}ngOnDestroy(){window.clearTimeout(this.initChartTimer),this.resizeSub&&this.resizeSub.unsubscribe(),this.animationFrameID&&window.cancelAnimationFrame(this.animationFrameID),this.resizeOb&&this.resizeOb.unobserve(this.el.nativeElement),this.dispose()}ngAfterViewInit(){this.initChartTimer=window.setTimeout(()=>this.initChart())}dispose(){this.chart&&(this.chart.isDisposed()||this.chart.dispose(),this.chart=null)}resize(){this.chart&&this.chart.resize()}toggleLoading(o){this.chart&&(o?this.chart.showLoading(this.loadingType,this.loadingOpts):this.chart.hideLoading())}setOption(o,d){if(this.chart)try{this.chart.setOption(o,d)}catch(f){console.error(f),this.optionsError.emit(f)}}refreshChart(){var o=this;return(0,C.Z)(function*(){o.dispose(),yield o.initChart()})()}createChart(){const o=this.el.nativeElement;if(window&&window.getComputedStyle){const d=window.getComputedStyle(o,null).getPropertyValue("height");(!d||"0px"===d)&&(!o.style.height||"0px"===o.style.height)&&(o.style.height="400px")}return this.ngZone.runOutsideAngular(()=>("function"==typeof this.echarts?this.echarts:()=>Promise.resolve(this.echarts))().then(({init:f})=>f(o,this.theme,this.initOpts)))}initChart(){var o=this;return(0,C.Z)(function*(){yield o.onOptionsChange(o.options),o.merge&&o.chart&&o.setOption(o.merge)})()}onOptionsChange(o){var d=this;return(0,C.Z)(function*(){!o||(d.chart||(d.chart=yield d.createChart(),d.chartInit.emit(d.chart)),d.setOption(d.options,!0))})()}createLazyEvent(o){return this.chartInit.pipe((0,S.w)(d=>new Z.y(f=>(d.on(o,h=>this.ngZone.run(()=>f.next(h))),()=>{this.chart&&(this.chart.isDisposed()||d.off(o))}))))}}return b.\u0275fac=function(o){return new(o||b)(p.Y36(c),p.Y36(p.SBq),p.Y36(p.R0b))},b.\u0275dir=p.lG2({type:b,selectors:[["echarts"],["","echarts",""]],inputs:{options:"options",theme:"theme",loading:"loading",initOpts:"initOpts",merge:"merge",autoResize:"autoResize",loadingType:"loadingType",loadingOpts:"loadingOpts"},outputs:{chartInit:"chartInit",optionsError:"optionsError",chartClick:"chartClick",chartDblClick:"chartDblClick",chartMouseDown:"chartMouseDown",chartMouseMove:"chartMouseMove",chartMouseUp:"chartMouseUp",chartMouseOver:"chartMouseOver",chartMouseOut:"chartMouseOut",chartGlobalOut:"chartGlobalOut",chartContextMenu:"chartContextMenu",chartLegendSelectChanged:"chartLegendSelectChanged",chartLegendSelected:"chartLegendSelected",chartLegendUnselected:"chartLegendUnselected",chartLegendScroll:"chartLegendScroll",chartDataZoom:"chartDataZoom",chartDataRangeSelected:"chartDataRangeSelected",chartTimelineChanged:"chartTimelineChanged",chartTimelinePlayChanged:"chartTimelinePlayChanged",chartRestore:"chartRestore",chartDataViewChanged:"chartDataViewChanged",chartMagicTypeChanged:"chartMagicTypeChanged",chartPieSelectChanged:"chartPieSelectChanged",chartPieSelected:"chartPieSelected",chartPieUnselected:"chartPieUnselected",chartMapSelectChanged:"chartMapSelectChanged",chartMapSelected:"chartMapSelected",chartMapUnselected:"chartMapUnselected",chartAxisAreaSelected:"chartAxisAreaSelected",chartFocusNodeAdjacency:"chartFocusNodeAdjacency",chartUnfocusNodeAdjacency:"chartUnfocusNodeAdjacency",chartBrush:"chartBrush",chartBrushEnd:"chartBrushEnd",chartBrushSelected:"chartBrushSelected",chartRendered:"chartRendered",chartFinished:"chartFinished"},exportAs:["echarts"],features:[p.TTD]}),b})(),U=(()=>{class b{static forRoot(o){return{ngModule:b,providers:[{provide:c,useValue:o}]}}static forChild(){return{ngModule:b}}}return b.\u0275fac=function(o){return new(o||b)},b.\u0275mod=p.oAB({type:b}),b.\u0275inj=p.cJS({}),b})()}}]);