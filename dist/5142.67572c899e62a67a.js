"use strict";(self.webpackChunkst_admin=self.webpackChunkst_admin||[]).push([[5142],{71942:(A,Z,o)=>{o.d(Z,{f:()=>E});var s=o(38014),V=o(3927),l=o(26245),u=o(21086),m=o(27221),_=o(66708),f=o(94650),h=o(60097),e=o(80529),b=o(28555),v=o(91599);let E=(()=>{class T extends V.su{constructor(t,a,p,d){super(a,p),this.carparkService=t,this.http=a,this.store=p,this.modelName="Vehicle",this.handleError=d.createHandleError(`${this.modelName}Service`),this.handleDynamicUrl()}ngOnInit(){}handleDynamicUrl(){const t=JSON.parse(localStorage.getItem("user")).login;this.baseUrl=this.carparkService.isMotorist()&&_.Z.isNotNull(t)?`carpark/api/drivers/${t}/vehicles`:"carpark/api/vehicle/get-vehicles"}getTelList(t,a){console.log(t);const p=this.getUrl((0,l.U8)("carpark/api/vehicle/vehicles",{...t,...(0,l.jq)(a)}));return this.get(p)}filterModel(t,a){const p=this.getUrl((0,l.U8)(this.baseUrl,{...t,...(0,l.jq)(a)}));return this.get(p).pipe((0,m.K)(this.handleError(`${this.modelName}Filter`,{}))).map(d=>Array.isArray(d)?(0,V.eC)(d):(0,V.O7)(d))}updateVehicle(t){const a=this.getUrl(`carpark/api/drivers/${t.driverCode}/vehicles/${t.vehicleId}`);return this.patch(a,t.vehicle).pipe((0,m.K)(this.handleError(`${this.modelName}Update`,{})))}getModel(t){const a=this.getUrl(`carpark/api/vehicle/${t}`);return this.get(a).pipe((0,m.K)(this.handleError(`${this.modelName}Get`,{})))}deleteModel(t,a){const p=this.getUrl(`carpark/api/drivers/${t}/vehicles/${a}`);return this.delete(p).pipe((0,m.K)(this.handleError(`${this.modelName}Delete`)))}deleteAdminModel(t){const a=this.getUrl(`carpark/api/admin/vehicle/${t}`);return this.delete(a).pipe((0,m.K)(this.handleError(`${this.modelName}Delete`)))}createVehicle(t,a){const p=this.getUrl(`carpark/api/drivers/${t}/vehicles`);return this.post(p,a)}putUpdateVehicle(t,a){const p=this.getUrl(`carpark/api/drivers/${t}/vehicles/${a.id}`);return this.put(p,a)}getDriverCode(t){const a=this.getUrl(`carpark/api/drivers/${t}/driverCode`);return this.get(a)}createModel(t,a){const p=this.getUrl(`carpark/api/drivers/${t}/vehicles`);return this.post(p,a).pipe((0,m.K)(this.handleError(`${this.modelName}Create`,{})))}createVehicleAdmin(t){const a=this.getUrl(`carpark/api/admin/vehicles/${t.mobile}`);return this.post(a,t).pipe((0,m.K)(this.handleError(`${this.modelName}Create`,{})))}updateModel(t){const a=this.getUrl("carpark/api/admin/vehicle-changes");return this.post(a,t).pipe((0,m.K)(this.handleError(`${this.modelName}Update`,{})))}getSimpleList(){const t=this.getUrl("carpark/api/vehicle/simple-vehicles-list");return this.get(t).pipe((0,m.K)(this.handleError(`${this.modelName}SimpleList`,{})))}filterModelByDriver(t){const a=this.getUrl(`carpark/api/drivers/${t}/vehicles`);return this.get(a).pipe((0,m.K)(()=>(0,u.of)([])))}isOperator(){const t=JSON.parse(localStorage.getItem("user-roles"));return!(!_.Z.isNotNull(t)||!t.includes(s.i44.Operator))}getUserVehicle(t,a){this.baseUrl=`carpark/api/drivers/${t}/vehicles`;const p=this.getUrl((0,l.U8)(this.baseUrl,{...(0,l.jq)(a)}));return this.get(p).pipe((0,m.K)(this.handleError(`${this.modelName}Filter`,{}))).map(d=>Array.isArray(d)?(0,V.eC)(d):(0,V.O7)(d))}}return T.\u0275fac=function(t){return new(t||T)(f.LFG(h.x),f.LFG(e.eN),f.LFG(b.yh),f.LFG(v.k))},T.\u0275prov=f.Yz7({token:T,factory:T.\u0275fac}),T})()},63115:(A,Z,o)=>{o.d(Z,{J:()=>m});var s=o(94650),V=o(21837),l=o(36895),u=o(60883);let m=(()=>{class _{constructor(){this._value=new Date,this.format="hh:mm a, dd LLLL yyyy",this.bsValueChange=new s.vpe,this.bsConfig={containerClass:"theme-light",showWeekNumbers:!1},this.showPicker=!1,this.showDate=!0,this.showTime=!0,this.closeButton={show:!0,label:"Close",cssClass:"btn btn-sm btn-primary"}}get value(){return this._value}set value(h){h?("string"==typeof h&&(this._value=new Date(h)),this._value=h):this._value=null}get displayText(){return this.format=this.formatTime?"dd LLLL yyyy  /  hh:mm a":this.format,this.value?V.ou.fromJSDate(this.value).toFormat(this.format):null}onTogglePicker(){!1===this.showPicker&&(this.showPicker=!0)}onValueChange(h){this.bsValueChange.emit(h)}isValid(){return this.value&&"string"!=typeof this.value&&!isNaN(this.value.getTime())}}return _.\u0275fac=function(h){return new(h||_)},_.\u0275cmp=s.Xpm({type:_,selectors:[["app-datetimepicker"]],inputs:{value:"value",formatTime:"formatTime",format:"format"},outputs:{bsValueChange:"bsValueChange"},decls:6,vars:7,consts:[[1,"m-input-icon","m-input-icon--right",3,"ngClass"],["type","text","placement","bottom","readonly","",1,"form-control","m-input",3,"value","click"],[1,"m-input-icon__icon","m-input-icon__icon--right"],[1,"la","la-calendar"],[3,"value","showPopup","showDate","showTime","closeButton","valueChange","showPopupChange"]],template:function(h,e){1&h&&(s.TgZ(0,"div",0)(1,"input",1),s.NdJ("click",function(){return e.onTogglePicker()}),s.qZA(),s.TgZ(2,"span",2)(3,"span"),s._UZ(4,"i",3),s.qZA()()(),s.TgZ(5,"datetime-popup",4),s.NdJ("valueChange",function(v){return e.onValueChange(v)})("showPopupChange",function(v){return e.showPicker=v}),s.qZA()),2&h&&(s.Q6J("ngClass",e.rounded?"rounded":""),s.xp6(1),s.Q6J("value",e.displayText),s.xp6(4),s.Q6J("value",e.value)("showPopup",e.showPicker)("showDate",e.showDate)("showTime",e.showTime)("closeButton",e.closeButton))},dependencies:[l.mk,u.U],encapsulation:2}),_})()},46021:(A,Z,o)=>{o.r(Z),o.d(Z,{VisitorDisplaysModule:()=>Q});var s=o(36895),V=o(80529),l=o(24006),u=o(34793),m=o(30329),_=o(21532),f=o(1176),h=o(59501),e=o(94650),b=o(76916),v=o(89383);const E=function(){return["create"]},T=function(){return["overview"]};let M=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-visitor-displays-home"]],decls:17,vars:12,consts:[[1,"m-content"],[1,"m-portlet","m-portlet--tabs"],[1,"m-portlet__head"],[1,"m-portlet__head-tools"],["role","tablist",1,"nav","nav-tabs","m-tabs-line","m-tabs-line--primary","m-tabs-line--2x"],[1,"nav-item","m-tabs__item"],[1,"nav-link","m-tabs__link",3,"routerLink","routerLinkActive"],[1,"m-portlet__body","m-portlet__body--scrollable"],[1,"m-portlet__frame"]],template:function(r,n){1&r&&(e._UZ(0,"app-title-bar"),e.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"ul",4)(6,"li",5)(7,"a",6),e._uU(8),e.ALo(9,"translate"),e.qZA()(),e.TgZ(10,"li",5)(11,"a",6),e._uU(12),e.ALo(13,"translate"),e.qZA()()()()(),e.TgZ(14,"div",7)(15,"div",8),e._UZ(16,"router-outlet"),e.qZA()()()()),2&r&&(e.xp6(7),e.Q6J("routerLink",e.DdM(10,E))("routerLinkActive","active"),e.xp6(1),e.hij(" ",e.lcZ(9,6,"Create Visitor")," "),e.xp6(3),e.Q6J("routerLink",e.DdM(11,T))("routerLinkActive","active"),e.xp6(1),e.hij(" ",e.lcZ(13,8,"Visitor Overview")," "))},dependencies:[u.lC,u.yS,u.Od,b.G,v.X$],encapsulation:2}),i})();var t=o(15128),a=o(92889),p=o(74564),d=o(38014),L=o(63115);const x=["formVehicle"];function P(i,c){1&i&&e._UZ(0,"app-title-bar")}function N(i,c){if(1&i&&(e.TgZ(0,"div",23)(1,"div",24)(2,"div",25)(3,"h3",26),e._uU(4),e.qZA()()()()),2&i){const r=e.oxw();e.xp6(4),e.hij(" ",r.form.id," ")}}function w(i,c){if(1&i&&(e.TgZ(0,"div",27),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i){const r=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,r.vehicleNoMessage),". At least 3 characters. ")}}function F(i,c){1&i&&(e.TgZ(0,"div",29),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"License plate already exists."),""))}function k(i,c){if(1&i&&e.YNc(0,F,3,3,"div",28),2&i){const r=e.oxw();e.Q6J("ngIf",r.errorMsg)}}function I(i,c){if(1&i){const r=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){e.CHM(r);const g=e.oxw();return e.KtG(g.delete())}),e._UZ(1,"i",30),e._uU(2),e.ALo(3,"translate"),e.qZA()}2&i&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"Delete")," "))}let y=(()=>{class i{constructor(r,n,g){this.router=r,this.visitorVehicleService=n,this.route=g,this.form=(0,d.plP)(),this.canceled=new e.vpe,this.isCreate=!0,this.errorMsg=!1,this.vehicleNoMessage=d.vwt.VehicleNo}ngOnInit(){const{item:r,breadcrumb:n}=this.route.snapshot.data;this.isCreate=!0,"Edit Visitor"===n.label&&(this.form={...r,dateTime:new Date(r.dateTime)},this.isCreate=!1)}delete(){console.log(this.form),this.visitorVehicleService.deleteModel(this.form.id).subscribe(()=>{this.router.navigate(["/visitor-displays/overview"])})}cancel(){this.router.navigate(["/visitor-displays/overview"])}submit(r){r.valid&&(this.errorMsg=!1,this.isCreate?this.visitorVehicleService.createVehicle(this.form).subscribe(n=>{console.log(n),"Created"==n.statusText&&201==n.status?this.resetForm():"OK"==n.statusText&&200==n.status&&(this.errorMsg=!0)}):this.visitorVehicleService.updateModel(this.form.id,this.form).subscribe(()=>{this.router.navigate(["/visitor-displays/overview"])}))}resetForm(){this.form=(0,d.plP)(),this.formVehicle.reset()}}return i.\u0275fac=function(r){return new(r||i)(e.Y36(u.F0),e.Y36(a.E),e.Y36(u.gz))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-visitor-displays-create"]],viewQuery:function(r,n){if(1&r&&e.Gf(x,5),2&r){let g;e.iGM(g=e.CRH())&&(n.formVehicle=g.first)}},decls:35,vars:19,consts:[[4,"ngIf"],[1,"m-content"],[1,"m-form","m-form--fit","m-form--label-align-right",3,"ngSubmit"],["formVehicle","ngForm"],[1,"m-portlet"],["class","m-portlet__head",4,"ngIf"],[1,"m-portlet__body"],[1,"row","form-group","m-form__group"],[1,"col-form-label","col-lg-2","col-sm-12"],[1,"m--font-danger"],[1,"col-lg-4","col-sm-12"],["type","text","name","vehicleNumber","required","","maxlength","8","minlength","3","pattern","^[a-zA-Z0-9]+$","oninput","this.value = this.value.toUpperCase()",1,"form-control","m-input",3,"ngModel","ngModelChange"],["vehicleNumber","ngModel"],["class","form-control-feedback",4,"ngIf","ngIfElse"],["msg",""],[3,"value","bsValueChange"],[1,"m-portlet__foot","bg-light-gray"],[1,"row"],[1,"m-form__actions","col"],["class","btn btn-secondary",3,"click",4,"ngIf"],[1,"m-form__actions","m-form__actions--right","row"],[1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-main","m--margin-left-30"],[1,"m-portlet__head"],[1,"m-portlet__head-caption"],[1,"m-portlet__head-title"],[1,"m-portlet__head-text"],[1,"form-control-feedback"],["class","form-control-feedback errMsg",4,"ngIf"],[1,"form-control-feedback","errMsg"],[1,"la","la-trash"]],template:function(r,n){if(1&r){const g=e.EpF();e.YNc(0,P,1,0,"app-title-bar",0),e.TgZ(1,"div",1)(2,"form",2,3),e.NdJ("ngSubmit",function(){e.CHM(g);const U=e.MAs(3);return e.KtG(n.submit(U))}),e.TgZ(4,"div",4),e.YNc(5,N,5,1,"div",5),e.TgZ(6,"div",6)(7,"div",7)(8,"label",8)(9,"span",9),e._uU(10,"*"),e.qZA(),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"div",10)(14,"input",11,12),e.NdJ("ngModelChange",function(U){return n.form.vehicleNo=U})("ngModelChange",function(){return n.errorMsg=!1}),e.qZA(),e.YNc(16,w,3,3,"div",13),e.YNc(17,k,1,1,"ng-template",null,14,e.W1O),e.qZA(),e.TgZ(19,"label",8),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"div",10)(23,"app-datetimepicker",15),e.NdJ("bsValueChange",function(U){return n.form.dateTime=U}),e.qZA()()()(),e.TgZ(24,"div",16)(25,"div",17)(26,"div",18),e.YNc(27,I,4,3,"button",19),e.qZA(),e.TgZ(28,"div",20)(29,"button",21),e.NdJ("click",function(){return n.cancel()}),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"button",22),e._uU(33),e.ALo(34,"translate"),e.qZA()()()()()()()}if(2&r){const g=e.MAs(3),C=e.MAs(15),U=e.MAs(18);e.Q6J("ngIf",!n.isCreate),e.xp6(5),e.Q6J("ngIf",n.form.id),e.xp6(6),e.hij(" ",e.lcZ(12,11,"Vehicle No.")," "),e.xp6(3),e.Q6J("ngModel",n.form.vehicleNo),e.xp6(2),e.Q6J("ngIf",C.invalid&&(C.dirty||C.touched||g.submitted))("ngIfElse",U),e.xp6(4),e.hij(" ",e.lcZ(21,13,"Estimated time")," "),e.xp6(3),e.Q6J("value",n.form.dateTime),e.xp6(4),e.Q6J("ngIf",n.form.id),e.xp6(3),e.hij(" ",e.lcZ(31,15,"Cancel")," "),e.xp6(3),e.hij(" ",e.lcZ(34,17,"Submit")," ")}},dependencies:[s.O5,b.G,L.J,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.wO,l.nD,l.c5,l.On,l.F,v.X$],styles:[".errMsg[_ngcontent-%COMP%]{color:#f4516c}"]}),i})();var $=o(26245),D=o(79118),J=o(40269);const K=function(i){return["..","edit",i]};function S(i,c){if(1&i&&(e.TgZ(0,"td",7)(1,"span"),e._uU(2),e.qZA()(),e.TgZ(3,"td",7)(4,"span")(5,"span"),e._UZ(6,"img",8),e.qZA(),e.TgZ(7,"span"),e._uU(8),e.qZA()()(),e.TgZ(9,"td",7)(10,"span"),e._uU(11),e.ALo(12,"date"),e.qZA()(),e.TgZ(13,"td",7)(14,"span",9)(15,"a",10),e._UZ(16,"i",11),e.qZA()()()),2&i){const r=c.$implicit,n=e.oxw();e.xp6(1),e.Udp("width",n.tableHeaders[0].width),e.xp6(1),e.hij(" ",r.id," "),e.xp6(2),e.Udp("width",n.tableHeaders[1].width),e.xp6(2),e.Q6J("src",n.vehicleTypeLogo(r.vehicleType),e.LSH),e.xp6(2),e.Oqu(r.vehicleNo),e.xp6(2),e.Udp("width",n.tableHeaders[2].width),e.xp6(1),e.hij(" ",e.xi3(12,13,r.dateTime,"medium")," "),e.xp6(3),e.Udp("width",n.tableHeaders[3].width),e.xp6(1),e.Q6J("routerLink",e.VKq(16,K,r.id))}}const B=function(){return["../create"]};const j=[{path:"",component:h.f,children:[{path:"",component:M,children:[{path:"",redirectTo:"create",pathMatch:"full"},{path:"create",component:y,data:{breadcrumb:{label:"Create Visitor"}}},{path:"overview",component:(()=>{class i extends D.Gw{constructor(r){super(),this.visitorVehicleService=r,this.tableHeaders=[{text:"ID",column:"id",width:"80px"},{text:"Vehicle",column:"vehiclePlateNo",width:"120px"},{text:"Estimated time",column:"estimatedTime",width:"200px"},{text:"Actions",width:"100px"}],this.loading=!1,this.pagination=(0,$.f$)(),this.dateRange=[],this.data=[]}get filterParams(){return{}}ngOnInit(){this.reloadData()}pageChanged(r){this.pagination=r,this.reloadData()}reloadData(){this.reloadDataService(this.visitorVehicleService,"getAllVehicleDisplays")}vehicleTypeLogo(r){return(0,d.e9Z)(d.php,r,"icon")}}return i.\u0275fac=function(r){return new(r||i)(e.Y36(a.E))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-visitor-displays-overview"]],features:[e.qOj],decls:12,vars:11,consts:[[1,"form-group","m-form__group","m-portlet__filters"],[1,"m-portlet__filter"],[1,"btn","btn-main","m-btn","m-btn--custom","m-btn--icon","m-btn--air","m-btn--pill",3,"routerLink"],[1,"la","la-plus"],[3,"headers","items","isExtended","loading","pagination","scrollingDisabled","pageChanged"],["whitelistTable",""],["rowTemplate",""],[1,"m-datatable__cell"],["alt","",3,"src"],[1,"cell-actions"],[1,"btn","btn-outline-primary","m-btn","m-btn--icon","m-btn--icon-only","m-btn--custom","m-btn--pill","no-border",3,"routerLink"],[1,"la","la-edit"]],template:function(r,n){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"a",2)(3,"span"),e._UZ(4,"i",3),e.TgZ(5,"span"),e._uU(6),e.ALo(7,"translate"),e.qZA()()()()(),e.TgZ(8,"app-datatable",4,5),e.NdJ("pageChanged",function(C){return n.pageChanged(C)}),e.YNc(10,S,17,18,"ng-template",null,6,e.W1O),e.qZA()),2&r&&(e.xp6(2),e.Q6J("routerLink",e.DdM(10,B)),e.xp6(4),e.hij(" ",e.lcZ(7,8,"Create Visitor")," "),e.xp6(2),e.Q6J("headers",n.tableHeaders)("items",n.data)("isExtended",!0)("loading",n.loading)("pagination",n.pagination)("scrollingDisabled",!0))},dependencies:[u.yS,J.Uo,D.nE,s.uU,v.X$]}),i})(),data:{breadcrumb:{label:"Visitor Overview"}}}]},{path:"edit",component:p.O,children:[{path:":id",component:y,data:{breadcrumb:{label:"Edit Visitor"}},resolve:{item:t.$X}}]}]}];let Q=(()=>{class i{}return i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[a.E,t.$X],imports:[s.ez,u.Bz.forChild(j),_.x,m.D,l.u5,v.aw.forChild({loader:{provide:v.Zw,useFactory:f.createTranslateLoader,deps:[V.eN]}}),u.Bz]}),i})()}}]);