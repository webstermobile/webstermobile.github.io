"use strict";(self.webpackChunkst_admin=self.webpackChunkst_admin||[]).push([[9679],{11917:(q,j,n)=>{n.d(j,{X:()=>Z});var e=n(94650),x=n(34793),F=n(20388),l=n(66616),P=n(47044),I=n(21811);let Z=(()=>{class U{constructor(R,y){this.router=R,this.bsModalRef=y,this.cancel=new e.vpe,this.submit=new e.vpe}doSubmit(){this.submit.emit()}doCancel(){this.cancel.emit()}}return U.\u0275fac=function(R){return new(R||U)(e.Y36(x.F0),e.Y36(F.UZ))},U.\u0275cmp=e.Xpm({type:U,selectors:[["confirm-modal"]],inputs:{options:"options"},outputs:{cancel:"cancel",submit:"submit"},decls:10,vars:4,consts:[[1,"modal-body"],[1,"modal-title"],[1,"modal-msg"],[1,"modal-btns"],["type","button","nz-button","","nzType","primary","nzGhost","",3,"click"],["type","button","nz-button","","nzType","primary",3,"click"]],template:function(R,y){1&R&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2),e._uU(4),e.qZA(),e.TgZ(5,"div",3)(6,"button",4),e.NdJ("click",function(){return y.doCancel()}),e._uU(7),e.qZA(),e.TgZ(8,"button",5),e.NdJ("click",function(){return y.doSubmit()}),e._uU(9),e.qZA()()()),2&R&&(e.xp6(2),e.hij(" ",y.options.title," "),e.xp6(2),e.Oqu(y.options.message),e.xp6(3),e.hij(" ",y.options.cancelText||"Cancel"," "),e.xp6(2),e.hij(" ",y.options.submitText||"Submit"," "))},dependencies:[l.ix,P.w,I.dQ],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-items:center;align-items:center}.modal-body[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{color:#6c6e86}.modal-body[_ngcontent-%COMP%]   .modal-msg[_ngcontent-%COMP%]{color:#868aa8}.modal-body[_ngcontent-%COMP%]   .modal-btns[_ngcontent-%COMP%]{margin-top:20px}.modal-body[_ngcontent-%COMP%]   .modal-btns[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 10px}"]}),U})()},53033:(q,j,n)=>{n.d(j,{Z:()=>F,e:()=>l});var e=n(36895),x=n(94650);let F=(()=>{class P extends e.H9{transform(Z,U,z,R,y){if(!U)return"";switch(U.toUpperCase()){case"MMK":return`MMK ${Z}`;case"SGD":return`$${Z}`;default:return super.transform(Z,U,z,R,y)}}}return P.\u0275fac=function(){let I;return function(U){return(I||(I=x.n5z(P)))(U||P)}}(),P.\u0275pipe=x.Yjl({name:"excurrency",type:P,pure:!0}),P})(),l=(()=>{class P{transform(Z){return Z/100}}return P.\u0275fac=function(Z){return new(Z||P)},P.\u0275pipe=x.Yjl({name:"cent2Dollar",type:P,pure:!0}),P})()},76916:(q,j,n)=>{n.d(j,{G:()=>t});var e=n(34793),x=n(92198),F=n(38014),l=n(94650),P=n(89383),I=n(60097),Z=n(36895);function U(L,N){if(1&L&&(l.TgZ(0,"a",14)(1,"span",15),l._uU(2),l.ALo(3,"translate"),l.qZA()()),2&L){const g=l.oxw().$implicit;l.xp6(2),l.hij(" ",l.lcZ(3,1,g.label)," ")}}function z(L,N){if(1&L&&(l.TgZ(0,"a",16)(1,"span",15),l._uU(2),l.ALo(3,"translate"),l.qZA()()),2&L){const g=l.oxw(),D=g.$implicit,v=g.last,E=l.oxw(2);l.Q6J("routerLink",D.url)("queryParams",v&&E.route.snapshot.queryParams),l.xp6(2),l.hij(" ",l.lcZ(3,3,D.label)," ")}}function R(L,N){if(1&L&&(l.ynx(0),l.TgZ(1,"li",10)(2,"span"),l._uU(3," > "),l.qZA()(),l.TgZ(4,"li",11),l.YNc(5,U,4,3,"a",12),l.YNc(6,z,4,5,"a",13),l.qZA(),l.BQk()),2&L){const g=N.first;l.xp6(5),l.Q6J("ngIf",g),l.xp6(1),l.Q6J("ngIf",!g)}}function y(L,N){if(1&L){const g=l.EpF();l.TgZ(0,"div",1)(1,"div",2)(2,"div",3),l._UZ(3,"h3",4),l.TgZ(4,"ul",5)(5,"li",6)(6,"a",7),l.NdJ("click",function(){l.CHM(g);const v=l.oxw();return l.KtG(v.jumpHome())}),l._UZ(7,"i",8),l.qZA()(),l.YNc(8,R,7,2,"ng-container",9),l.qZA()(),l.TgZ(9,"div"),l.Hsn(10),l.qZA()()()}if(2&L){const g=l.oxw();l.xp6(3),l.Q6J("innerHTML",g.title,l.oJD),l.xp6(5),l.Q6J("ngForOf",g.breads)}}const Q=["*"];let t=(()=>{class L{constructor(g,D,v,E){this.router=g,this.route=D,this.translate=v,this._carparkService=E,this.breads=[],this.loginUser=""}ngOnInit(){let g=JSON.parse(localStorage.getItem("user-roles"))[0];this.loginUser=g,console.log(this.loginUser,"\u4fe1\u606f"),this.breads=this.buildBreadCrumb(this.route.root),this.translate.get(this.breads[0].label).subscribe(v=>{this.label=v}),this.router.events.pipe((0,x.h)(v=>v instanceof e.m2)).subscribe(()=>{this.breads=this.buildBreadCrumb(this.route.root)})}buildBreadCrumb(g,D=[""],v=[]){const E=g.snapshot.url[0]&&g.snapshot.url[0].path,B=[...D,E],K={...this.extractBreadcrumb(g),url:B},W=E&&K.label?[...v,K]:v;return this.title=K.title||this.title||"",this.isMotorist&&"My Vehicle(s)"===K.label&&(this.title="My Vehicle(s)"),g.firstChild?E?this.buildBreadCrumb(g.firstChild,B,W):this.buildBreadCrumb(g.firstChild,D,v):(this.translate.get(this.title).subscribe(J=>{this.title=J}),W)}get isMotorist(){return this._carparkService.isMotorist()}extractBreadcrumb(g){return g.snapshot.data.breadcrumb instanceof Function?g.snapshot.data.breadcrumb(g):g.snapshot.data.breadcrumb}jumpHome(){let g=JSON.parse(localStorage.getItem("user-roles"))[0]??"";this.router.navigate(g.length?[F.gpL[g]]:["/"])}}return L.\u0275fac=function(g){return new(g||L)(l.Y36(e.F0),l.Y36(e.gz),l.Y36(P.sK),l.Y36(I.x))},L.\u0275cmp=l.Xpm({type:L,selectors:[["app-title-bar"]],ngContentSelectors:Q,decls:1,vars:1,consts:[["class","m-subheader",4,"ngIf"],[1,"m-subheader"],[1,"d-flex","align-items-center"],[1,"mr-auto"],[1,"m-subheader__title","m-subheader__title--separator","text-main",3,"innerHTML"],[1,"m-subheader__breadcrumbs","m-nav","m-nav--inline"],[1,"m-nav__item","m-nav__item--home"],[1,"m-nav__link","m-nav__link--icon",3,"click"],[1,"m-nav__link-icon","la","la-home"],[4,"ngFor","ngForOf"],[1,"m-nav__separator"],[1,"m-nav__item"],["class","m-nav__link",4,"ngIf"],["class","m-nav__link",3,"routerLink","queryParams",4,"ngIf"],[1,"m-nav__link"],[1,"m-nav__link-text"],[1,"m-nav__link",3,"routerLink","queryParams"]],template:function(g,D){1&g&&(l.F$t(),l.YNc(0,y,11,2,"div",0)),2&g&&l.Q6J("ngIf","ROLE_TPO_PARTNER"!==D.loginUser)},dependencies:[Z.sg,Z.O5,e.yS,P.X$],encapsulation:2}),L})()},72156:(q,j,n)=>{n.d(j,{H:()=>C});var e=n(94650),x=n(38014),F=n(28555),l=n(17489),I=(n(19612),n(20388)),Z=n(69440),U=n(89383),z=n(36895),R=n(11917),y=n(66616),Q=n(47044),t=n(21811),L=n(8929),N=n(1059),g=n(80013),D=n(75778),v=n(2994),E=n(87545),B=n(24850),K=n(88117),W=n(72986),J=n(34793),H=n(64050),S=n(24006),$=n(38231);function O(o,A){if(1&o&&e._UZ(0,"nz-option",9),2&o){const i=A.$implicit,d=e.oxw();e.Q6J("nzValue",i)("nzLabel",d.displayDriverOption(i))}}let T=(()=>{class o{constructor(i,d,m){this.router=i,this.bsModalRef=d,this.driverService=m,this.cancel=new e.vpe,this.submit=new e.vpe,this.options={},this.driverInput$=new L.xQ}ngOnInit(){this.driver$=this.driverInput$.pipe((0,N.O)(""),(0,g.b)(400),(0,D.x)(),(0,v.b)(()=>this.driverLoading=!0),(0,E.w)(i=>this.driverService.getEnforcementList().pipe((0,B.U)(d=>i?d.filter(m=>-1!==this.displayDriverOption(m).toLowerCase().indexOf(i.toLowerCase())):d.slice(0,40)),(0,v.b)(()=>{this.driverLoading=!1}))),(0,K.B)()),this.driver$.pipe((0,W.q)(1)).subscribe(i=>{this.driver=i[0]})}doSubmit(){this.submit.emit(this.driver)}doCancel(){this.cancel.emit()}displayDriverOption(i){return[[i.firstName,i.lastName].filter(m=>m).join(" "),i.email,i.mobile].filter(m=>m&&m.length).join(", ")}}return o.\u0275fac=function(i){return new(i||o)(e.Y36(J.F0),e.Y36(I.UZ),e.Y36(H.F))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-assign-modal"]],outputs:{cancel:"cancel",submit:"submit"},decls:17,vars:14,consts:[[1,"modal-header","align-items-center"],[1,"btn","btn-sm",3,"click"],[1,"la","la-times"],[1,"modal-body"],["name","driverControl","nzPlaceHolder","Please Select",2,"width","100%",3,"nzLoading","ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[1,"modal-footer"],["nz-button","","nzType","primary","nzGhost","",3,"click"],["nz-button","","nzType","primary",3,"click"],[3,"nzValue","nzLabel"]],template:function(i,d){1&i&&(e.TgZ(0,"div",0)(1,"h6"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",1),e.NdJ("click",function(){return d.doCancel()}),e._UZ(5,"i",2),e.qZA()(),e.TgZ(6,"div",3)(7,"nz-select",4),e.NdJ("ngModelChange",function(a){return d.driver=a}),e.YNc(8,O,1,2,"nz-option",5),e.ALo(9,"async"),e.qZA()(),e.TgZ(10,"div",6)(11,"button",7),e.NdJ("click",function(){return d.doCancel()}),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"button",8),e.NdJ("click",function(){return d.doSubmit()}),e._uU(15),e.ALo(16,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,6,"Assign To")),e.xp6(5),e.Q6J("nzLoading",d.driverLoading)("ngModel",d.driver),e.xp6(1),e.Q6J("ngForOf",e.lcZ(9,8,d.driver$)),e.xp6(4),e.Oqu(e.lcZ(13,10,"Cancel")),e.xp6(3),e.Oqu(e.lcZ(16,12,"Confirm")))},dependencies:[z.sg,S.JJ,S.On,$.Ip,$.Vq,y.ix,Q.w,t.dQ,z.Ov,U.X$],encapsulation:2}),o})();function b(o,A){if(1&o&&(e.ynx(0),e.TgZ(1,"div",9)(2,"div",10),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",11),e._uU(6),e.qZA()(),e.TgZ(7,"div",9)(8,"div",10),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"div",11),e._uU(12),e.qZA()(),e.BQk()),2&o){const i=e.oxw(2);e.xp6(3),e.Oqu(e.lcZ(4,4,"Assigned By")),e.xp6(3),e.Oqu(i.fault.assignedBy),e.xp6(3),e.Oqu(e.lcZ(10,6,"Assigned To")),e.xp6(3),e.Oqu(i.fault.assignedTo)}}function s(o,A){if(1&o){const i=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"div",10),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",11),e._uU(6),e.qZA()(),e.TgZ(7,"div",9)(8,"div",10),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"div",11),e._uU(12),e.qZA()(),e.TgZ(13,"div",9)(14,"div",10),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",11),e._uU(18),e.qZA()(),e.TgZ(19,"div",9)(20,"div",10),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"div",11),e._uU(24),e.qZA()(),e.TgZ(25,"div",9)(26,"div",10),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"div",11),e._uU(30),e.qZA()(),e._UZ(31,"hr"),e.TgZ(32,"div",9)(33,"div",10),e._uU(34),e.ALo(35,"translate"),e.qZA(),e.TgZ(36,"div",11),e._uU(37),e.qZA()(),e.TgZ(38,"div",9)(39,"div",10),e._uU(40),e.ALo(41,"translate"),e.qZA(),e.TgZ(42,"div",11),e._uU(43),e.qZA()(),e.YNc(44,b,13,8,"ng-container",12),e.TgZ(45,"div",13)(46,"button",14),e.NdJ("click",function(){e.CHM(i);const m=e.oxw(),a=e.MAs(12);return e.KtG(m.openAssign(a))}),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.TgZ(49,"button",15),e.NdJ("click",function(){e.CHM(i);const m=e.oxw(),a=e.MAs(8);return e.KtG(m.openSolve(a))}),e._uU(50),e.ALo(51,"translate"),e.qZA()(),e.TgZ(52,"button",16),e.NdJ("click",function(){e.CHM(i);const m=e.oxw();return e.KtG(m.edit.emit())}),e._UZ(53,"i",17),e._uU(54),e.ALo(55,"translate"),e.qZA(),e.TgZ(56,"button",18),e.NdJ("click",function(){e.CHM(i);const m=e.oxw(),a=e.MAs(10);return e.KtG(m.openSolve(a))}),e._UZ(57,"i",19),e._uU(58),e.ALo(59,"translate"),e.qZA()()}if(2&o){const i=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,21,"Car Park")),e.xp6(3),e.AsE("",null==i.fault.carPark?null:i.fault.carPark.code," ",null==i.fault.carPark?null:i.fault.carPark.name,""),e.xp6(3),e.Oqu(e.lcZ(10,23,"Equipment")),e.xp6(3),e.Oqu(i.fault.equipment),e.xp6(3),e.Oqu(e.lcZ(16,25,"Fault Name")),e.xp6(3),e.Oqu(i.fault.faultName),e.xp6(3),e.Oqu(e.lcZ(22,27,"Level")),e.xp6(3),e.Oqu(i.fault.faultLevel),e.xp6(3),e.Oqu(e.lcZ(28,29,"Remark")),e.xp6(3),e.Oqu(i.fault.remark),e.xp6(4),e.Oqu(e.lcZ(35,31,"Created At")),e.xp6(3),e.Oqu(i.formatTime(i.fault.raisedTime)),e.xp6(3),e.Oqu(e.lcZ(41,33,"Created By")),e.xp6(3),e.Oqu(i.fault.raisedBy),e.xp6(1),e.Q6J("ngIf",i.fault.assignedTo),e.xp6(3),e.Oqu(e.lcZ(48,35,"Assign To")),e.xp6(2),e.Q6J("disabled","assigned"!==i.fault.status),e.xp6(1),e.Oqu(e.lcZ(51,37,"Solve")),e.xp6(4),e.hij(" ",e.lcZ(55,39,"Edit Fault"),""),e.xp6(4),e.hij(" ",e.lcZ(59,41,"Ignore Fault"),"")}}function M(o,A){if(1&o){const i=e.EpF();e.TgZ(0,"confirm-modal",20),e.NdJ("cancel",function(m){e.CHM(i);const a=e.oxw();return e.KtG(a.onCancel(m))})("submit",function(m){e.CHM(i);const a=e.oxw();return e.KtG(a.onSolve(m))}),e.qZA()}if(2&o){const i=e.oxw();e.Q6J("options",i.solveConfirmOpts)}}function h(o,A){if(1&o){const i=e.EpF();e.TgZ(0,"confirm-modal",20),e.NdJ("cancel",function(m){e.CHM(i);const a=e.oxw();return e.KtG(a.onCancel(m))})("submit",function(m){e.CHM(i);const a=e.oxw();return e.KtG(a.onReject(m))}),e.qZA()}if(2&o){const i=e.oxw();e.Q6J("options",i.rejectConfirmOpts)}}function c(o,A){if(1&o){const i=e.EpF();e.TgZ(0,"app-assign-modal",21),e.NdJ("cancel",function(m){e.CHM(i);const a=e.oxw();return e.KtG(a.onCancel(m))})("submit",function(m){e.CHM(i);const a=e.oxw();return e.KtG(a.onAssign(m))}),e.qZA()}}let C=(()=>{class o{constructor(i,d,m,a,_){this.modalService=i,this.modalRef=d,this.maintenanceService=m,this.translate=a,this.store=_,this.cancel=new e.vpe,this.edit=new e.vpe,this.solve=new e.vpe,this.assign=new e.vpe,this.reject=new e.vpe,this.solveConfirmOpts={title:"Are you sure it has resolved?",message:"You won't be able to revert this!",cancelText:"Cancel",submitText:"Confirm"},this.rejectConfirmOpts={title:"Are you sure it has ignored?",message:"You won't be able to revert this!",cancelText:"Cancel",submitText:"Confirm"},this.alive=!0,this.user$=_.pipe((0,F.Ys)("global"))}openSolve(i){this.modalRef=this.modalService.show(i,{class:"modal-dialog-centered"})}onCancel(){this.modalRef.hide()}onSolve(){this.solve.emit({fault:this.fault,callback:()=>this.modalRef.hide()})}onAssign(i){this.assign.emit({fault:{...this.fault,assignedTo:i.userName},callback:()=>this.modalRef.hide()})}onReject(){this.reject.emit({fault:this.fault,callback:()=>this.modalRef.hide()})}openAssign(i){this.modalRef=this.modalService.show(i,{class:"modal-dialog-centered"})}formatTime(i){return this.maintenanceService.formatTime(i)}ngOnInit(){console.log(this.solveConfirmOpts);let i=Object.keys(this.solveConfirmOpts),d=[],m=[];i.forEach(r=>{d.push(this.solveConfirmOpts[r])}),this.translate.get(d).subscribe(r=>{if(Object.keys(r).forEach(u=>{m.push(r[u])}),i.length===m.length){console.log(i,m);for(let u=0;u<i.length;u++)this.solveConfirmOpts[i[u]]=m[u]}});let a=Object.keys(this.rejectConfirmOpts),_=[],p=[];a.forEach(r=>{_.push(this.rejectConfirmOpts[r])}),this.translate.get(_).subscribe(r=>{if(Object.keys(r).forEach(u=>{p.push(r[u])}),console.log(_,p),a.length===p.length)for(let u=0;u<a.length;u++)this.rejectConfirmOpts[a[u]]=p[u]}),this.user$.takeWhile(()=>this.alive).subscribe(({user:r})=>{this.viewOnly=(0,l.intersection)([x.i44.ThirdParty,x.i44.Tester,x.i44.Auditor],r.authorities).length>0})}}return o.\u0275fac=function(i){return new(i||o)(e.Y36(I.tT),e.Y36(I.UZ),e.Y36(Z.N),e.Y36(U.sK),e.Y36(F.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-fault-detail"]],inputs:{fault:"fault"},outputs:{cancel:"cancel",edit:"edit",solve:"solve",assign:"assign",reject:"reject"},decls:13,vars:4,consts:[[1,"header"],[1,"m--font-bolder"],[1,"btn","btn-sm",3,"click"],[1,"la","la-times"],["class","body",4,"ngIf"],["resolveConfirmModal",""],["rejectConfirmModal",""],["assignModal",""],[1,"body"],[1,"detail"],[1,"label"],[1,"content"],[4,"ngIf"],[1,"d-flex","justify-content-between","m--margin-top-30","footer-buttons"],["nz-button","","nzType","primary","nzGhost","",3,"click"],["nz-button","","nzType","primary",3,"disabled","click"],["nz-button","","nzType","primary","nzGhost","",1,"w-100","m--margin-top-50",3,"click"],[1,"la","la-edit"],["nz-button","","nzType","primary","nzGhost","",1,"w-100","m--margin-top-20",3,"click"],[1,"la","la-trash"],[3,"options","cancel","submit"],[3,"cancel","submit"]],template:function(i,d){1&i&&(e.TgZ(0,"div",0)(1,"span",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return d.cancel.emit()}),e._UZ(5,"i",3),e.qZA()(),e.YNc(6,s,60,43,"div",4),e.YNc(7,M,1,1,"ng-template",null,5,e.W1O),e.YNc(9,h,1,1,"ng-template",null,6,e.W1O),e.YNc(11,c,1,0,"ng-template",null,7,e.W1O)),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"Fault Details")),e.xp6(4),e.Q6J("ngIf",d.fault))},dependencies:[z.O5,R.X,y.ix,Q.w,t.dQ,T,U.X$],styles:[".header[_ngcontent-%COMP%]{padding:15px;border-bottom:1px solid #e9ecef;justify-content:space-between;display:flex;align-items:center}.body[_ngcontent-%COMP%]{padding:15px}.body[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]{margin:10px 0}.body[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;color:#a8aec4}.body[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{color:#575962}.body[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex-basis:40%}"]}),o})()},84607:(q,j,n)=>{n.d(j,{s:()=>h});var e=n(94650),x=n(38014),F=n(8929),l=n(1059),P=n(80013),I=n(75778),Z=n(2994),U=n(87545),z=n(24850),R=n(88117),y=n(72986),Q=n(34793),t=n(60097),L=n(71942),N=n(36511),g=n(69440),D=n(7053),v=n(89383),E=n(36895),B=n(24006),K=n(38231),W=n(35635),J=n(66616),H=n(47044),S=n(21811),$=n(28213);function O(c,C){if(1&c&&e._UZ(0,"nz-option",25),2&c){const o=C.$implicit;e.Q6J("nzValue",o.id)("nzLabel",o.name)}}function T(c,C){if(1&c&&e._UZ(0,"nz-option",25),2&c){const o=C.$implicit;e.Q6J("nzValue",o.name)("nzLabel",o.name)}}function b(c,C){if(1&c&&e._UZ(0,"nz-option",25),2&c){const o=C.$implicit;e.Q6J("nzValue",o.code)("nzLabel",o.name)}}function s(c,C){if(1&c){const o=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){const d=e.CHM(o).$implicit,m=e.oxw(2);return e.KtG(m.form.remark=d.value)}),e._uU(1),e.qZA()}if(2&c){const o=C.$implicit;e.xp6(1),e.Oqu(o.code)}}function M(c,C){if(1&c){const o=e.EpF();e.TgZ(0,"div",5)(1,"form",6,7),e.NdJ("ngSubmit",function(i){e.CHM(o);const d=e.MAs(2),m=e.oxw();return i.stopPropagation(),e.KtG(m.createFault(d))}),e.TgZ(3,"div",8)(4,"label",9)(5,"span",10),e._uU(6,"*"),e.qZA(),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"nz-select",11),e.NdJ("ngModelChange",function(i){e.CHM(o);const d=e.oxw();return e.KtG(d.form.carParkId=i)}),e.YNc(10,O,1,2,"nz-option",12),e.ALo(11,"async"),e.qZA()(),e.TgZ(12,"div",8)(13,"label",9)(14,"span",10),e._uU(15,"*"),e.qZA(),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"nz-select",13),e.NdJ("ngModelChange",function(i){e.CHM(o);const d=e.oxw();return e.KtG(d.form.equipment=i)}),e.YNc(19,T,1,2,"nz-option",12),e.ALo(20,"async"),e.qZA()(),e.TgZ(21,"div",8)(22,"label",9)(23,"span",10),e._uU(24,"*"),e.qZA(),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"input",14),e.NdJ("ngModelChange",function(i){e.CHM(o);const d=e.oxw();return e.KtG(d.form.faultName=i)}),e.qZA()(),e.TgZ(28,"div",8)(29,"label",9)(30,"span",10),e._uU(31,"*"),e.qZA(),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"nz-select",15,16),e.NdJ("ngModelChange",function(i){e.CHM(o);const d=e.oxw();return e.KtG(d.form.faultLevel=i)}),e.YNc(36,b,1,2,"nz-option",12),e.ALo(37,"async"),e.qZA()(),e.TgZ(38,"div",8)(39,"label",9)(40,"span",10),e._uU(41,"*"),e.qZA(),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"input",17),e.NdJ("ngModelChange",function(i){e.CHM(o);const d=e.oxw();return e.KtG(d.form.raisedBy=i)}),e.qZA()(),e.TgZ(45,"div",8)(46,"label",9),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.YNc(49,s,2,1,"button",18),e.ALo(50,"async"),e.qZA(),e.TgZ(51,"div",8)(52,"label",9)(53,"span",10),e._uU(54,"*"),e.qZA(),e._uU(55),e.ALo(56,"translate"),e.qZA(),e.TgZ(57,"textarea",19),e.NdJ("ngModelChange",function(i){e.CHM(o);const d=e.oxw();return e.KtG(d.form.remark=i)}),e.qZA()(),e.TgZ(58,"div",20)(59,"label",21),e.NdJ("ngModelChange",function(i){e.CHM(o);const d=e.oxw();return e.KtG(d.form.noteMessageFlag=i)}),e._uU(60),e.ALo(61,"translate"),e.qZA()(),e.TgZ(62,"div",22)(63,"button",23),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.cancel.emit())}),e._uU(64),e.ALo(65,"translate"),e.qZA(),e.TgZ(66,"button",24),e._uU(67),e.ALo(68,"translate"),e.qZA()()()()}if(2&c){const o=e.oxw();e.xp6(7),e.hij(" ",e.lcZ(8,22,"Car Park"),": "),e.xp6(2),e.Q6J("ngModel",o.form.carParkId)("nzLoading",o.carParkLoading),e.xp6(1),e.Q6J("ngForOf",e.lcZ(11,24,o.carParks$)),e.xp6(6),e.hij(" ",e.lcZ(17,26,"Equipment"),": "),e.xp6(2),e.Q6J("ngModel",o.form.equipment),e.xp6(1),e.Q6J("ngForOf",e.lcZ(20,28,o.equipments$)),e.xp6(6),e.hij(" ",e.lcZ(26,30,"Fault Name"),": "),e.xp6(2),e.Q6J("ngModel",o.form.faultName),e.xp6(5),e.hij(" ",e.lcZ(33,32,"Level"),": "),e.xp6(2),e.Q6J("ngModel",o.form.faultLevel),e.xp6(2),e.Q6J("ngForOf",e.lcZ(37,34,o.levels$)),e.xp6(6),e.hij(" ",e.lcZ(43,36,"Created By"),": "),e.xp6(2),e.Q6J("ngModel",o.form.raisedBy),e.xp6(3),e.hij(" ",e.lcZ(48,38,"Predefined remarks"),": "),e.xp6(2),e.Q6J("ngForOf",e.lcZ(50,40,o.remarks$)),e.xp6(6),e.hij(" ",e.lcZ(56,42,"Remark"),": "),e.xp6(2),e.Q6J("ngModel",o.form.remark),e.xp6(2),e.Q6J("ngModel",o.form.noteMessageFlag),e.xp6(1),e.Oqu(e.lcZ(61,44,"Create note message")),e.xp6(4),e.Oqu(e.lcZ(65,46,"Cancel")),e.xp6(3),e.Oqu(e.lcZ(68,48,"Submit"))}}let h=(()=>{class c{constructor(o,A,i,d,m,a,_){this.router=o,this.carParkService=A,this.vehicleService=i,this.codeTablesService=d,this.maintenanceService=m,this.authenticationService=a,this.translate=_,this.cancel=new e.vpe,this.submit=new e.vpe,this.form={carParkId:null,equipment:"",faultName:null,faultLevel:"",raisedBy:this.authenticationService.getCurrentUser().login,raisedTime:new Date,remark:"",noteMessageFlag:!0},this.carParkInput$=new F.xQ,this.vehicleInput$=new F.xQ}ngOnInit(){this.carParks$=this.carParkInput$.pipe((0,l.O)(""),(0,P.b)(200),(0,I.x)(),(0,Z.b)(()=>this.carParkLoading=!0),(0,U.w)(o=>this.carParkService.getSimpleList(o).pipe((0,z.U)(A=>o?A.filter(i=>-1!==i.name.toLowerCase().indexOf(o.toLowerCase())):A.slice(0,20)),(0,Z.b)(()=>this.carParkLoading=!1))),(0,R.B)()),this.carParks$.pipe((0,y.q)(1)).subscribe(o=>{this.form.carParkId=this.form.carParkId||o[0]&&o[0].id}),this.remarks$=this.codeTablesService.filterModelByType(x.BcL.FaultRemark),this.equipments$=this.codeTablesService.filterModelByType(x.BcL.FaultEquipment),this.levels$=this.codeTablesService.filterModelByType(x.BcL.FaultLevel)}createFault(o){return o.valid&&this.submit.emit(this.form)}}return c.\u0275fac=function(o){return new(o||c)(e.Y36(Q.F0),e.Y36(t.x),e.Y36(L.f),e.Y36(N.I),e.Y36(g.N),e.Y36(D.$),e.Y36(v.sK))},c.\u0275cmp=e.Xpm({type:c,selectors:[["app-fault-dialog"]],inputs:{form:"form"},outputs:{cancel:"cancel",submit:"submit"},decls:7,vars:4,consts:[[1,"header"],[1,"m--font-bolder"],[1,"btn","btn-sm",3,"click"],[1,"la","la-times"],["class","body",4,"ngIf"],[1,"body"],[3,"ngSubmit"],["faultForm","ngForm"],[1,"form-group","m-form__group"],["for",""],[1,"m--font-danger"],["required","","nzPlaceHolder","Please Select","name","carParkId",2,"width","100%",3,"ngModel","nzLoading","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["required","","nzPlaceHolder","Please Select","name","equipment",2,"width","100%",3,"ngModel","ngModelChange"],["type","text","name","holiday","nz-input","","id","","required","",3,"ngModel","ngModelChange"],["required","","nzPlaceHolder","Please Select","name","faultLevel",2,"width","100%",3,"ngModel","ngModelChange"],["faultLevel","ngModel"],["disabled","","type","text","name","raisedBy","nz-input","","id","",3,"ngModel","ngModelChange"],["type","button","nz-button","","nzType","primary","nzGhost","","style","margin-bottom:6px;",3,"click",4,"ngFor","ngForOf"],["nz-input","","name","remarkText",3,"ngModel","ngModelChange"],[1,"input-group","m-input-group"],["nz-checkbox","","name","noteMsg",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-between","m--margin-top-30","footer-buttons"],["type","button","nz-button","","nzType","primary","nzGhost","",3,"click"],["type","submit","nz-button","","nzType","primary"],[3,"nzValue","nzLabel"],["type","button","nz-button","","nzType","primary","nzGhost","",2,"margin-bottom","6px",3,"click"]],template:function(o,A){1&o&&(e.TgZ(0,"div",0)(1,"span",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return A.cancel.emit()}),e._UZ(5,"i",3),e.qZA()(),e.YNc(6,M,69,50,"div",4)),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"Fault Details")),e.xp6(4),e.Q6J("ngIf",A.form))},dependencies:[E.sg,E.O5,B._Y,B.Fj,B.JJ,B.JL,B.Q7,B.On,B.F,K.Ip,K.Vq,W.Zp,J.ix,H.w,S.dQ,$.Ie,E.Ov,v.X$],styles:[".header[_ngcontent-%COMP%]{padding:15px;border-bottom:1px solid #e9ecef;justify-content:space-between;display:flex;align-items:center}.body[_ngcontent-%COMP%]{padding:15px}.body[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex-basis:40%}"]}),c})()},19654:(q,j,n)=>{n.d(j,{e:()=>m});var e=n(38014),x=n(79118),F=n(8929),l=n(1059),P=n(80013),I=n(75778),Z=n(2994),U=n(87545),z=n(24850),R=n(5646),y=n(74327),Q=n(52746),t=n(94650),L=n(4666),N=n(60097),g=n(36511),D=n(34793),v=n(69440),E=n(89383),B=n(71942),K=n(36895),W=n(24006),J=n(40269),H=n(38231),S=n(35635),$=n(47044),O=n(834),T=n(73325),b=n(29562);function s(a,_){if(1&a&&t._UZ(0,"nz-option",7),2&a){const p=_.$implicit;t.Q6J("nzValue",p.id)("nzLabel",p.name)}}function M(a,_){if(1&a&&t._UZ(0,"nz-option",7),2&a){const p=_.$implicit;t.Q6J("nzValue",p.name)("nzLabel",p.name)}}function h(a,_){if(1&a&&t._UZ(0,"nz-option",7),2&a){const p=_.$implicit;t.Q6J("nzValue",p.code)("nzLabel",p.name)}}function c(a,_){if(1&a&&t._UZ(0,"nz-option",7),2&a){const p=_.$implicit;t.Q6J("nzValue",p.code)("nzLabel",p.name)}}function C(a,_){if(1&a&&t._uU(0),2&a){const p=_.range;t.lnq(" ",p[0],"-",p[1]," of ",_.$implicit," items\n")}}function o(a,_){if(1&a&&(t.TgZ(0,"th"),t._uU(1),t.qZA()),2&a){const p=_.$implicit;t.xp6(1),t.Oqu(p.text)}}const A=function(a){return["/transactions",a,"update"]};function i(a,_){if(1&a&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.ALo(13,"async"),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"async"),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.ALo(21,"titlecase"),t.qZA(),t.TgZ(22,"td"),t._uU(23),t.ALo(24,"date"),t.qZA(),t.TgZ(25,"td")(26,"button",15),t._UZ(27,"i",16),t.qZA(),t.TgZ(28,"nz-dropdown-menu",null,17)(30,"ul",18)(31,"li",19),t._UZ(32,"i",20),t.TgZ(33,"span"),t._uU(34),t.ALo(35,"translate"),t.qZA()()()()()()),2&a){const p=_.$implicit,r=_.index,u=t.MAs(29),f=t.oxw();t.ekj("ant-table-row-odd",r%2==1),t.xp6(2),t.Oqu(r+1),t.xp6(2),t.Oqu(p.id),t.xp6(2),t.Oqu(null==p.carPark?null:p.carPark.code),t.xp6(2),t.Oqu(p.equipment),t.xp6(2),t.Oqu(p.faultName),t.xp6(2),t.Oqu(t.lcZ(13,16,f.getCreator(p.creator))),t.xp6(3),t.Oqu(p.remark),t.xp6(2),t.Oqu(t.lcZ(18,18,f.getFaultLevel(p.faultLevel))),t.xp6(3),t.Oqu(t.lcZ(21,20,p.status)),t.xp6(3),t.Oqu(t.xi3(24,22,p.raisedTime,"medium")),t.xp6(3),t.Q6J("nzDropdownMenu",u)("nzPlacement","topCenter"),t.xp6(5),t.Q6J("routerLink",t.VKq(27,A,p.id)),t.xp6(3),t.Oqu(t.lcZ(35,25,"Edit Transaction"))}}const d=[{text:"#",width:"60px",align:x.iW.Center},{text:"ID",width:"60px"},{text:"Car Park",width:"120px"},{text:"Equipment",width:"120px"},{text:"Fault Name",width:"120px"},{text:"Creator",width:"120px"},{text:"Remark",width:"120px"},{text:"Level",width:"120px"},{text:"Status",width:"120px"},{text:"Time Created",width:"120px"}];let m=(()=>{class a extends Q.t{constructor(p,r,u,f,Y,k,V){super(),this.transactionService=p,this.carParkService=r,this.codeTablesService=u,this.route=f,this.maintenanceService=Y,this.translate=k,this.vehicleService=V,this.tableHeaders=this.isOperator?d:[...d,{text:"Action",width:"80px"}],this.keyword="",this.dateRange=[],this.carParkInput$=new F.xQ,this.equipment="",this.level="",this.creator="",this.status="",this.keyword$=new F.xQ}ngOnInit(){this.reloadData(),this.carParks$=this.carParkInput$.pipe((0,l.O)(""),(0,P.b)(200),(0,I.x)(),(0,Z.b)(()=>this.carParkLoading=!0),(0,U.w)(r=>this.carParkService.getSimpleList(r).pipe((0,z.U)(u=>r?u.filter(f=>-1!==f.name.toLowerCase().indexOf(r.toLowerCase())):u.slice(0,20)),(0,Z.b)(()=>this.carParkLoading=!1))));const p=this.tableHeaders.map(r=>r.text);this.translate.get(p).subscribe(r=>{this.tableHeaders.forEach(u=>{for(let f in r)r.hasOwnProperty(f)&&u.text===f&&(u.text=r[f])})}),this.equipments$=this.codeTablesService.filterModelByType(e.BcL.FaultEquipment),this.levels$=this.codeTablesService.filterModelByType(e.BcL.FaultLevel).pipe((0,R._)(1),(0,y.x)()),this.creators$=this.codeTablesService.filterModelByType(e.BcL.FaultCreator).pipe((0,R._)(1),(0,y.x)()),this.keyword$.debounceTime(500).subscribe(()=>{this.reloadData()})}get filterParams(){return{carPark:this.carParkId,equipment:this.equipment,level:this.level,creator:this.creator,keyword:this.keyword,status:this.status,sort:"createdDate,desc",from:this.dateRange&&this.dateRange.length?this.dateRange[0].toISOString():void 0,to:this.dateRange&&this.dateRange.length>1?this.dateRange[1].toISOString():void 0}}reloadData(){this.reloadDataService(this.maintenanceService,"filterHistoryFaults")}pageChanged(p){this.pagination=p,this.reloadData()}getFaultLevel(p){return this.levels$.pipe((0,z.U)(r=>{const u=r.find(f=>f.code===p);return u?u.name:""}))}getCreator(p){return this.creators$.pipe((0,z.U)(r=>{const u=r.find(f=>f.code===p);return u?u.name:""}))}get isOperator(){return this.vehicleService.isOperator()}}return a.\u0275fac=function(p){return new(p||a)(t.Y36(L.p),t.Y36(N.x),t.Y36(g.I),t.Y36(D.gz),t.Y36(v.N),t.Y36(E.sK),t.Y36(B.f))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-maintenance-fault-history"]],features:[t.qOj],decls:63,vars:56,consts:[[1,"form-group","m-form__group","m-portlet__filters"],[1,"m-portlet__filter"],[1,"col-form-label"],["nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","nzLoading","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel"],[1,"m-input-icon","m-input-icon--left"],["type","text","nz-input","","placeholder","",3,"ngModel","ngModelChange"],["rangeTemplate",""],[3,"nzData","nzFrontPagination","nzLoading","nzTotal","nzPageSize","nzPageIndex","nzShowSizeChanger","nzShowTotal","nzQueryParams"],["basicTable",""],[4,"ngFor","ngForOf"],[3,"ant-table-row-odd",4,"ngFor","ngForOf"],["nz-dropdown","","nzTrigger","click",1,"btn","btn-outline-primary","m-btn","m-btn--icon","m-btn--icon-only","m-btn--custom","m-btn--outline-2x","m-btn--pill","no-border",3,"nzDropdownMenu","nzPlacement"],[1,"la","la-ellipsis-h"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"routerLink"],[1,"la","la-edit",2,"margin-right","4px"]],template:function(p,r){if(1&p&&(t.TgZ(0,"div",0)(1,"div",1)(2,"label",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div")(6,"nz-select",3),t.NdJ("ngModelChange",function(f){return r.carParkId=f})("ngModelChange",function(){return r.reloadData()}),t.YNc(7,s,1,2,"nz-option",4),t.ALo(8,"async"),t.qZA()()(),t.TgZ(9,"div",1)(10,"label",2),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"div")(14,"nz-select",5),t.NdJ("ngModelChange",function(f){return r.equipment=f})("ngModelChange",function(){return r.reloadData()}),t.YNc(15,M,1,2,"nz-option",4),t.ALo(16,"async"),t.qZA()()(),t.TgZ(17,"div",1)(18,"label",2),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.TgZ(21,"div")(22,"nz-select",5),t.NdJ("ngModelChange",function(f){return r.level=f})("ngModelChange",function(){return r.reloadData()}),t.YNc(23,h,1,2,"nz-option",4),t.ALo(24,"async"),t.qZA()()(),t.TgZ(25,"div",1)(26,"label",2),t._uU(27),t.ALo(28,"translate"),t.qZA(),t.TgZ(29,"div")(30,"nz-select",5),t.NdJ("ngModelChange",function(f){return r.creator=f})("ngModelChange",function(){return r.reloadData()}),t.YNc(31,c,1,2,"nz-option",4),t.ALo(32,"async"),t.qZA()()(),t.TgZ(33,"div",1)(34,"label",2),t._uU(35),t.ALo(36,"translate"),t.qZA(),t.TgZ(37,"div")(38,"nz-range-picker",6),t.NdJ("ngModelChange",function(f){return r.dateRange=f})("ngModelChange",function(){return r.reloadData()}),t.qZA()()(),t.TgZ(39,"div",1)(40,"label",2),t._uU(41),t.ALo(42,"translate"),t.qZA(),t.TgZ(43,"div")(44,"nz-select",5),t.NdJ("ngModelChange",function(f){return r.status=f})("ngModelChange",function(){return r.reloadData()}),t._UZ(45,"nz-option",7),t.ALo(46,"translate"),t._UZ(47,"nz-option",7),t.ALo(48,"translate"),t.qZA()()(),t.TgZ(49,"div",1)(50,"label",2),t._uU(51," Remark / Fault Name: "),t.qZA(),t.TgZ(52,"div",8)(53,"input",9),t.NdJ("ngModelChange",function(f){return r.keyword=f})("ngModelChange",function(f){return r.keyword$.next(f)}),t.qZA()()()(),t.YNc(54,C,1,3,"ng-template",null,10,t.W1O),t.TgZ(56,"nz-table",11,12),t.NdJ("nzQueryParams",function(f){return r.onQueryParamsChange(f)}),t.TgZ(58,"thead")(59,"tr"),t.YNc(60,o,2,1,"th",13),t.qZA()(),t.TgZ(61,"tbody"),t.YNc(62,i,36,29,"tr",14),t.qZA()()),2&p){const u=t.MAs(55),f=t.MAs(57);t.xp6(3),t.hij(" ",t.lcZ(4,32,"Car Park"),": "),t.xp6(3),t.Q6J("ngModel",r.carParkId)("nzLoading",r.carParkLoading),t.xp6(1),t.Q6J("ngForOf",t.lcZ(8,34,r.carParks$)),t.xp6(4),t.hij(" ",t.lcZ(12,36,"Equipment"),": "),t.xp6(3),t.Q6J("ngModel",r.equipment),t.xp6(1),t.Q6J("ngForOf",t.lcZ(16,38,r.equipments$)),t.xp6(4),t.hij(" ",t.lcZ(20,40,"Level"),": "),t.xp6(3),t.Q6J("ngModel",r.level),t.xp6(1),t.Q6J("ngForOf",t.lcZ(24,42,r.levels$)),t.xp6(4),t.hij(" ",t.lcZ(28,44,"Creator"),": "),t.xp6(3),t.Q6J("ngModel",r.creator),t.xp6(1),t.Q6J("ngForOf",t.lcZ(32,46,r.creators$)),t.xp6(4),t.hij(" ",t.lcZ(36,48,"Time Range"),": "),t.xp6(3),t.Q6J("ngModel",r.dateRange),t.xp6(3),t.hij(" ",t.lcZ(42,50,"Status"),": "),t.xp6(3),t.Q6J("ngModel",r.status),t.xp6(1),t.Q6J("nzValue","resolved")("nzLabel",t.lcZ(46,52,"Resolved")),t.xp6(2),t.Q6J("nzValue","ignored")("nzLabel",t.lcZ(48,54,"Ignored")),t.xp6(6),t.Q6J("ngModel",r.keyword),t.xp6(3),t.Q6J("nzData",r.listData)("nzFrontPagination",!1)("nzLoading",r.loading)("nzTotal",r.pagination.totalCount)("nzPageSize",r.pagination.rowsPerPage)("nzPageIndex",r.pagination.page)("nzShowSizeChanger",!0)("nzShowTotal",u),t.xp6(4),t.Q6J("ngForOf",r.tableHeaders),t.xp6(2),t.Q6J("ngForOf",f.data)}},dependencies:[K.sg,W.Fj,W.JJ,W.On,J.N8,J.Uo,J._C,J.Om,J.p0,J.$Z,H.Ip,H.Vq,S.Zp,$.w,O.uw,O.wS,T.wO,T.r9,b.cm,b.RR,D.rH,K.Ov,K.rS,K.uU,E.X$],encapsulation:2}),a})()},798:(q,j,n)=>{n.d(j,{P:()=>i});var e=n(94650),x=n(38014),l=(n(79118),n(21837)),P=n(8929),I=n(1059),Z=n(80013),U=n(75778),z=n(2994),R=n(87545),y=n(24850),Q=n(72986),t=n(52746),L=n(4666),N=n(60097),g=n(36511),D=n(34793),v=n(89383),E=n(71942),B=n(36895),K=n(24006),W=n(40269),J=n(38231),H=n(35635),S=n(47044),$=n(834),O=n(14685),T=n(73325),b=n(29562),s=n(53033);function M(d,m){if(1&d&&e._UZ(0,"nz-option",16),2&d){const a=m.$implicit;e.Q6J("nzValue",a.id)("nzLabel",a.name)}}function h(d,m){if(1&d&&(e._UZ(0,"nz-option",16),e.ALo(1,"titlecase")),2&d){const a=m.$implicit;e.Q6J("nzValue",a.value)("nzLabel",e.lcZ(1,2,a.value))}}function c(d,m){if(1&d&&e._uU(0),2&d){const a=m.range;e.lnq(" ",a[0],"-",a[1]," of ",m.$implicit," items\n")}}function C(d,m){if(1&d&&(e.TgZ(0,"th",17),e._uU(1),e.qZA()),2&d){const a=m.$implicit;e.Q6J("nzWidth",m.first?"60px":""),e.xp6(1),e.Oqu(a.text)}}function o(d,m){if(1&d){const a=e.EpF();e.ynx(0),e.TgZ(1,"tr")(2,"td",18),e.NdJ("nzExpandChange",function(p){const u=e.CHM(a).$implicit,f=e.oxw();return e.KtG(f.onExpandChange(u.id,p))}),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"span"),e._UZ(7,"img",19),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"td"),e._uU(15),e.qZA(),e.TgZ(16,"td"),e._uU(17),e.ALo(18,"date"),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.ALo(23,"cent2Dollar"),e.qZA(),e.TgZ(24,"td"),e._UZ(25,"span",20),e._uU(26," \xa0 "),e.TgZ(27,"span",21),e._uU(28),e.ALo(29,"titlecase"),e.qZA()(),e.TgZ(30,"td"),e._uU(31),e.qZA(),e.TgZ(32,"td")(33,"button",22),e._UZ(34,"i",23),e.qZA(),e.TgZ(35,"nz-dropdown-menu",null,24)(37,"ul",25)(38,"li",26),e.NdJ("click",function(){const r=e.CHM(a).$implicit,u=e.oxw();return e.KtG(u.closeTransactions.emit(r))}),e._UZ(39,"i",27),e.TgZ(40,"span"),e._uU(41,"Close Transaction"),e.qZA()(),e.TgZ(42,"li",26),e.NdJ("click",function(){const r=e.CHM(a).$implicit,u=e.oxw();return e.KtG(u.endTransactions.emit(r))}),e._UZ(43,"i",28),e.TgZ(44,"span"),e._uU(45,"End Transaction"),e.qZA()()()()()(),e.TgZ(46,"tr",29)(47,"nz-table",30)(48,"thead")(49,"tr")(50,"th"),e._uU(51),e.ALo(52,"translate"),e.qZA(),e.TgZ(53,"th"),e._uU(54),e.ALo(55,"translate"),e.qZA(),e.TgZ(56,"th"),e._uU(57),e.ALo(58,"translate"),e.qZA()()(),e.TgZ(59,"tbody")(60,"tr")(61,"td"),e._uU(62),e.ALo(63,"excurrency"),e.ALo(64,"cent2Dollar"),e.qZA(),e.TgZ(65,"td"),e._uU(66),e.ALo(67,"excurrency"),e.ALo(68,"cent2Dollar"),e.qZA(),e.TgZ(69,"td"),e._uU(70),e.ALo(71,"excurrency"),e.ALo(72,"cent2Dollar"),e.qZA()()()()(),e.BQk()}if(2&d){const a=m.$implicit,_=m.index,p=e.MAs(36),r=e.oxw();e.xp6(1),e.ekj("ant-table-row-odd",_%2==1),e.xp6(1),e.Q6J("nzExpand",r.expandSet.has(a.id)),e.xp6(2),e.Oqu(a.id),e.xp6(3),e.Q6J("src",r.vehicleIcon(null==a.vehicle?null:a.vehicle.vehicleType),e.LSH),e.xp6(1),e.hij(" ",null==a.vehicle?null:a.vehicle.vehicleNumber," "),e.xp6(2),e.Oqu(a.entrySessionId),e.xp6(2),e.Oqu(e.xi3(13,23,a.startTime,"medium")),e.xp6(3),e.Oqu(a.exitSessionId),e.xp6(2),e.Oqu(e.xi3(18,26,a.endTime,"medium")),e.xp6(3),e.Oqu(a.duration||0),e.xp6(2),e.Oqu(e.lcZ(23,29,null==a.chargeSummary||null==a.chargeSummary.total?null:a.chargeSummary.total.amount)),e.xp6(6),e.hij(" ",e.lcZ(29,31,a.type)," "),e.xp6(3),e.Oqu(a.status),e.xp6(2),e.Q6J("nzDropdownMenu",p)("nzPlacement","topCenter"),e.xp6(13),e.Q6J("nzExpand",r.expandSet.has(a.id)),e.xp6(5),e.Oqu(e.lcZ(52,33,"Calculation Cost")),e.xp6(3),e.Oqu(e.lcZ(55,35,"Promotions")),e.xp6(3),e.Oqu(e.lcZ(58,37,"Amount to Pay")),e.xp6(5),e.Oqu(e.xi3(63,39,e.lcZ(64,42,(null==a.chargeSummary||null==a.chargeSummary.calculation?null:a.chargeSummary.calculation.amount)||0),null==a.chargeSummary||null==a.chargeSummary.calculation?null:a.chargeSummary.calculation.currency)),e.xp6(4),e.Oqu(e.xi3(67,44,e.lcZ(68,47,(null==a.chargeSummary||null==a.chargeSummary.promotion?null:a.chargeSummary.promotion.amount)||0),null==a.chargeSummary||null==a.chargeSummary.promotion?null:a.chargeSummary.promotion.currency)),e.xp6(4),e.Oqu(e.xi3(71,49,e.lcZ(72,52,(null==a.chargeSummary||null==a.chargeSummary.total?null:a.chargeSummary.total.amount)||0),null==a.chargeSummary||null==a.chargeSummary.total?null:a.chargeSummary.total.currency))}}const A=[{text:"",width:"60px"},{text:"ID",width:"60px"},{text:"Vehicle",width:"120px"},{text:"Entry ID",width:"120px"},{text:"Entry Time",width:"120px"},{text:"Exit ID",width:"200px"},{text:"Exit Time",width:"120px"},{text:"Duration",width:"120px"},{text:"Paid Amount",width:"120px"},{text:"Type",width:"120px"},{text:"Status",width:"120px"},{text:"Action",width:"80px"}];let i=(()=>{class d extends t.t{constructor(a,_,p,r,u,f){super(),this.transactionService=a,this.carParkService=_,this.codeTablesService=p,this.route=r,this.translate=u,this.vehicleService=f,this.tableHeaders=A,this.verifyVehicle=new e.vpe,this.endTransactions=new e.vpe,this.closeTransactions=new e.vpe,this.vehicleIcon=x.mts,this.vehiclePlateNo="",this.statusOptions=x.EKt,this.loading=!1,this.vehicleType="",this.abnormalType="",this.keyword="",this.keyword$=new P.xQ,this.carParkInput$=new P.xQ,this.timeChanged$=new P.xQ,this.expandSet=new Set}ngOnInit(){this.carParks$=this.carParkInput$.pipe((0,I.O)(""),(0,Z.b)(200),(0,U.x)(),(0,z.b)(()=>this.carParkLoading=!0),(0,R.w)(_=>this.carParkService.getSimpleList(_).pipe((0,y.U)(p=>_?p.filter(r=>-1!==r.name.toLowerCase().indexOf(_.toLowerCase())):p.slice(0,20)),(0,z.b)(()=>this.carParkLoading=!1)))),this.keyword$.pipe((0,Z.b)(400)).subscribe(()=>{this.reloadData()}),this.timeChanged$.pipe((0,Z.b)(500)).subscribe(()=>{this.reloadData()}),this.vehicleTypes$=this.codeTablesService.filterModelByType(x.BcL.VehicleType).pipe((0,Q.q)(1)),this.reloadData();const a=this.tableHeaders.map(_=>_.text);this.translate.get(a).subscribe(_=>{this.tableHeaders.forEach(p=>{for(let r in _)_.hasOwnProperty(r)&&p.text===r&&(p.text=_[r])})})}get filterParams(){return{carPark:this.carParkId,keyword:this.keyword,vehicleType:this.vehicleType,abnormalType:this.abnormalType,sort:"createdDate,desc",date:this.date&&l.ou.fromJSDate(this.date).toFormat("yyyy-LL-dd"),timeFrom:this.fromTime&&l.ou.fromJSDate(this.fromTime).toISOTime(),timeTo:this.endTime&&l.ou.fromJSDate(this.endTime).toISOTime()}}reloadData(){this.reloadDataService(this.transactionService,"fetchAbnormalTransactions")}pageChanged(a){this.pagination=a,this.reloadData()}displayTime(a){return a&&l.ou.fromJSDate(a).toLocaleString(l.ou.TIME_24_SIMPLE)}onStartTimeChanged(a){this.endTime&&l.ou.fromJSDate(a).diff(l.ou.fromJSDate(this.endTime)).as("minute")>0&&(this.endTime=a),this.timeChanged$.next(null)}onEndTimeChanged(a){this.endTime&&l.ou.fromJSDate(this.fromTime).diff(l.ou.fromJSDate(a)).as("minute")>0&&(this.fromTime=a),this.timeChanged$.next(null)}get isOperator(){return this.vehicleService.isOperator()}onExpandChange(a,_){_?this.expandSet.add(a):this.expandSet.delete(a)}}return d.\u0275fac=function(a){return new(a||d)(e.Y36(L.p),e.Y36(N.x),e.Y36(g.I),e.Y36(D.gz),e.Y36(v.sK),e.Y36(E.f))},d.\u0275cmp=e.Xpm({type:d,selectors:[["app-maintenance-transactions"]],outputs:{verifyVehicle:"verifyVehicle",endTransactions:"endTransactions",closeTransactions:"closeTransactions"},features:[e.qOj],decls:59,vars:48,consts:[[1,"form-group","m-form__group","m-portlet__filters"],[1,"m-portlet__filter"],[1,"col-form-label"],["nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","nzLoading","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],["nzPlaceHolder","Please Select",2,"width","160px",3,"ngModel","ngModelChange"],["nzValue","NoCarPlateNo",3,"nzLabel"],["nzValue","ExitWithoutEntry",3,"nzLabel"],[1,"m-input-icon","m-input-icon--left"],["type","text","nz-input","","placeholder","",3,"ngModel","ngModelChange"],["rangeTemplate",""],[3,"nzData","nzFrontPagination","nzLoading","nzTotal","nzPageSize","nzPageIndex","nzShowSizeChanger","nzShowTotal"],["basicTable",""],[3,"nzWidth",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"],[3,"nzWidth"],[3,"nzExpand","nzExpandChange"],["alt","",3,"src"],[1,"m-badge","m-badge--info","m-badge--dot"],[1,"m--font-bold","m--font-info"],["nz-dropdown","","nzTrigger","click",1,"btn","btn-outline-primary","m-btn","m-btn--icon","m-btn--icon-only","m-btn--custom","m-btn--outline-2x","m-btn--pill","no-border",3,"nzDropdownMenu","nzPlacement"],[1,"la","la-ellipsis-h"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"],[1,"la","la-close",2,"margin-right","4px"],[1,"la","la-check",2,"margin-right","4px"],[3,"nzExpand"],["nzTemplateMode",""]],template:function(a,_){if(1&a&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div")(6,"nz-select",3),e.NdJ("ngModelChange",function(r){return _.carParkId=r})("ngModelChange",function(){return _.reloadData()}),e.YNc(7,M,1,2,"nz-option",4),e.ALo(8,"async"),e.qZA()()(),e.TgZ(9,"div",1)(10,"label",2),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"div")(14,"nz-date-picker",5),e.NdJ("ngModelChange",function(r){return _.date=r})("ngModelChange",function(){return _.reloadData()}),e.qZA()()(),e.TgZ(15,"div",1)(16,"label",2),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"div")(20,"nz-time-picker",5),e.NdJ("ngModelChange",function(r){return _.fromTime=r})("ngModelChange",function(r){return _.onStartTimeChanged(r)}),e.qZA()()(),e.TgZ(21,"div",1)(22,"label",2),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"div")(26,"nz-time-picker",5),e.NdJ("ngModelChange",function(r){return _.endTime=r})("ngModelChange",function(r){return _.onEndTimeChanged(r)}),e.qZA()()(),e.TgZ(27,"div",1)(28,"label",2),e._uU(29),e.ALo(30,"translate"),e.qZA(),e.TgZ(31,"div")(32,"nz-select",6),e.NdJ("ngModelChange",function(r){return _.vehicleType=r})("ngModelChange",function(){return _.reloadData()}),e.YNc(33,h,2,4,"nz-option",4),e.ALo(34,"async"),e.qZA()()(),e.TgZ(35,"div",1)(36,"label",2),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.TgZ(39,"div")(40,"nz-select",6),e.NdJ("ngModelChange",function(r){return _.abnormalType=r})("ngModelChange",function(){return _.reloadData()}),e._UZ(41,"nz-option",7),e.ALo(42,"translate"),e._UZ(43,"nz-option",8),e.ALo(44,"translate"),e.qZA()()(),e.TgZ(45,"div",1)(46,"label",2),e._uU(47," Vehicle No. / Session Id: "),e.qZA(),e.TgZ(48,"div",9)(49,"input",10),e.NdJ("ngModelChange",function(r){return _.keyword=r})("ngModelChange",function(r){return _.keyword$.next(r)}),e.qZA()()()(),e.YNc(50,c,1,3,"ng-template",null,11,e.W1O),e.TgZ(52,"nz-table",12,13)(54,"thead")(55,"tr"),e.YNc(56,C,2,2,"th",14),e.qZA()(),e.TgZ(57,"tbody"),e.YNc(58,o,73,54,"ng-container",15),e.qZA()()),2&a){const p=e.MAs(51),r=e.MAs(53);e.xp6(3),e.hij(" ",e.lcZ(4,28,"Car Park"),": "),e.xp6(3),e.Q6J("ngModel",_.carParkId)("nzLoading",_.carParkLoading),e.xp6(1),e.Q6J("ngForOf",e.lcZ(8,30,_.carParks$)),e.xp6(4),e.hij(" ",e.lcZ(12,32,"Date"),": "),e.xp6(3),e.Q6J("ngModel",_.date),e.xp6(3),e.hij(" ",e.lcZ(18,34,"From"),": "),e.xp6(3),e.Q6J("ngModel",_.fromTime),e.xp6(3),e.hij(" ",e.lcZ(24,36,"To"),": "),e.xp6(3),e.Q6J("ngModel",_.endTime),e.xp6(3),e.hij(" ",e.lcZ(30,38,"Vehicle Type"),": "),e.xp6(3),e.Q6J("ngModel",_.vehicleType),e.xp6(1),e.Q6J("ngForOf",e.lcZ(34,40,_.vehicleTypes$)),e.xp6(4),e.hij(" ",e.lcZ(38,42,"Abnormal Type"),": "),e.xp6(3),e.Q6J("ngModel",_.abnormalType),e.xp6(1),e.Q6J("nzLabel",e.lcZ(42,44,"NoCarPlateNo")),e.xp6(2),e.Q6J("nzLabel",e.lcZ(44,46,"ExitWithoutEntry")),e.xp6(6),e.Q6J("ngModel",_.keyword),e.xp6(3),e.Q6J("nzData",_.listData)("nzFrontPagination",!1)("nzLoading",_.loading)("nzTotal",_.pagination.totalCount)("nzPageSize",_.pagination.rowsPerPage)("nzPageIndex",_.pagination.page)("nzShowSizeChanger",!0)("nzShowTotal",p),e.xp6(4),e.Q6J("ngForOf",_.tableHeaders),e.xp6(2),e.Q6J("ngForOf",r.data)}},dependencies:[B.sg,K.Fj,K.JJ,K.On,W.N8,W.Uo,W._C,W.h7,W.Om,W.p0,W.$Z,W.d3,W.Vk,J.Ip,J.Vq,H.Zp,S.w,$.uw,O.m4,T.wO,T.r9,b.cm,b.RR,B.Ov,B.rS,B.uU,s.Z,s.e,v.X$],encapsulation:2}),d})()},16233:(q,j,n)=>{n.d(j,{x:()=>O});var e=n(94650),x=n(8929),F=n(26582),l=n(40943),P=n(72986),I=n(1059),Z=n(80013),U=n(75778),z=n(2994),R=n(87545),y=n(24850),Q=n(34793),t=n(60097),L=n(4666),N=n(76284),g=n(20388),D=n(36895),v=n(24006),E=n(11917),B=n(88796),K=n(89383);const W=["faultForm"];function J(T,b){if(1&T&&e._UZ(0,"img",19),2&T){const s=e.oxw(2);e.Q6J("src",s.entryImage,e.LSH)}}function H(T,b){if(1&T&&e._UZ(0,"img",19),2&T){const s=e.oxw(2);e.Q6J("src",s.exitImage,e.LSH)}}function S(T,b){if(1&T){const s=e.EpF();e.TgZ(0,"div",2)(1,"div",3)(2,"form",4,5),e.NdJ("ngSubmit",function(h){e.CHM(s);const c=e.oxw(),C=e.MAs(2);return e.KtG(c.submitVerification(h,C))}),e.TgZ(4,"div",6)(5,"label",7)(6,"span",8),e._uU(7,"*"),e.qZA(),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"ng-select",9),e.NdJ("ngModelChange",function(h){e.CHM(s);const c=e.oxw();return e.KtG(c.transaction.carParkId=h)}),e.ALo(11,"async"),e.qZA()(),e.TgZ(12,"div",6)(13,"label",7)(14,"span",8),e._uU(15,"*"),e.qZA(),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"input",10),e.NdJ("ngModelChange",function(h){e.CHM(s);const c=e.oxw();return e.KtG(c.transaction.carPlateNo=h)}),e.qZA()(),e.TgZ(19,"div",6)(20,"label",7)(21,"span",8),e._uU(22,"*"),e.qZA(),e._uU(23),e.ALo(24,"translate"),e.qZA(),e._UZ(25,"input",11),e.qZA(),e.TgZ(26,"div",6)(27,"label",7)(28,"span",8),e._uU(29,"*"),e.qZA(),e._uU(30),e.ALo(31,"translate"),e.qZA(),e._UZ(32,"input",12),e.ALo(33,"date"),e.qZA(),e.TgZ(34,"div",6)(35,"label",7)(36,"span",8),e._uU(37,"*"),e.qZA(),e._uU(38),e.ALo(39,"translate"),e.qZA(),e._UZ(40,"input",13),e.qZA(),e.TgZ(41,"div",6)(42,"label",7)(43,"span",8),e._uU(44,"*"),e.qZA(),e._uU(45),e.ALo(46,"translate"),e.qZA(),e._UZ(47,"input",14),e.ALo(48,"date"),e.qZA(),e.TgZ(49,"div",15)(50,"button",16),e.NdJ("click",function(){e.CHM(s);const h=e.oxw();return e.KtG(h.cancel.emit())}),e._uU(51),e.ALo(52,"translate"),e.qZA(),e.TgZ(53,"button",17),e._uU(54),e.ALo(55,"translate"),e.qZA()()()(),e.TgZ(56,"div",3),e.YNc(57,J,1,1,"img",18),e.YNc(58,H,1,1,"img",18),e.qZA()()}if(2&T){const s=e.oxw();e.xp6(8),e.hij(" ",e.lcZ(9,19,"Car Park"),": "),e.xp6(2),e.Q6J("items",e.lcZ(11,21,s.carParks$))("ngModel",s.transaction.carParkId)("typeahead",s.carParkInput$)("loading",s.carParkLoading),e.xp6(6),e.hij(" ",e.lcZ(17,23,"Vehicle"),": "),e.xp6(2),e.Q6J("ngModel",s.transaction.carPlateNo),e.xp6(5),e.hij(" ",e.lcZ(24,25,"Entry ID"),": "),e.xp6(2),e.Q6J("value",s.transaction.entrySessionId),e.xp6(5),e.hij(" ",e.lcZ(31,27,"Entry Time"),": "),e.xp6(2),e.Q6J("value",e.xi3(33,29,s.transaction.entryDateTime,"medium")),e.xp6(6),e.hij(" ",e.lcZ(39,32,"Exit ID"),": "),e.xp6(2),e.Q6J("value",s.transaction.exitSessionId),e.xp6(5),e.hij(" ",e.lcZ(46,34,"Exit Time"),": "),e.xp6(2),e.Q6J("value",e.xi3(48,36,s.transaction.exitDateTime,"medium")),e.xp6(4),e.Oqu(e.lcZ(52,39,"Cancel")),e.xp6(3),e.Oqu(e.lcZ(55,41,"Submit")),e.xp6(3),e.Q6J("ngIf",s.entryImage),e.xp6(1),e.Q6J("ngIf",s.exitImage)}}function $(T,b){if(1&T){const s=e.EpF();e.TgZ(0,"confirm-modal",20),e.NdJ("cancel",function(){e.CHM(s);const h=e.oxw();return e.KtG(h.bsModalRef.hide())})("submit",function(){e.CHM(s);const h=e.oxw();return e.KtG(h.onSolve(h.faultForm))}),e.qZA()}if(2&T){const s=e.oxw();e.Q6J("options",s.verificationConfirmOpts)}}let O=(()=>{class T{constructor(s,M,h,c,C,o){this.router=s,this.carParkService=M,this.transactionService=h,this.assetsService=c,this.modalService=C,this.bsModalRef=o,this.cancel=new e.vpe,this.submit=new e.vpe,this.carParkInput$=new x.xQ,this.verificationConfirmOpts={title:"Are you sure it has verified?",cancelText:"Cancel",submitText:"Confirm"}}ngOnInit(){if(!this.transactionId)return setTimeout(()=>this.cancel.emit(),200);this.transactionService.fetchAbnormalTransaction(this.transactionId).subscribe(s=>{this.transaction=s,s.entrySessionId&&this.assetsService.requestSessionImage(s.carParkId,s.entrySessionId).subscribe(()=>{this.assetsService.getSessionImage(s.entrySessionId).pipe((0,F.a)(M=>M.pipe((0,l.g)(1e3),(0,P.q)(5)))).subscribe(M=>{this.entryImage=M})}),s.exitSessionId&&this.assetsService.requestSessionImage(s.carParkId,s.exitSessionId).subscribe(()=>{this.assetsService.getSessionImage(s.exitSessionId).pipe((0,F.a)(M=>M.pipe((0,l.g)(1e3),(0,P.q)(5)))).subscribe(M=>{this.exitImage=M})})}),this.carParks$=this.carParkInput$.pipe((0,I.O)(""),(0,Z.b)(200),(0,U.x)(),(0,z.b)(()=>this.carParkLoading=!0),(0,R.w)(s=>this.carParkService.getSimpleList(s).pipe((0,y.U)(M=>s?M.filter(h=>-1!==h.name.toLowerCase().indexOf(s.toLowerCase())):M.slice(0,20)),(0,z.b)(()=>this.carParkLoading=!1))))}submitVerification(s,M){s.stopPropagation(),this.bsModalRef=this.modalService.show(M,{class:"modal-dialog-centered"})}onSolve(s){s.valid&&this.submit.emit(this.transaction)}}return T.\u0275fac=function(s){return new(s||T)(e.Y36(Q.F0),e.Y36(t.x),e.Y36(L.p),e.Y36(N.z),e.Y36(g.tT),e.Y36(g.UZ))},T.\u0275cmp=e.Xpm({type:T,selectors:[["app-maintenance-vehicle-verification"]],viewQuery:function(s,M){if(1&s&&e.Gf(W,5),2&s){let h;e.iGM(h=e.CRH())&&(M.faultForm=h.first)}},inputs:{transactionId:"transactionId"},outputs:{cancel:"cancel",submit:"submit"},decls:3,vars:1,consts:[["class","row",4,"ngIf"],["verificationModal",""],[1,"row"],[1,"col-6"],[3,"ngSubmit"],["faultForm","ngForm"],[1,"form-group","m-form__group"],["for",""],[1,"m--font-danger"],["bindLabel","name","bindValue","id","name","carParkId","dropdownPosition","bottom","required","",3,"items","ngModel","typeahead","loading","ngModelChange"],["type","text","name","entryId","id","",1,"form-control","m-input","m-input--square",3,"ngModel","ngModelChange"],["readonly","","type","text","name","entryId","id","",1,"form-control","m-input","m-input--square",3,"value"],["readonly","","type","text","name","entryTime","id","",1,"form-control","m-input","m-input--square",3,"value"],["readonly","","type","text","name","exitId","id","",1,"form-control","m-input","m-input--square",3,"value"],["readonly","","type","text","name","exitTime","id","",1,"form-control","m-input","m-input--square",3,"value"],[1,"d-flex","justify-content-between","m--margin-top-30","footer-buttons"],["type","button",1,"btn","btn-outline-main","btn-sm",3,"click"],["type","submit",1,"btn","btn-main","btn-sm"],["width","90%",3,"src",4,"ngIf"],["width","90%",3,"src"],[3,"options","cancel","submit"]],template:function(s,M){1&s&&(e.YNc(0,S,59,43,"div",0),e.YNc(1,$,1,1,"ng-template",null,1,e.W1O)),2&s&&e.Q6J("ngIf",M.transaction)},dependencies:[D.O5,v._Y,v.Fj,v.JJ,v.JL,v.Q7,v.On,v.F,E.X,B.w9,D.Ov,D.uU,K.X$],encapsulation:2}),T})()},46367:(q,j,n)=>{n.d(j,{P:()=>H});var e=n(94650),x=n(38014),F=n(8929),l=n(1059),P=n(80013),I=n(75778),Z=n(2994),U=n(87545),z=n(24850),R=n(88117),y=n(72986),Q=n(34793),t=n(60097),L=n(71942),N=n(36511),g=n(69440),D=n(89383),v=n(36895),E=n(24006),B=n(88796);function K(S,$){if(1&S&&(e.TgZ(0,"option",21),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&S){const O=$.$implicit;e.Q6J("value",O.code),e.xp6(1),e.Oqu(e.lcZ(2,2,O.value))}}function W(S,$){1&S&&(e.TgZ(0,"div",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&S&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function J(S,$){if(1&S&&(e.TgZ(0,"div",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&S){const O=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,O.vehicleNoMessage)," ")}}let H=(()=>{class S{constructor(O,T,b,s,M,h){this.router=O,this.carParkService=T,this.vehicleService=b,this.codeTablesService=s,this.maintenanceService=M,this.translate=h,this.submit=new e.vpe,this.cancel=new e.vpe,this.form={carParkId:null,remark:null,vehicleNumber:null,vehicleType:null},this.carParkInput$=new F.xQ,this.vehicleInput$=new F.xQ,this.vehicleNoMessage=x.vwt.VehicleNo}ngOnInit(){this.carParks$=this.carParkInput$.pipe((0,l.O)(""),(0,P.b)(200),(0,I.x)(),(0,Z.b)(()=>this.carParkLoading=!0),(0,U.w)(O=>this.carParkService.getSimpleList(O).pipe((0,z.U)(T=>O?T.filter(b=>-1!==b.name.toLowerCase().indexOf(O.toLowerCase())):T.slice(0,20)),(0,Z.b)(()=>this.carParkLoading=!1))),(0,R.B)()),this.carParks$.pipe((0,y.q)(1)).subscribe(O=>{this.form.carParkId=this.form.carParkId||O[0]&&O[0].id}),this.vehicleTypes$=this.codeTablesService.filterModelByType(x.BcL.VehicleType).map(O=>(this.form.vehicleType=this.form.vehicleType||O[0]&&O[0].code,O))}create(O){return O.valid&&this.submit.emit(this.form)}}return S.\u0275fac=function(O){return new(O||S)(e.Y36(Q.F0),e.Y36(t.x),e.Y36(L.f),e.Y36(N.I),e.Y36(g.N),e.Y36(D.sK))},S.\u0275cmp=e.Xpm({type:S,selectors:[["app-enforcement-create"]],outputs:{submit:"submit",cancel:"cancel"},decls:56,vars:38,consts:[[1,"header"],[1,"m--font-bolder"],[1,"btn","btn-sm",3,"click"],[1,"la","la-times"],[1,"body"],[3,"ngSubmit"],["enforcementForm","ngForm"],[1,"form-group","m-form__group"],[1,"col-form-label"],[1,"m--font-danger"],["bindLabel","name","bindValue","id","name","carParkId","dropdownPosition","bottom",3,"items","ngModel","typeahead","loading","ngModelChange"],["name","vehicleType",1,"form-control","m-input",3,"ngModel","ngModelChange"],["vehicleType","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","form-control-feedback",4,"ngIf"],["type","text","maxlength","8","pattern","^[A-Z0-9]+$","name","vehicleNumber",1,"form-control","m-input",3,"ngModel","ngModelChange"],["vehicleNumber","ngModel"],["name","remark",1,"form-control","m-input",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-between","m--margin-top-30","footer-buttons"],["type","button",1,"btn","btn-outline-main","btn-sm",3,"click"],["type","submit",1,"btn","btn-main","btn-sm"],[3,"value"],[1,"form-control-feedback"]],template:function(O,T){if(1&O){const b=e.EpF();e.TgZ(0,"div",0)(1,"span",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return T.cancel.emit()}),e._UZ(5,"i",3),e.qZA()(),e.TgZ(6,"div",4)(7,"form",5,6),e.NdJ("ngSubmit",function(M){e.CHM(b);const h=e.MAs(8);return M.stopPropagation(),e.KtG(T.create(h))}),e.TgZ(9,"div",7)(10,"label",8)(11,"span",9),e._uU(12,"*"),e.qZA(),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"div")(16,"ng-select",10),e.NdJ("ngModelChange",function(M){return T.form.carParkId=M}),e.ALo(17,"async"),e.qZA()()(),e.TgZ(18,"div",7)(19,"label",8)(20,"span",9),e._uU(21,"*"),e.qZA(),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"div")(25,"select",11,12),e.NdJ("ngModelChange",function(M){return T.form.vehicleType=M}),e.TgZ(27,"option"),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.YNc(30,K,3,4,"option",13),e.ALo(31,"async"),e.qZA(),e.YNc(32,W,3,3,"div",14),e.qZA()(),e.TgZ(33,"div",7)(34,"label",8)(35,"span",9),e._uU(36,"*"),e.qZA(),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.TgZ(39,"div")(40,"input",15,16),e.NdJ("ngModelChange",function(M){return T.form.vehicleNumber=M}),e.qZA(),e.YNc(42,J,3,3,"div",14),e.qZA()(),e.TgZ(43,"div",7)(44,"label",8),e._uU(45),e.ALo(46,"translate"),e.qZA(),e.TgZ(47,"div")(48,"textarea",17),e.NdJ("ngModelChange",function(M){return T.form.remark=M}),e.qZA()()(),e.TgZ(49,"div",18)(50,"button",19),e.NdJ("click",function(){return T.cancel.emit()}),e._uU(51),e.ALo(52,"translate"),e.qZA(),e.TgZ(53,"button",20),e._uU(54),e.ALo(55,"translate"),e.qZA()()()()}if(2&O){const b=e.MAs(26),s=e.MAs(41);e.xp6(2),e.Oqu(e.lcZ(3,18,"Enforcement")),e.xp6(11),e.hij(" ",e.lcZ(14,20,"Car Park"),": "),e.xp6(3),e.Q6J("items",e.lcZ(17,22,T.carParks$))("ngModel",T.form.carParkId)("typeahead",T.carParkInput$)("loading",T.carParkLoading),e.xp6(6),e.hij(" ",e.lcZ(23,24,"Vehicle Type"),": "),e.xp6(3),e.Q6J("ngModel",T.form.vehicleType),e.xp6(3),e.Oqu(e.lcZ(29,26,"Select")),e.xp6(2),e.Q6J("ngForOf",e.lcZ(31,28,T.vehicleTypes$)),e.xp6(2),e.Q6J("ngIf",b.invalid&&(b.dirty||b.touched)),e.xp6(5),e.hij(" ",e.lcZ(38,30,"Vehicle No"),": "),e.xp6(3),e.Q6J("ngModel",T.form.vehicleNumber),e.xp6(2),e.Q6J("ngIf",s.invalid&&(s.dirty||s.touched)),e.xp6(3),e.hij(" ",e.lcZ(46,32,"Remark"),": "),e.xp6(3),e.Q6J("ngModel",T.form.remark),e.xp6(3),e.Oqu(e.lcZ(52,34,"Cancel")),e.xp6(3),e.Oqu(e.lcZ(55,36,"Submit"))}},dependencies:[v.sg,v.O5,E._Y,E.YN,E.Kr,E.Fj,E.EJ,E.JJ,E.JL,E.nD,E.c5,E.On,E.F,B.w9,v.Ov,v.rS,D.X$],styles:[".header[_ngcontent-%COMP%]{padding:15px;border-bottom:1px solid #e9ecef;justify-content:space-between;display:flex;align-items:center}.body[_ngcontent-%COMP%]{padding:15px}.body[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]{margin:10px 0}.body[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;color:#a8aec4}.body[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{color:#575962}.body[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex-basis:40%}"]}),S})()},46442:(q,j,n)=>{n.d(j,{s:()=>D});var e=n(36895),x=n(24006),F=n(372),l=n(60097),P=n(36511),I=n(69440),Z=n(71942),U=n(30329),z=n(21532),R=n(88796),y=n(56776),Q=n(80529),t=n(89383),L=n(19832),N=n(94650);function g(v){return new L.w(v,"../assets/i18n/",".json")}let D=(()=>{class v{}return v.\u0275fac=function(B){return new(B||v)},v.\u0275mod=N.oAB({type:v}),v.\u0275inj=N.cJS({providers:[I.N,P.I,l.x,Z.f],imports:[e.ez,z.x,U.D,x.u5,F.kn,y.Db,R.A0,t.aw.forChild({loader:{provide:t.Zw,useFactory:g,deps:[Q.eN]}})]}),v})()},37713:(q,j,n)=>{n.d(j,{R:()=>b});var e=n(94650),x=n(38014),F=n(20421),l=n(79118),P=n(28555),I=n(8929),Z=n(1059),U=n(80013),z=n(75778),R=n(2994),y=n(87545),Q=n(24850),t=n(17489),g=(n(19612),n(34793)),D=n(69440),v=n(60097),E=n(36511),B=n(89383),K=n(36895),W=n(40269),J=n(24006),H=n(71198),S=n(87501),$=n(88796);function O(s,M){if(1&s&&(e.TgZ(0,"option",20),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&s){const h=M.$implicit;e.Q6J("value",h.code),e.xp6(1),e.hij(" ",e.lcZ(2,2,h.value)," ")}}function T(s,M){if(1&s&&(e.TgZ(0,"td",21)(1,"span"),e._uU(2),e.qZA()(),e.TgZ(3,"td",22)(4,"span"),e._uU(5),e.qZA()(),e.TgZ(6,"td",22)(7,"span")(8,"span"),e._UZ(9,"img",23),e.qZA(),e.TgZ(10,"span"),e._uU(11),e.qZA()()(),e.TgZ(12,"td",22)(13,"span"),e._uU(14),e.qZA()(),e.TgZ(15,"td",22)(16,"span"),e._uU(17),e.ALo(18,"date"),e.qZA()(),e.TgZ(19,"td",22)(20,"span"),e._uU(21),e.qZA()()),2&s){const h=M.$implicit,c=e.oxw();e.xp6(1),e.Udp("width",c.tableHeaders[0].width),e.xp6(1),e.hij(" ",h.id," "),e.xp6(2),e.Udp("width",c.tableHeaders[1].width),e.xp6(1),e.hij(" ",h.id," "),e.xp6(2),e.Udp("width",c.tableHeaders[2].width),e.xp6(2),e.Q6J("src",c.vehicleIcon(h.vehicleType),e.LSH),e.xp6(2),e.Oqu(h.vehicleNumber),e.xp6(2),e.Udp("width",c.tableHeaders[3].width),e.xp6(1),e.hij(" ",null==h.carPark?null:h.carPark.code," "),e.xp6(2),e.Udp("width",c.tableHeaders[4].width),e.xp6(1),e.hij(" ",e.xi3(18,19,h.createdDate,"d LLL yyyy")," "),e.xp6(3),e.Udp("width",c.tableHeaders[5].width),e.xp6(1),e.hij(" ",h.remark," ")}}let b=(()=>{class s extends l.Gw{constructor(h,c,C,o,A,i,d){super(),this.router=h,this.route=c,this.maintenanceService=C,this.carParkService=o,this.codeTablesService=A,this.translate=i,this.store=d,this.openEnforcementCreation=new e.vpe,this.vehicleIcon=F.mt,this.keyword="",this.dateRange=[],this.carParkInput$=new I.xQ,this.vehicleType="",this.keyword$=new I.xQ,this.alive=!0,this.tableHeaders=[{text:"#",width:"30px",align:l.iW.Center},{text:"ID",column:"code",width:"80px"},{text:"Vehicle",column:"vehiclePlateNo",width:"150px"},{text:"Car Park",column:"driverId",width:"150px"},{text:"Date Created",column:"lastVisitedCarParkId",width:"200px"},{text:"Remark",column:"remark",width:"400px"}],this.user$=d.pipe((0,P.Ys)("global"))}get filterParams(){return{carParkId:this.carParkId,from:this.dateRange&&this.dateRange.length?this.dateRange[0].toISOString():void 0,to:this.dateRange&&this.dateRange.length>1?this.dateRange[1].toISOString():void 0,vehicleType:this.vehicleType,keyword:this.keyword,sort:"createdDate,desc"}}gotoCreate(){this.openEnforcementCreation.emit()}reloadData(){this.reloadDataService(this.maintenanceService,"filterEnforcements")}pageChanged(h){this.pagination=h,this.reloadData()}ngOnInit(){this.reloadData(),this.carParks$=this.carParkInput$.pipe((0,Z.O)(""),(0,U.b)(200),(0,z.x)(),(0,R.b)(()=>this.carParkLoading=!0),(0,y.w)(c=>this.carParkService.getSimpleList(c).pipe((0,Q.U)(C=>c?C.filter(o=>-1!==o.name.toLowerCase().indexOf(c.toLowerCase())):C.slice(0,20)),(0,R.b)(()=>this.carParkLoading=!1)))),this.vehicleTypes$=this.codeTablesService.filterModelByType(x.BcL.VehicleType),this.keyword$.debounceTime(500).subscribe(()=>{this.reloadData()});const h=this.tableHeaders.map(c=>c.text);this.translate.get(h).subscribe(c=>{this.tableHeaders.forEach(C=>{for(let o in c)c.hasOwnProperty(o)&&C.text===o&&(C.text=c[o])})}),this.user$.takeWhile(()=>this.alive).subscribe(({user:c})=>{this.viewOnly=(0,t.intersection)([x.i44.ThirdParty,x.i44.Tester,x.i44.Auditor],c.authorities).length>0})}}return s.\u0275fac=function(h){return new(h||s)(e.Y36(g.F0),e.Y36(g.gz),e.Y36(D.N),e.Y36(v.x),e.Y36(E.I),e.Y36(B.sK),e.Y36(P.yh))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-enforcement-home"]],outputs:{openEnforcementCreation:"openEnforcementCreation"},features:[e.qOj],decls:46,vars:34,consts:[[1,"form-group","m-form__group","m-portlet__filters"],[1,"m-portlet__filter","col-2"],[1,"col-form-label"],["placeholder","","bindLabel","name","bindValue","id",3,"items","ngModel","typeahead","dropdownPosition","loading","ngModelChange","change"],[1,"m-portlet__filter"],[1,"m-input-icon","m-input-icon--right"],["type","text","placeholder","","bsDaterangepicker","",1,"form-control","m-input",3,"ngModel","ngModelChange"],[1,"m-input-icon__icon","m-input-icon__icon--right"],[1,"la","la-calendar"],["name","vehicleType",1,"form-control","m-input",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"m-input-icon","m-input-icon--left"],["type","text","placeholder","",1,"form-control","m-input",3,"ngModel","ngModelChange"],[1,"m-input-icon__icon","m-input-icon__icon--left"],[1,"la","la-search"],[1,"btn","btn-main","m-btn","m-btn--custom","m-btn--icon","m-btn--air","m-btn--pill","btn-sm",3,"disabled","click"],[1,"la","la-plus"],[3,"headers","items","loading","pagination","scrollingDisabled","pageChanged"],["rowTemplate",""],[3,"value"],[1,"m-datatable__cell","text-center"],[1,"m-datatable__cell"],["alt","",3,"src"]],template:function(h,c){1&h&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div")(6,"ng-select",3),e.NdJ("ngModelChange",function(o){return c.carParkId=o})("change",function(){return c.reloadData()}),e.ALo(7,"async"),e.qZA()()(),e.TgZ(8,"div",4)(9,"label",2),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div")(13,"div",5)(14,"input",6),e.NdJ("ngModelChange",function(o){return c.dateRange=o})("ngModelChange",function(){return c.reloadData()}),e.qZA(),e.TgZ(15,"span",7)(16,"span"),e._UZ(17,"i",8),e.qZA()()()()(),e.TgZ(18,"div",4)(19,"label",2),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"div")(23,"select",9),e.NdJ("ngModelChange",function(o){return c.vehicleType=o})("ngModelChange",function(){return c.reloadData()}),e.TgZ(24,"option",10),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.YNc(27,O,3,4,"option",11),e.ALo(28,"async"),e.qZA()()(),e.TgZ(29,"div",4)(30,"label",2),e._uU(31," Vehicle No. / Remark "),e.qZA(),e.TgZ(32,"div",12)(33,"input",13),e.NdJ("ngModelChange",function(o){return c.keyword=o})("ngModelChange",function(o){return c.keyword$.next(o)}),e.qZA(),e.TgZ(34,"span",14)(35,"span"),e._UZ(36,"i",15),e.qZA()()()(),e.TgZ(37,"button",16),e.NdJ("click",function(){return c.gotoCreate()}),e.TgZ(38,"span"),e._UZ(39,"i",17),e.TgZ(40,"span"),e._uU(41),e.ALo(42,"translate"),e.qZA()()()(),e.TgZ(43,"app-datatable",18),e.NdJ("pageChanged",function(o){return c.pageChanged(o)}),e.YNc(44,T,22,22,"ng-template",19,19,e.W1O),e.qZA()),2&h&&(e.xp6(3),e.hij(" ",e.lcZ(4,20,"Car Park")," "),e.xp6(3),e.Q6J("items",e.lcZ(7,22,c.carParks$))("ngModel",c.carParkId)("typeahead",c.carParkInput$)("dropdownPosition","bottom")("loading",c.carParkLoading),e.xp6(4),e.hij(" ",e.lcZ(11,24,"Time Range")," "),e.xp6(4),e.Q6J("ngModel",c.dateRange),e.xp6(6),e.hij(" ",e.lcZ(21,26,"Vehicle Type")," "),e.xp6(3),e.Q6J("ngModel",c.vehicleType),e.xp6(2),e.Oqu(e.lcZ(26,28,"All")),e.xp6(2),e.Q6J("ngForOf",e.lcZ(28,30,c.vehicleTypes$)),e.xp6(6),e.Q6J("ngModel",c.keyword),e.xp6(4),e.Q6J("disabled",c.viewOnly),e.xp6(4),e.hij(" ",e.lcZ(42,32,"Create Enforcement")," "),e.xp6(2),e.Q6J("headers",c.tableHeaders)("items",c.data)("loading",c.loading)("pagination",c.pagination)("scrollingDisabled",!0))},dependencies:[K.sg,W.Uo,l.nE,J.YN,J.Kr,J.Fj,J.EJ,J.JJ,J.On,H.T,S.F,$.w9,K.Ov,K.rS,K.uU,B.X$],encapsulation:2}),s})()}}]);