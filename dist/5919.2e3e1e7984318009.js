"use strict";(self.webpackChunkst_admin=self.webpackChunkst_admin||[]).push([[5919],{32997:(He,M,l)=>{l.r(M),l.d(M,{CarParkTariffModule:()=>ze,createTranslateLoader:()=>J});var c=l(36895),p=l(24006),s=l(34793),C=l(36511),q=l(91599),N=l(42684),T=l(31289),A=l(30329),O=l(21532),S=l(80529),m=l(89383),P=l(19832),w=l(22630),e=l(94650);function Q(n){return new P.w(n,"../assets/i18n/",".json")}let L=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[c.ez,p.u5,A.D,s.Bz,w.z,m.aw.forChild({loader:{provide:m.Zw,useFactory:Q,deps:[S.eN]}})]}),n})();var h=l(38014),g=l(79118),z=l(76916),f=l(40269);function Y(n,i){if(1&n&&(e.TgZ(0,"option",19),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.text," ")}}function F(n,i){if(1&n&&(e.TgZ(0,"option",19),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.text," ")}}function D(n,i){1&n&&(e.TgZ(0,"span",31),e._UZ(1,"span",32),e._uU(2," \xa0Normal "),e.qZA())}function E(n,i){1&n&&(e.TgZ(0,"span",33),e._UZ(1,"span",32),e._uU(2," \xa0Season "),e.qZA())}function $(n,i){1&n&&(e.TgZ(0,"span",34),e._UZ(1,"span",32),e._uU(2," \xa0Adhoc "),e.qZA())}const V=function(n){return[n]};function j(n,i){if(1&n&&(e.TgZ(0,"td",20)(1,"span"),e._uU(2),e.qZA()(),e.TgZ(3,"td",21)(4,"span"),e._uU(5),e.qZA()(),e.TgZ(6,"td",21)(7,"span"),e._uU(8),e.qZA()(),e.TgZ(9,"td",21)(10,"span"),e._uU(11),e.ALo(12,"date"),e.qZA()(),e.TgZ(13,"td",21)(14,"span"),e._uU(15),e.ALo(16,"date"),e.qZA()(),e.TgZ(17,"td",21)(18,"span")(19,"span"),e._UZ(20,"img",22),e.qZA(),e.TgZ(21,"span"),e._uU(22),e.qZA()()(),e.TgZ(23,"td",21)(24,"span",23),e.YNc(25,D,3,0,"span",24),e.YNc(26,E,3,0,"span",25),e.YNc(27,$,3,0,"span",26),e.qZA()(),e.TgZ(28,"td",21)(29,"span"),e._uU(30),e.ALo(31,"date"),e.qZA()(),e.TgZ(32,"td",27)(33,"span",28)(34,"a",29),e._UZ(35,"i",30),e.qZA()()()),2&n){const t=i.$implicit,a=e.oxw();e.xp6(1),e.Udp("width",a.tableHeaders[0].width),e.xp6(1),e.hij(" ",t.id," "),e.xp6(2),e.Udp("width",a.tableHeaders[1].width),e.xp6(1),e.hij(" ",t.tariffId," "),e.xp6(2),e.Udp("width",a.tableHeaders[2].width),e.xp6(1),e.hij(" ",t.tariffName," "),e.xp6(2),e.Udp("width",a.tableHeaders[3].width),e.xp6(1),e.hij(" ",e.lcZ(12,31,t.effectiveStartDate)," "),e.xp6(3),e.Udp("width",a.tableHeaders[4].width),e.xp6(1),e.hij(" ",e.lcZ(16,33,t.effectiveEndDate)," "),e.xp6(3),e.Udp("width",a.tableHeaders[5].width),e.xp6(2),e.Q6J("src",a.vehicleIcon(t.vehicleTypeCode),e.LSH),e.xp6(2),e.Oqu(t.vehicleTypeCode),e.xp6(2),e.Udp("width",a.tableHeaders[6].width),e.Q6J("ngSwitch",t.tariffType),e.xp6(1),e.Q6J("ngSwitchCase","Normal"),e.xp6(1),e.Q6J("ngSwitchCase","Season"),e.xp6(1),e.Q6J("ngSwitchCase","Adhoc"),e.xp6(2),e.Udp("width",a.tableHeaders[7].width),e.xp6(1),e.hij(" ",e.lcZ(31,35,t.created)," "),e.xp6(3),e.Udp("width",a.tableHeaders[8].width),e.xp6(1),e.Q6J("routerLink",e.VKq(37,V,t.id))}}let K=(()=>{class n extends g.Gw{constructor(t,a,r,o){super(),this.router=t,this.route=a,this.tariffService=r,this.translate=o,this.breadcrumbs=[{text:"Tariff History"}],this.tableHeaders=[{text:"#",align:g.iW.Center,width:"40px"},{text:"Tariff ID",width:"80px"},{text:"Tariff Name",width:"100px"},{text:"Start Date",width:"100px"},{text:"End Date",width:"100px"},{text:"Vehicle Type",width:"100px"},{text:"Tariff Type",width:"100px"},{text:"Date Created",width:"100px"},{text:"Actions",width:"80px"}],this.vehicleIcon=h.mts}onSubmitted(){}onCanceled(){}reloadData(){this.reloadDataService(this.tariffService)}pageChanged(){}ngOnInit(){const t=this.tableHeaders.map(a=>a.text);this.translate.get(t).subscribe(a=>{this.tableHeaders.forEach(r=>{for(let o in a)a.hasOwnProperty(o)&&r.text===o&&(r.text=a[o])})})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(s.F0),e.Y36(s.gz),e.Y36(T.K),e.Y36(m.sK))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-carpark-tariff-history"]],features:[e.qOj],decls:35,vars:9,consts:[[1,"body-wrapper"],[1,"m-content"],[1,"m-portlet"],[1,"m-portlet__body","m-portlet__body--scrollable"],[1,"m-portlet__frame"],[1,"form-group","m-form__group","m-portlet__filters"],[1,"m-portlet__filter"],[1,"col-form-label"],["name","vehicle",1,"form-control","m-input",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["name","carPark",1,"form-control","m-input",3,"ngModel","ngModelChange"],[1,"m-input-icon","m-input-icon--left"],["type","text","placeholder","",1,"form-control","m-input",3,"ngModel","ngModelChange"],[1,"m-input-icon__icon","m-input-icon__icon--left"],[1,"la","la-search"],[3,"headers","items","loading","scrollingDisabled","pageChanged"],["listTable",""],["rowTemplate",""],[3,"value"],[1,"m-datatable__cell","text-center"],[1,"m-datatable__cell"],["alt","",3,"src"],[1,"m--font-bolder",3,"ngSwitch"],["class","m--font-info",4,"ngSwitchCase"],["class","m--font-primary",4,"ngSwitchCase"],["class","m--font-warning",4,"ngSwitchCase"],[1,"m-datatable__cell","action-cell"],[1,"cell-actions"],[1,"btn","btn-outline-primary","m-btn","m-btn--icon","m-btn--icon-only","m-btn--custom","m-btn--pill","no-border",3,"routerLink"],[1,"la","la-eye"],[1,"m--font-info"],[1,"m-badge","m-badge--info","m-badge--dot"],[1,"m--font-primary"],[1,"m--font-warning"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-title-bar"),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"label",7),e._uU(9," Vehicle Type: "),e.qZA(),e.TgZ(10,"div")(11,"select",8),e.NdJ("ngModelChange",function(o){return a.vehicle=o})("ngModelChange",function(){return a.reloadData()}),e.TgZ(12,"option",9),e._uU(13,"All"),e.qZA(),e.YNc(14,Y,2,2,"option",10),e.qZA()()(),e.TgZ(15,"div",6)(16,"label",7),e._uU(17," Tariff Type "),e.qZA(),e.TgZ(18,"div")(19,"select",11),e.NdJ("ngModelChange",function(o){return a.carPark=o})("ngModelChange",function(){return a.reloadData()}),e.TgZ(20,"option",9),e._uU(21,"All"),e.qZA(),e.YNc(22,F,2,2,"option",10),e.qZA()()(),e.TgZ(23,"div",6)(24,"label",7),e._uU(25," Car Park No. / Car Park Name "),e.qZA(),e.TgZ(26,"div",12)(27,"input",13),e.NdJ("ngModelChange",function(o){return a.keyword=o})("ngModelChange",function(){return a.reloadData()}),e.qZA(),e.TgZ(28,"span",14)(29,"span"),e._UZ(30,"i",15),e.qZA()()()()(),e.TgZ(31,"app-datatable",16,17),e.NdJ("pageChanged",function(){return a.pageChanged()}),e.YNc(33,j,36,39,"ng-template",null,18,e.W1O),e.qZA()()()()()()),2&t&&(e.xp6(11),e.Q6J("ngModel",a.vehicle),e.xp6(3),e.Q6J("ngForOf",a.vehicles),e.xp6(5),e.Q6J("ngModel",a.carPark),e.xp6(3),e.Q6J("ngForOf",a.carParks),e.xp6(5),e.Q6J("ngModel",a.keyword),e.xp6(4),e.Q6J("headers",a.tableHeaders)("items",a.data)("loading",a.loading)("scrollingDisabled",!0))},dependencies:[c.sg,c.RF,c.n9,s.yS,z.G,f.Uo,g.nE,p.YN,p.Kr,p.Fj,p.EJ,p.JJ,p.On,c.uU],encapsulation:2}),n})(),R=(()=>{class n{constructor(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-carpark-tariff-home"]],decls:1,vars:0,template:function(t,a){1&t&&e._UZ(0,"router-outlet")},dependencies:[s.lC],encapsulation:2}),n})();var G=l(17489),B=l(86181),_=l(20388),U=l(60097),H=l(67556),b=l(66616),Z=l(47044),x=l(21811),W=l(52746),X=l(48339),v=l(38231),ee=l(28213),I=l(69659);const te=["evcSelectTariff"];function ae(n,i){if(1&n&&(e._UZ(0,"nz-option",24),e.ALo(1,"titlecase")),2&n){const t=i.$implicit;e.Q6J("nzValue",t.id)("nzLabel",e.lcZ(1,2,t.value))}}function ne(n,i){if(1&n&&e._uU(0),2&n){const t=i.range;e.lnq(" ",t[0],"-",t[1]," of ",i.$implicit," items ")}}function re(n,i){if(1&n&&(e.TgZ(0,"th",25),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.Q6J("nzWidth",i.first?"60px":""),e.xp6(1),e.Oqu(t.text)}}function ie(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"label",29),e.NdJ("ngModelChange",function(r){e.CHM(t);const o=e.oxw().$implicit,d=e.oxw();return e.KtG(d.choosenTariffIds[o.id]=r)}),e.qZA()}if(2&n){const t=e.oxw().$implicit,a=e.oxw();e.MGl("name","tariff",t.id,""),e.Q6J("ngModel",a.choosenTariffIds[t.id])}}function oe(n,i){1&n&&(e.TgZ(0,"span",30),e._UZ(1,"i",31),e.qZA())}function le(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e.YNc(2,ie,1,2,"label",26),e.YNc(3,oe,2,0,"span",27),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td")(9,"span"),e._UZ(10,"img",28),e.qZA(),e.TgZ(11,"span"),e._uU(12),e.qZA()(),e.TgZ(13,"td"),e._uU(14),e.ALo(15,"titlecase"),e.qZA(),e.TgZ(16,"td"),e._uU(17),e.ALo(18,"titlecase"),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.ALo(21,"date"),e.qZA()()),2&n){const t=i.$implicit,a=i.index,r=e.oxw();e.ekj("ant-table-row-odd",a%2==1),e.xp6(2),e.Q6J("ngIf",r.isValidTariff(t)),e.xp6(1),e.Q6J("ngIf",!r.isValidTariff(t)),e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(t.name),e.xp6(3),e.Q6J("src",r.vehicleIcon(t.vehicleTypeCode),e.LSH),e.xp6(2),e.Oqu(t.vehicleTypeCode),e.xp6(2),e.Oqu(e.lcZ(15,11,t.ownerName)),e.xp6(3),e.Oqu(e.lcZ(18,13,t.operatorName)),e.xp6(3),e.Oqu(e.lcZ(21,15,t.createdDate))}}const se=function(){return{y:"240px"}};let ce=(()=>{class n extends W.t{constructor(t,a,r,o,d,u){super(),this.router=t,this.bsModalRef=a,this.tariffService=r,this.codeTablesService=o,this.translate=d,this._alertService=u,this.tariffs=[],this.submit=new e.vpe,this.evcSubmit=new e.vpe,this.cancel=new e.vpe,this.breadcrumbs=[{text:"Tariff History"}],this.tableHeaders=[{text:"",align:g.iW.Center,width:"80px"},{text:"Tariff ID",width:"120px"},{text:"Tariff Name",width:"100px"},{text:"Vehicle Type",width:"100px"},{text:"Owner",width:"100px"},{text:"Operator",width:"100px"},{text:"Date Created",width:"100px"}],this.vehicleIcon=h.mts,this.choosenTariffIds={},this.tariffTypeId=null,this.selectEvcTariff={select:!0,costmodeId:""}}get filterParams(){return{tariffTypeId:this.tariffTypeId}}reloadData(){this.reloadDataService(this.tariffService)}pageChanged(t){this.pagination=t,this.reloadData()}ngOnInit(){this.reloadData(),this.tariffTypes$=this.codeTablesService.filterModelByType(h.BcL.TariffType),this.tariffs.forEach(a=>{this.choosenTariffIds[a.id]=!0});const t=this.tableHeaders.map(a=>a.text);this.translate.get(t).subscribe(a=>{this.tableHeaders.forEach(r=>{for(let o in a)a.hasOwnProperty(o)&&r.text===o&&(r.text=a[o])})}),this.subscription=this._alertService.getBehaviorMessage().subscribe(a=>{a&&(this.selectEvcTariff.costmodeId=a.companyId)})}ngOnDestroy(){this.subscription.unsubscribe()}onCancel(){this.cancel.emit()}isValidTariff(t){return t.ownerId===this.carpark.carParkOwnerId&&t.operatorId===this.carpark.carParkOperatorId}onSubmit(){const t=Object.keys(this.choosenTariffIds).filter(r=>r),a=this.listData.filter(r=>t.indexOf(`${r.id}`)>-1);this.submit.emit(a),this.evcSubmit.emit(this.evcSelectTariff?.evcEvcTariff())}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(s.F0),e.Y36(_.UZ),e.Y36(T.K),e.Y36(C.I),e.Y36(m.sK),e.Y36(X.c))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-carpark-tariff-select"]],viewQuery:function(t,a){if(1&t&&e.Gf(te,5),2&t){let r;e.iGM(r=e.CRH())&&(a.evcSelectTariff=r.first)}},inputs:{carpark:"carpark",tariffs:"tariffs"},outputs:{submit:"submit",evcSubmit:"evcSubmit",cancel:"cancel"},features:[e.qOj],decls:39,vars:30,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"close","pull-right",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"m-content"],[2,"margin-bottom","2.2rem"],[1,"m-portlet__frame"],[1,"form-group","m-form__group","m-portlet__filters"],[1,"m-portlet__filter"],[1,"col-form-label",2,"margin-right","10px"],[1,"m--font-danger"],["name","tariffTypeControl","nzPlaceHolder","Please Select",2,"width","160px",3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["rangeTemplate",""],["nzSize","small",3,"nzData","nzScroll","nzFrontPagination","nzLoading","nzTotal","nzPageSize","nzPageIndex","nzShowSizeChanger","nzShowTotal","nzQueryParams"],["basicTable",""],[3,"nzWidth",4,"ngFor","ngForOf"],[3,"ant-table-row-odd",4,"ngFor","ngForOf"],["createCarpark","true","selectTariff","true",3,"carparkId","isPopMode"],["evcSelectTariff",""],[1,"modal-footer"],["type","button","nz-button","","nzType","primary","nzGhost","",3,"click"],["type","button","nz-button","","nzType","primary",3,"click"],[3,"nzValue","nzLabel"],[3,"nzWidth"],["nz-checkbox","",3,"name","ngModel","ngModelChange",4,"ngIf"],["class","m--padding-right-10",4,"ngIf"],["alt","",3,"src"],["nz-checkbox","",3,"name","ngModel","ngModelChange"],[1,"m--padding-right-10"],[1,"la","la-ban"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return a.onCancel()}),e.TgZ(5,"span",3),e._uU(6,"\xd7"),e.qZA()()(),e.TgZ(7,"div",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"label",10)(14,"span",11),e._uU(15,"*"),e.qZA(),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"nz-select",12),e.NdJ("ngModelChange",function(o){return a.tariffTypeId=o})("ngModelChange",function(){return a.reloadData()}),e.YNc(19,ae,2,4,"nz-option",13),e.ALo(20,"async"),e.qZA()()(),e.YNc(21,ne,1,3,"ng-template",null,14,e.W1O),e.TgZ(23,"nz-table",15,16),e.NdJ("nzQueryParams",function(o){return a.onQueryParamsChange(o)}),e.TgZ(25,"thead")(26,"tr"),e.YNc(27,re,2,2,"th",17),e.qZA()(),e.TgZ(28,"tbody"),e.YNc(29,le,22,17,"tr",18),e.qZA()()()()(),e._UZ(30,"app-evc-tariff-table",19,20),e.qZA(),e.TgZ(32,"div",21)(33,"button",22),e.NdJ("click",function(){return a.onCancel()}),e._uU(34),e.ALo(35,"translate"),e.qZA(),e.TgZ(36,"button",23),e.NdJ("click",function(){return a.onSubmit()}),e._uU(37),e.ALo(38,"translate"),e.qZA()()),2&t){const r=e.MAs(22),o=e.MAs(24);e.xp6(2),e.Oqu(e.lcZ(3,19,"Select Tariff")),e.xp6(14),e.hij(" ",e.lcZ(17,21,"Tariff Type")," "),e.xp6(2),e.Q6J("ngModel",a.tariffTypeId),e.xp6(1),e.Q6J("ngForOf",e.lcZ(20,23,a.tariffTypes$)),e.xp6(4),e.Q6J("nzData",a.listData)("nzScroll",e.DdM(29,se))("nzFrontPagination",!1)("nzLoading",a.loading)("nzTotal",a.pagination.totalCount)("nzPageSize",a.pagination.rowsPerPage)("nzPageIndex",a.pagination.page)("nzShowSizeChanger",!0)("nzShowTotal",r),e.xp6(4),e.Q6J("ngForOf",a.tableHeaders),e.xp6(2),e.Q6J("ngForOf",o.data),e.xp6(1),e.Q6J("carparkId",a.carpark.id)("isPopMode",!0),e.xp6(4),e.Oqu(e.lcZ(35,25,"Cancel")),e.xp6(3),e.Oqu(e.lcZ(38,27,"Confirm"))}},dependencies:[c.sg,c.O5,p.JJ,p.On,f.N8,f.Uo,f._C,f.Om,f.p0,f.$Z,v.Ip,v.Vq,b.ix,Z.w,x.dQ,ee.Ie,I.q,c.Ov,c.rS,c.uU,m.X$],encapsulation:2}),n})();function pe(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"app-carpark-tariff-select",15),e.NdJ("submit",function(r){e.CHM(t);const o=e.oxw();return e.KtG(o.submitTariffs(r))})("cancel",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.hideModal())})("evcSubmit",function(r){e.CHM(t);const o=e.oxw();return e.KtG(o.updateEvcCostmode(r))}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("carpark",t.carpark)("tariffs",t.carpark.tariffs)}}const fe=function(n,i){return[n,i]},de=function(){return["home-carpark"]},me=function(){return["home-evc"]};let he=(()=>{class n extends g.Gw{constructor(t,a,r,o,d,u,y,k,Ue){super(),this.router=t,this.route=a,this.tariffService=r,this.bsModalRef=o,this.modalService=d,this.carParkService=u,this.codeTablesService=y,this.translate=k,this.evcService=Ue,this.tableHeaders=[{text:"#",align:g.iW.Center,width:"40px"},{text:"Tariff ID",width:"120px"},{text:"Tariff Name",width:"100px"},{text:"Start Date",width:"100px"},{text:"End Date",width:"100px"},{text:"Vehicle Type",width:"100px"},{text:"Tariff Type",width:"100px"},{text:"Date Created",width:"100px"},{text:"Status",width:"100px"},{text:"Actions",width:"80px"}],this.vehicleTypeId="",this.tariffTypeId="",this.tariffStatus="",this.keyword="",this.vehicleIcon=h.mts,this.deleteModalOptions={title:"Do you want to delete this tariff?",message:"This can not be reverted"},this.tariffs=[],this.allElectricPriceArr=[],this.moduleName="carparks"}ngOnInit(){this.route.parent.parent.parent.data.subscribe(({item:a})=>{this.carpark=a,this.filterTariffs()}),this.getAllElecticPrice();const t=this.tableHeaders.map(a=>a.text);this.translate.get(t).subscribe(a=>{this.tableHeaders.forEach(r=>{for(let o in a)a.hasOwnProperty(o)&&r.text===o&&(r.text=a[o])})}),this.moduleName=(0,B.pO)()}filterTariffs(){try{return this.tariffs=this.carpark.tariffs.filter(t=>(!this.vehicleTypeId||t.vehicleTypeId===Number(this.vehicleTypeId))&&(!this.tariffTypeId||t.tariffTypeId===Number(this.tariffTypeId))&&t.name.search(new RegExp(this.keyword,"gi"))>-1)}catch{return this.tariffs=[]}}openModal(t,a){this.selectedTariffId=a,this.bsModalRef=this.modalService.show(t,{class:"modal-dialog-centered"})}hideModal(){this.bsModalRef.hide()}deleteTariff(){const t=this.carpark.tariffs.filter(r=>r.id!==this.selectedTariffId),a={...this.carpark,tariffs:t};this.carParkService.updateModel(a.id,a).subscribe(()=>{this.bsModalRef.hide(),this.router.navigate([this.moduleName,this.carpark.id,"tariffs"])})}openSelectModal(t){this.bsModalRef=this.modalService.show(t,{class:"modal-dialog-centered modal-lg"})}reloadData(){}pageChanged(){}submitTariffs(t){const a=(0,G.uniqBy)([...this.carpark.tariffs,...t],"id");this.carParkService.updateModel(this.carpark.id,{...this.carpark,tariffs:a}).subscribe(()=>{this.bsModalRef.hide(),this.router.navigate([this.moduleName,this.carpark.id,"tariffs"])})}updateEvcCostmode(t){if(0!==t.length){console.log(t);const a=this.allElectricPriceArr.filter(o=>o.companyId==t[0].companyId)[0];this.evcService.carparkEvcCostmode({carparkId:this.carpark.id,costmodeId:t[0].costmodeId,electricityfee:a.note,priceType:0,remark:null,servicefee:0,servicefeeComm:null,unifyPrice:0,zoneId:0}).subscribe(o=>{console.log(o),this.bsModalRef.hide(),this.router.navigate([`/${this.moduleName}`])})}}getAllElecticPrice(){this.evcService.getAllElectricPrice({companyName:"",pageNum:1,pageSize:99999}).subscribe(a=>{"00000"==a.messageCode&&(this.allElectricPriceArr=a.data.content)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(s.F0),e.Y36(s.gz),e.Y36(T.K),e.Y36(_.UZ),e.Y36(_.tT),e.Y36(U.x),e.Y36(C.I),e.Y36(m.sK),e.Y36(H.z$))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-carpark-tariff-management"]],features:[e.qOj],decls:26,vars:16,consts:[[1,"body-wrapper"],["nz-button","","nzType","primary","nzGhost","","nzShape","circle",3,"routerLink"],[1,"la","la-reply"],["nz-button","","nzType","primary","nzShape","round",1,"m--margin-left-10",3,"click"],[1,"la","la-plus"],[1,"m-content"],[1,"m-portlet","m-portlet--tabs"],[1,"m-portlet__head"],[1,"m-portlet__head-tools"],["role","tablist",1,"nav","nav-tabs","m-tabs-line","m-tabs-line--primary","m-tabs-line--2x"],[1,"nav-item","m-tabs__item"],[1,"nav-link","m-tabs__link",3,"routerLink","routerLinkActive"],[1,"m-portlet__body","m-portlet__body--scrollable"],[1,"m-portlet__frame"],["selectTariffs",""],[3,"carpark","tariffs","submit","cancel","evcSubmit"]],template:function(t,a){if(1&t){const r=e.EpF();e.TgZ(0,"div",0)(1,"app-title-bar")(2,"button",1),e._UZ(3,"i",2),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){e.CHM(r);const d=e.MAs(25);return e.KtG(a.openSelectModal(d))}),e._UZ(5,"i",4),e.TgZ(6,"span"),e._uU(7," Select Tariff"),e.qZA()()(),e.TgZ(8,"div",5)(9,"div",6)(10,"div",7)(11,"div",8)(12,"ul",9)(13,"li",10)(14,"a",11),e._uU(15),e.ALo(16,"translate"),e.qZA()(),e.TgZ(17,"li",10)(18,"a",11),e._uU(19),e.ALo(20,"translate"),e.qZA()()()()(),e.TgZ(21,"div",12)(22,"div",13),e._UZ(23,"router-outlet"),e.qZA()()()()(),e.YNc(24,pe,1,2,"ng-template",null,14,e.W1O)}2&t&&(e.xp6(2),e.Q6J("routerLink",e.WLB(11,fe,"/"+a.moduleName,null==a.carpark?null:a.carpark.id)),e.xp6(12),e.Q6J("routerLink",e.DdM(14,de))("routerLinkActive","active"),e.xp6(1),e.hij(" ",e.lcZ(16,7,"Carpark")," "),e.xp6(3),e.Q6J("routerLink",e.DdM(15,me))("routerLinkActive","active"),e.xp6(1),e.hij(" ",e.lcZ(20,9,"EVC")," "))},dependencies:[s.lC,s.rH,s.yS,s.Od,z.G,b.ix,Z.w,x.dQ,ce,m.X$],encapsulation:2}),n})();var ue=l(35635),ge=l(11917);function _e(n,i){if(1&n&&(e._UZ(0,"nz-option",14),e.ALo(1,"titlecase")),2&n){const t=i.$implicit;e.Q6J("nzValue",t.id)("nzLabel",e.lcZ(1,2,t.value))}}function Te(n,i){if(1&n&&(e._UZ(0,"nz-option",14),e.ALo(1,"titlecase")),2&n){const t=i.$implicit;e.Q6J("nzValue",t.id)("nzLabel",e.lcZ(1,2,t.value))}}function Ce(n,i){if(1&n&&(e._UZ(0,"nz-option",14),e.ALo(1,"titlecase")),2&n){const t=i.$implicit;e.Q6J("nzValue",t.value)("nzLabel",e.lcZ(1,2,t.value))}}function ve(n,i){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.Oqu(t.text)}}function be(n,i){1&n&&(e.TgZ(0,"span",25),e._UZ(1,"span",26),e._uU(2," \xa0Normal "),e.qZA())}function Ze(n,i){1&n&&(e.TgZ(0,"span",27),e._UZ(1,"span",26),e._uU(2," \xa0Season "),e.qZA())}function xe(n,i){1&n&&(e.TgZ(0,"span",28),e._UZ(1,"span",26),e._uU(2," \xa0Adhoc "),e.qZA())}const ye=function(n){return["/","tariffs",n]};function ke(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"date"),e.qZA(),e.TgZ(11,"td")(12,"span"),e._UZ(13,"img",15),e.qZA(),e.TgZ(14,"span"),e._uU(15),e.qZA()(),e.TgZ(16,"td")(17,"span",16),e.YNc(18,be,3,0,"span",17),e.YNc(19,Ze,3,0,"span",18),e.YNc(20,xe,3,0,"span",19),e.qZA()(),e.TgZ(21,"td"),e._uU(22),e.ALo(23,"date"),e.qZA(),e.TgZ(24,"td")(25,"span",20),e._uU(26," Active "),e.qZA()(),e.TgZ(27,"td")(28,"a",21),e._UZ(29,"i",22),e.qZA(),e.TgZ(30,"button",23),e.NdJ("click",function(){const o=e.CHM(t).$implicit,d=e.oxw(),u=e.MAs(38);return e.KtG(d.openModal(u,o.id))}),e._UZ(31,"i",24),e.qZA()()()}if(2&n){const t=i.$implicit,a=i.index,r=e.oxw();e.ekj("ant-table-row-odd",a%2==1),e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(e.xi3(7,14,t.effectiveStartDate,"medium")),e.xp6(3),e.Oqu(e.xi3(10,17,t.effectiveEndDate,"medium")),e.xp6(4),e.Q6J("src",r.vehicleIcon(t.vehicleTypeCode),e.LSH),e.xp6(2),e.Oqu(t.vehicleTypeCode),e.xp6(2),e.Q6J("ngSwitch",t.tariffType),e.xp6(1),e.Q6J("ngSwitchCase","Normal"),e.xp6(1),e.Q6J("ngSwitchCase","Season"),e.xp6(1),e.Q6J("ngSwitchCase","Adhoc"),e.xp6(2),e.Oqu(e.lcZ(23,20,t.createdDate)),e.xp6(6),e.Q6J("routerLink",e.VKq(22,ye,t.id))}}function Me(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"confirm-modal",29),e.NdJ("cancel",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.hideModal())})("submit",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.deleteTariff())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("options",t.deleteModalOptions)}}const Ae=function(){return["history"]};function J(n){return new P.w(n,"../assets/i18n/",".json")}const we=[{path:"",component:R,children:[{path:"",component:he,children:[{path:"",redirectTo:"home-carpark",pathMatch:"full"},{path:"home-carpark",component:(()=>{class n{constructor(t,a,r,o,d,u,y,k){this.router=t,this.route=a,this.tariffService=r,this.bsModalRef=o,this.modalService=d,this.carParkService=u,this.codeTablesService=y,this.translate=k,this.tableHeaders=[{text:"Tariff ID",width:"120px"},{text:"Tariff Name",width:"100px"},{text:"Start Date",width:"100px"},{text:"End Date",width:"100px"},{text:"Vehicle Type",width:"100px"},{text:"Tariff Type",width:"100px"},{text:"Date Created",width:"100px"},{text:"Status",width:"100px"},{text:"Actions",width:"80px"}],this.vehicleTypeId="",this.tariffTypeId="",this.tariffStatus="",this.keyword="",this.vehicleIcon=h.mts,this.deleteModalOptions={title:"Do you want to delete this tariff?",message:"This can not be reverted"},this.tariffs=[]}ngOnInit(){this.route.parent.parent.parent.parent.data.subscribe(({item:a})=>{this.carpark=a,this.filterTariffs()}),this.vehicleTypes$=this.codeTablesService.filterModelByType(h.BcL.VehicleType),this.tariffTypes$=this.codeTablesService.filterModelByType(h.BcL.TariffType);const t=this.tableHeaders.map(a=>a.text);this.translate.get(t).subscribe(a=>{this.tableHeaders.forEach(r=>{for(let o in a)a.hasOwnProperty(o)&&r.text===o&&(r.text=a[o])})})}filterTariffs(){try{return this.tariffs=this.carpark.tariffs.filter(t=>(!this.vehicleTypeId||t.vehicleTypeId===Number(this.vehicleTypeId))&&(!this.tariffTypeId||t.tariffTypeId===Number(this.tariffTypeId))&&t.name.search(new RegExp(this.keyword,"gi"))>-1)}catch{return this.tariffs=[]}}openModal(t,a){this.selectedTariffId=a,this.bsModalRef=this.modalService.show(t,{class:"modal-dialog-centered"})}hideModal(){this.bsModalRef.hide()}deleteTariff(){const t=this.carpark.tariffs.filter(r=>r.id!==this.selectedTariffId),a={...this.carpark,tariffs:t};this.carParkService.updateModel(a.id,a).subscribe(()=>{this.bsModalRef.hide(),this.router.navigate(["carparks",this.carpark.id,"tariffs"])})}openSelectModal(t){this.bsModalRef=this.modalService.show(t,{class:"modal-dialog-centered modal-lg"})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(s.F0),e.Y36(s.gz),e.Y36(T.K),e.Y36(_.UZ),e.Y36(_.tT),e.Y36(U.x),e.Y36(C.I),e.Y36(m.sK))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-tariff-management-carpark"]],decls:39,vars:17,consts:[[1,"form-group","m-form__group","m-portlet__filters"],[1,"m-portlet__filter"],[1,"col-form-label"],["nzPlaceHolder","Please Select",2,"width","160px",3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[1,"col-form-label",2,"white-space","nowrap"],[1,"m-input-icon","m-input-icon--left"],["type","text","nz-input","","placeholder","","placeholder","Car Park No./Name",3,"ngModel","ngModelChange"],["nz-button","","nzType","primary","nzGhost","","nzShape","round",3,"routerLink"],[1,"la","la-history"],["nzTemplateMode",""],[4,"ngFor","ngForOf"],[3,"ant-table-row-odd",4,"ngFor","ngForOf"],["deleteConfirm",""],[3,"nzValue","nzLabel"],["alt","",3,"src"],[1,"m--font-bolder",3,"ngSwitch"],["class","m--font-info",4,"ngSwitchCase"],["class","m--font-primary",4,"ngSwitchCase"],["class","m--font-warning",4,"ngSwitchCase"],[1,"m-badge","m-badge--primary","m-badge--wide"],[1,"btn","btn-outline-primary","m-btn","m-btn--icon","m-btn--icon-only","m-btn--custom","m-btn--pill","no-border",3,"routerLink"],[1,"la","la-edit"],[1,"btn","btn-outline-primary","m-btn","m-btn--icon","m-btn--icon-only","m-btn--custom","m-btn--pill","no-border",3,"click"],[1,"la","la-close"],[1,"m--font-info"],[1,"m-badge","m-badge--info","m-badge--dot"],[1,"m--font-primary"],[1,"m--font-warning"],[3,"options","cancel","submit"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3," Vehicle Type: "),e.qZA(),e.TgZ(4,"div")(5,"nz-select",3),e.NdJ("ngModelChange",function(o){return a.vehicleTypeId=o})("ngModelChange",function(){return a.filterTariffs()}),e.YNc(6,_e,2,4,"nz-option",4),e.ALo(7,"async"),e.qZA()()(),e.TgZ(8,"div",1)(9,"label",2),e._uU(10," Tariff Type "),e.qZA(),e.TgZ(11,"div")(12,"nz-select",3),e.NdJ("ngModelChange",function(o){return a.tariffTypeId=o})("ngModelChange",function(){return a.filterTariffs()}),e.YNc(13,Te,2,4,"nz-option",4),e.ALo(14,"async"),e.qZA()()(),e.TgZ(15,"div",1)(16,"label",2),e._uU(17," Tariff Status: "),e.qZA(),e.TgZ(18,"div")(19,"nz-select",3),e.NdJ("ngModelChange",function(o){return a.tariffStatus=o})("ngModelChange",function(){return a.filterTariffs()}),e.YNc(20,Ce,2,4,"nz-option",4),e.ALo(21,"async"),e.qZA()()(),e.TgZ(22,"div",1)(23,"label",5),e._uU(24," Car Park No./Name "),e.qZA(),e.TgZ(25,"div",6)(26,"input",7),e.NdJ("ngModelChange",function(o){return a.keyword=o})("ngModelChange",function(){return a.filterTariffs()}),e.qZA()()(),e.TgZ(27,"div",1)(28,"button",8),e._UZ(29,"i",9),e._uU(30," View History "),e.qZA()()(),e.TgZ(31,"nz-table",10)(32,"thead")(33,"tr"),e.YNc(34,ve,2,1,"th",11),e.qZA()(),e.TgZ(35,"tbody"),e.YNc(36,ke,32,24,"tr",12),e.qZA()(),e.YNc(37,Me,1,1,"ng-template",null,13,e.W1O)),2&t&&(e.xp6(5),e.Q6J("ngModel",a.vehicleTypeId),e.xp6(1),e.Q6J("ngForOf",e.lcZ(7,10,a.vehicleTypes$)),e.xp6(6),e.Q6J("ngModel",a.tariffTypeId),e.xp6(1),e.Q6J("ngForOf",e.lcZ(14,12,a.tariffTypes$)),e.xp6(6),e.Q6J("ngModel",a.tariffStatus),e.xp6(1),e.Q6J("ngForOf",e.lcZ(21,14,a.tariffStatuses$)),e.xp6(6),e.Q6J("ngModel",a.keyword),e.xp6(2),e.Q6J("routerLink",e.DdM(16,Ae)),e.xp6(6),e.Q6J("ngForOf",a.tableHeaders),e.xp6(2),e.Q6J("ngForOf",a.tariffs))},dependencies:[c.sg,c.RF,c.n9,s.rH,s.yS,ue.Zp,b.ix,Z.w,x.dQ,v.Ip,v.Vq,f.N8,f.Uo,f._C,f.Om,f.p0,f.$Z,ge.X,p.Fj,p.JJ,p.On,c.Ov,c.rS,c.uU]}),n})(),data:{breadcrumb:{label:"Carpark"}}},{path:"home-evc",component:(()=>{class n{constructor(t,a){this.evcService=t,this.router=a}ngOnInit(){this.carparkId=this.router.url.replace(/[^0-9]/gi,"")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(H.z$),e.Y36(s.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-tariff-management-evc"]],decls:2,vars:2,consts:[[3,"carparkId","pageSize"],["evcTable",""]],template:function(t,a){1&t&&e._UZ(0,"app-evc-tariff-table",0,1),2&t&&e.Q6J("carparkId",a.carparkId)("pageSize",99999)},dependencies:[I.q]}),n})(),data:{breadcrumb:{label:"EVC"}}}]},{path:"history",component:K,data:{breadcrumb:{label:"History"}}}]}];let ze=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[q.k,N.e,T.K,C.I],imports:[c.ez,s.Bz.forChild(we),O.x,A.D,p.u5,L,_.zk.forRoot(),w.z,m.aw.forChild({loader:{provide:m.Zw,useFactory:J,deps:[S.eN]}}),s.Bz]}),n})()}}]);