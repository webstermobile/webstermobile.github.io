"use strict";(self.webpackChunkst_admin=self.webpackChunkst_admin||[]).push([[5380],{83513:(J,A,s)=>{s.d(A,{r:()=>Z,y:()=>f});class f{constructor(i,P,b,x,h,M,m,g){this.email=i,this.id=P,this.username=b,this.address=x,this.nric=h,this.facebookId=M,this.race=m,this.nationality=g}}class Z{constructor(i,P,b,x,h,M,m,g,e,U,u,C,l,_){this.login=i,this.name=P,this.email=b,this.department=x,this.contactNo=h,this.address=M,this.unitNumber=m,this.buildingName=g,this.postalCode=e,this.active=U,this.roadName=u,this.floorNumber=C,this.unitNoApplicable=l,this.blockNo=_}}},54405:(J,A,s)=>{s.d(A,{x:()=>x});var f=s(3927),Z=s(92340),p=s(94650),i=s(80529),P=s(28555),b=s(91599);let x=(()=>{class h extends f.su{constructor(m,g,e){super(m,g),this.http=m,this.store=g,this.modelName="Profile",this.baseUrl="carpark/api/motorist-profiles",this.accountBaseUrl="api/account",this.handleError=e.createHandleError(`${this.modelName}Service`)}getUpdateProfileDetails(){return this.get(this.getUrl(this.baseUrl)).map(m=>this.profile=m)}getUpdateProfileTicket(){return this.get(`${Z.N.apiHost}/carpark/api/organization-profile/NTU/me`).map(g=>this.profile=g)}submitUpdateProfileForm(m=null){return this.post(`${Z.N.apiHost}/${this.baseUrl}`,m)}submitUpdateProfileTicket(m){return this.post(`${Z.N.apiHost}/carpark/api/organization-profile/NTU/me`,m)}submitChangePasswordForm(m=null){return this.post(`${Z.N.apiHost}/${this.accountBaseUrl}/change_password`,m)}searchMsg(m){return this.http.get(`https://developers.onemap.sg/commonapi/search?searchVal=${m}&returnGeom=N&getAddrDetails=Y`)}}return h.\u0275fac=function(m){return new(m||h)(p.LFG(i.eN),p.LFG(P.yh),p.LFG(b.k))},h.\u0275prov=p.Yz7({token:h,factory:h.\u0275fac}),h})()},76916:(J,A,s)=>{s.d(A,{G:()=>U});var f=s(34793),Z=s(92198),p=s(38014),i=s(94650),P=s(89383),b=s(60097),x=s(36895);function h(u,C){if(1&u&&(i.TgZ(0,"a",14)(1,"span",15),i._uU(2),i.ALo(3,"translate"),i.qZA()()),2&u){const l=i.oxw().$implicit;i.xp6(2),i.hij(" ",i.lcZ(3,1,l.label)," ")}}function M(u,C){if(1&u&&(i.TgZ(0,"a",16)(1,"span",15),i._uU(2),i.ALo(3,"translate"),i.qZA()()),2&u){const l=i.oxw(),_=l.$implicit,c=l.last,v=i.oxw(2);i.Q6J("routerLink",_.url)("queryParams",c&&v.route.snapshot.queryParams),i.xp6(2),i.hij(" ",i.lcZ(3,3,_.label)," ")}}function m(u,C){if(1&u&&(i.ynx(0),i.TgZ(1,"li",10)(2,"span"),i._uU(3," > "),i.qZA()(),i.TgZ(4,"li",11),i.YNc(5,h,4,3,"a",12),i.YNc(6,M,4,5,"a",13),i.qZA(),i.BQk()),2&u){const l=C.first;i.xp6(5),i.Q6J("ngIf",l),i.xp6(1),i.Q6J("ngIf",!l)}}function g(u,C){if(1&u){const l=i.EpF();i.TgZ(0,"div",1)(1,"div",2)(2,"div",3),i._UZ(3,"h3",4),i.TgZ(4,"ul",5)(5,"li",6)(6,"a",7),i.NdJ("click",function(){i.CHM(l);const c=i.oxw();return i.KtG(c.jumpHome())}),i._UZ(7,"i",8),i.qZA()(),i.YNc(8,m,7,2,"ng-container",9),i.qZA()(),i.TgZ(9,"div"),i.Hsn(10),i.qZA()()()}if(2&u){const l=i.oxw();i.xp6(3),i.Q6J("innerHTML",l.title,i.oJD),i.xp6(5),i.Q6J("ngForOf",l.breads)}}const e=["*"];let U=(()=>{class u{constructor(l,_,c,v){this.router=l,this.route=_,this.translate=c,this._carparkService=v,this.breads=[],this.loginUser=""}ngOnInit(){let l=JSON.parse(localStorage.getItem("user-roles"))[0];this.loginUser=l,console.log(this.loginUser,"\u4fe1\u606f"),this.breads=this.buildBreadCrumb(this.route.root),this.translate.get(this.breads[0].label).subscribe(c=>{this.label=c}),this.router.events.pipe((0,Z.h)(c=>c instanceof f.m2)).subscribe(()=>{this.breads=this.buildBreadCrumb(this.route.root)})}buildBreadCrumb(l,_=[""],c=[]){const v=l.snapshot.url[0]&&l.snapshot.url[0].path,F=[..._,v],w={...this.extractBreadcrumb(l),url:F},y=v&&w.label?[...c,w]:c;return this.title=w.title||this.title||"",this.isMotorist&&"My Vehicle(s)"===w.label&&(this.title="My Vehicle(s)"),l.firstChild?v?this.buildBreadCrumb(l.firstChild,F,y):this.buildBreadCrumb(l.firstChild,_,c):(this.translate.get(this.title).subscribe(q=>{this.title=q}),y)}get isMotorist(){return this._carparkService.isMotorist()}extractBreadcrumb(l){return l.snapshot.data.breadcrumb instanceof Function?l.snapshot.data.breadcrumb(l):l.snapshot.data.breadcrumb}jumpHome(){let l=JSON.parse(localStorage.getItem("user-roles"))[0]??"";this.router.navigate(l.length?[p.gpL[l]]:["/"])}}return u.\u0275fac=function(l){return new(l||u)(i.Y36(f.F0),i.Y36(f.gz),i.Y36(P.sK),i.Y36(b.x))},u.\u0275cmp=i.Xpm({type:u,selectors:[["app-title-bar"]],ngContentSelectors:e,decls:1,vars:1,consts:[["class","m-subheader",4,"ngIf"],[1,"m-subheader"],[1,"d-flex","align-items-center"],[1,"mr-auto"],[1,"m-subheader__title","m-subheader__title--separator","text-main",3,"innerHTML"],[1,"m-subheader__breadcrumbs","m-nav","m-nav--inline"],[1,"m-nav__item","m-nav__item--home"],[1,"m-nav__link","m-nav__link--icon",3,"click"],[1,"m-nav__link-icon","la","la-home"],[4,"ngFor","ngForOf"],[1,"m-nav__separator"],[1,"m-nav__item"],["class","m-nav__link",4,"ngIf"],["class","m-nav__link",3,"routerLink","queryParams",4,"ngIf"],[1,"m-nav__link"],[1,"m-nav__link-text"],[1,"m-nav__link",3,"routerLink","queryParams"]],template:function(l,_){1&l&&(i.F$t(),i.YNc(0,g,11,2,"div",0)),2&l&&i.Q6J("ngIf","ROLE_TPO_PARTNER"!==_.loginUser)},dependencies:[x.sg,x.O5,f.yS,P.X$],encapsulation:2}),u})()},25380:(J,A,s)=>{s.r(A),s.d(A,{ProfileSettingsModule:()=>fe,createTranslateLoader:()=>Q});var f=s(36895),Z=s(80529),p=s(24006),i=s(34793),P=s(372),b=s(91599),x=s(42684),h=s(54405),M=s(30329),m=s(21532),g=s(59501),e=s(94650),U=s(20388),u=s(76916);let C=(()=>{class n{constructor(t,o,r,a){this.router=t,this.modalService=o,this.route=r,this.location=a}ngOnInit(){}openModal(t){this.modalRef=this.modalService.show(t)}ngOnDestroy(){}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(i.F0),e.Y36(U.tT),e.Y36(i.gz),e.Y36(f.Ye))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-profile-settings"]],decls:7,vars:0,consts:[[1,"body-wrapper"],[1,"m-content"],[1,"m-portlet","m-portlet--tabs"],[1,"m-portlet__body","m-portlet__body--scrollable","p-0"],[1,"portlet__frame"],[3,"activate"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-title-bar"),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"router-outlet",5),e.NdJ("activate",function(a){return o.routedComponent=a}),e.qZA()()()()()())},dependencies:[i.lC,u.G]}),n})();var l=s(4358),_=s(66708),c=s(9648),v=s(38014),F=s(35635),w=s(66616),y=s(47044),q=s(21811),k=s(89383);const z=["errMsgModal"];function Y(n,d){if(1&n&&(e.TgZ(0,"div",25)(1,"alert",26),e._uU(2),e.qZA()()),2&n){const t=d.$implicit;e.Q6J("hidden",!t.type),e.xp6(1),e.Q6J("type",t.type)("dismissOnTimeout",t.timeout),e.xp6(1),e.Oqu(t.msg)}}function B(n,d){1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Field is required")))}function D(n,d){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.lnq("",e.lcZ(2,3,"Password must be at least")," ",t.minLengthPrevPass," ",e.lcZ(3,5,"characters"),"")}}function K(n,d){if(1&n&&(e.TgZ(0,"div",27),e.YNc(1,B,3,3,"div",28),e.YNc(2,D,4,7,"div",28),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.previouspassword.errors.required),e.xp6(1),e.Q6J("ngIf",t.f.previouspassword.errors.minlength)}}function H(n,d){1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Field is required")))}function G(n,d){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.lnq("",e.lcZ(2,3,"Password must be at least")," ",t.minLengthNewPass," ",e.lcZ(3,5,"characters"),"")}}function j(n,d){if(1&n&&(e.TgZ(0,"div",27),e.YNc(1,H,3,3,"div",28),e.YNc(2,G,4,7,"div",28),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.newpassword.errors.required),e.xp6(1),e.Q6J("ngIf",t.f.newpassword.errors.minlength)}}function R(n,d){1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Field is required")))}function $(n,d){1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Passwords must match")))}function W(n,d){if(1&n&&(e.TgZ(0,"div",27),e.YNc(1,R,3,3,"div",28),e.YNc(2,$,3,3,"div",28),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.repeatnewpassword.errors.required),e.xp6(1),e.Q6J("ngIf",t.f.repeatnewpassword.errors.mustMatch)}}function V(n,d){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=d.$implicit;e.xp6(1),e.Oqu(t)}}function X(n,d){if(1&n&&(e.TgZ(0,"ul",29),e.YNc(1,V,2,1,"li",30),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.errMsgs)}}function ee(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"div",31)(1,"p"),e._uU(2),e.qZA(),e.TgZ(3,"button",32),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onDecline())}),e._uU(4,"Close"),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(2),e.Oqu(t.errMsg)}}const I=function(n){return{"is-invalid":n}};let te=(()=>{class n{constructor(t,o,r,a){this._profileSettingsServices=t,this.formBuilder=o,this.router=r,this.modalService=a,this.alerts=[{type:null,msg:null,timeout:0}],this.submitted=!1,this.minLengthPrevPass=1,this.minLengthNewPass=8,this.passwordErrMsgs=[`${v.vwt.ValidatePwdUpperCase}`,`${v.vwt.ValidatePwdLowercaseCase}`,`${v.vwt.ValidatePwdSpecialCharacter} ${v.vwt.ValidatePwd}.`,`${v.vwt.ValidatePwdAtLeast}`],this.errMsgs=this.passwordErrMsgs}ngOnInit(){this.changePassForm=this.formBuilder.group({previouspassword:["",[p.kI.required,p.kI.minLength(this.minLengthPrevPass)]],newpassword:["",[p.kI.required,p.kI.minLength(this.minLengthNewPass)]],repeatnewpassword:["",p.kI.required]},{validator:_.Z.MustMatch("newpassword","repeatnewpassword")})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}get f(){return this.changePassForm.controls}onSubmitForm(){return this.submitted=!0,this.errMsgs=[],new RegExp("(?=.*[A-Z])(?=.*["+v.vwt.ValidatePwd+"]).{8,}$").test(this.changePassForm.value.newpassword)?this.changePassForm.value.newpassword!==this.changePassForm.value.repeatnewpassword?(this.errMsg="Passwords do not match",this.modalRef=this.modalService.show(this.errMsgModal,{class:"modal-sm"}),void(this.errMsgs=this.passwordErrMsgs)):void(this.changePassForm.invalid||(this.subscription=this._profileSettingsServices.submitChangePasswordForm({newPassword:this.changePassForm.value.newpassword,oldPassword:this.changePassForm.value.previouspassword}).subscribe(o=>{this.alerts.push({type:"success",msg:"Password successfully updated.",timeout:c.W.middleTime}),this.changePassForm.valid&&(this.formGroupDirective.resetForm(),Object.keys(this.changePassForm.controls).forEach(r=>{this.changePassForm.controls[r].setErrors(null)}),setTimeout(()=>{this.router.navigateByUrl("/")},1500))},o=>{console.log(o),_.Z.isNotNull(o.status)&&this.alerts.push({type:"danger",msg:o.error,timeout:c.W.middleTime})}))):(this.errMsg="Invalid Password",this.modalRef=this.modalService.show(this.errMsgModal,{class:"modal-sm"}),void(this.errMsgs=this.passwordErrMsgs))}onDecline(){this.modalRef.hide()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(h.x),e.Y36(p.qu),e.Y36(i.F0),e.Y36(U.tT))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-change-password"]],viewQuery:function(t,o){if(1&t&&(e.Gf(p.sg,5),e.Gf(z,5)),2&t){let r;e.iGM(r=e.CRH())&&(o.formGroupDirective=r.first),e.iGM(r=e.CRH())&&(o.errMsgModal=r.first)}},decls:48,vars:27,consts:[[1,"m-content","p-0"],[1,"row"],[1,"col-sm-4","mx-auto"],["class","mt-3 mt-3",3,"hidden",4,"ngFor","ngForOf"],[1,"m-form","m-form--fit","m-form--label-align-right",3,"formGroup","ngSubmit"],[1,"m-portlet"],[1,"m-portlet__head"],[1,"m-portlet__head-caption"],[1,"m-portlet__head-title"],[1,"m-portlet__head-text"],[1,"m-portlet__body","row"],[1,"col-sm-12"],[1,"row","form-group","m-form__group"],[1,"col-form-label","col-lg-3","col-sm-12"],[1,"m--font-danger"],[1,"col-lg-5","col-sm-12"],["type","password","autocomplete","off","nz-input","","placeholder","","name","previouspassword","formControlName","previouspassword",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["type","password","autocomplete","off","nz-input","","placeholder","","name","newpassword","formControlName","newpassword",3,"ngClass"],["type","password","autocomplete","off","nz-input","","placeholder","","name","repeatnewpassword","formControlName","repeatnewpassword",3,"ngClass"],[3,"ngIf"],[1,"m-portlet__foot","bg-light-gray"],[1,"m-form__actions","m-form__actions--right"],["nz-button","","nzType","primary","nzSize","large",1,"btn-form-ops"],["errMsgModal",""],[1,"mt-3","mt-3",3,"hidden"],[3,"type","dismissOnTimeout"],[1,"invalid-feedback"],[4,"ngIf"],[1,"errMsg"],[4,"ngFor","ngForOf"],[1,"modal-body","text-center"],["type","button",1,"btn","btn-default","mr-3",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,Y,3,4,"div",3),e.qZA()(),e.TgZ(4,"form",4),e.NdJ("ngSubmit",function(){return o.onSubmitForm()}),e.TgZ(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"h4",9),e._uU(10),e.ALo(11,"translate"),e.qZA()()()(),e.TgZ(12,"div",10)(13,"div",11)(14,"div",12)(15,"label",13)(16,"span",14),e._uU(17,"*"),e.qZA(),e._uU(18," Current Password: "),e.qZA(),e.TgZ(19,"div",15),e._UZ(20,"input",16),e.YNc(21,K,3,2,"div",17),e.qZA()(),e.TgZ(22,"div",12)(23,"label",13)(24,"span",14),e._uU(25,"*"),e.qZA(),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"div",15),e._UZ(29,"input",18),e.YNc(30,j,3,2,"div",17),e.qZA()(),e.TgZ(31,"div",12)(32,"label",13)(33,"span",14),e._uU(34,"*"),e.qZA(),e._uU(35),e.ALo(36,"translate"),e.qZA(),e.TgZ(37,"div",15),e._UZ(38,"input",19),e.YNc(39,W,3,2,"div",17),e.YNc(40,X,2,1,"ng-template",20),e.qZA()()()(),e.TgZ(41,"div",21)(42,"div",22)(43,"button",23),e._uU(44),e.ALo(45,"translate"),e.qZA()()()()(),e.YNc(46,ee,5,1,"ng-template",null,24,e.W1O),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngForOf",o.alerts),e.xp6(1),e.Q6J("formGroup",o.changePassForm),e.xp6(6),e.hij(" ",e.lcZ(11,13,"Change Password")," "),e.xp6(10),e.Q6J("ngClass",e.VKq(21,I,o.submitted&&o.f.previouspassword.errors)),e.xp6(1),e.Q6J("ngIf",o.submitted&&o.f.previouspassword.errors),e.xp6(5),e.hij(" ",e.lcZ(27,15,"New Password"),": "),e.xp6(3),e.Q6J("ngClass",e.VKq(23,I,o.submitted&&o.f.newpassword.errors)),e.xp6(1),e.Q6J("ngIf",o.submitted&&o.f.newpassword.errors),e.xp6(5),e.hij(" ",e.lcZ(36,17,"Confirm New Password"),": "),e.xp6(3),e.Q6J("ngClass",e.VKq(25,I,o.submitted&&o.f.repeatnewpassword.errors)),e.xp6(1),e.Q6J("ngIf",o.submitted&&o.f.repeatnewpassword.errors),e.xp6(1),e.Q6J("ngIf",o.errMsgs.length),e.xp6(4),e.hij(" ",e.lcZ(45,19,"Submit")," "))},dependencies:[f.mk,f.sg,f.O5,p._Y,p.Fj,p.JJ,p.JL,p.sg,p.u,F.Zp,w.ix,y.w,q.dQ,l.wx,k.X$],styles:[".errMsg[_ngcontent-%COMP%]{color:#f4516c;text-align:left;font-size:80%}"]}),n})();var S=s(83513),E=s(60097),oe=s(28213),O=s(38231);function ne(n,d){if(1&n&&(e.TgZ(0,"div",6)(1,"alert",7),e._uU(2),e.qZA()()),2&n){const t=d.$implicit;e.Q6J("hidden",!t.type),e.xp6(1),e.Q6J("type",t.type)("dismissOnTimeout",t.timeout),e.xp6(1),e.Oqu(t.msg)}}function ie(n,d){1&n&&(e.TgZ(0,"div",50),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function re(n,d){1&n&&(e.TgZ(0,"div",50),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function ae(n,d){1&n&&(e.TgZ(0,"span",51),e._uU(1,"Please input valid email."),e.qZA())}function se(n,d){1&n&&(e.TgZ(0,"div",50),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function le(n,d){1&n&&(e.TgZ(0,"div",50),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function de(n,d){1&n&&(e.TgZ(0,"div",50),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function pe(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"form",8,9),e.NdJ("ngSubmit",function(){e.CHM(t);const r=e.MAs(1),a=e.oxw();return e.KtG(a.onSubmitTicket(r))}),e.TgZ(2,"div",10)(3,"div",11)(4,"div",12)(5,"div",13)(6,"h4",14),e._uU(7),e.ALo(8,"translate"),e.qZA()()()(),e.TgZ(9,"div",15)(10,"div",16)(11,"div",17)(12,"label",18)(13,"span",19),e._uU(14,"*"),e.qZA(),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",20)(18,"input",21,22),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.updateProfileTicketForm.name=r)}),e.qZA(),e.YNc(20,ie,3,3,"div",23),e.qZA(),e.TgZ(21,"label",18)(22,"span",19),e._uU(23,"*"),e.qZA(),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"div",20)(27,"input",24,25),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.updateProfileTicketForm.email=r)})("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.checkEmail(r))}),e.qZA(),e.YNc(29,re,3,3,"div",23),e.YNc(30,ae,2,0,"span",26),e.qZA()(),e._UZ(31,"div",17),e.TgZ(32,"div",17)(33,"label",18)(34,"span",19),e._uU(35,"*"),e.qZA(),e._uU(36),e.ALo(37,"translate"),e.qZA(),e.TgZ(38,"div",20)(39,"input",27,28),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.updateProfileTicketForm.postalCode=r)})("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.searchMsg(r))}),e.qZA(),e.YNc(41,se,3,3,"div",23),e.qZA(),e.TgZ(42,"label",18)(43,"span",19),e._uU(44,"*"),e.qZA(),e._uU(45),e.ALo(46,"translate"),e.qZA(),e.TgZ(47,"div",29)(48,"nz-input-group",30)(49,"nz-select",31),e._UZ(50,"nz-option",32),e.qZA(),e.TgZ(51,"input",33,34),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.updateProfileTicketForm.contactNo=r)}),e.qZA()(),e.YNc(53,le,3,3,"div",23),e.qZA()(),e.TgZ(54,"div",17)(55,"label",18)(56,"span",19),e._uU(57,"*"),e.qZA(),e._uU(58),e.ALo(59,"translate"),e.qZA(),e.TgZ(60,"div",20)(61,"input",35,36),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.updateProfileTicketForm.blockNo=r)}),e.qZA(),e.YNc(63,de,3,3,"div",23),e.qZA(),e.TgZ(64,"label",18)(65,"span",19),e._uU(66,"*"),e.qZA(),e._uU(67),e.ALo(68,"translate"),e.qZA(),e.TgZ(69,"div",20)(70,"input",37,36),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.updateProfileTicketForm.roadName=r)}),e.qZA()()(),e.TgZ(72,"div",17)(73,"label",18),e._uU(74),e.ALo(75,"translate"),e.qZA(),e.TgZ(76,"div",20)(77,"div",38)(78,"input",39,40),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.updateProfileTicketForm.floorNumber=r)}),e.qZA(),e.TgZ(80,"span",41),e._uU(81,"-"),e.qZA(),e.TgZ(82,"input",42,40),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.updateProfileTicketForm.unitNumber=r)}),e.qZA()(),e.TgZ(84,"div",43)(85,"label",44,45),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.updateProfileTicketForm.unitNoApplicable=r)})("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.unitNoApplicableChange(r))}),e._uU(87,"Floor & Unit No. not apllicable to address"),e.qZA()()(),e.TgZ(88,"label",18),e._uU(89),e.ALo(90,"translate"),e.qZA(),e.TgZ(91,"div",20)(92,"input",46,40),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.updateProfileTicketForm.buildingName=r)}),e.qZA()()(),e.TgZ(94,"div",17)(95,"label",18)(96,"span",19),e._uU(97,"*"),e.qZA(),e._uU(98," Required field(s) "),e.qZA()()()(),e.TgZ(99,"div",47)(100,"div",48)(101,"button",49),e._uU(102),e.ALo(103,"translate"),e.qZA()()()()()}if(2&n){const t=e.MAs(1),o=e.MAs(19),r=e.MAs(28),a=e.MAs(40),N=e.MAs(52),L=e.MAs(62),T=e.oxw();e.xp6(7),e.hij(" ",e.lcZ(8,31,"Update Profile")," "),e.xp6(8),e.hij(" ",e.lcZ(16,33,"Name"),": "),e.xp6(3),e.Q6J("ngModel",T.updateProfileTicketForm.name),e.xp6(2),e.Q6J("ngIf",o.invalid&&(o.dirty||o.touched||t.submitted)),e.xp6(4),e.hij(" ",e.lcZ(25,35,"Email"),": "),e.xp6(3),e.Q6J("ngModel",T.updateProfileTicketForm.email),e.xp6(2),e.Q6J("ngIf",r.invalid&&(r.dirty||r.touched||t.submitted)),e.xp6(1),e.Q6J("ngIf",T.InvalidEmail),e.xp6(6),e.hij(" ",e.lcZ(37,37,"Postal Code"),": "),e.xp6(3),e.Q6J("ngModel",T.updateProfileTicketForm.postalCode),e.xp6(2),e.Q6J("ngIf",a.invalid&&(a.dirty||a.touched||t.submitted)),e.xp6(4),e.hij(" ",e.lcZ(46,39,"Mobile No."),": "),e.xp6(5),e.Q6J("nzLabel","+65")("nzValue","65"),e.xp6(1),e.Q6J("ngModel",T.updateProfileTicketForm.contactNo),e.xp6(2),e.Q6J("ngIf",N.invalid&&(N.dirty||N.touched||t.submitted)),e.xp6(5),e.hij(" ",e.lcZ(59,41,"Block Number"),": "),e.xp6(3),e.Q6J("ngModel",T.updateProfileTicketForm.blockNo),e.xp6(2),e.Q6J("ngIf",L.invalid&&(L.dirty||L.touched||t.submitted)),e.xp6(4),e.hij(" ",e.lcZ(68,43,"Street Name"),": "),e.xp6(3),e.Q6J("ngModel",T.updateProfileTicketForm.roadName),e.xp6(4),e.hij(" ",e.lcZ(75,45,"Floor & Unit No."),": "),e.xp6(4),e.Q6J("ngModel",T.updateProfileTicketForm.floorNumber)("disabled",T.updateProfileTicketForm.unitNoApplicable),e.xp6(4),e.Q6J("ngModel",T.updateProfileTicketForm.unitNumber)("disabled",T.updateProfileTicketForm.unitNoApplicable),e.xp6(3),e.Q6J("ngModel",T.updateProfileTicketForm.unitNoApplicable),e.xp6(4),e.hij(" ",e.lcZ(90,47,"Building Name"),": "),e.xp6(3),e.Q6J("ngModel",T.updateProfileTicketForm.buildingName),e.xp6(9),e.Q6J("disabled",!t.valid),e.xp6(1),e.hij(" ",e.lcZ(103,49,"Submit")," ")}}function me(n,d){1&n&&(e.TgZ(0,"span",51),e._uU(1,"Please input valid email."),e.qZA())}function ce(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"form",8,52),e.NdJ("ngSubmit",function(){e.CHM(t);const r=e.MAs(1),a=e.oxw();return e.KtG(a.onSubmitForm(r))}),e.TgZ(2,"div",10)(3,"div",11)(4,"div",12)(5,"div",13)(6,"h4",14),e._uU(7),e.ALo(8,"translate"),e.qZA()()()(),e.TgZ(9,"div",15)(10,"div",16)(11,"div",17)(12,"label",18)(13,"span",19),e._uU(14,"*"),e.qZA(),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",20)(18,"input",53,22),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.updateProfileForm.username=r)}),e.qZA()(),e.TgZ(20,"label",18)(21,"span",19),e._uU(22,"*"),e.qZA(),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"div",20)(26,"input",54,25),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.updateProfileForm.email=r)})("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.checkEmail(r))}),e.qZA(),e.YNc(28,me,2,0,"span",26),e.qZA()(),e._UZ(29,"div",17),e.TgZ(30,"div",17)(31,"label",18),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"div",20)(35,"input",55,40),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.updateProfileForm.address=r)}),e.qZA()()(),e.TgZ(37,"div",17)(38,"label",18)(39,"span",19),e._uU(40,"*"),e.qZA(),e._uU(41," Required field(s) "),e.qZA()()()(),e.TgZ(42,"div",47)(43,"div",48)(44,"button",49),e._uU(45),e.ALo(46,"translate"),e.qZA()()()()()}if(2&n){const t=e.MAs(1),o=e.oxw();e.xp6(7),e.hij(" ",e.lcZ(8,10,"Update Profile")," "),e.xp6(8),e.hij(" ",e.lcZ(16,12,"Name"),": "),e.xp6(3),e.Q6J("ngModel",o.updateProfileForm.username),e.xp6(5),e.hij(" ",e.lcZ(24,14,"Email"),": "),e.xp6(3),e.Q6J("ngModel",o.updateProfileForm.email),e.xp6(2),e.Q6J("ngIf",o.InvalidEmail),e.xp6(4),e.hij(" ",e.lcZ(33,16,"Mailing Address"),": "),e.xp6(3),e.Q6J("ngModel",o.updateProfileForm.address),e.xp6(9),e.Q6J("disabled",!t.valid),e.xp6(1),e.hij(" ",e.lcZ(46,18,"Submit")," ")}}let ue=(()=>{class n{constructor(t,o){this._profileSettingsServices=t,this.carparkService=o,this.alerts=[{type:null,msg:null,timeout:0}],this.updateProfileForm=new S.y,this.updateProfileTicketForm=new S.r,this.InvalidEmail=!1,this.areaCode="+65"}ngOnInit(){this.getProfile()}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}get isTicket(){return this.carparkService.isTicket()}getProfile(){this.isTicket?this._profileSettingsServices.getUpdateProfileTicket().subscribe(t=>{this.updateProfileTicketForm=t.profile,this.updateProfileTicketForm={...this.updateProfileTicketForm,contactNo:this.updateProfileTicketForm.contactNo?.slice(3,11)}}):this._profileSettingsServices.getUpdateProfileDetails().subscribe(t=>{this.updateProfileForm=t})}checkEmail(t){this.InvalidEmail=!/[-\|a-z0-9A-Z._](@ntu\.edu\.sg|@nie\.edu\.sg)$/.test(t)}searchMsg(t){t&&this._profileSettingsServices.searchMsg(t).subscribe(o=>{0!==o.found?(this.updateProfileTicketForm.address=o.results[0].ADDRESS,this.updateProfileTicketForm.blockNo=o.results[0].BLK_NO,this.updateProfileTicketForm.roadName=o.results[0].ROAD_NAME,this.updateProfileTicketForm.buildingName="NIL"!=o.results[0].BUILDING?o.results[0].BUILDING:""):(this.updateProfileTicketForm.address="",this.updateProfileTicketForm.blockNo="",this.updateProfileTicketForm.roadName="",this.updateProfileTicketForm.buildingName="")})}unitNoApplicableChange(t){this.updateProfileTicketForm.unitNoApplicable&&(this.updateProfileTicketForm.floorNumber="",this.updateProfileTicketForm.unitNumber="")}onSubmitForm(t){const o={...this.updateProfileForm,...t};o.username?o.username.length<3?this.alerts.push({type:"danger",msg:"Name field needs at least 3 characters",timeout:c.W.longTime}):!o.email||/[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$/.test(o.email)?this.subscription=this._profileSettingsServices.submitUpdateProfileForm({address:o.address,email:o.email,id:o.id,facebookId:o.facebookId,nationality:o.nationality,nric:o.nric,race:o.race,username:o.username}).subscribe(a=>{_.Z.isNotNull(a.id)&&this.alerts.push({type:"success",msg:"Profile successfully updated.",timeout:c.W.longTime})},a=>{const{error:N}=a;_.Z.isNotNull(N.status)&&this.alerts.push({type:"danger",msg:N.message,timeout:c.W.longTime})}):this.alerts.push({type:"danger",msg:"Invalid email.",timeout:c.W.longTime}):this.alerts.push({type:"danger",msg:"Ensure all required fields are completed.",timeout:c.W.longTime})}onSubmitTicket(t){const o={...this.updateProfileTicketForm,...t};this.InvalidEmail||(this.subscription=this._profileSettingsServices.submitUpdateProfileTicket({login:o.contactNo,name:o.name,email:o.email,department:o.department,contactNo:this.areaCode+o.contactNo,address:o.address,unitNumber:o.unitNumber,buildingName:o.buildingName,postalCode:o.postalCode,active:o.active,roadName:o.roadName,floorNumber:o.floorNumber,unitNoApplicable:o.unitNoApplicable,blockNo:o.blockNo}).subscribe(a=>{200===a.statusCode&&this.alerts.push({type:"success",msg:"Profile successfully updated.",timeout:c.W.longTime})},a=>{const{error:N}=a;this.alerts.push({type:"danger",msg:"Profile updated failed."+N.message,timeout:c.W.longTime})}))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(h.x),e.Y36(E.x))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-update-profile"]],decls:7,vars:3,consts:[[1,"m-content","p-0"],[1,"row"],[1,"col-sm-4","mx-auto"],["class","mt-3 mt-3",3,"hidden",4,"ngFor","ngForOf"],["class","m-form m-form--fit m-form--label-align-right",3,"ngSubmit",4,"ngIf","ngIfElse"],["profile",""],[1,"mt-3","mt-3",3,"hidden"],[3,"type","dismissOnTimeout"],[1,"m-form","m-form--fit","m-form--label-align-right",3,"ngSubmit"],["updateProfileTicket","ngForm"],[1,"m-portlet"],[1,"m-portlet__head"],[1,"m-portlet__head-caption"],[1,"m-portlet__head-title"],[1,"m-portlet__head-text"],[1,"m-portlet__body","row"],[1,"col-sm-12"],[1,"row","form-group","m-form__group"],[1,"col-form-label","col-lg-2","col-sm-12"],[1,"m--font-danger"],[1,"col-lg-4","col-sm-12"],["nz-input","","type","text","placeholder","","name","name","maxlength","50","required","",3,"ngModel","ngModelChange"],["name","ngModel"],["class","form-control-feedback",4,"ngIf"],["nz-input","","type","email","placeholder","","name","email","required","",3,"ngModel","ngModelChange"],["email","ngModel"],["class","form-control-feedback","style","color: #f00;",4,"ngIf"],["nz-input","","type","text","placeholder","","name","postalCode","placeholder","Postal Code","autocomplete","off","maxlength","6","onKeyPress","if(this.value.length && !/^[0-9]*$/.test(Number(this.value))) return false;","required","",3,"ngModel","ngModelChange"],["billingAddress","ngModel"],[1,"input-group","col-lg-4","col-sm-12"],["nzCompact",""],["id","countryCode","name","countryCode","ngModel","65",2,"width","80px"],[3,"nzLabel","nzValue"],["type","text","nz-input","","name","tel","maxlength","8","required","",2,"width","calc(100% - 80px)",3,"ngModel","ngModelChange"],["contactNo","ngModel"],["type","text","nz-input","","placeholder","","name","blockNo","required","",3,"ngModel","ngModelChange"],["blockNo","ngModel"],["type","text","nz-input","","placeholder","","name","roadName","required","",3,"ngModel","ngModelChange"],[1,"unitInput"],["type","text","nz-input","","placeholder","","name","floorNumber",1,"col-sm-3",3,"ngModel","disabled","ngModelChange"],["address","ngModel"],[1,"inputItem"],["type","text","nz-input","","placeholder","","name","unitNumber",1,"col-sm-3",3,"ngModel","disabled","ngModelChange"],[1,"unitNoApplicable"],["nz-checkbox","","name","unitNolicable",3,"ngModel","ngModelChange"],["unitNolicable","ngModel"],["nz-input","","type","text","placeholder","","name","buildingName",3,"ngModel","ngModelChange"],[1,"m-portlet__foot","bg-light-gray"],[1,"m-form__actions","m-form__actions--right"],["nz-button","","nzType","primary","nzSize","large",1,"btn-form-ops",3,"disabled"],[1,"form-control-feedback"],[1,"form-control-feedback",2,"color","#f00"],["updateProfile","ngForm"],["nz-input","","type","text","placeholder","","name","name","maxlength","50",3,"ngModel","ngModelChange"],["nz-input","","type","email","placeholder","","name","email",3,"ngModel","ngModelChange"],["nz-input","","type","text","placeholder","","name","address","maxlength","50",3,"ngModel","ngModelChange"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,ne,3,4,"div",3),e.qZA()(),e.YNc(4,pe,104,51,"form",4),e.YNc(5,ce,47,20,"ng-template",null,5,e.W1O),e.qZA()),2&t){const r=e.MAs(6);e.xp6(3),e.Q6J("ngForOf",o.alerts),e.xp6(1),e.Q6J("ngIf",o.isTicket)("ngIfElse",r)}},dependencies:[f.sg,f.O5,p._Y,p.Fj,p.JJ,p.JL,p.Q7,p.nD,p.On,p.F,F.Zp,F.gB,oe.Ie,w.ix,y.w,q.dQ,O.Ip,O.Vq,l.wx,k.X$],styles:[".unitInput[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.inputItem[_ngcontent-%COMP%]{margin:5px}.unitNoApplicable[_ngcontent-%COMP%]{margin-top:10px;font-size:14px;font-weight:400}"]}),n})();var ge=s(19832);function Q(n){return new ge.w(n,"../assets/i18n/",".json")}const _e=[{path:"",component:g.f,children:[{path:"",component:C,children:[{path:"",redirectTo:"update-profile",pathMatch:"full"},{path:"change-password",component:te,data:{breadcrumb:{label:"Change Password"}}},{path:"update-profile",component:ue,data:{breadcrumb:{label:"Update Profile"}}}]}]}];let fe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[b.k,x.e,h.x,E.x],imports:[f.ez,p.u5,p.UX,i.Bz.forChild(_e),m.x,M.D,U.zk.forRoot(),l.nM,P.kn,k.aw.forChild({loader:{provide:k.Zw,useFactory:Q,deps:[Z.eN]}}),i.Bz]}),n})()}}]);