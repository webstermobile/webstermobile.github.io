(self.webpackChunkst_admin=self.webpackChunkst_admin||[]).push([[5494,9226],{52746:(S,M,o)=>{"use strict";o.d(M,{t:()=>a});var s=o(72986),b=o(591),f=o(94650);let a=(()=>{class A{constructor(){this.loading=!1,this.pagination={totalCount:0,rowsPerPage:20,page:1,sortBy:null,descending:!0,totalPages:1},this.listData=[],this.hadGetData$=new b.X(!1)}get hadGetData(){return this.hadGetData$.getValue()}get filterParams(){return this._filterParams}set filterParams(h){this._filterParams=h}reloadDataService(h,_="filterModel"){this.loading=!0,this.hadGetData$.next(!1),h[_](this.filterParams,this.pagination).pipe((0,s.q)(1)).subscribe(g=>{if(g.pagination.page>g.pagination.totalPages)return this.pagination={...this.pagination,page:g.pagination.totalPages},this.reloadDataService(h);this.loading=!1,this.pagination={...this.pagination,totalCount:g.pagination.totalCount||g.pagination.totalElements},this.listData=g.data,this.hadGetData$.next(!0)},()=>{this.loading=!1,this.listData=[],this.pagination={...this.pagination,totalCount:0}})}onQueryParamsChange(h){const{pageSize:_,pageIndex:g}=h;this.pagination={...this.pagination,rowsPerPage:_,page:g},this.reloadData()}reloadData(){}ngOnInit(){}}return A.\u0275fac=function(h){return new(h||A)},A.\u0275cmp=f.Xpm({type:A,selectors:[["ng-component"]],decls:0,vars:0,template:function(h,_){},encapsulation:2}),A})()},63115:(S,M,o)=>{"use strict";o.d(M,{J:()=>A});var s=o(94650),b=o(21837),f=o(36895),a=o(60883);let A=(()=>{class C{constructor(){this._value=new Date,this.format="hh:mm a, dd LLLL yyyy",this.bsValueChange=new s.vpe,this.bsConfig={containerClass:"theme-light",showWeekNumbers:!1},this.showPicker=!1,this.showDate=!0,this.showTime=!0,this.closeButton={show:!0,label:"Close",cssClass:"btn btn-sm btn-primary"}}get value(){return this._value}set value(_){_?("string"==typeof _&&(this._value=new Date(_)),this._value=_):this._value=null}get displayText(){return this.format=this.formatTime?"dd LLLL yyyy  /  hh:mm a":this.format,this.value?b.ou.fromJSDate(this.value).toFormat(this.format):null}onTogglePicker(){!1===this.showPicker&&(this.showPicker=!0)}onValueChange(_){this.bsValueChange.emit(_)}isValid(){return this.value&&"string"!=typeof this.value&&!isNaN(this.value.getTime())}}return C.\u0275fac=function(_){return new(_||C)},C.\u0275cmp=s.Xpm({type:C,selectors:[["app-datetimepicker"]],inputs:{value:"value",formatTime:"formatTime",format:"format"},outputs:{bsValueChange:"bsValueChange"},decls:6,vars:7,consts:[[1,"m-input-icon","m-input-icon--right",3,"ngClass"],["type","text","placement","bottom","readonly","",1,"form-control","m-input",3,"value","click"],[1,"m-input-icon__icon","m-input-icon__icon--right"],[1,"la","la-calendar"],[3,"value","showPopup","showDate","showTime","closeButton","valueChange","showPopupChange"]],template:function(_,g){1&_&&(s.TgZ(0,"div",0)(1,"input",1),s.NdJ("click",function(){return g.onTogglePicker()}),s.qZA(),s.TgZ(2,"span",2)(3,"span"),s._UZ(4,"i",3),s.qZA()()(),s.TgZ(5,"datetime-popup",4),s.NdJ("valueChange",function(d){return g.onValueChange(d)})("showPopupChange",function(d){return g.showPicker=d}),s.qZA()),2&_&&(s.Q6J("ngClass",g.rounded?"rounded":""),s.xp6(1),s.Q6J("value",g.displayText),s.xp6(4),s.Q6J("value",g.value)("showPopup",g.showPicker)("showDate",g.showDate)("showTime",g.showTime)("closeButton",g.closeButton))},dependencies:[f.mk,a.U],encapsulation:2}),C})()},76916:(S,M,o)=>{"use strict";o.d(M,{G:()=>e});var s=o(34793),b=o(92198),f=o(38014),a=o(94650),A=o(89383),C=o(60097),h=o(36895);function _(m,y){if(1&m&&(a.TgZ(0,"a",14)(1,"span",15),a._uU(2),a.ALo(3,"translate"),a.qZA()()),2&m){const p=a.oxw().$implicit;a.xp6(2),a.hij(" ",a.lcZ(3,1,p.label)," ")}}function g(m,y){if(1&m&&(a.TgZ(0,"a",16)(1,"span",15),a._uU(2),a.ALo(3,"translate"),a.qZA()()),2&m){const p=a.oxw(),v=p.$implicit,T=p.last,Z=a.oxw(2);a.Q6J("routerLink",v.url)("queryParams",T&&Z.route.snapshot.queryParams),a.xp6(2),a.hij(" ",a.lcZ(3,3,v.label)," ")}}function c(m,y){if(1&m&&(a.ynx(0),a.TgZ(1,"li",10)(2,"span"),a._uU(3," > "),a.qZA()(),a.TgZ(4,"li",11),a.YNc(5,_,4,3,"a",12),a.YNc(6,g,4,5,"a",13),a.qZA(),a.BQk()),2&m){const p=y.first;a.xp6(5),a.Q6J("ngIf",p),a.xp6(1),a.Q6J("ngIf",!p)}}function d(m,y){if(1&m){const p=a.EpF();a.TgZ(0,"div",1)(1,"div",2)(2,"div",3),a._UZ(3,"h3",4),a.TgZ(4,"ul",5)(5,"li",6)(6,"a",7),a.NdJ("click",function(){a.CHM(p);const T=a.oxw();return a.KtG(T.jumpHome())}),a._UZ(7,"i",8),a.qZA()(),a.YNc(8,c,7,2,"ng-container",9),a.qZA()(),a.TgZ(9,"div"),a.Hsn(10),a.qZA()()()}if(2&m){const p=a.oxw();a.xp6(3),a.Q6J("innerHTML",p.title,a.oJD),a.xp6(5),a.Q6J("ngForOf",p.breads)}}const P=["*"];let e=(()=>{class m{constructor(p,v,T,Z){this.router=p,this.route=v,this.translate=T,this._carparkService=Z,this.breads=[],this.loginUser=""}ngOnInit(){let p=JSON.parse(localStorage.getItem("user-roles"))[0];this.loginUser=p,console.log(this.loginUser,"\u4fe1\u606f"),this.breads=this.buildBreadCrumb(this.route.root),this.translate.get(this.breads[0].label).subscribe(T=>{this.label=T}),this.router.events.pipe((0,b.h)(T=>T instanceof s.m2)).subscribe(()=>{this.breads=this.buildBreadCrumb(this.route.root)})}buildBreadCrumb(p,v=[""],T=[]){const Z=p.snapshot.url[0]&&p.snapshot.url[0].path,R=[...v,Z],L={...this.extractBreadcrumb(p),url:R},w=Z&&L.label?[...T,L]:T;return this.title=L.title||this.title||"",this.isMotorist&&"My Vehicle(s)"===L.label&&(this.title="My Vehicle(s)"),p.firstChild?Z?this.buildBreadCrumb(p.firstChild,R,w):this.buildBreadCrumb(p.firstChild,v,T):(this.translate.get(this.title).subscribe(z=>{this.title=z}),w)}get isMotorist(){return this._carparkService.isMotorist()}extractBreadcrumb(p){return p.snapshot.data.breadcrumb instanceof Function?p.snapshot.data.breadcrumb(p):p.snapshot.data.breadcrumb}jumpHome(){let p=JSON.parse(localStorage.getItem("user-roles"))[0]??"";this.router.navigate(p.length?[f.gpL[p]]:["/"])}}return m.\u0275fac=function(p){return new(p||m)(a.Y36(s.F0),a.Y36(s.gz),a.Y36(A.sK),a.Y36(C.x))},m.\u0275cmp=a.Xpm({type:m,selectors:[["app-title-bar"]],ngContentSelectors:P,decls:1,vars:1,consts:[["class","m-subheader",4,"ngIf"],[1,"m-subheader"],[1,"d-flex","align-items-center"],[1,"mr-auto"],[1,"m-subheader__title","m-subheader__title--separator","text-main",3,"innerHTML"],[1,"m-subheader__breadcrumbs","m-nav","m-nav--inline"],[1,"m-nav__item","m-nav__item--home"],[1,"m-nav__link","m-nav__link--icon",3,"click"],[1,"m-nav__link-icon","la","la-home"],[4,"ngFor","ngForOf"],[1,"m-nav__separator"],[1,"m-nav__item"],["class","m-nav__link",4,"ngIf"],["class","m-nav__link",3,"routerLink","queryParams",4,"ngIf"],[1,"m-nav__link"],[1,"m-nav__link-text"],[1,"m-nav__link",3,"routerLink","queryParams"]],template:function(p,v){1&p&&(a.F$t(),a.YNc(0,d,11,2,"div",0)),2&p&&a.Q6J("ngIf","ROLE_TPO_PARTNER"!==v.loginUser)},dependencies:[h.sg,h.O5,s.yS,A.X$],encapsulation:2}),m})()},25494:(S,M,o)=>{"use strict";o.r(M),o.d(M,{ReportModule:()=>Ce,createTranslateLoader:()=>j});var s=o(36895),b=o(80529),f=o(24006),a=o(34793),A=o(372),C=o(60097),h=o(36511),_=o(91599),g=o(42684),c=o(3927),d=o(86181),P=o(27221),e=o(94650),m=o(28555);let y=(()=>{class i extends c.su{constructor(n,t,l){super(t,n),this.store=n,this.http=t,this.modelName="Report",this.baseUrl="carpark/api/file-informations",this.handleError=l.createHandleError(`${this.modelName}Service`)}filterModelByCarPark(n,t){const l=(0,d.U8)(`${this.baseUrl}/byCarParkId`,{...n,...(0,d.jq)(t)});return this.get(this.getUrl(l)).pipe((0,P.K)(this.handleError(`${this.modelName}Filter`,{}))).map(r=>Array.isArray(r)?(0,c.eC)(r):(0,c.O7)(r))}getFile(n){const t=this.getUrl(`carpark/api/fileresources/${n}`);return this.get(t,{responseType:"blob"})}getCustomerSelect(){const n=this.getUrl("carpark/api/car-park-owners");return this.get(n)}getCarparkAll(n){const t=this.getUrl(`carpark/api/getCarParkByOwnerId?ownerId=${n}`);return this.get(t)}}return i.\u0275fac=function(n){return new(n||i)(e.LFG(m.yh),e.LFG(b.eN),e.LFG(_.k))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();var p=o(30329),v=o(21532),T=o(59501),Z=o(8929),R=o(44290),L=o(1059),w=o(80013),z=o(75778),U=o(2994),$=o(87545),q=o(24850),E=(o(19612),o(70853)),H=o(76916),J=o(88796),x=o(38014),K=o(63115),k=o(89383);let Y=(()=>{class i{constructor(){this.search=new e.vpe,this.moreSearch=new e.vpe,this.isMoreSearch=!1,this.carParkInput$=new Z.xQ,this.carParkId=0,this.alive=!0,this.params=(0,x.d5Q)()}ngOnInit(){}submit(){}clear(){this.params=(0,x.d5Q)()}export(){}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-report-more-search"]],inputs:{isMoreSearch:"isMoreSearch",carParks$:"carParks$"},outputs:{search:"search",moreSearch:"moreSearch"},decls:109,vars:61,consts:[[1,"row","form-group","m-form__group","m-portlet__filters"],[1,"m-portlet__filter","col-3"],[1,"row"],[1,"col-form-label","col-4"],[1,"col-8"],[3,"value","bsValueChange"],["placeholder","","bindLabel","name","bindValue","id",3,"items","ngModel","typeahead","loading","ngModelChange"],["type","text","name","connector","placeholder","",1,"form-control","m-input",3,"ngModel","ngModelChange"],["type","text","name","orderRefNo","placeholder","",1,"form-control","m-input",3,"ngModel","ngModelChange"],[1,"col-form-label","col-4","mb-3"],["type","text","name","licenseNo","placeholder","",1,"form-control","m-input",3,"ngModel","ngModelChange"],["placeholder","","bindLabel","name","bindValue","id",3,"items","ngModel","ngModelChange"],["type","text","name","chargingChannel","placeholder","",1,"form-control","m-input",3,"ngModel","ngModelChange"],["type","text","name","orderNo","placeholder","",1,"form-control","m-input",3,"ngModel","ngModelChange"],["type","text","name","chargingCardNo","placeholder","",1,"form-control","m-input",3,"ngModel","ngModelChange"],["type","text","name","account","placeholder","",1,"form-control","m-input",3,"ngModel","ngModelChange"],["type","text","name","ownCoding","placeholder","",1,"form-control","m-input",3,"ngModel","ngModelChange"],[1,"row","mt-2"],[1,"btn","btn-default","mr-2",3,"click"],[1,"btn","btn-main","mr-2",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"div",4)(7,"app-datetimepicker",5),e.NdJ("bsValueChange",function(r){return t.params.endTime=r}),e.qZA()()()(),e.TgZ(8,"div",1)(9,"div",2)(10,"label",3),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"div",4)(14,"ng-select",6),e.NdJ("ngModelChange",function(r){return t.params.carParkId=r}),e.ALo(15,"async"),e.qZA()()()(),e.TgZ(16,"div",1)(17,"div",2)(18,"label",3),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"div",4)(22,"input",7),e.NdJ("ngModelChange",function(r){return t.params.connector=r}),e.qZA()()()(),e.TgZ(23,"div",1)(24,"div",2)(25,"label",3),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"div",4)(29,"input",8),e.NdJ("ngModelChange",function(r){return t.params.orderRefNo=r}),e.qZA()()()(),e.TgZ(30,"div",1)(31,"div",2)(32,"label",9),e._uU(33),e.ALo(34,"translate"),e.qZA(),e.TgZ(35,"div",4)(36,"input",10),e.NdJ("ngModelChange",function(r){return t.params.licenseNo=r}),e.qZA()()()(),e.TgZ(37,"div",1)(38,"div",2)(39,"label",3),e._uU(40),e.ALo(41,"translate"),e.qZA(),e.TgZ(42,"div",4)(43,"ng-select",11),e.NdJ("ngModelChange",function(r){return t.params.startType=r}),e.qZA()()()(),e.TgZ(44,"div",1)(45,"div",2)(46,"label",3),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.TgZ(49,"div",4)(50,"ng-select",11),e.NdJ("ngModelChange",function(r){return t.params.chargingStatus=r}),e.qZA()()()(),e.TgZ(51,"div",1)(52,"div",2)(53,"label",3),e._uU(54),e.ALo(55,"translate"),e.qZA(),e.TgZ(56,"div",4)(57,"ng-select",11),e.NdJ("ngModelChange",function(r){return t.params.orderStatus=r}),e.qZA()()()(),e.TgZ(58,"div",1)(59,"div",2)(60,"label",3),e._uU(61),e.ALo(62,"translate"),e.qZA(),e.TgZ(63,"div",4)(64,"input",12),e.NdJ("ngModelChange",function(r){return t.params.chargingChannel=r}),e.qZA()()()(),e.TgZ(65,"div",1)(66,"div",2)(67,"label",3),e._uU(68),e.ALo(69,"translate"),e.qZA(),e.TgZ(70,"div",4)(71,"input",13),e.NdJ("ngModelChange",function(r){return t.params.orderNo=r}),e.qZA()()()(),e.TgZ(72,"div",1)(73,"div",2)(74,"label",3),e._uU(75),e.ALo(76,"translate"),e.qZA(),e.TgZ(77,"div",4)(78,"input",14),e.NdJ("ngModelChange",function(r){return t.params.chargingCardNo=r}),e.qZA()()()(),e.TgZ(79,"div",1)(80,"div",2)(81,"label",3),e._uU(82),e.ALo(83,"translate"),e.qZA(),e.TgZ(84,"div",4)(85,"input",15),e.NdJ("ngModelChange",function(r){return t.params.account=r}),e.qZA()()()(),e.TgZ(86,"div",1)(87,"div",2)(88,"label",3),e._uU(89),e.ALo(90,"translate"),e.qZA(),e.TgZ(91,"div",4)(92,"ng-select",11),e.NdJ("ngModelChange",function(r){return t.params.department=r}),e.qZA()()()(),e.TgZ(93,"div",1)(94,"div",2)(95,"label",3),e._uU(96),e.ALo(97,"translate"),e.qZA(),e.TgZ(98,"div",4)(99,"input",16),e.NdJ("ngModelChange",function(r){return t.params.ownCoding=r}),e.qZA()()()()(),e.TgZ(100,"div",17)(101,"button",18),e.NdJ("click",function(){return t.clear()}),e._uU(102,"Clear "),e.qZA(),e.TgZ(103,"button",19),e.NdJ("click",function(){return t.search.emit(t.params)}),e._uU(104,"Search "),e.qZA(),e.TgZ(105,"button",19),e.NdJ("click",function(){return t.export()}),e._uU(106,"Export "),e.qZA(),e.TgZ(107,"button",18),e.NdJ("click",function(){return t.moreSearch.emit(!1)}),e._uU(108,"Schedule "),e.qZA()()),2&n&&(e.xp6(4),e.hij(" ",e.lcZ(5,31,"End Time Of Order"),": "),e.xp6(3),e.Q6J("value",t.params.endTime),e.xp6(4),e.hij(" ",e.lcZ(12,33,"Station Name"),": "),e.xp6(3),e.Q6J("items",e.lcZ(15,35,t.carParks$))("ngModel",t.params.carParkId)("typeahead",t.carParkInput$)("loading",t.carParkLoading),e.xp6(5),e.hij(" ",e.lcZ(20,37,"Connector"),": "),e.xp6(3),e.Q6J("ngModel",t.params.connector),e.xp6(4),e.hij(" ",e.lcZ(27,39,"Order Reference Number"),": "),e.xp6(3),e.Q6J("ngModel",t.params.orderRefNo),e.xp6(4),e.hij(" ",e.lcZ(34,41,"License No."),": "),e.xp6(3),e.Q6J("ngModel",t.params.licenseNo),e.xp6(4),e.hij(" ",e.lcZ(41,43,"Start Type"),": "),e.xp6(3),e.Q6J("ngModel",t.params.startType),e.xp6(4),e.hij(" ",e.lcZ(48,45,"Charging Status"),": "),e.xp6(3),e.Q6J("ngModel",t.params.chargingStatus),e.xp6(4),e.hij(" ",e.lcZ(55,47,"Order Status"),": "),e.xp6(3),e.Q6J("ngModel",t.params.orderStatus),e.xp6(4),e.hij(" ",e.lcZ(62,49,"Charging Channel"),": "),e.xp6(3),e.Q6J("ngModel",t.params.chargingChannel),e.xp6(4),e.hij(" ",e.lcZ(69,51,"Order No."),": "),e.xp6(3),e.Q6J("ngModel",t.params.orderNo),e.xp6(4),e.hij(" ",e.lcZ(76,53,"Charging Card Number"),": "),e.xp6(3),e.Q6J("ngModel",t.params.chargingCardNo),e.xp6(4),e.hij(" ",e.lcZ(83,55,"Account"),": "),e.xp6(3),e.Q6J("ngModel",t.params.account),e.xp6(4),e.hij(" ",e.lcZ(90,57,"Department"),": "),e.xp6(3),e.Q6J("ngModel",t.params.department),e.xp6(4),e.hij(" ",e.lcZ(97,59,"Own Coding"),": "),e.xp6(3),e.Q6J("ngModel",t.params.ownCoding))},dependencies:[f.Fj,f.JJ,f.On,K.J,J.w9,s.Ov,k.X$]}),i})();function W(i,u){if(1&i){const n=e.EpF();e.TgZ(0,"div",15)(1,"div",16)(2,"div",6)(3,"div",17)(4,"div",18)(5,"label",19),e._uU(6," Car Park: "),e.qZA(),e.TgZ(7,"div",20)(8,"ng-select",21),e.NdJ("ngModelChange",function(l){e.CHM(n);const r=e.oxw();return e.KtG(r.carParkId=l)})("blur",function(l){e.CHM(n);const r=e.oxw();return e.KtG(r.onBlur(l))})("change",function(){e.CHM(n);const l=e.oxw();return e.KtG(l.reloadData())}),e.ALo(9,"async"),e.qZA()()()()()()()}if(2&i){const n=e.oxw();e.xp6(8),e.Q6J("items",e.lcZ(9,4,n.carParks$))("ngModel",n.carParkId)("typeahead",n.carParkInput$)("loading",n.carParkLoading)}}function V(i,u){if(1&i){const n=e.EpF();e.TgZ(0,"div",22)(1,"div",16)(2,"div",23)(3,"div",13)(4,"app-report-more-search",24),e.NdJ("moreSearch",function(l){e.CHM(n);const r=e.oxw();return e.KtG(r.isMoreSearch=l)})("search",function(l){e.CHM(n);const r=e.oxw();return e.KtG(r.moreSearch(l))}),e.qZA(),e.TgZ(5,"div",25)(6,"div",26)(7,"div",27)(8,"label",28),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"div",29)(12,"ng-select",21),e.NdJ("ngModelChange",function(l){e.CHM(n);const r=e.oxw();return e.KtG(r.carParkId=l)})("blur",function(l){e.CHM(n);const r=e.oxw();return e.KtG(r.onBlur(l))})("change",function(){e.CHM(n);const l=e.oxw();return e.KtG(l.reloadData())}),e.ALo(13,"async"),e.qZA()()()(),e.TgZ(14,"div",26)(15,"button",30),e.NdJ("click",function(){e.CHM(n);const l=e.oxw();return e.KtG(l.isMoreSearch=!0)}),e.TgZ(16,"span"),e._uU(17),e.qZA()()()()()()()()}if(2&i){const n=e.oxw();e.xp6(4),e.Q6J("hidden",!n.isMoreSearch)("carParks$",n.carParks$)("isMoreSearch",n.isMoreSearch),e.xp6(1),e.Q6J("hidden",n.isMoreSearch),e.xp6(4),e.hij(" ",e.lcZ(10,10,"Depot"),": "),e.xp6(3),e.Q6J("items",e.lcZ(13,12,n.carParks$))("ngModel",n.carParkId)("typeahead",n.carParkInput$)("loading",n.carParkLoading),e.xp6(5),e.Oqu(n.isMoreSearch?"Schedule":"Customize")}}const G=function(){return["all"]},X=function(){return{carParkId:0}},ee=function(){return["daily"]},B=function(i){return{carParkId:i}},te=function(){return["monthly"]};let ne=(()=>{class i{constructor(n,t,l,r,D,N){this.carParkService=n,this.router=t,this.location=l,this.PlatformLocation=r,this.route=D,this.busService=N,this.carParkInput$=new Z.xQ,this.carParkId=0,this.alive=!0,this.isMoreSearch=!0,this.isBusAdmin=!1}ngOnInit(){this.carParkId=this.route.snapshot.queryParams.carParkId&&Number(this.route.snapshot.queryParams.carParkId),void 0===this.carParkId&&(this.carParkId=0),this.carParks$=this.carParkInput$.pipe((0,R.o)(()=>this.alive),(0,L.O)(""),(0,w.b)(200),(0,z.x)(),(0,U.b)(()=>this.carParkLoading=!0),(0,$.w)(n=>this.carParkService.getSimpleList(n).pipe((0,q.U)(t=>n?t.filter(l=>-1!==l.name.toLowerCase().indexOf(n.toLowerCase())):t.slice(0,20)),(0,U.b)(()=>this.carParkLoading=!1)))),this.isBusAdmin=this.busService.isBusAdmin()}reloadData(){if(this.router.url.includes("?")){const n=this.router.url.slice(0,this.router.url.indexOf("?"));this.router.navigate([`${n}`],{queryParams:{carParkId:this.carParkId}})}else this.router.navigate([`${this.router.url}`],{queryParams:{carParkId:0}})}isActive(n){return-1!==this.router.url.indexOf(n)}onBlur(n){return!n.target.value&&this.carParkInput$.next(null)}moreSearch(n){console.log(n)}ngOnDestroy(){this.alive=!1}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(C.x),e.Y36(a.F0),e.Y36(s.Ye),e.Y36(s.lw),e.Y36(a.gz),e.Y36(E.Z))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-report"]],decls:23,vars:25,consts:[[1,"body-wrapper"],["class","m-content pb-0","style","display: none;",4,"ngIf"],[2,"margin","30px"],["class","m-content pb-0",4,"ngIf"],[1,"m-content","pt-0"],[1,"m-portlet","m-portlet--tabs"],[1,"m-portlet__head"],[1,"m-portlet__head-tools"],["role","tablist",1,"nav","nav-tabs","m-tabs-line","m-tabs-line--primary","m-tabs-line--2x"],[1,"nav-item","m-tabs__item"],[1,"nav-link","m-tabs__link",3,"routerLink","queryParams"],[1,"nav-item","m-tabs__item",2,"display","none"],[1,"m-portlet__body","m-portlet__body--scrollable"],[1,"m-portlet__frame"],[3,"activate"],[1,"m-content","pb-0",2,"display","none"],[1,"m-portlet"],[1,"form-group","m-form__group","m-portlet__filters","mt-3"],[1,"m-portlet__filter","row","m-0"],[1,"col-form-label","mr-5"],[1,"col-4"],["placeholder","","bindLabel","name","bindValue","id",3,"items","ngModel","typeahead","loading","ngModelChange","blur","change"],[1,"m-content","pb-0"],[1,"m-portlet__body"],[3,"hidden","carParks$","isMoreSearch","moreSearch","search"],[1,"row","form-group","m-form__group","m-portlet__filters",3,"hidden"],[1,"m-portlet__filter","col-3"],[1,"row"],[1,"col-form-label","col-2"],[1,"col-10"],[1,"btn","btn-main","m-btn","m-btn--custom","m-btn--icon","m-btn--air","m-btn--pill",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"app-title-bar"),e.YNc(2,W,10,6,"div",1),e._UZ(3,"div",2),e.YNc(4,V,18,14,"div",3),e.TgZ(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"ul",8)(10,"li",9)(11,"a",10),e._uU(12),e.ALo(13,"translate"),e.qZA()(),e.TgZ(14,"li",11)(15,"a",10),e._uU(16," Daily Report "),e.qZA()(),e.TgZ(17,"li",11)(18,"a",10),e._uU(19," Monthly Report "),e.qZA()()()()(),e.TgZ(20,"div",12)(21,"div",13)(22,"router-outlet",14),e.NdJ("activate",function(r){return t.routedComponent=r}),e.qZA()()()()()()),2&n&&(e.xp6(2),e.Q6J("ngIf",!t.isBusAdmin),e.xp6(2),e.Q6J("ngIf",t.isBusAdmin),e.xp6(7),e.ekj("active",t.isActive("/all")),e.Q6J("routerLink",e.DdM(17,G))("queryParams",e.DdM(18,X)),e.xp6(1),e.hij(" ",e.lcZ(13,15,"All Reports")," "),e.xp6(3),e.ekj("active",t.isActive("/report/daily")),e.Q6J("routerLink",e.DdM(19,ee))("queryParams",e.VKq(20,B,t.carParkId)),e.xp6(3),e.ekj("active",t.isActive("/monthly")),e.Q6J("routerLink",e.DdM(22,te))("queryParams",e.VKq(23,B,t.carParkId)))},dependencies:[s.O5,f.JJ,f.On,a.lC,a.yS,H.G,J.w9,Y,s.Ov,k.X$],styles:[".btn-create[_ngcontent-%COMP%]{display:flex;margin-left:auto;margin-top:auto;margin-bottom:auto}"]}),i})();var ae=o(52746),oe=o(94327),re=o(92198),ie=o(17489),Q=o(38231),F=o(834),O=o(40269);function le(i,u){1&i&&(e._UZ(0,"nz-option",8),e.ALo(1,"translate")),2&i&&e.Q6J("nzLabel",e.lcZ(1,1,"All"))}function se(i,u){if(1&i&&(e._UZ(0,"nz-option",19),e.ALo(1,"titlecase")),2&i){const n=u.$implicit;e.Q6J("nzValue",n.id)("nzLabel",e.lcZ(1,2,n.name))}}function pe(i,u){if(1&i&&(e._UZ(0,"nz-option",19),e.ALo(1,"titlecase")),2&i){const n=u.$implicit;e.Q6J("nzValue",n.id)("nzLabel",e.lcZ(1,2,n.name))}}function ce(i,u){1&i&&(e._UZ(0,"nz-option",8),e.ALo(1,"translate")),2&i&&e.Q6J("nzLabel",e.lcZ(1,1,"All"))}function de(i,u){1&i&&(e._UZ(0,"nz-option",8),e.ALo(1,"translate")),2&i&&e.Q6J("nzLabel",e.lcZ(1,1,"All"))}function me(i,u){if(1&i&&e._UZ(0,"nz-option",19),2&i){const n=u.$implicit;e.Q6J("nzValue",n)("nzLabel",n)}}function ue(i,u){if(1&i&&e._uU(0),2&i){const n=u.range;e.lnq(" ",n[0],"-",n[1]," of ",u.$implicit," items\n")}}function he(i,u){if(1&i&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&i){const n=u.$implicit;e.xp6(1),e.Oqu(n.text)}}function ge(i,u){if(1&i){const n=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td")(13,"a",20),e.NdJ("click",function(){const r=e.CHM(n).$implicit,D=e.oxw();return e.KtG(D.download(r))}),e._uU(14),e.ALo(15,"translate"),e.qZA()()()}if(2&i){const n=u.$implicit;e.ekj("ant-table-row-odd",u.index%2==1),e.xp6(2),e.Oqu(n.id),e.xp6(2),e.Oqu(e.lcZ(5,8,n.reportDate)),e.xp6(3),e.Oqu(n.fileScope),e.xp6(2),e.Oqu(n.ownerName),e.xp6(2),e.Oqu(n.extension),e.xp6(3),e.Oqu(e.lcZ(15,10,"Download"))}}let I=(()=>{class i extends ae.t{constructor(n,t,l,r,D){super(),this.router=n,this.reportService=t,this.route=l,this.codeTablesService=r,this.translate=D,this.tableHeaders=[{text:"ID",width:"80px"},{text:"Report Date",width:"120px"},{text:"Report Name",width:"180px"},{text:"Customer",width:"120px"},{text:"File Type",width:"120px"},{text:"Actions",width:"100px"}],this.alive=!0,this.reportType="",this.fileType="",this.reportName="",this.timeRange=[],this.customerArr=[],this.loginRoles="",this.CustomerId="",this.needOwnerId="",this.showAllCustomer=!1,this.carparkAllList=[],this.CarparkChoose="",this.router.events.pipe((0,R.o)(()=>this.alive),(0,re.h)(N=>N instanceof a.m2)).subscribe(()=>this.reloadData()),(0,ie.intersection)([localStorage.getItem("user-roles")],[x.i44.Cpouser])||(this.reportNames$=this.codeTablesService.ReportscopeSelect(x.BcL.ReportName))}ngOnInit(){this.reportService.getCarparkAll(this.CustomerId).subscribe(t=>{this.carparkAllList=t});const n=this.tableHeaders.map(t=>t.text);this.translate.get(n).subscribe(t=>{this.tableHeaders.forEach(l=>{for(const r in t)t.hasOwnProperty(r)&&l.text===r&&(l.text=t[r])})}),this.loginRoles=JSON.parse(localStorage.getItem("user-roles"))[0],"ROLE_ADMIN"==this.loginRoles&&(this.showAllCustomer=!0),"ROLE_CARPARK_OPERATOR"==this.loginRoles&&(this.showAllCustomer=!0),this.reportService.getCustomerSelect().subscribe(t=>{if(this.customerArr=t,this.needOwnerId=localStorage.getItem("needOwnerId"),"ROLE_ADMIN"!==this.loginRoles&&"ROLE_CARPARK_OPERATOR"!==this.loginRoles){let l=[];this.customerArr.forEach(r=>{r.id==this.needOwnerId&&l.push(r)}),this.customerArr=l,this.CustomerId=this.customerArr[0].id,this.reportService.getCarparkAll(this.CustomerId).subscribe(r=>{this.carparkAllList=r})}})}getCarpark(){this.reportService.getCarparkAll(this.CustomerId).subscribe(n=>{this.CarparkChoose="",this.carparkAllList=n})}get filterParams(){const n=this.route.snapshot.url[0].path;return{generateType:"monthly"===n?x.C2Q.Monthly:"daily"===n?x.C2Q.Daily:"",carParkId:this.CarparkChoose,ownerId:this.CustomerId,extension:this.fileType,fileScope:this.reportName,from:this.timeRange[0]&&this.timeRange[0].toISOString(),to:this.timeRange[1]&&this.timeRange[1].toISOString()}}reloadData(){this.reloadDataService(this.reportService,"filterModelByCarPark")}pageChanged(n){this.pagination=n,this.reloadData()}download(n){this.reportService.getFile(n.uuid).subscribe(t=>{(0,oe.saveAs)(t,n.originalName)})}ngOnDestroy(){this.alive=!1}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(a.F0),e.Y36(y),e.Y36(a.gz),e.Y36(h.I),e.Y36(k.sK))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-table-report"]],features:[e.qOj],decls:51,vars:43,consts:[[1,"form-group","m-form__group","m-portlet__filters"],[1,"filter-wrap"],[1,"filter-item"],[1,"filter-label"],["name","CustomerId",2,"width","160px",3,"ngModel","ngModelChange"],["nzValue","",3,"nzLabel",4,"ngIf"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["name","CarparkChoose",2,"width","160px",3,"ngModel","nzDropdownMatchSelectWidth","ngModelChange"],["nzValue","",3,"nzLabel"],["name","fileType",2,"width","160px",3,"ngModel","ngModelChange"],["nzValue","PDF","nzLabel","PDF"],["nzValue","CSV","nzLabel","CSV"],["name","reportName",2,"width","160px",3,"ngModel","nzDropdownMatchSelectWidth","ngModelChange"],[3,"ngModel","ngModelChange"],["rangeTemplate",""],[3,"nzData","nzFrontPagination","nzLoading","nzTotal","nzPageSize","nzPageIndex","nzShowSizeChanger","nzShowTotal","nzQueryParams"],["basicTable",""],[4,"ngFor","ngForOf"],[3,"ant-table-row-odd",4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"],[1,"m-link","m--font-primary",3,"click"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"nz-select",4),e.NdJ("ngModelChange",function(r){return t.CustomerId=r})("ngModelChange",function(){return t.getCarpark()}),e.YNc(7,le,2,3,"nz-option",5),e.YNc(8,se,2,4,"nz-option",6),e.qZA()()(),e.TgZ(9,"div",1)(10,"div",2)(11,"span",3),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"nz-select",7),e.NdJ("ngModelChange",function(r){return t.CarparkChoose=r})("ngModelChange",function(){return t.reloadData()}),e._UZ(15,"nz-option",8),e.ALo(16,"translate"),e.YNc(17,pe,2,4,"nz-option",6),e.qZA()()(),e.TgZ(18,"div",1)(19,"div",2)(20,"span",3),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"nz-select",9),e.NdJ("ngModelChange",function(r){return t.fileType=r})("ngModelChange",function(){return t.reloadData()}),e.YNc(24,ce,2,3,"nz-option",5),e._UZ(25,"nz-option",10)(26,"nz-option",11),e.qZA()()(),e.TgZ(27,"div",1)(28,"div",2)(29,"span",3),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"nz-select",12),e.NdJ("ngModelChange",function(r){return t.reportName=r})("ngModelChange",function(){return t.reloadData()}),e.YNc(33,de,2,3,"nz-option",5),e.YNc(34,me,1,2,"nz-option",6),e.ALo(35,"async"),e.qZA()()(),e.TgZ(36,"div",1)(37,"div",2)(38,"span",3),e._uU(39),e.ALo(40,"translate"),e.qZA(),e.TgZ(41,"nz-range-picker",13),e.NdJ("ngModelChange",function(r){return t.timeRange=r})("ngModelChange",function(){return t.reloadData()}),e.qZA()()()(),e.YNc(42,ue,1,3,"ng-template",null,14,e.W1O),e.TgZ(44,"nz-table",15,16),e.NdJ("nzQueryParams",function(r){return t.onQueryParamsChange(r)}),e.TgZ(46,"thead")(47,"tr"),e.YNc(48,he,2,1,"th",17),e.qZA()(),e.TgZ(49,"tbody"),e.YNc(50,ge,16,12,"tr",18),e.qZA()()),2&n){const l=e.MAs(43),r=e.MAs(45);e.xp6(4),e.hij("",e.lcZ(5,29,"Customer"),":"),e.xp6(2),e.Q6J("ngModel",t.CustomerId),e.xp6(1),e.Q6J("ngIf",t.showAllCustomer),e.xp6(1),e.Q6J("ngForOf",t.customerArr),e.xp6(4),e.hij("",e.lcZ(13,31,"Carpark"),":"),e.xp6(2),e.Q6J("ngModel",t.CarparkChoose)("nzDropdownMatchSelectWidth",!1),e.xp6(1),e.Q6J("nzLabel",e.lcZ(16,33,"All")),e.xp6(2),e.Q6J("ngForOf",t.carparkAllList),e.xp6(4),e.hij("",e.lcZ(22,35,"File Type"),":"),e.xp6(2),e.Q6J("ngModel",t.fileType),e.xp6(1),e.Q6J("ngIf",t.showAllCustomer),e.xp6(6),e.hij("",e.lcZ(31,37,"Report scope"),":"),e.xp6(2),e.Q6J("ngModel",t.reportName)("nzDropdownMatchSelectWidth",!1),e.xp6(1),e.Q6J("ngIf",t.showAllCustomer),e.xp6(1),e.Q6J("ngForOf",e.lcZ(35,39,t.reportNames$)),e.xp6(5),e.hij("",e.lcZ(40,41,"Time Range"),":"),e.xp6(2),e.Q6J("ngModel",t.timeRange),e.xp6(3),e.Q6J("nzData",t.listData)("nzFrontPagination",!1)("nzLoading",t.loading)("nzTotal",t.pagination.totalCount)("nzPageSize",t.pagination.rowsPerPage)("nzPageIndex",t.pagination.page)("nzShowSizeChanger",!0)("nzShowTotal",l),e.xp6(4),e.Q6J("ngForOf",t.tableHeaders),e.xp6(2),e.Q6J("ngForOf",r.data)}},dependencies:[s.sg,s.O5,f.JJ,f.On,Q.Ip,Q.Vq,F.uw,F.wS,O.N8,O.Uo,O._C,O.Om,O.p0,O.$Z,s.Ov,s.rS,s.uU,k.X$],styles:[".form-control[_ngcontent-%COMP%]{width:10vw}"]}),i})();var _e=o(19832),fe=o(20388);function j(i){return new _e.w(i,"../assets/i18n/",".json")}const ve=[{path:"",component:T.f,children:[{path:"",component:ne,children:[{path:"",redirectTo:"all",pathMatch:"full"},{path:"daily",component:I,data:{breadcrumb:{label:"Daily Report"}}},{path:"monthly",component:I,data:{breadcrumb:{label:"Monthly Report"}}},{path:"all",component:I,data:{breadcrumb:{label:"All Reports"}}}]}]}];let Ce=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[_.k,g.e,y,C.x,h.I,E.Z],imports:[s.ez,f.u5,a.Bz.forChild(ve),v.x,p.D,fe.zk.forRoot(),A.kn,J.A0,k.aw.forChild({loader:{provide:k.Zw,useFactory:j,deps:[b.eN]}}),a.Bz]}),i})()},94327:function(S,M){var b;void 0!==(b=function(){"use strict";function a(c,d,P){var e=new XMLHttpRequest;e.open("GET",c),e.responseType="blob",e.onload=function(){g(e.response,d,P)},e.onerror=function(){console.error("could not download file")},e.send()}function A(c){var d=new XMLHttpRequest;d.open("HEAD",c,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function C(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(d)}}var h="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,_=h.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=h.saveAs||("object"!=typeof window||window!==h?function(){}:"download"in HTMLAnchorElement.prototype&&!_?function(c,d,P){var e=h.URL||h.webkitURL,m=document.createElement("a");m.download=d=d||c.name||"download",m.rel="noopener","string"==typeof c?(m.href=c,m.origin===location.origin?C(m):A(m.href)?a(c,d,P):C(m,m.target="_blank")):(m.href=e.createObjectURL(c),setTimeout(function(){e.revokeObjectURL(m.href)},4e4),setTimeout(function(){C(m)},0))}:"msSaveOrOpenBlob"in navigator?function(c,d,P){if(d=d||c.name||"download","string"!=typeof c)navigator.msSaveOrOpenBlob(function f(c,d){return typeof d>"u"?d={autoBom:!1}:"object"!=typeof d&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\ufeff",c],{type:c.type}):c}(c,P),d);else if(A(c))a(c,d,P);else{var e=document.createElement("a");e.href=c,e.target="_blank",setTimeout(function(){C(e)})}}:function(c,d,P,e){if((e=e||open("","_blank"))&&(e.document.title=e.document.body.innerText="downloading..."),"string"==typeof c)return a(c,d,P);var m="application/octet-stream"===c.type,y=/constructor/i.test(h.HTMLElement)||h.safari,p=/CriOS\/[\d]+/.test(navigator.userAgent);if((p||m&&y||_)&&typeof FileReader<"u"){var v=new FileReader;v.onloadend=function(){var R=v.result;R=p?R:R.replace(/^data:[^;]*;/,"data:attachment/file;"),e?e.location.href=R:location=R,e=null},v.readAsDataURL(c)}else{var T=h.URL||h.webkitURL,Z=T.createObjectURL(c);e?e.location=Z:location.href=Z,e=null,setTimeout(function(){T.revokeObjectURL(Z)},4e4)}});h.saveAs=g.saveAs=g,S.exports=g}.apply(M,[]))&&(S.exports=b)},7499:(S,M,o)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0});var s=o(77415),b=o(67694);s.Observable.prototype.takeWhile=b.takeWhile},67694:(S,M,o)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0});var s=o(41451);M.takeWhile=function b(f){return s.takeWhile(f)(this)}},19612:(S,M,o)=>{"use strict";o(7499)}}]);