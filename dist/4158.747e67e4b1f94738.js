"use strict";(self.webpackChunkst_admin=self.webpackChunkst_admin||[]).push([[4158],{54158:(B,u,a)=>{a.r(u),a.d(u,{VisitorHistoryModule:()=>z});var d=a(36895),l=a(24006),g=a(34793),f=a(8929),b=a(86181),v=a(94327),t=(a(97442),a(94650)),_=a(80601),h=a(60097),c=a(98062),C=a(76916),y=a(79118),T=a(40269);function Z(n,o){1&n&&t._UZ(0,"span")}function w(n,o){1&n&&t._uU(0),2&n&&t.hij(" ",""," ")}function k(n,o){1&n&&t._UZ(0,"span")}function M(n,o){1&n&&t._uU(0),2&n&&t.hij(" ","--"," ")}function D(n,o){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"date"),t._UZ(3,"br"),t._uU(4),t.ALo(5,"date"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,2,e.visitDate,"d LLL yyyy"),""),t.xp6(3),t.hij(" ",t.xi3(5,5,e.visitDate,"h:mm:ss a")," ")}}function A(n,o){1&n&&t._uU(0),2&n&&t.hij(" ","--"," ")}function O(n,o){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"date"),t._UZ(3,"br"),t._uU(4),t.ALo(5,"date"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,2,null==e.workingSessionObj?null:e.workingSessionObj.exitDateTime,"d LLL yyyy"),""),t.xp6(3),t.hij(" ",t.xi3(5,5,null==e.workingSessionObj?null:e.workingSessionObj.exitDateTime,"h:mm:ss a")," ")}}function N(n,o){1&n&&t._uU(0),2&n&&t.hij(" ","--"," ")}function U(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"td")(1,"span"),t._uU(2),t.qZA()(),t.TgZ(3,"td")(4,"span"),t._uU(5),t.qZA()(),t.TgZ(6,"td")(7,"span"),t.YNc(8,Z,1,0,"span",5),t._uU(9),t.qZA(),t.YNc(10,w,1,1,"ng-template",null,6,t.W1O),t.qZA(),t.TgZ(12,"td")(13,"span"),t.YNc(14,k,1,0,"span",5),t._uU(15),t.qZA(),t.YNc(16,M,1,1,"ng-template",null,7,t.W1O),t.qZA(),t.TgZ(18,"td"),t.YNc(19,D,6,8,"span",5),t.YNc(20,A,1,1,"ng-template",null,8,t.W1O),t.qZA(),t.TgZ(22,"td"),t.YNc(23,O,6,8,"span",5),t.YNc(24,N,1,1,"ng-template",null,9,t.W1O),t.qZA(),t.TgZ(26,"td")(27,"span"),t._uU(28),t.qZA()(),t.TgZ(29,"td")(30,"span")(31,"a",10),t.NdJ("click",function(){const s=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.shouOneData(s))}),t._uU(32),t.qZA()()()}if(2&n){const e=o.$implicit,i=t.MAs(11),r=t.MAs(17),s=t.MAs(21),m=t.MAs(25),p=t.oxw();t.Udp("width",p.tableHeaders[0].width),t.xp6(2),t.hij(" ",e.carPark.carParkCode||""," "),t.xp6(1),t.Udp("width",p.tableHeaders[1].width),t.xp6(2),t.hij(" ",e.vehicleNumber||""," "),t.xp6(1),t.Udp("width",p.tableHeaders[2].width),t.xp6(2),t.Q6J("ngIf",e.blk)("ngIfElse",i),t.xp6(1),t.lnq(" ",e.blk,"-",e.level,"-",e.unit," "),t.xp6(3),t.Udp("width",p.tableHeaders[3].width),t.xp6(2),t.Q6J("ngIf",e.entryType)("ngIfElse",r),t.xp6(1),t.hij(" ",e.entryType," "),t.xp6(3),t.Udp("width",p.tableHeaders[4].width),t.xp6(1),t.Q6J("ngIf",e.visitDate)("ngIfElse",s),t.xp6(3),t.Udp("width",p.tableHeaders[5].width),t.xp6(1),t.Q6J("ngIf",null==e.workingSessionObj?null:e.workingSessionObj.exitDateTime)("ngIfElse",m),t.xp6(3),t.Udp("width",p.tableHeaders[6].width),t.xp6(2),t.hij(" ",e.hpNumber||"--"," "),t.xp6(1),t.Udp("width",p.tableHeaders[7].width),t.xp6(3),t.Oqu("Detail")}}function V(n,o){if(1&n&&(t.TgZ(0,"div",16)(1,"div",17)(2,"p",18),t._uU(3,"Vehicle No."),t.qZA(),t.TgZ(4,"p",18),t._uU(5),t.qZA()(),t.TgZ(6,"div",17)(7,"p",18),t._uU(8,"carParkCode"),t.qZA(),t.TgZ(9,"p",18),t._uU(10),t.qZA()(),t.TgZ(11,"div",17)(12,"p",18),t._uU(13,"Blk/Unit#"),t.qZA(),t.TgZ(14,"p",18),t._uU(15),t.qZA()(),t.TgZ(16,"div",17)(17,"p",18),t._uU(18,"Entry Type"),t.qZA(),t.TgZ(19,"p",18),t._uU(20),t.qZA()(),t.TgZ(21,"div",17)(22,"p",18),t._uU(23,"Entry Time"),t.qZA(),t.TgZ(24,"p",18),t._uU(25),t.ALo(26,"date"),t._UZ(27,"br"),t._uU(28),t.ALo(29,"date"),t.qZA()(),t.TgZ(30,"div",17)(31,"p",18),t._uU(32,"Phone Num"),t.qZA(),t.TgZ(33,"p",18),t._uU(34),t.qZA()()()),2&n){const e=t.oxw(2);t.xp6(5),t.Oqu(e.showOneData.vehicleNumber),t.xp6(5),t.Oqu(e.showOneData.carPark.carParkCode),t.xp6(5),t.lnq(" ",e.showOneData.blk,"-",e.showOneData.level,"-",e.showOneData.unit," "),t.xp6(5),t.hij(" ",e.showOneData.entryType,""),t.xp6(5),t.hij(" ",t.xi3(26,9,e.showOneData.visitDate,"d LLL yyyy"),""),t.xp6(3),t.hij(" ",t.xi3(29,12,e.showOneData.visitDate,"h:mm:ss a")," "),t.xp6(6),t.Oqu(e.showOneData.hpNumber)}}function P(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",11)(1,"div",12)(2,"div",13)(3,"h5"),t._uU(4,"Transaction Information"),t.qZA(),t.TgZ(5,"button",14),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.turnOffDialog())}),t._uU(6,"Close"),t.qZA()(),t.YNc(7,V,35,15,"div",15),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(7),t.Q6J("ngIf",e.showOneData.id)}}let H=(()=>{class n{constructor(e,i){this.carParkService=e,this.VisitorHistoryService=i,this.tableHeaders=[],this.data=[],this.loading=!1,this.pagination=(0,b.f$)(),this.vehicleNumberD="",this.entryTypeChoosD="",this.showOneData={},this.dialogShow=!1}ngOnInit(){this.tableHeaders=[{text:"Car Park",column:"carPark",width:"200px"},{text:"vehicle No.",column:"carPark",width:"200px"},{text:"Blk/Unit#",column:"roomNo",width:"200px"},{text:"Entry Type",column:"entryType",width:"240px"},{text:"Entry Time",column:"enterTime",width:"200px"},{text:"Exit Time",column:"exitTime",width:"200px"},{text:"Phone Num",column:"hpNumber",width:"200px"},{text:"Actions",width:"100px"}]}pageChanged(e){this.pagination=e,this.askTableDate(e)}ngOnChanges(e){e.carparkId&&(this.carparkIds=e.carparkId.currentValue),e.blk&&(this.blks=e.blk.currentValue),e.level&&(this.levels=e.level.currentValue),e.unit&&(this.units=e.unit.currentValue),e.visitDate&&(this.visitDates=e.visitDate.currentValue),e.vehicleNumber&&(this.vehicleNumberD=e.vehicleNumber.currentValue),e.entryTypeChoose&&(this.entryTypeChoosD=e.entryTypeChoose.currentValue),this.askTableDate(this.pagination)}askTableDate(e){this.VisitorHistoryService.askTableList({carparkId:this.carparkIds,blk:this.blks,level:this.levels,unit:this.units,visitDate:this.visitDates,vehicleNo:this.vehicleNumberD,entryType:this.entryTypeChoosD},{sort:"id,desc"},e).subscribe(i=>{this.pagination={...e,totalCount:i.totalElements},this.data=i.content})}shouOneData(e){this.dialogShow=!0,this.showOneData=e,console.log(e,"\u6570\u636e")}turnOffDialog(){this.dialogShow=!1}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(h.x),t.Y36(c.I))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-condo-table"]],inputs:{carparkId:"carparkId",blk:"blk",level:"level",unit:"unit",visitDate:"visitDate",vehicleNumber:"vehicleNumber",entryTypeChoose:"entryTypeChoose"},features:[t.TTD],decls:6,vars:6,consts:[[3,"headers","items","loading","pagination","scrollingDisabled","pageChanged"],["tableTransactions",""],["class","tbody-main"],["rowTemplate",""],["class","  info-box","style"," width:70vw;height:68vh; ",4,"ngIf"],[4,"ngIf","ngIfElse"],["noData",""],["noDataC",""],["noDataA",""],["noDataB",""],[1,"m-link","m--font-primary",3,"click"],[1,"info-box",2,"width","70vw","height","68vh"],[1,"m-content"],[1,"offBtn"],["type","button",1,"btn","btn-default",3,"click"],["style","box-sizing: border-box;padding-left: 30px;",4,"ngIf"],[2,"box-sizing","border-box","padding-left","30px"],[1,"col-12",2,"display","flex"],[1,"col-3"]],template:function(e,i){1&e&&(t.TgZ(0,"app-datatable",0,1),t.NdJ("pageChanged",function(s){return i.pageChanged(s)}),t.ynx(2),t.YNc(3,U,33,32,"ng-template",2,3,t.W1O),t.BQk(),t.qZA(),t.YNc(5,P,8,1,"div",4)),2&e&&(t.Q6J("headers",i.tableHeaders)("items",i.data)("loading",i.loading)("pagination",i.pagination)("scrollingDisabled",!0),t.xp6(5),t.Q6J("ngIf",1==i.dialogShow))},dependencies:[d.O5,y.nE,T.Uo,d.uU],styles:[".info-box[_ngcontent-%COMP%]{z-index:9;position:fixed;top:15%;left:20%;background-color:#f2f3f8;box-sizing:border-box;padding:10px}.info-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:500}.m-content[_ngcontent-%COMP%]{background-color:#fff;height:60vh;margin:0 auto;padding:10px!important}.m-content[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{height:50px;display:flex;align-items:center}.offBtn[_ngcontent-%COMP%]{display:flex;justify-content:space-between;background-color:#fff;height:6vh;align-items:center;box-sizing:border-box;padding-left:30px;padding-right:30px}"]}),n})();function I(n,o){if(1&n&&(t.TgZ(0,"option",21),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}let j=(()=>{class n{constructor(e,i,r){this.parkingMemberService=e,this.carParkService=i,this.VisitorHistoryService=r,this.carparkList=[],this.chooseCarpark="",this.roomNo="",this.roomNo$=new f.xQ,this.VehicleNo="",this.VehicleNo$=new f.xQ,this.entryTime=new Date,this.carparkId="",this.blk="",this.level="",this.unit="",this.timeRange=[],this.tableData=[],this.startYmdhs="",this.endYmdhs="",this.tableHeaders=[{text:"",width:"40px"},{text:"ID",column:"id",width:"80px"},{text:"Vehicle",column:"vehiclePlateNo",width:"150px"},{text:"IU No.",column:"iuNumber",width:"150px"},{text:"Driver",column:"driverId",width:"120px"},{text:"Car Park",column:"carParkId",width:"120px"},{text:"Zone",column:"Zone",width:"120px"},{text:"Start Date",column:"startDate",width:"120px"},{text:"End Date",column:"endDate",width:"120px"},{text:"Visitor Type",column:"status",width:"120px"},{text:"Remark",column:"remark",width:"120px"},{text:"Actions",width:"100px"}],this.entryType=[],this.entryTypeChoose=""}get filterParams(){throw new Error("Method not implemented.")}ngOnInit(){this.zoneOrCarparkChanged(),this.carParkService.getSimpleList("").subscribe(e=>{this.carparkList=e}),this.carParkService.getEntryTypeSelect().subscribe(e=>{this.entryType=e}),this.roomNo$.debounceTime(500).subscribe(()=>{let e=this.roomNo.split("-");this.blk=e[0],this.level=e[1],this.unit=e[2]})}zoneOrCarparkChanged(e){this.carparkId=this.chooseCarpark}getVisitDate(){this.visitDate=this.startYmdhs+" - "+this.endYmdhs}export(){this.VisitorHistoryService.exportCondo({blk:this.blk,level:this.level,unit:this.unit,visitDate:this.visitDate,carparkId:this.carparkId}).subscribe(i=>{(0,v.saveAs)(i,"Condo visitor history.csv")})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_.N),t.Y36(h.x),t.Y36(c.I))},n.\u0275cmp=t.Xpm({type:n,selectors:[["visitor-history"]],decls:39,vars:17,consts:[[1,"body-wrapper"],[1,"m-content"],[1,"m-portlet","m-portlet--tabs"],[1,"m-portlet__body","m-portlet__body--scrollable"],[1,"m-portlet__frame"],[1,"form-group"],[1,"m-portlet__filter"],[1,"col-form-label"],["name","entryType",1,"form-control","m-input","selectAreas",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-form-label","col-form-label-nowrap"],[1,"m-input-icon","m-input-icon--left"],["type","text","placeholder","1-1001-1",1,"form-control","m-input","selectAreas",3,"ngModel","ngModelChange"],[1,"m-input-icon__icon","m-input-icon__icon--left"],[1,"la","la-search"],["type","text",1,"form-control","m-input","selectAreas",3,"ngModel","ngModelChange"],[1,"m-input-icon",2,"display","flex"],["type","datetime-local",1,"form-control",3,"ngModel","ngModelChange"],[1,"btnss",3,"click"],[3,"carparkId","blk","level","unit","visitDate","vehicleNumber","entryTypeChoose"],[3,"value"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"app-title-bar"),t.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"label",7),t._uU(9),t.qZA(),t.TgZ(10,"select",8),t.NdJ("ngModelChange",function(s){return i.entryTypeChoose=s}),t._UZ(11,"option",9),t.YNc(12,I,2,2,"option",10),t.qZA()(),t.TgZ(13,"div",6)(14,"label",11),t._uU(15),t.qZA(),t.TgZ(16,"div",12)(17,"input",13),t.NdJ("ngModelChange",function(s){return i.roomNo=s})("ngModelChange",function(s){return i.roomNo$.next(s)}),t.qZA(),t.TgZ(18,"span",14)(19,"span"),t._UZ(20,"i",15),t.qZA()()()(),t.TgZ(21,"div",6)(22,"label",11),t._uU(23),t.qZA(),t.TgZ(24,"div",12)(25,"input",16),t.NdJ("ngModelChange",function(s){return i.VehicleNo=s})("ngModelChange",function(s){return i.VehicleNo$.next(s)}),t.qZA(),t.TgZ(26,"span",14)(27,"span"),t._UZ(28,"i",15),t.qZA()()()()(),t.TgZ(29,"div",5)(30,"div",17)(31,"label",11),t._uU(32),t.qZA(),t.TgZ(33,"input",18),t.NdJ("ngModelChange",function(s){return i.startYmdhs=s}),t.qZA(),t.TgZ(34,"input",18),t.NdJ("ngModelChange",function(s){return i.endYmdhs=s})("ngModelChange",function(){return i.getVisitDate()}),t.qZA()(),t.TgZ(35,"div",19),t.NdJ("click",function(){return i.export()}),t._uU(36,"Export"),t.qZA()(),t.TgZ(37,"div"),t._UZ(38,"app-condo-table",20),t.qZA()()()()()()),2&e&&(t.xp6(9),t.hij(" ","Entry Type",": "),t.xp6(1),t.Q6J("ngModel",i.entryTypeChoose),t.xp6(2),t.Q6J("ngForOf",i.entryType),t.xp6(3),t.hij(" ","Blk/Unit#",": "),t.xp6(2),t.Q6J("ngModel",i.roomNo),t.xp6(6),t.hij(" ","Vehicle No.",": "),t.xp6(2),t.Q6J("ngModel",i.VehicleNo),t.xp6(7),t.hij(" ","Entry Time",": "),t.xp6(1),t.Q6J("ngModel",i.startYmdhs),t.xp6(1),t.Q6J("ngModel",i.endYmdhs),t.xp6(4),t.Q6J("carparkId",i.carparkId)("blk",i.blk)("level",i.level)("unit",i.unit)("visitDate",i.visitDate)("vehicleNumber",i.VehicleNo)("entryTypeChoose",i.entryTypeChoose))},dependencies:[d.sg,C.G,l.YN,l.Kr,l.Fj,l.EJ,l.JJ,l.On,H],styles:["h1[_ngcontent-%COMP%]{font-weight:500;font-size:24px}.form-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.form-group[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20%}.selectAreas[_ngcontent-%COMP%]{width:260px}.col-form-label[_ngcontent-%COMP%]{font-size:20px}.btnss[_ngcontent-%COMP%]{width:120px!important;height:42px;display:flex;justify-content:center;align-items:center;border-radius:5px;border:1px solid #00bdb5;margin-right:20px;font-size:16x;cursor:pointer;font-weight:500}.col-form-label[_ngcontent-%COMP%]{font-weight:500;font-size:16px;width:auto}.btnss[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:120px!important;margin-left:20px}.btnss[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-of-type(1){color:#00bdb5}.btnss[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-of-type(2){color:#fff;background-color:#00bdb5}.form-group[_ngcontent-%COMP%]{display:flex!important;justify-content:space-between}.m-portlet__filter[_ngcontent-%COMP%]{display:flex;margin-right:30px!important;width:25%;justify-content:center;align-items:center}"]}),n})();var J=a(59501),q=a(21532),S=a(88796),x=a(30329);let Y=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[h.x,c.I],imports:[d.ez,x.D]}),n})();var E=a(4666),L=a(372);const Q=[{path:"",component:J.f,children:[{path:"",component:j}]}];let z=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[_.N,E.p,c.I],imports:[d.ez,q.x,g.Bz.forChild(Q),S.A0,l.u5,l.UX,Y,x.D,L.kn,g.Bz]}),n})()}}]);