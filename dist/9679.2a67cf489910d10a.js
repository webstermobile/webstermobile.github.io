"use strict";(self.webpackChunkst_admin=self.webpackChunkst_admin||[]).push([[9679],{11917:(H,j,n)=>{n.d(j,{X:()=>x});var e=n(94650),A=n(34793),d=n(20388),Z=n(66616),P=n(47044),z=n(21811);let x=(()=>{class D{constructor(K,y){this.router=K,this.bsModalRef=y,this.cancel=new e.vpe,this.submit=new e.vpe}doSubmit(){this.submit.emit()}doCancel(){this.cancel.emit()}}return D.\u0275fac=function(K){return new(K||D)(e.Y36(A.F0),e.Y36(d.UZ))},D.\u0275cmp=e.Xpm({type:D,selectors:[["confirm-modal"]],inputs:{options:"options"},outputs:{cancel:"cancel",submit:"submit"},decls:10,vars:4,consts:[[1,"modal-body"],[1,"modal-title"],[1,"modal-msg"],[1,"modal-btns"],["type","button","nz-button","","nzType","primary","nzGhost","",3,"click"],["type","button","nz-button","","nzType","primary",3,"click"]],template:function(K,y){1&K&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2),e._uU(4),e.qZA(),e.TgZ(5,"div",3)(6,"button",4),e.NdJ("click",function(){return y.doCancel()}),e._uU(7),e.qZA(),e.TgZ(8,"button",5),e.NdJ("click",function(){return y.doSubmit()}),e._uU(9),e.qZA()()()),2&K&&(e.xp6(2),e.hij(" ",y.options.title," "),e.xp6(2),e.Oqu(y.options.message),e.xp6(3),e.hij(" ",y.options.cancelText||"Cancel"," "),e.xp6(2),e.hij(" ",y.options.submitText||"Submit"," "))},dependencies:[Z.ix,P.w,z.dQ],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-items:center;align-items:center}.modal-body[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{color:#6c6e86}.modal-body[_ngcontent-%COMP%]   .modal-msg[_ngcontent-%COMP%]{color:#868aa8}.modal-body[_ngcontent-%COMP%]   .modal-btns[_ngcontent-%COMP%]{margin-top:20px}.modal-body[_ngcontent-%COMP%]   .modal-btns[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 10px}"]}),D})()},53033:(H,j,n)=>{n.d(j,{Z:()=>d,e:()=>Z});var e=n(36895),A=n(94650);let d=(()=>{class P extends e.H9{transform(x,D,B,K,y){if(!D)return"";switch(D.toUpperCase()){case"MMK":return`MMK ${x}`;case"SGD":return`$${x}`;default:return super.transform(x,D,B,K,y)}}}return P.\u0275fac=function(){let z;return function(D){return(z||(z=A.n5z(P)))(D||P)}}(),P.\u0275pipe=A.Yjl({name:"excurrency",type:P,pure:!0}),P})(),Z=(()=>{class P{transform(x){return x/100}}return P.\u0275fac=function(x){return new(x||P)},P.\u0275pipe=A.Yjl({name:"cent2Dollar",type:P,pure:!0}),P})()},76916:(H,j,n)=>{n.d(j,{G:()=>Q});var e=n(34793),A=n(92198),d=n(94650),Z=n(89383),P=n(60097),z=n(36895);function x(t,N){if(1&t&&(d.TgZ(0,"a",14)(1,"span",15),d._uU(2),d.ALo(3,"translate"),d.qZA()()),2&t){const T=d.oxw().$implicit;d.xp6(2),d.hij(" ",d.lcZ(3,1,T.label)," ")}}function D(t,N){if(1&t&&(d.TgZ(0,"a",16)(1,"span",15),d._uU(2),d.ALo(3,"translate"),d.qZA()()),2&t){const T=d.oxw(),b=T.$implicit,L=T.last,v=d.oxw(2);d.Q6J("routerLink",b.url)("queryParams",L&&v.route.snapshot.queryParams),d.xp6(2),d.hij(" ",d.lcZ(3,3,b.label)," ")}}function B(t,N){if(1&t&&(d.ynx(0),d.TgZ(1,"li",10)(2,"span"),d._uU(3," > "),d.qZA()(),d.TgZ(4,"li",11),d.YNc(5,x,4,3,"a",12),d.YNc(6,D,4,5,"a",13),d.qZA(),d.BQk()),2&t){const T=N.first;d.xp6(5),d.Q6J("ngIf",T),d.xp6(1),d.Q6J("ngIf",!T)}}function K(t,N){if(1&t&&(d.TgZ(0,"div",1)(1,"div",2)(2,"div",3),d._UZ(3,"h3",4),d.TgZ(4,"ul",5)(5,"li",6)(6,"a",7),d._UZ(7,"i",8),d.qZA()(),d.YNc(8,B,7,2,"ng-container",9),d.qZA()(),d.TgZ(9,"div"),d.Hsn(10),d.qZA()()()),2&t){const T=d.oxw();d.xp6(3),d.Q6J("innerHTML",T.title,d.oJD),d.xp6(5),d.Q6J("ngForOf",T.breads)}}const y=["*"];let Q=(()=>{class t{constructor(T,b,L,v){this.router=T,this.route=b,this.translate=L,this._carparkService=v,this.breads=[],this.loginUser=""}ngOnInit(){let T=JSON.parse(localStorage.getItem("user-roles"))[0];this.loginUser=T,console.log(this.loginUser,"\u4fe1\u606f"),this.breads=this.buildBreadCrumb(this.route.root),this.translate.get(this.breads[0].label).subscribe(L=>{this.label=L}),this.router.events.pipe((0,A.h)(L=>L instanceof e.m2)).subscribe(()=>{this.breads=this.buildBreadCrumb(this.route.root)})}buildBreadCrumb(T,b=[""],L=[]){const v=T.snapshot.url[0]&&T.snapshot.url[0].path,U=[...b,v],I={...this.extractBreadcrumb(T),url:U},W=v&&I.label?[...L,I]:L;return this.title=I.title||this.title||"",this.isMotorist&&"My Vehicle(s)"===I.label&&(this.title="My Vehicle(s)"),T.firstChild?v?this.buildBreadCrumb(T.firstChild,U,W):this.buildBreadCrumb(T.firstChild,b,L):(this.translate.get(this.title).subscribe(F=>{this.title=F}),W)}get isMotorist(){return this._carparkService.isMotorist()}extractBreadcrumb(T){return T.snapshot.data.breadcrumb instanceof Function?T.snapshot.data.breadcrumb(T):T.snapshot.data.breadcrumb}}return t.\u0275fac=function(T){return new(T||t)(d.Y36(e.F0),d.Y36(e.gz),d.Y36(Z.sK),d.Y36(P.x))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-title-bar"]],ngContentSelectors:y,decls:1,vars:1,consts:[["class","m-subheader",4,"ngIf"],[1,"m-subheader"],[1,"d-flex","align-items-center"],[1,"mr-auto"],[1,"m-subheader__title","m-subheader__title--separator","text-main",3,"innerHTML"],[1,"m-subheader__breadcrumbs","m-nav","m-nav--inline"],[1,"m-nav__item","m-nav__item--home"],["routerLink","/",1,"m-nav__link","m-nav__link--icon"],[1,"m-nav__link-icon","la","la-home"],[4,"ngFor","ngForOf"],[1,"m-nav__separator"],[1,"m-nav__item"],["class","m-nav__link",4,"ngIf"],["class","m-nav__link",3,"routerLink","queryParams",4,"ngIf"],[1,"m-nav__link"],[1,"m-nav__link-text"],[1,"m-nav__link",3,"routerLink","queryParams"]],template:function(T,b){1&T&&(d.F$t(),d.YNc(0,K,11,2,"div",0)),2&T&&d.Q6J("ngIf","ROLE_TPO_PARTNER"!==b.loginUser)},dependencies:[z.sg,z.O5,e.yS,Z.X$],encapsulation:2}),t})()},72156:(H,j,n)=>{n.d(j,{H:()=>C});var e=n(94650),A=n(38014),d=n(28555),Z=n(17489),z=(n(19612),n(20388)),x=n(69440),D=n(89383),B=n(36895),K=n(11917),y=n(66616),Q=n(47044),t=n(21811),N=n(8929),T=n(1059),b=n(80013),L=n(75778),v=n(2994),U=n(87545),I=n(24850),W=n(88117),F=n(72986),J=n(34793),q=n(64050),S=n(24006),$=n(38231);function E(o,O){if(1&o&&e._UZ(0,"nz-option",9),2&o){const i=O.$implicit,c=e.oxw();e.Q6J("nzValue",i)("nzLabel",c.displayDriverOption(i))}}let M=(()=>{class o{constructor(i,c,m){this.router=i,this.bsModalRef=c,this.driverService=m,this.cancel=new e.vpe,this.submit=new e.vpe,this.options={},this.driverInput$=new N.xQ}ngOnInit(){this.driver$=this.driverInput$.pipe((0,T.O)(""),(0,b.b)(400),(0,L.x)(),(0,v.b)(()=>this.driverLoading=!0),(0,U.w)(i=>this.driverService.getEnforcementList().pipe((0,I.U)(c=>i?c.filter(m=>-1!==this.displayDriverOption(m).toLowerCase().indexOf(i.toLowerCase())):c.slice(0,40)),(0,v.b)(()=>{this.driverLoading=!1}))),(0,W.B)()),this.driver$.pipe((0,F.q)(1)).subscribe(i=>{this.driver=i[0]})}doSubmit(){this.submit.emit(this.driver)}doCancel(){this.cancel.emit()}displayDriverOption(i){return[[i.firstName,i.lastName].filter(m=>m).join(" "),i.email,i.mobile].filter(m=>m&&m.length).join(", ")}}return o.\u0275fac=function(i){return new(i||o)(e.Y36(J.F0),e.Y36(z.UZ),e.Y36(q.F))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-assign-modal"]],outputs:{cancel:"cancel",submit:"submit"},decls:17,vars:14,consts:[[1,"modal-header","align-items-center"],[1,"btn","btn-sm",3,"click"],[1,"la","la-times"],[1,"modal-body"],["name","driverControl","nzPlaceHolder","Please Select",2,"width","100%",3,"nzLoading","ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[1,"modal-footer"],["nz-button","","nzType","primary","nzGhost","",3,"click"],["nz-button","","nzType","primary",3,"click"],[3,"nzValue","nzLabel"]],template:function(i,c){1&i&&(e.TgZ(0,"div",0)(1,"h6"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",1),e.NdJ("click",function(){return c.doCancel()}),e._UZ(5,"i",2),e.qZA()(),e.TgZ(6,"div",3)(7,"nz-select",4),e.NdJ("ngModelChange",function(a){return c.driver=a}),e.YNc(8,E,1,2,"nz-option",5),e.ALo(9,"async"),e.qZA()(),e.TgZ(10,"div",6)(11,"button",7),e.NdJ("click",function(){return c.doCancel()}),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"button",8),e.NdJ("click",function(){return c.doSubmit()}),e._uU(15),e.ALo(16,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,6,"Assign To")),e.xp6(5),e.Q6J("nzLoading",c.driverLoading)("ngModel",c.driver),e.xp6(1),e.Q6J("ngForOf",e.lcZ(9,8,c.driver$)),e.xp6(4),e.Oqu(e.lcZ(13,10,"Cancel")),e.xp6(3),e.Oqu(e.lcZ(16,12,"Confirm")))},dependencies:[B.sg,S.JJ,S.On,$.Ip,$.Vq,y.ix,Q.w,t.dQ,B.Ov,D.X$],encapsulation:2}),o})();function R(o,O){if(1&o&&(e.ynx(0),e.TgZ(1,"div",9)(2,"div",10),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",11),e._uU(6),e.qZA()(),e.TgZ(7,"div",9)(8,"div",10),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"div",11),e._uU(12),e.qZA()(),e.BQk()),2&o){const i=e.oxw(2);e.xp6(3),e.Oqu(e.lcZ(4,4,"Assigned By")),e.xp6(3),e.Oqu(i.fault.assignedBy),e.xp6(3),e.Oqu(e.lcZ(10,6,"Assigned To")),e.xp6(3),e.Oqu(i.fault.assignedTo)}}function l(o,O){if(1&o){const i=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"div",10),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",11),e._uU(6),e.qZA()(),e.TgZ(7,"div",9)(8,"div",10),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"div",11),e._uU(12),e.qZA()(),e.TgZ(13,"div",9)(14,"div",10),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",11),e._uU(18),e.qZA()(),e.TgZ(19,"div",9)(20,"div",10),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"div",11),e._uU(24),e.qZA()(),e.TgZ(25,"div",9)(26,"div",10),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"div",11),e._uU(30),e.qZA()(),e._UZ(31,"hr"),e.TgZ(32,"div",9)(33,"div",10),e._uU(34),e.ALo(35,"translate"),e.qZA(),e.TgZ(36,"div",11),e._uU(37),e.qZA()(),e.TgZ(38,"div",9)(39,"div",10),e._uU(40),e.ALo(41,"translate"),e.qZA(),e.TgZ(42,"div",11),e._uU(43),e.qZA()(),e.YNc(44,R,13,8,"ng-container",12),e.TgZ(45,"div",13)(46,"button",14),e.NdJ("click",function(){e.CHM(i);const m=e.oxw(),a=e.MAs(12);return e.KtG(m.openAssign(a))}),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.TgZ(49,"button",15),e.NdJ("click",function(){e.CHM(i);const m=e.oxw(),a=e.MAs(8);return e.KtG(m.openSolve(a))}),e._uU(50),e.ALo(51,"translate"),e.qZA()(),e.TgZ(52,"button",16),e.NdJ("click",function(){e.CHM(i);const m=e.oxw();return e.KtG(m.edit.emit())}),e._UZ(53,"i",17),e._uU(54),e.ALo(55,"translate"),e.qZA(),e.TgZ(56,"button",18),e.NdJ("click",function(){e.CHM(i);const m=e.oxw(),a=e.MAs(10);return e.KtG(m.openSolve(a))}),e._UZ(57,"i",19),e._uU(58),e.ALo(59,"translate"),e.qZA()()}if(2&o){const i=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,21,"Car Park")),e.xp6(3),e.AsE("",null==i.fault.carPark?null:i.fault.carPark.code," ",null==i.fault.carPark?null:i.fault.carPark.name,""),e.xp6(3),e.Oqu(e.lcZ(10,23,"Equipment")),e.xp6(3),e.Oqu(i.fault.equipment),e.xp6(3),e.Oqu(e.lcZ(16,25,"Fault Name")),e.xp6(3),e.Oqu(i.fault.faultName),e.xp6(3),e.Oqu(e.lcZ(22,27,"Level")),e.xp6(3),e.Oqu(i.fault.faultLevel),e.xp6(3),e.Oqu(e.lcZ(28,29,"Remark")),e.xp6(3),e.Oqu(i.fault.remark),e.xp6(4),e.Oqu(e.lcZ(35,31,"Created At")),e.xp6(3),e.Oqu(i.formatTime(i.fault.raisedTime)),e.xp6(3),e.Oqu(e.lcZ(41,33,"Created By")),e.xp6(3),e.Oqu(i.fault.raisedBy),e.xp6(1),e.Q6J("ngIf",i.fault.assignedTo),e.xp6(3),e.Oqu(e.lcZ(48,35,"Assign To")),e.xp6(2),e.Q6J("disabled","assigned"!==i.fault.status),e.xp6(1),e.Oqu(e.lcZ(51,37,"Solve")),e.xp6(4),e.hij(" ",e.lcZ(55,39,"Edit Fault"),""),e.xp6(4),e.hij(" ",e.lcZ(59,41,"Ignore Fault"),"")}}function h(o,O){if(1&o){const i=e.EpF();e.TgZ(0,"confirm-modal",20),e.NdJ("cancel",function(m){e.CHM(i);const a=e.oxw();return e.KtG(a.onCancel(m))})("submit",function(m){e.CHM(i);const a=e.oxw();return e.KtG(a.onSolve(m))}),e.qZA()}if(2&o){const i=e.oxw();e.Q6J("options",i.solveConfirmOpts)}}function g(o,O){if(1&o){const i=e.EpF();e.TgZ(0,"confirm-modal",20),e.NdJ("cancel",function(m){e.CHM(i);const a=e.oxw();return e.KtG(a.onCancel(m))})("submit",function(m){e.CHM(i);const a=e.oxw();return e.KtG(a.onReject(m))}),e.qZA()}if(2&o){const i=e.oxw();e.Q6J("options",i.rejectConfirmOpts)}}function _(o,O){if(1&o){const i=e.EpF();e.TgZ(0,"app-assign-modal",21),e.NdJ("cancel",function(m){e.CHM(i);const a=e.oxw();return e.KtG(a.onCancel(m))})("submit",function(m){e.CHM(i);const a=e.oxw();return e.KtG(a.onAssign(m))}),e.qZA()}}let C=(()=>{class o{constructor(i,c,m,a,s){this.modalService=i,this.modalRef=c,this.maintenanceService=m,this.translate=a,this.store=s,this.cancel=new e.vpe,this.edit=new e.vpe,this.solve=new e.vpe,this.assign=new e.vpe,this.reject=new e.vpe,this.solveConfirmOpts={title:"Are you sure it has resolved?",message:"You won't be able to revert this!",cancelText:"Cancel",submitText:"Confirm"},this.rejectConfirmOpts={title:"Are you sure it has ignored?",message:"You won't be able to revert this!",cancelText:"Cancel",submitText:"Confirm"},this.alive=!0,this.user$=s.pipe((0,d.Ys)("global"))}openSolve(i){this.modalRef=this.modalService.show(i,{class:"modal-dialog-centered"})}onCancel(){this.modalRef.hide()}onSolve(){this.solve.emit({fault:this.fault,callback:()=>this.modalRef.hide()})}onAssign(i){this.assign.emit({fault:{...this.fault,assignedTo:i.userName},callback:()=>this.modalRef.hide()})}onReject(){this.reject.emit({fault:this.fault,callback:()=>this.modalRef.hide()})}openAssign(i){this.modalRef=this.modalService.show(i,{class:"modal-dialog-centered"})}formatTime(i){return this.maintenanceService.formatTime(i)}ngOnInit(){console.log(this.solveConfirmOpts);let i=Object.keys(this.solveConfirmOpts),c=[],m=[];i.forEach(r=>{c.push(this.solveConfirmOpts[r])}),this.translate.get(c).subscribe(r=>{if(Object.keys(r).forEach(u=>{m.push(r[u])}),i.length===m.length){console.log(i,m);for(let u=0;u<i.length;u++)this.solveConfirmOpts[i[u]]=m[u]}});let a=Object.keys(this.rejectConfirmOpts),s=[],p=[];a.forEach(r=>{s.push(this.rejectConfirmOpts[r])}),this.translate.get(s).subscribe(r=>{if(Object.keys(r).forEach(u=>{p.push(r[u])}),console.log(s,p),a.length===p.length)for(let u=0;u<a.length;u++)this.rejectConfirmOpts[a[u]]=p[u]}),this.user$.takeWhile(()=>this.alive).subscribe(({user:r})=>{this.viewOnly=(0,Z.intersection)([A.i44.ThirdParty,A.i44.Tester,A.i44.Auditor],r.authorities).length>0})}}return o.\u0275fac=function(i){return new(i||o)(e.Y36(z.tT),e.Y36(z.UZ),e.Y36(x.N),e.Y36(D.sK),e.Y36(d.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-fault-detail"]],inputs:{fault:"fault"},outputs:{cancel:"cancel",edit:"edit",solve:"solve",assign:"assign",reject:"reject"},decls:13,vars:4,consts:[[1,"header"],[1,"m--font-bolder"],[1,"btn","btn-sm",3,"click"],[1,"la","la-times"],["class","body",4,"ngIf"],["resolveConfirmModal",""],["rejectConfirmModal",""],["assignModal",""],[1,"body"],[1,"detail"],[1,"label"],[1,"content"],[4,"ngIf"],[1,"d-flex","justify-content-between","m--margin-top-30","footer-buttons"],["nz-button","","nzType","primary","nzGhost","",3,"click"],["nz-button","","nzType","primary",3,"disabled","click"],["nz-button","","nzType","primary","nzGhost","",1,"w-100","m--margin-top-50",3,"click"],[1,"la","la-edit"],["nz-button","","nzType","primary","nzGhost","",1,"w-100","m--margin-top-20",3,"click"],[1,"la","la-trash"],[3,"options","cancel","submit"],[3,"cancel","submit"]],template:function(i,c){1&i&&(e.TgZ(0,"div",0)(1,"span",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return c.cancel.emit()}),e._UZ(5,"i",3),e.qZA()(),e.YNc(6,l,60,43,"div",4),e.YNc(7,h,1,1,"ng-template",null,5,e.W1O),e.YNc(9,g,1,1,"ng-template",null,6,e.W1O),e.YNc(11,_,1,0,"ng-template",null,7,e.W1O)),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"Fault Details")),e.xp6(4),e.Q6J("ngIf",c.fault))},dependencies:[B.O5,K.X,y.ix,Q.w,t.dQ,M,D.X$],styles:[".header[_ngcontent-%COMP%]{padding:15px;border-bottom:1px solid #e9ecef;justify-content:space-between;display:flex;align-items:center}.body[_ngcontent-%COMP%]{padding:15px}.body[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]{margin:10px 0}.body[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;color:#a8aec4}.body[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{color:#575962}.body[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex-basis:40%}"]}),o})()},84607:(H,j,n)=>{n.d(j,{s:()=>g});var e=n(94650),A=n(38014),d=n(8929),Z=n(1059),P=n(80013),z=n(75778),x=n(2994),D=n(87545),B=n(24850),K=n(88117),y=n(72986),Q=n(34793),t=n(60097),N=n(71942),T=n(36511),b=n(69440),L=n(7053),v=n(89383),U=n(36895),I=n(24006),W=n(38231),F=n(35635),J=n(66616),q=n(47044),S=n(21811),$=n(28213);function E(_,C){if(1&_&&e._UZ(0,"nz-option",25),2&_){const o=C.$implicit;e.Q6J("nzValue",o.id)("nzLabel",o.name)}}function M(_,C){if(1&_&&e._UZ(0,"nz-option",25),2&_){const o=C.$implicit;e.Q6J("nzValue",o.name)("nzLabel",o.name)}}function R(_,C){if(1&_&&e._UZ(0,"nz-option",25),2&_){const o=C.$implicit;e.Q6J("nzValue",o.code)("nzLabel",o.name)}}function l(_,C){if(1&_){const o=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){const c=e.CHM(o).$implicit,m=e.oxw(2);return e.KtG(m.form.remark=c.value)}),e._uU(1),e.qZA()}if(2&_){const o=C.$implicit;e.xp6(1),e.Oqu(o.code)}}function h(_,C){if(1&_){const o=e.EpF();e.TgZ(0,"div",5)(1,"form",6,7),e.NdJ("ngSubmit",function(i){e.CHM(o);const c=e.MAs(2),m=e.oxw();return i.stopPropagation(),e.KtG(m.createFault(c))}),e.TgZ(3,"div",8)(4,"label",9)(5,"span",10),e._uU(6,"*"),e.qZA(),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"nz-select",11),e.NdJ("ngModelChange",function(i){e.CHM(o);const c=e.oxw();return e.KtG(c.form.carParkId=i)}),e.YNc(10,E,1,2,"nz-option",12),e.ALo(11,"async"),e.qZA()(),e.TgZ(12,"div",8)(13,"label",9)(14,"span",10),e._uU(15,"*"),e.qZA(),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"nz-select",13),e.NdJ("ngModelChange",function(i){e.CHM(o);const c=e.oxw();return e.KtG(c.form.equipment=i)}),e.YNc(19,M,1,2,"nz-option",12),e.ALo(20,"async"),e.qZA()(),e.TgZ(21,"div",8)(22,"label",9)(23,"span",10),e._uU(24,"*"),e.qZA(),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"input",14),e.NdJ("ngModelChange",function(i){e.CHM(o);const c=e.oxw();return e.KtG(c.form.faultName=i)}),e.qZA()(),e.TgZ(28,"div",8)(29,"label",9)(30,"span",10),e._uU(31,"*"),e.qZA(),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"nz-select",15,16),e.NdJ("ngModelChange",function(i){e.CHM(o);const c=e.oxw();return e.KtG(c.form.faultLevel=i)}),e.YNc(36,R,1,2,"nz-option",12),e.ALo(37,"async"),e.qZA()(),e.TgZ(38,"div",8)(39,"label",9)(40,"span",10),e._uU(41,"*"),e.qZA(),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"input",17),e.NdJ("ngModelChange",function(i){e.CHM(o);const c=e.oxw();return e.KtG(c.form.raisedBy=i)}),e.qZA()(),e.TgZ(45,"div",8)(46,"label",9),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.YNc(49,l,2,1,"button",18),e.ALo(50,"async"),e.qZA(),e.TgZ(51,"div",8)(52,"label",9)(53,"span",10),e._uU(54,"*"),e.qZA(),e._uU(55),e.ALo(56,"translate"),e.qZA(),e.TgZ(57,"textarea",19),e.NdJ("ngModelChange",function(i){e.CHM(o);const c=e.oxw();return e.KtG(c.form.remark=i)}),e.qZA()(),e.TgZ(58,"div",20)(59,"label",21),e.NdJ("ngModelChange",function(i){e.CHM(o);const c=e.oxw();return e.KtG(c.form.noteMessageFlag=i)}),e._uU(60),e.ALo(61,"translate"),e.qZA()(),e.TgZ(62,"div",22)(63,"button",23),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.cancel.emit())}),e._uU(64),e.ALo(65,"translate"),e.qZA(),e.TgZ(66,"button",24),e._uU(67),e.ALo(68,"translate"),e.qZA()()()()}if(2&_){const o=e.oxw();e.xp6(7),e.hij(" ",e.lcZ(8,22,"Car Park"),": "),e.xp6(2),e.Q6J("ngModel",o.form.carParkId)("nzLoading",o.carParkLoading),e.xp6(1),e.Q6J("ngForOf",e.lcZ(11,24,o.carParks$)),e.xp6(6),e.hij(" ",e.lcZ(17,26,"Equipment"),": "),e.xp6(2),e.Q6J("ngModel",o.form.equipment),e.xp6(1),e.Q6J("ngForOf",e.lcZ(20,28,o.equipments$)),e.xp6(6),e.hij(" ",e.lcZ(26,30,"Fault Name"),": "),e.xp6(2),e.Q6J("ngModel",o.form.faultName),e.xp6(5),e.hij(" ",e.lcZ(33,32,"Level"),": "),e.xp6(2),e.Q6J("ngModel",o.form.faultLevel),e.xp6(2),e.Q6J("ngForOf",e.lcZ(37,34,o.levels$)),e.xp6(6),e.hij(" ",e.lcZ(43,36,"Created By"),": "),e.xp6(2),e.Q6J("ngModel",o.form.raisedBy),e.xp6(3),e.hij(" ",e.lcZ(48,38,"Predefined remarks"),": "),e.xp6(2),e.Q6J("ngForOf",e.lcZ(50,40,o.remarks$)),e.xp6(6),e.hij(" ",e.lcZ(56,42,"Remark"),": "),e.xp6(2),e.Q6J("ngModel",o.form.remark),e.xp6(2),e.Q6J("ngModel",o.form.noteMessageFlag),e.xp6(1),e.Oqu(e.lcZ(61,44,"Create note message")),e.xp6(4),e.Oqu(e.lcZ(65,46,"Cancel")),e.xp6(3),e.Oqu(e.lcZ(68,48,"Submit"))}}let g=(()=>{class _{constructor(o,O,i,c,m,a,s){this.router=o,this.carParkService=O,this.vehicleService=i,this.codeTablesService=c,this.maintenanceService=m,this.authenticationService=a,this.translate=s,this.cancel=new e.vpe,this.submit=new e.vpe,this.form={carParkId:null,equipment:"",faultName:null,faultLevel:"",raisedBy:this.authenticationService.getCurrentUser().login,raisedTime:new Date,remark:"",noteMessageFlag:!0},this.carParkInput$=new d.xQ,this.vehicleInput$=new d.xQ}ngOnInit(){this.carParks$=this.carParkInput$.pipe((0,Z.O)(""),(0,P.b)(200),(0,z.x)(),(0,x.b)(()=>this.carParkLoading=!0),(0,D.w)(o=>this.carParkService.getSimpleList(o).pipe((0,B.U)(O=>o?O.filter(i=>-1!==i.name.toLowerCase().indexOf(o.toLowerCase())):O.slice(0,20)),(0,x.b)(()=>this.carParkLoading=!1))),(0,K.B)()),this.carParks$.pipe((0,y.q)(1)).subscribe(o=>{this.form.carParkId=this.form.carParkId||o[0]&&o[0].id}),this.remarks$=this.codeTablesService.filterModelByType(A.BcL.FaultRemark),this.equipments$=this.codeTablesService.filterModelByType(A.BcL.FaultEquipment),this.levels$=this.codeTablesService.filterModelByType(A.BcL.FaultLevel)}createFault(o){return o.valid&&this.submit.emit(this.form)}}return _.\u0275fac=function(o){return new(o||_)(e.Y36(Q.F0),e.Y36(t.x),e.Y36(N.f),e.Y36(T.I),e.Y36(b.N),e.Y36(L.$),e.Y36(v.sK))},_.\u0275cmp=e.Xpm({type:_,selectors:[["app-fault-dialog"]],inputs:{form:"form"},outputs:{cancel:"cancel",submit:"submit"},decls:7,vars:4,consts:[[1,"header"],[1,"m--font-bolder"],[1,"btn","btn-sm",3,"click"],[1,"la","la-times"],["class","body",4,"ngIf"],[1,"body"],[3,"ngSubmit"],["faultForm","ngForm"],[1,"form-group","m-form__group"],["for",""],[1,"m--font-danger"],["required","","nzPlaceHolder","Please Select","name","carParkId",2,"width","100%",3,"ngModel","nzLoading","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["required","","nzPlaceHolder","Please Select","name","equipment",2,"width","100%",3,"ngModel","ngModelChange"],["type","text","name","holiday","nz-input","","id","","required","",3,"ngModel","ngModelChange"],["required","","nzPlaceHolder","Please Select","name","faultLevel",2,"width","100%",3,"ngModel","ngModelChange"],["faultLevel","ngModel"],["disabled","","type","text","name","raisedBy","nz-input","","id","",3,"ngModel","ngModelChange"],["type","button","nz-button","","nzType","primary","nzGhost","","style","margin-bottom:6px;",3,"click",4,"ngFor","ngForOf"],["nz-input","","name","remarkText",3,"ngModel","ngModelChange"],[1,"input-group","m-input-group"],["nz-checkbox","","name","noteMsg",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-between","m--margin-top-30","footer-buttons"],["type","button","nz-button","","nzType","primary","nzGhost","",3,"click"],["type","submit","nz-button","","nzType","primary"],[3,"nzValue","nzLabel"],["type","button","nz-button","","nzType","primary","nzGhost","",2,"margin-bottom","6px",3,"click"]],template:function(o,O){1&o&&(e.TgZ(0,"div",0)(1,"span",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return O.cancel.emit()}),e._UZ(5,"i",3),e.qZA()(),e.YNc(6,h,69,50,"div",4)),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"Fault Details")),e.xp6(4),e.Q6J("ngIf",O.form))},dependencies:[U.sg,U.O5,I._Y,I.Fj,I.JJ,I.JL,I.Q7,I.On,I.F,W.Ip,W.Vq,F.Zp,J.ix,q.w,S.dQ,$.Ie,U.Ov,v.X$],styles:[".header[_ngcontent-%COMP%]{padding:15px;border-bottom:1px solid #e9ecef;justify-content:space-between;display:flex;align-items:center}.body[_ngcontent-%COMP%]{padding:15px}.body[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex-basis:40%}"]}),_})()},19654:(H,j,n)=>{n.d(j,{e:()=>m});var e=n(38014),A=n(79118),d=n(8929),Z=n(1059),P=n(80013),z=n(75778),x=n(2994),D=n(87545),B=n(24850),K=n(5646),y=n(74327),Q=n(52746),t=n(94650),N=n(4666),T=n(60097),b=n(36511),L=n(34793),v=n(69440),U=n(89383),I=n(71942),W=n(36895),F=n(24006),J=n(40269),q=n(38231),S=n(35635),$=n(47044),E=n(834),M=n(73325),R=n(29562);function l(a,s){if(1&a&&t._UZ(0,"nz-option",7),2&a){const p=s.$implicit;t.Q6J("nzValue",p.id)("nzLabel",p.name)}}function h(a,s){if(1&a&&t._UZ(0,"nz-option",7),2&a){const p=s.$implicit;t.Q6J("nzValue",p.name)("nzLabel",p.name)}}function g(a,s){if(1&a&&t._UZ(0,"nz-option",7),2&a){const p=s.$implicit;t.Q6J("nzValue",p.code)("nzLabel",p.name)}}function _(a,s){if(1&a&&t._UZ(0,"nz-option",7),2&a){const p=s.$implicit;t.Q6J("nzValue",p.code)("nzLabel",p.name)}}function C(a,s){if(1&a&&t._uU(0),2&a){const p=s.range;t.lnq(" ",p[0],"-",p[1]," of ",s.$implicit," items\n")}}function o(a,s){if(1&a&&(t.TgZ(0,"th"),t._uU(1),t.qZA()),2&a){const p=s.$implicit;t.xp6(1),t.Oqu(p.text)}}const O=function(a){return["/transactions",a,"update"]};function i(a,s){if(1&a&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.ALo(13,"async"),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"async"),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.ALo(21,"titlecase"),t.qZA(),t.TgZ(22,"td"),t._uU(23),t.ALo(24,"date"),t.qZA(),t.TgZ(25,"td")(26,"button",15),t._UZ(27,"i",16),t.qZA(),t.TgZ(28,"nz-dropdown-menu",null,17)(30,"ul",18)(31,"li",19),t._UZ(32,"i",20),t.TgZ(33,"span"),t._uU(34),t.ALo(35,"translate"),t.qZA()()()()()()),2&a){const p=s.$implicit,r=s.index,u=t.MAs(29),f=t.oxw();t.ekj("ant-table-row-odd",r%2==1),t.xp6(2),t.Oqu(r+1),t.xp6(2),t.Oqu(p.id),t.xp6(2),t.Oqu(null==p.carPark?null:p.carPark.code),t.xp6(2),t.Oqu(p.equipment),t.xp6(2),t.Oqu(p.faultName),t.xp6(2),t.Oqu(t.lcZ(13,16,f.getCreator(p.creator))),t.xp6(3),t.Oqu(p.remark),t.xp6(2),t.Oqu(t.lcZ(18,18,f.getFaultLevel(p.faultLevel))),t.xp6(3),t.Oqu(t.lcZ(21,20,p.status)),t.xp6(3),t.Oqu(t.xi3(24,22,p.raisedTime,"medium")),t.xp6(3),t.Q6J("nzDropdownMenu",u)("nzPlacement","topCenter"),t.xp6(5),t.Q6J("routerLink",t.VKq(27,O,p.id)),t.xp6(3),t.Oqu(t.lcZ(35,25,"Edit Transaction"))}}const c=[{text:"#",width:"60px",align:A.iW.Center},{text:"ID",width:"60px"},{text:"Car Park",width:"120px"},{text:"Equipment",width:"120px"},{text:"Fault Name",width:"120px"},{text:"Creator",width:"120px"},{text:"Remark",width:"120px"},{text:"Level",width:"120px"},{text:"Status",width:"120px"},{text:"Time Created",width:"120px"}];let m=(()=>{class a extends Q.t{constructor(p,r,u,f,Y,k,V){super(),this.transactionService=p,this.carParkService=r,this.codeTablesService=u,this.route=f,this.maintenanceService=Y,this.translate=k,this.vehicleService=V,this.tableHeaders=this.isOperator?c:[...c,{text:"Action",width:"80px"}],this.keyword="",this.dateRange=[],this.carParkInput$=new d.xQ,this.equipment="",this.level="",this.creator="",this.status="",this.keyword$=new d.xQ}ngOnInit(){this.reloadData(),this.carParks$=this.carParkInput$.pipe((0,Z.O)(""),(0,P.b)(200),(0,z.x)(),(0,x.b)(()=>this.carParkLoading=!0),(0,D.w)(r=>this.carParkService.getSimpleList(r).pipe((0,B.U)(u=>r?u.filter(f=>-1!==f.name.toLowerCase().indexOf(r.toLowerCase())):u.slice(0,20)),(0,x.b)(()=>this.carParkLoading=!1))));const p=this.tableHeaders.map(r=>r.text);this.translate.get(p).subscribe(r=>{this.tableHeaders.forEach(u=>{for(let f in r)r.hasOwnProperty(f)&&u.text===f&&(u.text=r[f])})}),this.equipments$=this.codeTablesService.filterModelByType(e.BcL.FaultEquipment),this.levels$=this.codeTablesService.filterModelByType(e.BcL.FaultLevel).pipe((0,K._)(1),(0,y.x)()),this.creators$=this.codeTablesService.filterModelByType(e.BcL.FaultCreator).pipe((0,K._)(1),(0,y.x)()),this.keyword$.debounceTime(500).subscribe(()=>{this.reloadData()})}get filterParams(){return{carPark:this.carParkId,equipment:this.equipment,level:this.level,creator:this.creator,keyword:this.keyword,status:this.status,sort:"createdDate,desc",from:this.dateRange&&this.dateRange.length?this.dateRange[0].toISOString():void 0,to:this.dateRange&&this.dateRange.length>1?this.dateRange[1].toISOString():void 0}}reloadData(){this.reloadDataService(this.maintenanceService,"filterHistoryFaults")}pageChanged(p){this.pagination=p,this.reloadData()}getFaultLevel(p){return this.levels$.pipe((0,B.U)(r=>{const u=r.find(f=>f.code===p);return u?u.name:""}))}getCreator(p){return this.creators$.pipe((0,B.U)(r=>{const u=r.find(f=>f.code===p);return u?u.name:""}))}get isOperator(){return this.vehicleService.isOperator()}}return a.\u0275fac=function(p){return new(p||a)(t.Y36(N.p),t.Y36(T.x),t.Y36(b.I),t.Y36(L.gz),t.Y36(v.N),t.Y36(U.sK),t.Y36(I.f))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-maintenance-fault-history"]],features:[t.qOj],decls:63,vars:56,consts:[[1,"form-group","m-form__group","m-portlet__filters"],[1,"m-portlet__filter"],[1,"col-form-label"],["nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","nzLoading","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel"],[1,"m-input-icon","m-input-icon--left"],["type","text","nz-input","","placeholder","",3,"ngModel","ngModelChange"],["rangeTemplate",""],[3,"nzData","nzFrontPagination","nzLoading","nzTotal","nzPageSize","nzPageIndex","nzShowSizeChanger","nzShowTotal","nzQueryParams"],["basicTable",""],[4,"ngFor","ngForOf"],[3,"ant-table-row-odd",4,"ngFor","ngForOf"],["nz-dropdown","","nzTrigger","click",1,"btn","btn-outline-primary","m-btn","m-btn--icon","m-btn--icon-only","m-btn--custom","m-btn--outline-2x","m-btn--pill","no-border",3,"nzDropdownMenu","nzPlacement"],[1,"la","la-ellipsis-h"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"routerLink"],[1,"la","la-edit",2,"margin-right","4px"]],template:function(p,r){if(1&p&&(t.TgZ(0,"div",0)(1,"div",1)(2,"label",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div")(6,"nz-select",3),t.NdJ("ngModelChange",function(f){return r.carParkId=f})("ngModelChange",function(){return r.reloadData()}),t.YNc(7,l,1,2,"nz-option",4),t.ALo(8,"async"),t.qZA()()(),t.TgZ(9,"div",1)(10,"label",2),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"div")(14,"nz-select",5),t.NdJ("ngModelChange",function(f){return r.equipment=f})("ngModelChange",function(){return r.reloadData()}),t.YNc(15,h,1,2,"nz-option",4),t.ALo(16,"async"),t.qZA()()(),t.TgZ(17,"div",1)(18,"label",2),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.TgZ(21,"div")(22,"nz-select",5),t.NdJ("ngModelChange",function(f){return r.level=f})("ngModelChange",function(){return r.reloadData()}),t.YNc(23,g,1,2,"nz-option",4),t.ALo(24,"async"),t.qZA()()(),t.TgZ(25,"div",1)(26,"label",2),t._uU(27),t.ALo(28,"translate"),t.qZA(),t.TgZ(29,"div")(30,"nz-select",5),t.NdJ("ngModelChange",function(f){return r.creator=f})("ngModelChange",function(){return r.reloadData()}),t.YNc(31,_,1,2,"nz-option",4),t.ALo(32,"async"),t.qZA()()(),t.TgZ(33,"div",1)(34,"label",2),t._uU(35),t.ALo(36,"translate"),t.qZA(),t.TgZ(37,"div")(38,"nz-range-picker",6),t.NdJ("ngModelChange",function(f){return r.dateRange=f})("ngModelChange",function(){return r.reloadData()}),t.qZA()()(),t.TgZ(39,"div",1)(40,"label",2),t._uU(41),t.ALo(42,"translate"),t.qZA(),t.TgZ(43,"div")(44,"nz-select",5),t.NdJ("ngModelChange",function(f){return r.status=f})("ngModelChange",function(){return r.reloadData()}),t._UZ(45,"nz-option",7),t.ALo(46,"translate"),t._UZ(47,"nz-option",7),t.ALo(48,"translate"),t.qZA()()(),t.TgZ(49,"div",1)(50,"label",2),t._uU(51," Remark / Fault Name: "),t.qZA(),t.TgZ(52,"div",8)(53,"input",9),t.NdJ("ngModelChange",function(f){return r.keyword=f})("ngModelChange",function(f){return r.keyword$.next(f)}),t.qZA()()()(),t.YNc(54,C,1,3,"ng-template",null,10,t.W1O),t.TgZ(56,"nz-table",11,12),t.NdJ("nzQueryParams",function(f){return r.onQueryParamsChange(f)}),t.TgZ(58,"thead")(59,"tr"),t.YNc(60,o,2,1,"th",13),t.qZA()(),t.TgZ(61,"tbody"),t.YNc(62,i,36,29,"tr",14),t.qZA()()),2&p){const u=t.MAs(55),f=t.MAs(57);t.xp6(3),t.hij(" ",t.lcZ(4,32,"Car Park"),": "),t.xp6(3),t.Q6J("ngModel",r.carParkId)("nzLoading",r.carParkLoading),t.xp6(1),t.Q6J("ngForOf",t.lcZ(8,34,r.carParks$)),t.xp6(4),t.hij(" ",t.lcZ(12,36,"Equipment"),": "),t.xp6(3),t.Q6J("ngModel",r.equipment),t.xp6(1),t.Q6J("ngForOf",t.lcZ(16,38,r.equipments$)),t.xp6(4),t.hij(" ",t.lcZ(20,40,"Level"),": "),t.xp6(3),t.Q6J("ngModel",r.level),t.xp6(1),t.Q6J("ngForOf",t.lcZ(24,42,r.levels$)),t.xp6(4),t.hij(" ",t.lcZ(28,44,"Creator"),": "),t.xp6(3),t.Q6J("ngModel",r.creator),t.xp6(1),t.Q6J("ngForOf",t.lcZ(32,46,r.creators$)),t.xp6(4),t.hij(" ",t.lcZ(36,48,"Time Range"),": "),t.xp6(3),t.Q6J("ngModel",r.dateRange),t.xp6(3),t.hij(" ",t.lcZ(42,50,"Status"),": "),t.xp6(3),t.Q6J("ngModel",r.status),t.xp6(1),t.Q6J("nzValue","resolved")("nzLabel",t.lcZ(46,52,"Resolved")),t.xp6(2),t.Q6J("nzValue","ignored")("nzLabel",t.lcZ(48,54,"Ignored")),t.xp6(6),t.Q6J("ngModel",r.keyword),t.xp6(3),t.Q6J("nzData",r.listData)("nzFrontPagination",!1)("nzLoading",r.loading)("nzTotal",r.pagination.totalCount)("nzPageSize",r.pagination.rowsPerPage)("nzPageIndex",r.pagination.page)("nzShowSizeChanger",!0)("nzShowTotal",u),t.xp6(4),t.Q6J("ngForOf",r.tableHeaders),t.xp6(2),t.Q6J("ngForOf",f.data)}},dependencies:[W.sg,F.Fj,F.JJ,F.On,J.N8,J.Uo,J._C,J.Om,J.p0,J.$Z,q.Ip,q.Vq,S.Zp,$.w,E.uw,E.wS,M.wO,M.r9,R.cm,R.RR,L.rH,W.Ov,W.rS,W.uU,U.X$],encapsulation:2}),a})()},798:(H,j,n)=>{n.d(j,{P:()=>i});var e=n(94650),A=n(38014),Z=(n(79118),n(21837)),P=n(8929),z=n(1059),x=n(80013),D=n(75778),B=n(2994),K=n(87545),y=n(24850),Q=n(72986),t=n(52746),N=n(4666),T=n(60097),b=n(36511),L=n(34793),v=n(89383),U=n(71942),I=n(36895),W=n(24006),F=n(40269),J=n(38231),q=n(35635),S=n(47044),$=n(834),E=n(14685),M=n(73325),R=n(29562),l=n(53033);function h(c,m){if(1&c&&e._UZ(0,"nz-option",16),2&c){const a=m.$implicit;e.Q6J("nzValue",a.id)("nzLabel",a.name)}}function g(c,m){if(1&c&&(e._UZ(0,"nz-option",16),e.ALo(1,"titlecase")),2&c){const a=m.$implicit;e.Q6J("nzValue",a.value)("nzLabel",e.lcZ(1,2,a.value))}}function _(c,m){if(1&c&&e._uU(0),2&c){const a=m.range;e.lnq(" ",a[0],"-",a[1]," of ",m.$implicit," items\n")}}function C(c,m){if(1&c&&(e.TgZ(0,"th",17),e._uU(1),e.qZA()),2&c){const a=m.$implicit;e.Q6J("nzWidth",m.first?"60px":""),e.xp6(1),e.Oqu(a.text)}}function o(c,m){if(1&c){const a=e.EpF();e.ynx(0),e.TgZ(1,"tr")(2,"td",18),e.NdJ("nzExpandChange",function(p){const u=e.CHM(a).$implicit,f=e.oxw();return e.KtG(f.onExpandChange(u.id,p))}),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"span"),e._UZ(7,"img",19),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"td"),e._uU(15),e.qZA(),e.TgZ(16,"td"),e._uU(17),e.ALo(18,"date"),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.ALo(23,"cent2Dollar"),e.qZA(),e.TgZ(24,"td"),e._UZ(25,"span",20),e._uU(26," \xa0 "),e.TgZ(27,"span",21),e._uU(28),e.ALo(29,"titlecase"),e.qZA()(),e.TgZ(30,"td"),e._uU(31),e.qZA(),e.TgZ(32,"td")(33,"button",22),e._UZ(34,"i",23),e.qZA(),e.TgZ(35,"nz-dropdown-menu",null,24)(37,"ul",25)(38,"li",26),e.NdJ("click",function(){const r=e.CHM(a).$implicit,u=e.oxw();return e.KtG(u.closeTransactions.emit(r))}),e._UZ(39,"i",27),e.TgZ(40,"span"),e._uU(41,"Close Transaction"),e.qZA()(),e.TgZ(42,"li",26),e.NdJ("click",function(){const r=e.CHM(a).$implicit,u=e.oxw();return e.KtG(u.endTransactions.emit(r))}),e._UZ(43,"i",28),e.TgZ(44,"span"),e._uU(45,"End Transaction"),e.qZA()()()()()(),e.TgZ(46,"tr",29)(47,"nz-table",30)(48,"thead")(49,"tr")(50,"th"),e._uU(51),e.ALo(52,"translate"),e.qZA(),e.TgZ(53,"th"),e._uU(54),e.ALo(55,"translate"),e.qZA(),e.TgZ(56,"th"),e._uU(57),e.ALo(58,"translate"),e.qZA()()(),e.TgZ(59,"tbody")(60,"tr")(61,"td"),e._uU(62),e.ALo(63,"excurrency"),e.ALo(64,"cent2Dollar"),e.qZA(),e.TgZ(65,"td"),e._uU(66),e.ALo(67,"excurrency"),e.ALo(68,"cent2Dollar"),e.qZA(),e.TgZ(69,"td"),e._uU(70),e.ALo(71,"excurrency"),e.ALo(72,"cent2Dollar"),e.qZA()()()()(),e.BQk()}if(2&c){const a=m.$implicit,s=m.index,p=e.MAs(36),r=e.oxw();e.xp6(1),e.ekj("ant-table-row-odd",s%2==1),e.xp6(1),e.Q6J("nzExpand",r.expandSet.has(a.id)),e.xp6(2),e.Oqu(a.id),e.xp6(3),e.Q6J("src",r.vehicleIcon(null==a.vehicle?null:a.vehicle.vehicleType),e.LSH),e.xp6(1),e.hij(" ",null==a.vehicle?null:a.vehicle.vehicleNumber," "),e.xp6(2),e.Oqu(a.entrySessionId),e.xp6(2),e.Oqu(e.xi3(13,23,a.startTime,"medium")),e.xp6(3),e.Oqu(a.exitSessionId),e.xp6(2),e.Oqu(e.xi3(18,26,a.endTime,"medium")),e.xp6(3),e.Oqu(a.duration||0),e.xp6(2),e.Oqu(e.lcZ(23,29,null==a.chargeSummary||null==a.chargeSummary.total?null:a.chargeSummary.total.amount)),e.xp6(6),e.hij(" ",e.lcZ(29,31,a.type)," "),e.xp6(3),e.Oqu(a.status),e.xp6(2),e.Q6J("nzDropdownMenu",p)("nzPlacement","topCenter"),e.xp6(13),e.Q6J("nzExpand",r.expandSet.has(a.id)),e.xp6(5),e.Oqu(e.lcZ(52,33,"Calculation Cost")),e.xp6(3),e.Oqu(e.lcZ(55,35,"Promotions")),e.xp6(3),e.Oqu(e.lcZ(58,37,"Amount to Pay")),e.xp6(5),e.Oqu(e.xi3(63,39,e.lcZ(64,42,(null==a.chargeSummary||null==a.chargeSummary.calculation?null:a.chargeSummary.calculation.amount)||0),null==a.chargeSummary||null==a.chargeSummary.calculation?null:a.chargeSummary.calculation.currency)),e.xp6(4),e.Oqu(e.xi3(67,44,e.lcZ(68,47,(null==a.chargeSummary||null==a.chargeSummary.promotion?null:a.chargeSummary.promotion.amount)||0),null==a.chargeSummary||null==a.chargeSummary.promotion?null:a.chargeSummary.promotion.currency)),e.xp6(4),e.Oqu(e.xi3(71,49,e.lcZ(72,52,(null==a.chargeSummary||null==a.chargeSummary.total?null:a.chargeSummary.total.amount)||0),null==a.chargeSummary||null==a.chargeSummary.total?null:a.chargeSummary.total.currency))}}const O=[{text:"",width:"60px"},{text:"ID",width:"60px"},{text:"Vehicle",width:"120px"},{text:"Entry ID",width:"120px"},{text:"Entry Time",width:"120px"},{text:"Exit ID",width:"200px"},{text:"Exit Time",width:"120px"},{text:"Duration",width:"120px"},{text:"Paid Amount",width:"120px"},{text:"Type",width:"120px"},{text:"Status",width:"120px"},{text:"Action",width:"80px"}];let i=(()=>{class c extends t.t{constructor(a,s,p,r,u,f){super(),this.transactionService=a,this.carParkService=s,this.codeTablesService=p,this.route=r,this.translate=u,this.vehicleService=f,this.tableHeaders=O,this.verifyVehicle=new e.vpe,this.endTransactions=new e.vpe,this.closeTransactions=new e.vpe,this.vehicleIcon=A.mts,this.vehiclePlateNo="",this.statusOptions=A.EKt,this.loading=!1,this.vehicleType="",this.abnormalType="",this.keyword="",this.keyword$=new P.xQ,this.carParkInput$=new P.xQ,this.timeChanged$=new P.xQ,this.expandSet=new Set}ngOnInit(){this.carParks$=this.carParkInput$.pipe((0,z.O)(""),(0,x.b)(200),(0,D.x)(),(0,B.b)(()=>this.carParkLoading=!0),(0,K.w)(s=>this.carParkService.getSimpleList(s).pipe((0,y.U)(p=>s?p.filter(r=>-1!==r.name.toLowerCase().indexOf(s.toLowerCase())):p.slice(0,20)),(0,B.b)(()=>this.carParkLoading=!1)))),this.keyword$.pipe((0,x.b)(400)).subscribe(()=>{this.reloadData()}),this.timeChanged$.pipe((0,x.b)(500)).subscribe(()=>{this.reloadData()}),this.vehicleTypes$=this.codeTablesService.filterModelByType(A.BcL.VehicleType).pipe((0,Q.q)(1)),this.reloadData();const a=this.tableHeaders.map(s=>s.text);this.translate.get(a).subscribe(s=>{this.tableHeaders.forEach(p=>{for(let r in s)s.hasOwnProperty(r)&&p.text===r&&(p.text=s[r])})})}get filterParams(){return{carPark:this.carParkId,keyword:this.keyword,vehicleType:this.vehicleType,abnormalType:this.abnormalType,sort:"createdDate,desc",date:this.date&&Z.ou.fromJSDate(this.date).toFormat("yyyy-LL-dd"),timeFrom:this.fromTime&&Z.ou.fromJSDate(this.fromTime).toISOTime(),timeTo:this.endTime&&Z.ou.fromJSDate(this.endTime).toISOTime()}}reloadData(){this.reloadDataService(this.transactionService,"fetchAbnormalTransactions")}pageChanged(a){this.pagination=a,this.reloadData()}displayTime(a){return a&&Z.ou.fromJSDate(a).toLocaleString(Z.ou.TIME_24_SIMPLE)}onStartTimeChanged(a){this.endTime&&Z.ou.fromJSDate(a).diff(Z.ou.fromJSDate(this.endTime)).as("minute")>0&&(this.endTime=a),this.timeChanged$.next(null)}onEndTimeChanged(a){this.endTime&&Z.ou.fromJSDate(this.fromTime).diff(Z.ou.fromJSDate(a)).as("minute")>0&&(this.fromTime=a),this.timeChanged$.next(null)}get isOperator(){return this.vehicleService.isOperator()}onExpandChange(a,s){s?this.expandSet.add(a):this.expandSet.delete(a)}}return c.\u0275fac=function(a){return new(a||c)(e.Y36(N.p),e.Y36(T.x),e.Y36(b.I),e.Y36(L.gz),e.Y36(v.sK),e.Y36(U.f))},c.\u0275cmp=e.Xpm({type:c,selectors:[["app-maintenance-transactions"]],outputs:{verifyVehicle:"verifyVehicle",endTransactions:"endTransactions",closeTransactions:"closeTransactions"},features:[e.qOj],decls:59,vars:48,consts:[[1,"form-group","m-form__group","m-portlet__filters"],[1,"m-portlet__filter"],[1,"col-form-label"],["nzPlaceHolder","Please Select",2,"width","100%",3,"ngModel","nzLoading","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],["nzPlaceHolder","Please Select",2,"width","160px",3,"ngModel","ngModelChange"],["nzValue","NoCarPlateNo",3,"nzLabel"],["nzValue","ExitWithoutEntry",3,"nzLabel"],[1,"m-input-icon","m-input-icon--left"],["type","text","nz-input","","placeholder","",3,"ngModel","ngModelChange"],["rangeTemplate",""],[3,"nzData","nzFrontPagination","nzLoading","nzTotal","nzPageSize","nzPageIndex","nzShowSizeChanger","nzShowTotal"],["basicTable",""],[3,"nzWidth",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"],[3,"nzWidth"],[3,"nzExpand","nzExpandChange"],["alt","",3,"src"],[1,"m-badge","m-badge--info","m-badge--dot"],[1,"m--font-bold","m--font-info"],["nz-dropdown","","nzTrigger","click",1,"btn","btn-outline-primary","m-btn","m-btn--icon","m-btn--icon-only","m-btn--custom","m-btn--outline-2x","m-btn--pill","no-border",3,"nzDropdownMenu","nzPlacement"],[1,"la","la-ellipsis-h"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"],[1,"la","la-close",2,"margin-right","4px"],[1,"la","la-check",2,"margin-right","4px"],[3,"nzExpand"],["nzTemplateMode",""]],template:function(a,s){if(1&a&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div")(6,"nz-select",3),e.NdJ("ngModelChange",function(r){return s.carParkId=r})("ngModelChange",function(){return s.reloadData()}),e.YNc(7,h,1,2,"nz-option",4),e.ALo(8,"async"),e.qZA()()(),e.TgZ(9,"div",1)(10,"label",2),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"div")(14,"nz-date-picker",5),e.NdJ("ngModelChange",function(r){return s.date=r})("ngModelChange",function(){return s.reloadData()}),e.qZA()()(),e.TgZ(15,"div",1)(16,"label",2),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"div")(20,"nz-time-picker",5),e.NdJ("ngModelChange",function(r){return s.fromTime=r})("ngModelChange",function(r){return s.onStartTimeChanged(r)}),e.qZA()()(),e.TgZ(21,"div",1)(22,"label",2),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"div")(26,"nz-time-picker",5),e.NdJ("ngModelChange",function(r){return s.endTime=r})("ngModelChange",function(r){return s.onEndTimeChanged(r)}),e.qZA()()(),e.TgZ(27,"div",1)(28,"label",2),e._uU(29),e.ALo(30,"translate"),e.qZA(),e.TgZ(31,"div")(32,"nz-select",6),e.NdJ("ngModelChange",function(r){return s.vehicleType=r})("ngModelChange",function(){return s.reloadData()}),e.YNc(33,g,2,4,"nz-option",4),e.ALo(34,"async"),e.qZA()()(),e.TgZ(35,"div",1)(36,"label",2),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.TgZ(39,"div")(40,"nz-select",6),e.NdJ("ngModelChange",function(r){return s.abnormalType=r})("ngModelChange",function(){return s.reloadData()}),e._UZ(41,"nz-option",7),e.ALo(42,"translate"),e._UZ(43,"nz-option",8),e.ALo(44,"translate"),e.qZA()()(),e.TgZ(45,"div",1)(46,"label",2),e._uU(47," Vehicle No. / Session Id: "),e.qZA(),e.TgZ(48,"div",9)(49,"input",10),e.NdJ("ngModelChange",function(r){return s.keyword=r})("ngModelChange",function(r){return s.keyword$.next(r)}),e.qZA()()()(),e.YNc(50,_,1,3,"ng-template",null,11,e.W1O),e.TgZ(52,"nz-table",12,13)(54,"thead")(55,"tr"),e.YNc(56,C,2,2,"th",14),e.qZA()(),e.TgZ(57,"tbody"),e.YNc(58,o,73,54,"ng-container",15),e.qZA()()),2&a){const p=e.MAs(51),r=e.MAs(53);e.xp6(3),e.hij(" ",e.lcZ(4,28,"Car Park"),": "),e.xp6(3),e.Q6J("ngModel",s.carParkId)("nzLoading",s.carParkLoading),e.xp6(1),e.Q6J("ngForOf",e.lcZ(8,30,s.carParks$)),e.xp6(4),e.hij(" ",e.lcZ(12,32,"Date"),": "),e.xp6(3),e.Q6J("ngModel",s.date),e.xp6(3),e.hij(" ",e.lcZ(18,34,"From"),": "),e.xp6(3),e.Q6J("ngModel",s.fromTime),e.xp6(3),e.hij(" ",e.lcZ(24,36,"To"),": "),e.xp6(3),e.Q6J("ngModel",s.endTime),e.xp6(3),e.hij(" ",e.lcZ(30,38,"Vehicle Type"),": "),e.xp6(3),e.Q6J("ngModel",s.vehicleType),e.xp6(1),e.Q6J("ngForOf",e.lcZ(34,40,s.vehicleTypes$)),e.xp6(4),e.hij(" ",e.lcZ(38,42,"Abnormal Type"),": "),e.xp6(3),e.Q6J("ngModel",s.abnormalType),e.xp6(1),e.Q6J("nzLabel",e.lcZ(42,44,"NoCarPlateNo")),e.xp6(2),e.Q6J("nzLabel",e.lcZ(44,46,"ExitWithoutEntry")),e.xp6(6),e.Q6J("ngModel",s.keyword),e.xp6(3),e.Q6J("nzData",s.listData)("nzFrontPagination",!1)("nzLoading",s.loading)("nzTotal",s.pagination.totalCount)("nzPageSize",s.pagination.rowsPerPage)("nzPageIndex",s.pagination.page)("nzShowSizeChanger",!0)("nzShowTotal",p),e.xp6(4),e.Q6J("ngForOf",s.tableHeaders),e.xp6(2),e.Q6J("ngForOf",r.data)}},dependencies:[I.sg,W.Fj,W.JJ,W.On,F.N8,F.Uo,F._C,F.h7,F.Om,F.p0,F.$Z,F.d3,F.Vk,J.Ip,J.Vq,q.Zp,S.w,$.uw,E.m4,M.wO,M.r9,R.cm,R.RR,I.Ov,I.rS,I.uU,l.Z,l.e,v.X$],encapsulation:2}),c})()},16233:(H,j,n)=>{n.d(j,{x:()=>E});var e=n(94650),A=n(8929),d=n(26582),Z=n(40943),P=n(72986),z=n(1059),x=n(80013),D=n(75778),B=n(2994),K=n(87545),y=n(24850),Q=n(34793),t=n(60097),N=n(4666),T=n(76284),b=n(20388),L=n(36895),v=n(24006),U=n(11917),I=n(88796),W=n(89383);const F=["faultForm"];function J(M,R){if(1&M&&e._UZ(0,"img",19),2&M){const l=e.oxw(2);e.Q6J("src",l.entryImage,e.LSH)}}function q(M,R){if(1&M&&e._UZ(0,"img",19),2&M){const l=e.oxw(2);e.Q6J("src",l.exitImage,e.LSH)}}function S(M,R){if(1&M){const l=e.EpF();e.TgZ(0,"div",2)(1,"div",3)(2,"form",4,5),e.NdJ("ngSubmit",function(g){e.CHM(l);const _=e.oxw(),C=e.MAs(2);return e.KtG(_.submitVerification(g,C))}),e.TgZ(4,"div",6)(5,"label",7)(6,"span",8),e._uU(7,"*"),e.qZA(),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"ng-select",9),e.NdJ("ngModelChange",function(g){e.CHM(l);const _=e.oxw();return e.KtG(_.transaction.carParkId=g)}),e.ALo(11,"async"),e.qZA()(),e.TgZ(12,"div",6)(13,"label",7)(14,"span",8),e._uU(15,"*"),e.qZA(),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"input",10),e.NdJ("ngModelChange",function(g){e.CHM(l);const _=e.oxw();return e.KtG(_.transaction.carPlateNo=g)}),e.qZA()(),e.TgZ(19,"div",6)(20,"label",7)(21,"span",8),e._uU(22,"*"),e.qZA(),e._uU(23),e.ALo(24,"translate"),e.qZA(),e._UZ(25,"input",11),e.qZA(),e.TgZ(26,"div",6)(27,"label",7)(28,"span",8),e._uU(29,"*"),e.qZA(),e._uU(30),e.ALo(31,"translate"),e.qZA(),e._UZ(32,"input",12),e.ALo(33,"date"),e.qZA(),e.TgZ(34,"div",6)(35,"label",7)(36,"span",8),e._uU(37,"*"),e.qZA(),e._uU(38),e.ALo(39,"translate"),e.qZA(),e._UZ(40,"input",13),e.qZA(),e.TgZ(41,"div",6)(42,"label",7)(43,"span",8),e._uU(44,"*"),e.qZA(),e._uU(45),e.ALo(46,"translate"),e.qZA(),e._UZ(47,"input",14),e.ALo(48,"date"),e.qZA(),e.TgZ(49,"div",15)(50,"button",16),e.NdJ("click",function(){e.CHM(l);const g=e.oxw();return e.KtG(g.cancel.emit())}),e._uU(51),e.ALo(52,"translate"),e.qZA(),e.TgZ(53,"button",17),e._uU(54),e.ALo(55,"translate"),e.qZA()()()(),e.TgZ(56,"div",3),e.YNc(57,J,1,1,"img",18),e.YNc(58,q,1,1,"img",18),e.qZA()()}if(2&M){const l=e.oxw();e.xp6(8),e.hij(" ",e.lcZ(9,19,"Car Park"),": "),e.xp6(2),e.Q6J("items",e.lcZ(11,21,l.carParks$))("ngModel",l.transaction.carParkId)("typeahead",l.carParkInput$)("loading",l.carParkLoading),e.xp6(6),e.hij(" ",e.lcZ(17,23,"Vehicle"),": "),e.xp6(2),e.Q6J("ngModel",l.transaction.carPlateNo),e.xp6(5),e.hij(" ",e.lcZ(24,25,"Entry ID"),": "),e.xp6(2),e.Q6J("value",l.transaction.entrySessionId),e.xp6(5),e.hij(" ",e.lcZ(31,27,"Entry Time"),": "),e.xp6(2),e.Q6J("value",e.xi3(33,29,l.transaction.entryDateTime,"medium")),e.xp6(6),e.hij(" ",e.lcZ(39,32,"Exit ID"),": "),e.xp6(2),e.Q6J("value",l.transaction.exitSessionId),e.xp6(5),e.hij(" ",e.lcZ(46,34,"Exit Time"),": "),e.xp6(2),e.Q6J("value",e.xi3(48,36,l.transaction.exitDateTime,"medium")),e.xp6(4),e.Oqu(e.lcZ(52,39,"Cancel")),e.xp6(3),e.Oqu(e.lcZ(55,41,"Submit")),e.xp6(3),e.Q6J("ngIf",l.entryImage),e.xp6(1),e.Q6J("ngIf",l.exitImage)}}function $(M,R){if(1&M){const l=e.EpF();e.TgZ(0,"confirm-modal",20),e.NdJ("cancel",function(){e.CHM(l);const g=e.oxw();return e.KtG(g.bsModalRef.hide())})("submit",function(){e.CHM(l);const g=e.oxw();return e.KtG(g.onSolve(g.faultForm))}),e.qZA()}if(2&M){const l=e.oxw();e.Q6J("options",l.verificationConfirmOpts)}}let E=(()=>{class M{constructor(l,h,g,_,C,o){this.router=l,this.carParkService=h,this.transactionService=g,this.assetsService=_,this.modalService=C,this.bsModalRef=o,this.cancel=new e.vpe,this.submit=new e.vpe,this.carParkInput$=new A.xQ,this.verificationConfirmOpts={title:"Are you sure it has verified?",cancelText:"Cancel",submitText:"Confirm"}}ngOnInit(){if(!this.transactionId)return setTimeout(()=>this.cancel.emit(),200);this.transactionService.fetchAbnormalTransaction(this.transactionId).subscribe(l=>{this.transaction=l,l.entrySessionId&&this.assetsService.requestSessionImage(l.carParkId,l.entrySessionId).subscribe(()=>{this.assetsService.getSessionImage(l.entrySessionId).pipe((0,d.a)(h=>h.pipe((0,Z.g)(1e3),(0,P.q)(5)))).subscribe(h=>{this.entryImage=h})}),l.exitSessionId&&this.assetsService.requestSessionImage(l.carParkId,l.exitSessionId).subscribe(()=>{this.assetsService.getSessionImage(l.exitSessionId).pipe((0,d.a)(h=>h.pipe((0,Z.g)(1e3),(0,P.q)(5)))).subscribe(h=>{this.exitImage=h})})}),this.carParks$=this.carParkInput$.pipe((0,z.O)(""),(0,x.b)(200),(0,D.x)(),(0,B.b)(()=>this.carParkLoading=!0),(0,K.w)(l=>this.carParkService.getSimpleList(l).pipe((0,y.U)(h=>l?h.filter(g=>-1!==g.name.toLowerCase().indexOf(l.toLowerCase())):h.slice(0,20)),(0,B.b)(()=>this.carParkLoading=!1))))}submitVerification(l,h){l.stopPropagation(),this.bsModalRef=this.modalService.show(h,{class:"modal-dialog-centered"})}onSolve(l){l.valid&&this.submit.emit(this.transaction)}}return M.\u0275fac=function(l){return new(l||M)(e.Y36(Q.F0),e.Y36(t.x),e.Y36(N.p),e.Y36(T.z),e.Y36(b.tT),e.Y36(b.UZ))},M.\u0275cmp=e.Xpm({type:M,selectors:[["app-maintenance-vehicle-verification"]],viewQuery:function(l,h){if(1&l&&e.Gf(F,5),2&l){let g;e.iGM(g=e.CRH())&&(h.faultForm=g.first)}},inputs:{transactionId:"transactionId"},outputs:{cancel:"cancel",submit:"submit"},decls:3,vars:1,consts:[["class","row",4,"ngIf"],["verificationModal",""],[1,"row"],[1,"col-6"],[3,"ngSubmit"],["faultForm","ngForm"],[1,"form-group","m-form__group"],["for",""],[1,"m--font-danger"],["bindLabel","name","bindValue","id","name","carParkId","dropdownPosition","bottom","required","",3,"items","ngModel","typeahead","loading","ngModelChange"],["type","text","name","entryId","id","",1,"form-control","m-input","m-input--square",3,"ngModel","ngModelChange"],["readonly","","type","text","name","entryId","id","",1,"form-control","m-input","m-input--square",3,"value"],["readonly","","type","text","name","entryTime","id","",1,"form-control","m-input","m-input--square",3,"value"],["readonly","","type","text","name","exitId","id","",1,"form-control","m-input","m-input--square",3,"value"],["readonly","","type","text","name","exitTime","id","",1,"form-control","m-input","m-input--square",3,"value"],[1,"d-flex","justify-content-between","m--margin-top-30","footer-buttons"],["type","button",1,"btn","btn-outline-main","btn-sm",3,"click"],["type","submit",1,"btn","btn-main","btn-sm"],["width","90%",3,"src",4,"ngIf"],["width","90%",3,"src"],[3,"options","cancel","submit"]],template:function(l,h){1&l&&(e.YNc(0,S,59,43,"div",0),e.YNc(1,$,1,1,"ng-template",null,1,e.W1O)),2&l&&e.Q6J("ngIf",h.transaction)},dependencies:[L.O5,v._Y,v.Fj,v.JJ,v.JL,v.Q7,v.On,v.F,U.X,I.w9,L.Ov,L.uU,W.X$],encapsulation:2}),M})()},46367:(H,j,n)=>{n.d(j,{P:()=>q});var e=n(94650),A=n(38014),d=n(8929),Z=n(1059),P=n(80013),z=n(75778),x=n(2994),D=n(87545),B=n(24850),K=n(88117),y=n(72986),Q=n(34793),t=n(60097),N=n(71942),T=n(36511),b=n(69440),L=n(89383),v=n(36895),U=n(24006),I=n(88796);function W(S,$){if(1&S&&(e.TgZ(0,"option",21),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&S){const E=$.$implicit;e.Q6J("value",E.code),e.xp6(1),e.Oqu(e.lcZ(2,2,E.value))}}function F(S,$){1&S&&(e.TgZ(0,"div",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&S&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Field is required.")," "))}function J(S,$){if(1&S&&(e.TgZ(0,"div",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&S){const E=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,E.vehicleNoMessage)," ")}}let q=(()=>{class S{constructor(E,M,R,l,h,g){this.router=E,this.carParkService=M,this.vehicleService=R,this.codeTablesService=l,this.maintenanceService=h,this.translate=g,this.submit=new e.vpe,this.cancel=new e.vpe,this.form={carParkId:null,remark:null,vehicleNumber:null,vehicleType:null},this.carParkInput$=new d.xQ,this.vehicleInput$=new d.xQ,this.vehicleNoMessage=A.vwt.VehicleNo}ngOnInit(){this.carParks$=this.carParkInput$.pipe((0,Z.O)(""),(0,P.b)(200),(0,z.x)(),(0,x.b)(()=>this.carParkLoading=!0),(0,D.w)(E=>this.carParkService.getSimpleList(E).pipe((0,B.U)(M=>E?M.filter(R=>-1!==R.name.toLowerCase().indexOf(E.toLowerCase())):M.slice(0,20)),(0,x.b)(()=>this.carParkLoading=!1))),(0,K.B)()),this.carParks$.pipe((0,y.q)(1)).subscribe(E=>{this.form.carParkId=this.form.carParkId||E[0]&&E[0].id}),this.vehicleTypes$=this.codeTablesService.filterModelByType(A.BcL.VehicleType).map(E=>(this.form.vehicleType=this.form.vehicleType||E[0]&&E[0].code,E))}create(E){return E.valid&&this.submit.emit(this.form)}}return S.\u0275fac=function(E){return new(E||S)(e.Y36(Q.F0),e.Y36(t.x),e.Y36(N.f),e.Y36(T.I),e.Y36(b.N),e.Y36(L.sK))},S.\u0275cmp=e.Xpm({type:S,selectors:[["app-enforcement-create"]],outputs:{submit:"submit",cancel:"cancel"},decls:56,vars:38,consts:[[1,"header"],[1,"m--font-bolder"],[1,"btn","btn-sm",3,"click"],[1,"la","la-times"],[1,"body"],[3,"ngSubmit"],["enforcementForm","ngForm"],[1,"form-group","m-form__group"],[1,"col-form-label"],[1,"m--font-danger"],["bindLabel","name","bindValue","id","name","carParkId","dropdownPosition","bottom",3,"items","ngModel","typeahead","loading","ngModelChange"],["name","vehicleType",1,"form-control","m-input",3,"ngModel","ngModelChange"],["vehicleType","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","form-control-feedback",4,"ngIf"],["type","text","maxlength","8","pattern","^[A-Z0-9]+$","name","vehicleNumber",1,"form-control","m-input",3,"ngModel","ngModelChange"],["vehicleNumber","ngModel"],["name","remark",1,"form-control","m-input",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-between","m--margin-top-30","footer-buttons"],["type","button",1,"btn","btn-outline-main","btn-sm",3,"click"],["type","submit",1,"btn","btn-main","btn-sm"],[3,"value"],[1,"form-control-feedback"]],template:function(E,M){if(1&E){const R=e.EpF();e.TgZ(0,"div",0)(1,"span",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return M.cancel.emit()}),e._UZ(5,"i",3),e.qZA()(),e.TgZ(6,"div",4)(7,"form",5,6),e.NdJ("ngSubmit",function(h){e.CHM(R);const g=e.MAs(8);return h.stopPropagation(),e.KtG(M.create(g))}),e.TgZ(9,"div",7)(10,"label",8)(11,"span",9),e._uU(12,"*"),e.qZA(),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"div")(16,"ng-select",10),e.NdJ("ngModelChange",function(h){return M.form.carParkId=h}),e.ALo(17,"async"),e.qZA()()(),e.TgZ(18,"div",7)(19,"label",8)(20,"span",9),e._uU(21,"*"),e.qZA(),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"div")(25,"select",11,12),e.NdJ("ngModelChange",function(h){return M.form.vehicleType=h}),e.TgZ(27,"option"),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.YNc(30,W,3,4,"option",13),e.ALo(31,"async"),e.qZA(),e.YNc(32,F,3,3,"div",14),e.qZA()(),e.TgZ(33,"div",7)(34,"label",8)(35,"span",9),e._uU(36,"*"),e.qZA(),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.TgZ(39,"div")(40,"input",15,16),e.NdJ("ngModelChange",function(h){return M.form.vehicleNumber=h}),e.qZA(),e.YNc(42,J,3,3,"div",14),e.qZA()(),e.TgZ(43,"div",7)(44,"label",8),e._uU(45),e.ALo(46,"translate"),e.qZA(),e.TgZ(47,"div")(48,"textarea",17),e.NdJ("ngModelChange",function(h){return M.form.remark=h}),e.qZA()()(),e.TgZ(49,"div",18)(50,"button",19),e.NdJ("click",function(){return M.cancel.emit()}),e._uU(51),e.ALo(52,"translate"),e.qZA(),e.TgZ(53,"button",20),e._uU(54),e.ALo(55,"translate"),e.qZA()()()()}if(2&E){const R=e.MAs(26),l=e.MAs(41);e.xp6(2),e.Oqu(e.lcZ(3,18,"Enforcement")),e.xp6(11),e.hij(" ",e.lcZ(14,20,"Car Park"),": "),e.xp6(3),e.Q6J("items",e.lcZ(17,22,M.carParks$))("ngModel",M.form.carParkId)("typeahead",M.carParkInput$)("loading",M.carParkLoading),e.xp6(6),e.hij(" ",e.lcZ(23,24,"Vehicle Type"),": "),e.xp6(3),e.Q6J("ngModel",M.form.vehicleType),e.xp6(3),e.Oqu(e.lcZ(29,26,"Select")),e.xp6(2),e.Q6J("ngForOf",e.lcZ(31,28,M.vehicleTypes$)),e.xp6(2),e.Q6J("ngIf",R.invalid&&(R.dirty||R.touched)),e.xp6(5),e.hij(" ",e.lcZ(38,30,"Vehicle No"),": "),e.xp6(3),e.Q6J("ngModel",M.form.vehicleNumber),e.xp6(2),e.Q6J("ngIf",l.invalid&&(l.dirty||l.touched)),e.xp6(3),e.hij(" ",e.lcZ(46,32,"Remark"),": "),e.xp6(3),e.Q6J("ngModel",M.form.remark),e.xp6(3),e.Oqu(e.lcZ(52,34,"Cancel")),e.xp6(3),e.Oqu(e.lcZ(55,36,"Submit"))}},dependencies:[v.sg,v.O5,U._Y,U.YN,U.Kr,U.Fj,U.EJ,U.JJ,U.JL,U.nD,U.c5,U.On,U.F,I.w9,v.Ov,v.rS,L.X$],styles:[".header[_ngcontent-%COMP%]{padding:15px;border-bottom:1px solid #e9ecef;justify-content:space-between;display:flex;align-items:center}.body[_ngcontent-%COMP%]{padding:15px}.body[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]{margin:10px 0}.body[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;color:#a8aec4}.body[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{color:#575962}.body[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex-basis:40%}"]}),S})()},46442:(H,j,n)=>{n.d(j,{s:()=>L});var e=n(36895),A=n(24006),d=n(372),Z=n(60097),P=n(36511),z=n(69440),x=n(71942),D=n(30329),B=n(21532),K=n(88796),y=n(56776),Q=n(80529),t=n(89383),N=n(19832),T=n(94650);function b(v){return new N.w(v,"../assets/i18n/",".json")}let L=(()=>{class v{}return v.\u0275fac=function(I){return new(I||v)},v.\u0275mod=T.oAB({type:v}),v.\u0275inj=T.cJS({providers:[z.N,P.I,Z.x,x.f],imports:[e.ez,B.x,D.D,A.u5,d.kn,y.Db,K.A0,t.aw.forChild({loader:{provide:t.Zw,useFactory:b,deps:[Q.eN]}})]}),v})()},37713:(H,j,n)=>{n.d(j,{R:()=>R});var e=n(94650),A=n(38014),d=n(20421),Z=n(79118),P=n(28555),z=n(8929),x=n(1059),D=n(80013),B=n(75778),K=n(2994),y=n(87545),Q=n(24850),t=n(17489),b=(n(19612),n(34793)),L=n(69440),v=n(60097),U=n(36511),I=n(89383),W=n(36895),F=n(40269),J=n(24006),q=n(71198),S=n(87501),$=n(88796);function E(l,h){if(1&l&&(e.TgZ(0,"option",20),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&l){const g=h.$implicit;e.Q6J("value",g.code),e.xp6(1),e.hij(" ",e.lcZ(2,2,g.value)," ")}}function M(l,h){if(1&l&&(e.TgZ(0,"td",21)(1,"span"),e._uU(2),e.qZA()(),e.TgZ(3,"td",22)(4,"span"),e._uU(5),e.qZA()(),e.TgZ(6,"td",22)(7,"span")(8,"span"),e._UZ(9,"img",23),e.qZA(),e.TgZ(10,"span"),e._uU(11),e.qZA()()(),e.TgZ(12,"td",22)(13,"span"),e._uU(14),e.qZA()(),e.TgZ(15,"td",22)(16,"span"),e._uU(17),e.ALo(18,"date"),e.qZA()(),e.TgZ(19,"td",22)(20,"span"),e._uU(21),e.qZA()()),2&l){const g=h.$implicit,_=e.oxw();e.xp6(1),e.Udp("width",_.tableHeaders[0].width),e.xp6(1),e.hij(" ",g.id," "),e.xp6(2),e.Udp("width",_.tableHeaders[1].width),e.xp6(1),e.hij(" ",g.id," "),e.xp6(2),e.Udp("width",_.tableHeaders[2].width),e.xp6(2),e.Q6J("src",_.vehicleIcon(g.vehicleType),e.LSH),e.xp6(2),e.Oqu(g.vehicleNumber),e.xp6(2),e.Udp("width",_.tableHeaders[3].width),e.xp6(1),e.hij(" ",null==g.carPark?null:g.carPark.code," "),e.xp6(2),e.Udp("width",_.tableHeaders[4].width),e.xp6(1),e.hij(" ",e.xi3(18,19,g.createdDate,"d LLL yyyy")," "),e.xp6(3),e.Udp("width",_.tableHeaders[5].width),e.xp6(1),e.hij(" ",g.remark," ")}}let R=(()=>{class l extends Z.Gw{constructor(g,_,C,o,O,i,c){super(),this.router=g,this.route=_,this.maintenanceService=C,this.carParkService=o,this.codeTablesService=O,this.translate=i,this.store=c,this.openEnforcementCreation=new e.vpe,this.vehicleIcon=d.mt,this.keyword="",this.dateRange=[],this.carParkInput$=new z.xQ,this.vehicleType="",this.keyword$=new z.xQ,this.alive=!0,this.tableHeaders=[{text:"#",width:"30px",align:Z.iW.Center},{text:"ID",column:"code",width:"80px"},{text:"Vehicle",column:"vehiclePlateNo",width:"150px"},{text:"Car Park",column:"driverId",width:"150px"},{text:"Date Created",column:"lastVisitedCarParkId",width:"200px"},{text:"Remark",column:"remark",width:"400px"}],this.user$=c.pipe((0,P.Ys)("global"))}get filterParams(){return{carParkId:this.carParkId,from:this.dateRange&&this.dateRange.length?this.dateRange[0].toISOString():void 0,to:this.dateRange&&this.dateRange.length>1?this.dateRange[1].toISOString():void 0,vehicleType:this.vehicleType,keyword:this.keyword,sort:"createdDate,desc"}}gotoCreate(){this.openEnforcementCreation.emit()}reloadData(){this.reloadDataService(this.maintenanceService,"filterEnforcements")}pageChanged(g){this.pagination=g,this.reloadData()}ngOnInit(){this.reloadData(),this.carParks$=this.carParkInput$.pipe((0,x.O)(""),(0,D.b)(200),(0,B.x)(),(0,K.b)(()=>this.carParkLoading=!0),(0,y.w)(_=>this.carParkService.getSimpleList(_).pipe((0,Q.U)(C=>_?C.filter(o=>-1!==o.name.toLowerCase().indexOf(_.toLowerCase())):C.slice(0,20)),(0,K.b)(()=>this.carParkLoading=!1)))),this.vehicleTypes$=this.codeTablesService.filterModelByType(A.BcL.VehicleType),this.keyword$.debounceTime(500).subscribe(()=>{this.reloadData()});const g=this.tableHeaders.map(_=>_.text);this.translate.get(g).subscribe(_=>{this.tableHeaders.forEach(C=>{for(let o in _)_.hasOwnProperty(o)&&C.text===o&&(C.text=_[o])})}),this.user$.takeWhile(()=>this.alive).subscribe(({user:_})=>{this.viewOnly=(0,t.intersection)([A.i44.ThirdParty,A.i44.Tester,A.i44.Auditor],_.authorities).length>0})}}return l.\u0275fac=function(g){return new(g||l)(e.Y36(b.F0),e.Y36(b.gz),e.Y36(L.N),e.Y36(v.x),e.Y36(U.I),e.Y36(I.sK),e.Y36(P.yh))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-enforcement-home"]],outputs:{openEnforcementCreation:"openEnforcementCreation"},features:[e.qOj],decls:46,vars:34,consts:[[1,"form-group","m-form__group","m-portlet__filters"],[1,"m-portlet__filter","col-2"],[1,"col-form-label"],["placeholder","","bindLabel","name","bindValue","id",3,"items","ngModel","typeahead","dropdownPosition","loading","ngModelChange","change"],[1,"m-portlet__filter"],[1,"m-input-icon","m-input-icon--right"],["type","text","placeholder","","bsDaterangepicker","",1,"form-control","m-input",3,"ngModel","ngModelChange"],[1,"m-input-icon__icon","m-input-icon__icon--right"],[1,"la","la-calendar"],["name","vehicleType",1,"form-control","m-input",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"m-input-icon","m-input-icon--left"],["type","text","placeholder","",1,"form-control","m-input",3,"ngModel","ngModelChange"],[1,"m-input-icon__icon","m-input-icon__icon--left"],[1,"la","la-search"],[1,"btn","btn-main","m-btn","m-btn--custom","m-btn--icon","m-btn--air","m-btn--pill","btn-sm",3,"disabled","click"],[1,"la","la-plus"],[3,"headers","items","loading","pagination","scrollingDisabled","pageChanged"],["rowTemplate",""],[3,"value"],[1,"m-datatable__cell","text-center"],[1,"m-datatable__cell"],["alt","",3,"src"]],template:function(g,_){1&g&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div")(6,"ng-select",3),e.NdJ("ngModelChange",function(o){return _.carParkId=o})("change",function(){return _.reloadData()}),e.ALo(7,"async"),e.qZA()()(),e.TgZ(8,"div",4)(9,"label",2),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div")(13,"div",5)(14,"input",6),e.NdJ("ngModelChange",function(o){return _.dateRange=o})("ngModelChange",function(){return _.reloadData()}),e.qZA(),e.TgZ(15,"span",7)(16,"span"),e._UZ(17,"i",8),e.qZA()()()()(),e.TgZ(18,"div",4)(19,"label",2),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"div")(23,"select",9),e.NdJ("ngModelChange",function(o){return _.vehicleType=o})("ngModelChange",function(){return _.reloadData()}),e.TgZ(24,"option",10),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.YNc(27,E,3,4,"option",11),e.ALo(28,"async"),e.qZA()()(),e.TgZ(29,"div",4)(30,"label",2),e._uU(31," Vehicle No. / Remark "),e.qZA(),e.TgZ(32,"div",12)(33,"input",13),e.NdJ("ngModelChange",function(o){return _.keyword=o})("ngModelChange",function(o){return _.keyword$.next(o)}),e.qZA(),e.TgZ(34,"span",14)(35,"span"),e._UZ(36,"i",15),e.qZA()()()(),e.TgZ(37,"button",16),e.NdJ("click",function(){return _.gotoCreate()}),e.TgZ(38,"span"),e._UZ(39,"i",17),e.TgZ(40,"span"),e._uU(41),e.ALo(42,"translate"),e.qZA()()()(),e.TgZ(43,"app-datatable",18),e.NdJ("pageChanged",function(o){return _.pageChanged(o)}),e.YNc(44,M,22,22,"ng-template",19,19,e.W1O),e.qZA()),2&g&&(e.xp6(3),e.hij(" ",e.lcZ(4,20,"Car Park")," "),e.xp6(3),e.Q6J("items",e.lcZ(7,22,_.carParks$))("ngModel",_.carParkId)("typeahead",_.carParkInput$)("dropdownPosition","bottom")("loading",_.carParkLoading),e.xp6(4),e.hij(" ",e.lcZ(11,24,"Time Range")," "),e.xp6(4),e.Q6J("ngModel",_.dateRange),e.xp6(6),e.hij(" ",e.lcZ(21,26,"Vehicle Type")," "),e.xp6(3),e.Q6J("ngModel",_.vehicleType),e.xp6(2),e.Oqu(e.lcZ(26,28,"All")),e.xp6(2),e.Q6J("ngForOf",e.lcZ(28,30,_.vehicleTypes$)),e.xp6(6),e.Q6J("ngModel",_.keyword),e.xp6(4),e.Q6J("disabled",_.viewOnly),e.xp6(4),e.hij(" ",e.lcZ(42,32,"Create Enforcement")," "),e.xp6(2),e.Q6J("headers",_.tableHeaders)("items",_.data)("loading",_.loading)("pagination",_.pagination)("scrollingDisabled",!0))},dependencies:[W.sg,F.Uo,Z.nE,J.YN,J.Kr,J.Fj,J.EJ,J.JJ,J.On,q.T,S.F,$.w9,W.Ov,W.rS,W.uU,I.X$],encapsulation:2}),l})()}}]);