"use strict";(self.webpackChunkst_admin=self.webpackChunkst_admin||[]).push([[4378],{76284:(E,b,o)=>{o.d(b,{z:()=>g});var _=o(3927),u=o(94650),r=o(80529),M=o(28555),v=o(11481),Z=o(91599);let g=(()=>{class T extends _.su{constructor(t,f,C,d){super(t,f),this.http=t,this.store=f,this.sanitizer=C,this.modelName="User",this.baseUrl="",this.handleError=d.createHandleError(`${this.modelName}Service`)}uploadImage(t){const f=this.getUrl("carpark/api/assets/img"),C=new FormData;return C.append("file",t,t.name),this.post(f,C).map(({uuid:d})=>this.getImage(d))}getImage(t){return this.getUrl(`carpark/api/resources/${t}`)}getImageByUuid(t,f){return this.get(this.getUrl(`carpark/api/resources/${t}`),{responseType:"blob"}).map(C=>f?this._getSafeFileUrl(C):this.getSafeFileUrl(C))}getSafeFileUrl(t){return this.sanitizer.bypassSecurityTrustUrl(URL.createObjectURL(t))}_getSafeFileUrl(t){return{imgUrl:this.sanitizer.bypassSecurityTrustUrl(URL.createObjectURL(t)),type:t.type}}requestSessionImage(t,f){const C=this.getUrl(`carpark/api/anpr/request/${t}/${f}`);return this.get(C,{responseType:"text"})}getSessionImage(t){return this.get(this.getUrl(`carpark/api/anpr/assets/${t}/1`),{responseType:"blob"}).map(f=>this.getSafeFileUrl(f))}}return T.\u0275fac=function(t){return new(t||T)(u.LFG(r.eN),u.LFG(M.yh),u.LFG(v.H7),u.LFG(Z.k))},T.\u0275prov=u.Yz7({token:T,factory:T.\u0275fac}),T})()},71942:(E,b,o)=>{o.d(b,{f:()=>C});var _=o(38014),u=o(3927),r=o(26245),M=o(21086),v=o(27221),Z=o(66708),g=o(94650),T=o(60097),A=o(80529),t=o(28555),f=o(91599);let C=(()=>{class d extends u.su{constructor(i,s,h,m){super(s,h),this.carparkService=i,this.http=s,this.store=h,this.modelName="Vehicle",this.handleError=m.createHandleError(`${this.modelName}Service`),this.handleDynamicUrl()}ngOnInit(){}handleDynamicUrl(){const i=JSON.parse(localStorage.getItem("user")).login;this.baseUrl=this.carparkService.isMotorist()&&Z.Z.isNotNull(i)?`carpark/api/drivers/${i}/vehicles`:"carpark/api/vehicle/get-vehicles"}getTelList(i,s){console.log(i);const h=this.getUrl((0,r.U8)("carpark/api/vehicle/vehicles",{...i,...(0,r.jq)(s)}));return this.get(h)}filterModel(i,s){const h=this.getUrl((0,r.U8)(this.baseUrl,{...i,...(0,r.jq)(s)}));return this.get(h).pipe((0,v.K)(this.handleError(`${this.modelName}Filter`,{}))).map(m=>Array.isArray(m)?(0,u.eC)(m):(0,u.O7)(m))}updateVehicle(i){const s=this.getUrl(`carpark/api/drivers/${i.driverCode}/vehicles/${i.vehicleId}`);return this.patch(s,i.vehicle).pipe((0,v.K)(this.handleError(`${this.modelName}Update`,{})))}getModel(i){const s=this.getUrl(`carpark/api/vehicle/${i}`);return this.get(s).pipe((0,v.K)(this.handleError(`${this.modelName}Get`,{})))}deleteModel(i,s){const h=this.getUrl(`carpark/api/drivers/${i}/vehicles/${s}`);return this.delete(h).pipe((0,v.K)(this.handleError(`${this.modelName}Delete`)))}deleteAdminModel(i){const s=this.getUrl(`carpark/api/admin/vehicle/${i}`);return this.delete(s).pipe((0,v.K)(this.handleError(`${this.modelName}Delete`)))}createVehicle(i,s){const h=this.getUrl(`carpark/api/drivers/${i}/vehicles`);return this.post(h,s)}putUpdateVehicle(i,s){const h=this.getUrl(`carpark/api/drivers/${i}/vehicles/${s.id}`);return this.put(h,s)}getDriverCode(i){const s=this.getUrl(`carpark/api/drivers/${i}/driverCode`);return this.get(s)}createModel(i,s){const h=this.getUrl(`carpark/api/drivers/${i}/vehicles`);return this.post(h,s).pipe((0,v.K)(this.handleError(`${this.modelName}Create`,{})))}createVehicleAdmin(i){const s=this.getUrl(`carpark/api/admin/vehicles/${i.mobile}`);return this.post(s,i).pipe((0,v.K)(this.handleError(`${this.modelName}Create`,{})))}updateModel(i){const s=this.getUrl("carpark/api/admin/vehicle-changes");return this.post(s,i).pipe((0,v.K)(this.handleError(`${this.modelName}Update`,{})))}getSimpleList(){const i=this.getUrl("carpark/api/vehicle/simple-vehicles-list");return this.get(i).pipe((0,v.K)(this.handleError(`${this.modelName}SimpleList`,{})))}filterModelByDriver(i){const s=this.getUrl(`carpark/api/drivers/${i}/vehicles`);return this.get(s).pipe((0,v.K)(()=>(0,M.of)([])))}isOperator(){const i=JSON.parse(localStorage.getItem("user-roles"));return!(!Z.Z.isNotNull(i)||!i.includes(_.i44.Operator))}getUserVehicle(i,s){this.baseUrl=`carpark/api/drivers/${i}/vehicles`;const h=this.getUrl((0,r.U8)(this.baseUrl,{...(0,r.jq)(s)}));return this.get(h).pipe((0,v.K)(this.handleError(`${this.modelName}Filter`,{}))).map(m=>Array.isArray(m)?(0,u.eC)(m):(0,u.O7)(m))}}return d.\u0275fac=function(i){return new(i||d)(g.LFG(T.x),g.LFG(A.eN),g.LFG(t.yh),g.LFG(f.k))},d.\u0275prov=g.Yz7({token:d,factory:d.\u0275fac}),d})()},76916:(E,b,o)=>{o.d(b,{G:()=>C});var _=o(34793),u=o(92198),r=o(94650),M=o(89383),v=o(60097),Z=o(36895);function g(d,x){if(1&d&&(r.TgZ(0,"a",14)(1,"span",15),r._uU(2),r.ALo(3,"translate"),r.qZA()()),2&d){const i=r.oxw().$implicit;r.xp6(2),r.hij(" ",r.lcZ(3,1,i.label)," ")}}function T(d,x){if(1&d&&(r.TgZ(0,"a",16)(1,"span",15),r._uU(2),r.ALo(3,"translate"),r.qZA()()),2&d){const i=r.oxw(),s=i.$implicit,h=i.last,m=r.oxw(2);r.Q6J("routerLink",s.url)("queryParams",h&&m.route.snapshot.queryParams),r.xp6(2),r.hij(" ",r.lcZ(3,3,s.label)," ")}}function A(d,x){if(1&d&&(r.ynx(0),r.TgZ(1,"li",10)(2,"span"),r._uU(3," > "),r.qZA()(),r.TgZ(4,"li",11),r.YNc(5,g,4,3,"a",12),r.YNc(6,T,4,5,"a",13),r.qZA(),r.BQk()),2&d){const i=x.first;r.xp6(5),r.Q6J("ngIf",i),r.xp6(1),r.Q6J("ngIf",!i)}}function t(d,x){if(1&d&&(r.TgZ(0,"div",1)(1,"div",2)(2,"div",3),r._UZ(3,"h3",4),r.TgZ(4,"ul",5)(5,"li",6)(6,"a",7),r._UZ(7,"i",8),r.qZA()(),r.YNc(8,A,7,2,"ng-container",9),r.qZA()(),r.TgZ(9,"div"),r.Hsn(10),r.qZA()()()),2&d){const i=r.oxw();r.xp6(3),r.Q6J("innerHTML",i.title,r.oJD),r.xp6(5),r.Q6J("ngForOf",i.breads)}}const f=["*"];let C=(()=>{class d{constructor(i,s,h,m){this.router=i,this.route=s,this.translate=h,this._carparkService=m,this.breads=[],this.loginUser=""}ngOnInit(){let i=JSON.parse(localStorage.getItem("user-roles"))[0];this.loginUser=i,console.log(this.loginUser,"\u4fe1\u606f"),this.breads=this.buildBreadCrumb(this.route.root),this.translate.get(this.breads[0].label).subscribe(h=>{this.label=h}),this.router.events.pipe((0,u.h)(h=>h instanceof _.m2)).subscribe(()=>{this.breads=this.buildBreadCrumb(this.route.root)})}buildBreadCrumb(i,s=[""],h=[]){const m=i.snapshot.url[0]&&i.snapshot.url[0].path,L=[...s,m],D={...this.extractBreadcrumb(i),url:L},y=m&&D.label?[...h,D]:h;return this.title=D.title||this.title||"",this.isMotorist&&"My Vehicle(s)"===D.label&&(this.title="My Vehicle(s)"),i.firstChild?m?this.buildBreadCrumb(i.firstChild,L,y):this.buildBreadCrumb(i.firstChild,s,h):(this.translate.get(this.title).subscribe(U=>{this.title=U}),y)}get isMotorist(){return this._carparkService.isMotorist()}extractBreadcrumb(i){return i.snapshot.data.breadcrumb instanceof Function?i.snapshot.data.breadcrumb(i):i.snapshot.data.breadcrumb}}return d.\u0275fac=function(i){return new(i||d)(r.Y36(_.F0),r.Y36(_.gz),r.Y36(M.sK),r.Y36(v.x))},d.\u0275cmp=r.Xpm({type:d,selectors:[["app-title-bar"]],ngContentSelectors:f,decls:1,vars:1,consts:[["class","m-subheader",4,"ngIf"],[1,"m-subheader"],[1,"d-flex","align-items-center"],[1,"mr-auto"],[1,"m-subheader__title","m-subheader__title--separator","text-main",3,"innerHTML"],[1,"m-subheader__breadcrumbs","m-nav","m-nav--inline"],[1,"m-nav__item","m-nav__item--home"],["routerLink","/",1,"m-nav__link","m-nav__link--icon"],[1,"m-nav__link-icon","la","la-home"],[4,"ngFor","ngForOf"],[1,"m-nav__separator"],[1,"m-nav__item"],["class","m-nav__link",4,"ngIf"],["class","m-nav__link",3,"routerLink","queryParams",4,"ngIf"],[1,"m-nav__link"],[1,"m-nav__link-text"],[1,"m-nav__link",3,"routerLink","queryParams"]],template:function(i,s){1&i&&(r.F$t(),r.YNc(0,t,11,2,"div",0)),2&i&&r.Q6J("ngIf","ROLE_TPO_PARTNER"!==s.loginUser)},dependencies:[Z.sg,Z.O5,_.yS,M.X$],encapsulation:2}),d})()},54378:(E,b,o)=>{o.r(b),o.d(b,{ViolationsModule:()=>Tt,createTranslateLoader:()=>H});var _=o(36895),u=o(34793),r=o(60097),M=o(36511),v=o(91599),Z=o(42684),g=o(71942),T=o(3927),A=o(26245),t=o(94650),f=o(80529),C=o(28555);let d=(()=>{class a extends T.su{constructor(e,n,l){super(e,n),this.http=e,this.store=n,this.modelName="Violation",this.baseUrl="carpark/api/enforcement/transactions",this.handleError=l.createHandleError(`${this.modelName}Service`)}filterModel(e,n){return super.filterModel(e,n).map(l=>l.data?l:{data:[],pagination:(0,A.f$)()})}createModel(e){const n=this.getUrl("carpark/api/parking-transactions-entry");return this.post(n,e)}getRuleList(e){const n=this.getUrl(`carpark/api/code-tables/type/${e}`);return this.get(n)}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(f.eN),t.LFG(C.yh),t.LFG(v.k))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac}),a})();var x=o(30329),i=o(59501),s=o(88796),h=o(21532),m=o(24006),L=o(372),D=o(59245),y=o(89518),U=o(89383),S=o(19832),N=o(76284);function K(a){return new S.w(a,"../assets/i18n/",".json")}let k=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({providers:[d,r.x,M.I,N.z],imports:[_.ez,m.u5,u.Bz,h.x,x.D,L.kn,D.mr,s.A0,y.H3,U.aw.forChild({loader:{provide:U.Zw,useFactory:K,deps:[f.eN]}})]}),a})();var W=o(76916),O=o(38014),P=o(79118),$=o(15035),B=o(8929),j=o(1059),Q=o(80013),Y=o(75778),F=o(2994),w=o(87545),G=o(71198),z=o(87501),X=o(36053),q=o(21086),J=o(20388),tt=o(40269);function et(a,p){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&a){const e=p.$implicit,n=t.oxw().$implicit,l=t.oxw();t.Udp("width",l.originalHeaders[6].width),t.xp6(1),t.hij(" ",e.code===l.addZero(n.ruleInfringed)?e.value:""," ")}}function nt(a,p){if(1&a){const e=t.EpF();t.TgZ(0,"td",5),t.NdJ("click",function(){const c=t.CHM(e).index,I=t.oxw(),V=t.MAs(1);return t.KtG(I.toggleViolation(V,c))}),t.TgZ(1,"span"),t._UZ(2,"i",6),t.qZA()(),t.TgZ(3,"td",7)(4,"span"),t._uU(5),t.qZA()(),t.TgZ(6,"td",7)(7,"span")(8,"span"),t._UZ(9,"img",8),t.qZA(),t.TgZ(10,"span"),t._uU(11),t.qZA()()(),t.TgZ(12,"td",7)(13,"span"),t._uU(14),t.qZA()(),t.TgZ(15,"td",7)(16,"span"),t._uU(17),t.ALo(18,"date"),t._UZ(19,"br"),t._uU(20),t.ALo(21,"date"),t.qZA()(),t.TgZ(22,"td",7)(23,"span"),t._uU(24),t.qZA()(),t.TgZ(25,"td",7),t.YNc(26,et,2,3,"span",9),t.qZA(),t.TgZ(27,"td",7)(28,"span"),t._uU(29),t.qZA()()}if(2&a){const e=p.$implicit,n=p.expanded,l=t.oxw();t.xp6(1),t.Udp("width",l.tableHeaders[0].width),t.xp6(1),t.Q6J("ngClass",n?"fa-caret-down":"fa-caret-right"),t.xp6(2),t.Udp("width",l.originalHeaders[1].width),t.xp6(1),t.hij(" ",e.id," "),t.xp6(2),t.Udp("width",l.originalHeaders[2].width),t.xp6(2),t.Q6J("src",l.vehicleTypeLogo(e),t.LSH),t.xp6(2),t.Oqu(e.plateNo),t.xp6(2),t.Udp("width",l.originalHeaders[3].width),t.xp6(1),t.hij(" ",null==e.carPark?null:e.carPark.code," "),t.xp6(2),t.Udp("width",l.originalHeaders[4].width),t.xp6(1),t.hij(" ",t.xi3(18,24,e.incidentDateTime,"MMM d, y")," "),t.xp6(3),t.hij(" ",t.xi3(21,27,e.incidentDateTime,"h:mm:ss a")," "),t.xp6(3),t.Udp("width",l.originalHeaders[5].width),t.xp6(1),t.hij(" ",e.violationType," "),t.xp6(2),t.Q6J("ngForOf",l.typeList),t.xp6(2),t.Udp("width",l.originalHeaders[7].width),t.xp6(1),t.hij(" ",e.compositionFine," ")}}function it(a,p){if(1&a){const e=t.EpF();t.TgZ(0,"div")(1,"img",16),t.NdJ("click",function(){const c=t.CHM(e).$implicit,I=t.oxw(3),V=t.MAs(7);return t.KtG(I.showLargerSize(V,c))})("contextmenu",function(l){t.CHM(e);const c=t.oxw(3);return t.KtG(c.onRightClick(l))}),t.qZA()()}if(2&a){const e=p.$implicit;t.xp6(1),t.Q6J("src",e,t.LSH)}}function at(a,p){if(1&a&&(t.ynx(0),t.YNc(1,it,2,1,"div",15),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",e.attachments)}}function ot(a,p){1&a&&(t.TgZ(0,"div"),t._uU(1,"Loading Attachments"),t.qZA())}function rt(a,p){1&a&&(t.TgZ(0,"div"),t._uU(1,"No Attachment"),t.qZA())}function lt(a,p){if(1&a&&(t.TgZ(0,"div"),t.YNc(1,ot,2,0,"div",14),t.YNc(2,rt,2,0,"div",14),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",0!==e.assets.length),t.xp6(1),t.Q6J("ngIf",0===e.assets.length)}}function st(a,p){if(1&a&&(t.TgZ(0,"td",7),t._UZ(1,"span"),t.qZA(),t.TgZ(2,"td",7)(3,"div",10)(4,"div",11),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"div",12)(8,"div",13),t.YNc(9,at,2,1,"ng-container",14),t.YNc(10,lt,3,2,"div",14),t.qZA()()()()),2&a){const e=p.$implicit,n=t.oxw();t.xp6(1),t.Udp("width",n.tableHeaders[0].width),t.xp6(4),t.hij(" ",t.lcZ(6,5,"Attachment")," "),t.xp6(4),t.Q6J("ngIf",e.attachments),t.xp6(1),t.Q6J("ngIf",!e.attachments)}}const ct=function(a,p){return{width:a,height:p}};function pt(a,p){if(1&a){const e=t.EpF();t.TgZ(0,"div",17)(1,"div",18)(2,"div",19)(3,"img",20),t.NdJ("contextmenu",function(l){t.CHM(e);const c=t.oxw();return t.KtG(c.onRightClick(l))}),t.qZA()(),t.TgZ(4,"div",21)(5,"button",22),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.imgZoom("minus"))}),t._uU(6,"-"),t.qZA(),t.TgZ(7,"button",23),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.imgZoom("plus"))}),t._uU(8,"+"),t.qZA()()(),t.TgZ(9,"div",24)(10,"button",23),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.cancel())}),t._uU(11,"Cancel"),t.qZA()()()}if(2&a){const e=t.oxw();t.xp6(3),t.Q6J("src",e.selectedImg,t.LSH)("ngStyle",t.WLB(2,ct,e.imgWidth+"px",e.imgHeight+"px"))}}const R=[{text:"",width:"30px",align:P.iW.Center},{text:"ID",width:"60px"},{text:"Vehicle",column:"vehiclePlateNo",width:"140px"},{text:"Car Park ID",column:"carParkId",width:"120px"},{text:"Offence Time",column:"offenceTime",width:"120px"},{text:"Violation Type",column:"violationType",width:"120px"},{text:"Type",column:"type",width:"120px"},{text:"Fine",column:"fine",width:"120px"}];let dt=(()=>{class a{constructor(e,n,l,c){this.translate=e,this.assetsService=n,this.modalService=l,this.bsModalRef=c,this.loading=!1,this.pageChange=new t.vpe,this.pagination=(0,A.f$)(),this.data=[],this.defaultImgWidth=800,this.defaultImgHeight=500,this.imgWidth=this.defaultImgWidth,this.imgHeight=this.defaultImgHeight,this.tableHeaders=R,this.originalHeaders=R}vehicleTypeLogo(e){return O.php.filter(n=>n.value===e.plateNo).map(n=>n.icon)[0]}addZero(e){const n="000"+e;return n.substring(n.length-3)}pageChanged(e){this.pagination=e,this.pageChange.emit(this.pagination)}ngOnInit(){const e=this.tableHeaders.map(n=>n.text);this.translate.get(e).subscribe(n=>{this.tableHeaders.forEach(l=>{for(const c in n)n.hasOwnProperty(c)&&l.text===c&&(l.text=n[c])})})}toggleViolation(e,n){e.toggleItem(n);const l=this.data[n];l.attachments||this.getAttachments(l.assets).subscribe({next:c=>l.attachments=c})}getAttachments(e){return console.log(e.length),e.length?(0,X.aj)(e.map(n=>this.assetsService.getImageByUuid(n.assetUuid))):(0,q.of)(null)}saveAs(e,n){e.attachments.map(l=>{this.saveFile(`${e.id}_${n}`,l.changingThisBreaksApplicationSecurity)})}saveFile(e,n){const l=document.createElement("a");document.body.appendChild(l),l.href=n,l.download=e,l.click(),setTimeout(()=>{window.URL.revokeObjectURL(n),document.body.removeChild(l)},0)}showLargerSize(e,n){this.selectedImg=n,this.bsModalRef=this.modalService.show(e,{ignoreBackdropClick:!0,class:"gray modal-lg"}),this.imgWidth=this.defaultImgWidth,this.imgHeight=this.defaultImgHeight}onRightClick(e){return!1}cancel(){this.bsModalRef.hide()}imgZoom(e){if("minus"===e){if(this.imgWidth==this.defaultImgWidth||this.imgHeight==this.defaultImgHeight)return;return this.imgWidth-=100,void(this.imgHeight-=100)}this.imgWidth+=100,this.imgHeight+=100}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(U.sK),t.Y36(N.z),t.Y36(J.tT),t.Y36(J.UZ))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-violations-datatable"]],inputs:{isExtended:"isExtended",loading:"loading",pagination:"pagination",data:"data",typeList:"typeList"},outputs:{pageChange:"pageChange"},decls:8,vars:5,consts:[[3,"headers","items","loading","pagination","scrollingDisabled","pageChanged"],["tableViolations",""],["rowTemplate",""],["expandTemplate",""],["largeSizeImg",""],[1,"m-datatable__cell","text-center",3,"click"],[1,"fa","text-primary",3,"ngClass"],[1,"m-datatable__cell"],["alt","",3,"src"],[3,"width",4,"ngFor","ngForOf"],[1,"row"],[1,"col-3","col-md-2","m-font-weight-500"],[1,"col"],[1,"row","m-0"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"mr-3",2,"max-width","90px","max-height","200px",3,"src","click","contextmenu"],[1,"modal-body","m-form","m-form--fit","m-form--label-align-right","text-center"],[1,"modalContent"],[1,"imgContainer"],[1,"modal-large-size-img",3,"src","ngStyle","contextmenu"],[1,"imgZoomBtnContianer"],["type","button",1,"btn","btn-default","mr-3","minusBtn",3,"click"],["type","button",1,"btn","btn-default","mr-3",3,"click"],[1,"mt-3","text-center"]],template:function(e,n){1&e&&(t.TgZ(0,"app-datatable",0,1),t.NdJ("pageChanged",function(c){return n.pageChanged(c)}),t.YNc(2,nt,30,30,"ng-template",null,2,t.W1O),t.YNc(4,st,11,7,"ng-template",null,3,t.W1O),t.qZA(),t.YNc(6,pt,12,5,"ng-template",null,4,t.W1O)),2&e&&t.Q6J("headers",n.tableHeaders)("items",n.data)("loading",n.loading)("pagination",n.pagination)("scrollingDisabled",!0)},dependencies:[_.mk,_.sg,_.O5,_.PC,tt.Uo,P.nE,_.uU,U.X$],styles:[".modalContent[_ngcontent-%COMP%]{display:flex}.modalContent[_ngcontent-%COMP%]   .imgZoomBtnContianer[_ngcontent-%COMP%]{flex-direction:column;justify-content:flex-end;align-items:center;display:flex;margin-left:20px}.modalContent[_ngcontent-%COMP%]   .imgZoomBtnContianer[_ngcontent-%COMP%]   .minusBtn[_ngcontent-%COMP%]{margin-bottom:10px}.modalContent[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]{width:900px;height:500px;overflow:auto}"]}),a})();const ht=["filterTemplate"];function gt(a,p){if(1&a&&(t.TgZ(0,"option",17),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&a){const e=p.$implicit;t.Q6J("value",e.code),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.value)," ")}}function mt(a,p){if(1&a&&(t.TgZ(0,"option",17),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&a){const e=p.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.value)," ")}}function ut(a,p){if(1&a&&(t.TgZ(0,"option",17),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&a){const e=p.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.description)," ")}}let _t=(()=>{class a extends P.Gw{constructor(e,n,l,c){super(),this.violationService=e,this.carParkService=n,this.codeTablesService=l,this.translate=c,this.vehiclePlateNo="",this.loading=!1,this.violationType="",this.ruleInfringed="",this.status="",this.type="",this.timeRange=[],this.vehicle$=new B.xQ,this.StatusList=O.xM4,this.carParkInput$=new B.xQ,this.ruleList=[],this.pagination=(0,A.f$)(),this.data=[]}get filterParams(){return{vehicle:this.vehicle,carPark:this.carParkId,violationType:this.violationType,status:this.status,type:this.ruleInfringed,from:this.timeRange[0]&&(0,$.W8)(this.timeRange[0]),to:this.timeRange[1]&&(0,$.W8)(this.timeRange[1]),sort:"incidentDateTime,desc"}}reloadData(){this.reloadDataService(this.violationService)}pageChanged(e){this.pagination=e,this.reloadData()}ngOnInit(){this.vehicle$.debounceTime(500).subscribe(()=>{this.reloadData()}),this.reloadData(),this.carParks$=this.carParkInput$.pipe((0,j.O)(""),(0,Q.b)(200),(0,Y.x)(),(0,F.b)(()=>this.carParkLoading=!0),(0,w.w)(e=>this.carParkService.getSimpleList(e).pipe((0,F.b)(()=>this.carParkLoading=!1)))),this.violationTypes$=this.codeTablesService.filterModelByType(O.BcL.Violation),this.violationService.getRuleList(O.BcL.RuleInfringed).subscribe(e=>{this.ruleList=e})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(d),t.Y36(r.x),t.Y36(M.I),t.Y36(U.sK))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-violations-table"]],contentQueries:function(e,n,l){if(1&e&&t.Suo(l,ht,5),2&e){let c;t.iGM(c=t.CRH())&&(n.filterTemplate=c.first)}},inputs:{isExtended:"isExtended"},features:[t.qOj],decls:56,vars:47,consts:[[1,"form-group","m-form__group","m-portlet__filters"],[1,"m-portlet__filter","col-3"],["placeholder","","bindLabel","name","bindValue","id",3,"items","ngModel","typeahead","loading","ngModelChange","change"],[1,"m-portlet__filter"],["bsDaterangepicker","",1,"form-control",3,"ngModel","ngModelChange"],["drp","bsDaterangepicker"],[1,"col-form-label"],[1,"m-input-icon","m-input-icon--left"],["type","text","placeholder","",1,"form-control","m-input",3,"ngModel","ngModelChange"],[1,"m-input-icon__icon","m-input-icon__icon--left"],[1,"la","la-search"],["name","type",1,"form-control","m-input",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["name","violationType",1,"form-control","m-input",3,"ngModel","ngModelChange"],["name","status",1,"form-control","m-input",3,"ngModel","ngModelChange"],[3,"data","typeList","loading","pagination","pageChange"],[3,"value"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"label"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div")(6,"ng-select",2),t.NdJ("ngModelChange",function(c){return n.carParkId=c})("change",function(){return n.reloadData()}),t.ALo(7,"async"),t.qZA()()(),t.TgZ(8,"div",3)(9,"label"),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"div")(13,"input",4,5),t.NdJ("ngModelChange",function(c){return n.timeRange=c})("ngModelChange",function(){return n.reloadData()}),t.qZA()()(),t.TgZ(15,"div",3)(16,"label",6),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"div",7)(20,"input",8),t.NdJ("ngModelChange",function(c){return n.vehicle=c})("ngModelChange",function(c){return n.vehicle$.next(c)}),t.qZA(),t.TgZ(21,"span",9)(22,"span"),t._UZ(23,"i",10),t.qZA()()()(),t.TgZ(24,"div",3)(25,"label"),t._uU(26),t.ALo(27,"translate"),t.qZA(),t.TgZ(28,"div")(29,"select",11),t.NdJ("ngModelChange",function(c){return n.ruleInfringed=c})("ngModelChange",function(){return n.reloadData()}),t.TgZ(30,"option",12),t._uU(31),t.ALo(32,"translate"),t.qZA(),t.YNc(33,gt,3,4,"option",13),t.qZA()()(),t.TgZ(34,"div",3)(35,"label"),t._uU(36),t.ALo(37,"translate"),t.qZA(),t.TgZ(38,"div")(39,"select",14),t.NdJ("ngModelChange",function(c){return n.violationType=c})("ngModelChange",function(){return n.reloadData()}),t.TgZ(40,"option",12),t._uU(41),t.ALo(42,"translate"),t.qZA(),t.YNc(43,mt,3,4,"option",13),t.ALo(44,"async"),t.qZA()()(),t.TgZ(45,"div",3)(46,"label"),t._uU(47),t.ALo(48,"translate"),t.qZA(),t.TgZ(49,"div")(50,"select",15),t.NdJ("ngModelChange",function(c){return n.status=c})("ngModelChange",function(){return n.reloadData()}),t.TgZ(51,"option",12),t._uU(52),t.ALo(53,"translate"),t.qZA(),t.YNc(54,ut,3,4,"option",13),t.qZA()()()(),t.TgZ(55,"app-violations-datatable",16),t.NdJ("pageChange",function(c){return n.pageChanged(c)}),t.qZA()),2&e&&(t.xp6(3),t.hij(" ",t.lcZ(4,25,"Car Park"),": "),t.xp6(3),t.Q6J("items",t.lcZ(7,27,n.carParks$))("ngModel",n.carParkId)("typeahead",n.carParkInput$)("loading",n.carParkLoading),t.xp6(4),t.hij(" ",t.lcZ(11,29,"Date"),": "),t.xp6(3),t.Q6J("ngModel",n.timeRange),t.xp6(4),t.hij(" ",t.lcZ(18,31,"Vehicle No."),": "),t.xp6(3),t.Q6J("ngModel",n.vehicle),t.xp6(6),t.hij(" ",t.lcZ(27,33,"Type"),": "),t.xp6(3),t.Q6J("ngModel",n.ruleInfringed),t.xp6(2),t.Oqu(t.lcZ(32,35,"All")),t.xp6(2),t.Q6J("ngForOf",n.ruleList),t.xp6(3),t.hij(" ",t.lcZ(37,37,"Violation Type"),": "),t.xp6(3),t.Q6J("ngModel",n.violationType),t.xp6(2),t.Oqu(t.lcZ(42,39,"All")),t.xp6(2),t.Q6J("ngForOf",t.lcZ(44,41,n.violationTypes$)),t.xp6(4),t.hij(" ",t.lcZ(48,43,"Status"),": "),t.xp6(3),t.Q6J("ngModel",n.status),t.xp6(2),t.Oqu(t.lcZ(53,45,"All")),t.xp6(2),t.Q6J("ngForOf",n.StatusList),t.xp6(1),t.Q6J("data",n.data)("typeList",n.ruleList)("loading",n.loading)("pagination",n.pagination))},dependencies:[_.sg,m.YN,m.Kr,m.Fj,m.EJ,m.JJ,m.On,G.T,z.F,s.w9,y.Bp,dt,_.Ov,_.rS,U.X$],encapsulation:2}),a})();function H(a){return new S.w(a,"../assets/i18n/",".json")}const ft=[{path:"",component:i.f,children:[{path:"",component:(()=>{class a{constructor(e){this.translate=e,this.breadcrumbs=[{text:"Violations"}],this.carParks=[]}ngOnInit(){}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(U.sK))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-violations-home"]],decls:6,vars:1,consts:[[1,"m-content"],[1,"m-portlet","m-portlet--bordered-semi","m--padding-top-40"],[1,"m-portlet__body","m-portlet__body--scrollable"],[1,"m-portlet__frame"],[3,"isExtended"]],template:function(e,n){1&e&&(t._UZ(0,"app-title-bar"),t.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3),t._UZ(5,"app-violations-table",4),t.qZA()()()()),2&e&&(t.xp6(5),t.Q6J("isExtended",!0))},dependencies:[W.G,_t],encapsulation:2}),a})()}]}];let Tt=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({providers:[v.k,Z.e,d,r.x,g.f,M.I],imports:[_.ez,u.Bz.forChild(ft),h.x,x.D,k,s.A0,U.aw.forChild({loader:{provide:U.Zw,useFactory:H,deps:[f.eN]}}),u.Bz]}),a})()},15035:(E,b,o)=>{o.d(b,{W8:()=>Z});var _=o(21837),u=(()=>((u||(u={})).Med="yyyy-LL-dd",u))();function Z(g,T=u.Med){return g?_.ou.fromJSDate(g).toFormat(T):null}}}]);